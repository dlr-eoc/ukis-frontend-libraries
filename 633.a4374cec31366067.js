"use strict";(self.webpackChunkdemo_maps=self.webpackChunkdemo_maps||[]).push([[633],{4633:(Or,be,c)=>{c.r(be),c.d(be,{RouteMap4Module:()=>Nr,RouteMap4RoutingModule:()=>Ke});var K=c(8692),ke=c(8808),Pe=c(7223),_=c(5548),Ce=c(790),ae=c(1899),Qe=c(4074),Le=c(4420),k=c(8051),Ie=c(9500),$e=c(5063);const Q=34962,$=35048,Ue=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function ce(i,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!$e.ME},t);const e=Ue.length;for(let r=0;r<e;++r)try{const n=i.getContext(Ue[r],t);if(n)return n}catch{}return null}var Me=c(992);function he(i){switch(i){case Q:return Float32Array;case 34963:return Uint32Array;default:return Float32Array}}const pe=class it{constructor(t,e){this.array=null,this.type=t,(0,Me.h)(t===Q||34963===t,62),this.usage=void 0!==e?e:35044}ofSize(t){this.array=new(he(this.type))(t)}fromArray(t){this.array=he(this.type).from(t)}fromArrayBuffer(t){this.array=new(he(this.type))(t)}getType(){return this.type}getArray(){return this.array}getUsage(){return this.usage}getSize(){return this.array?this.array.length:0}};var st=c(3570),at=c(6555),de=c(9683),z=c(8779);var lt=c(6450),G=c(513);const Ge=class ht{constructor(t){this.gl_=t.webGlContext;const e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();const r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),e.compileShader(r);const n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,t.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),e.compileShader(n),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,r),e.attachShader(this.renderTargetProgram_,n),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(l=>{this.uniforms_.push({value:t.uniforms[l],location:e.getUniformLocation(this.renderTargetProgram_,l)})})}getGL(){return this.gl_}init(t){const e=this.getGL(),r=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const n=0,o=e.RGBA,l=0,a=e.RGBA,h=e.UNSIGNED_BYTE,u=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,n,o,r[0],r[1],l,a,h,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}}apply(t,e,r,n){const o=this.getGL(),l=t.size;if(o.bindFramebuffer(o.FRAMEBUFFER,e?e.getFrameBuffer():null),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.renderTargetTexture_),!e){const h=(0,G.sq)(o.canvas);if(!t.renderTargets[h]){const u=o.getContextAttributes();u&&u.preserveDrawingBuffer&&(o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)),t.renderTargets[h]=!0}}o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.bindBuffer(o.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),o.useProgram(this.renderTargetProgram_),o.enableVertexAttribArray(this.renderTargetAttribLocation_),o.vertexAttribPointer(this.renderTargetAttribLocation_,2,o.FLOAT,!1,0,0),o.uniform2f(this.renderTargetUniformLocation_,l[0],l[1]),o.uniform1i(this.renderTargetTextureLocation_,0),o.uniform1f(this.renderTargetOpacityLocation_,t.layerStatesArray[t.layerIndex].opacity),this.applyUniforms(t),r&&r(o,t),o.drawArrays(o.TRIANGLES,0,6),n&&n(o,t)}getFrameBuffer(){return this.frameBuffer_}applyUniforms(t){const e=this.getGL();let r,n=1;this.uniforms_.forEach(function(o){if(r="function"==typeof o.value?o.value(t):o.value,r instanceof HTMLCanvasElement||r instanceof ImageData)o.texture||(o.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${n}`]),e.bindTexture(e.TEXTURE_2D,o.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,r.width,r.height,0,e.UNSIGNED_BYTE,new Uint8Array(r.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.uniform1i(o.location,n++);else if(Array.isArray(r))switch(r.length){case 2:return void e.uniform2f(o.location,r[0],r[1]);case 3:return void e.uniform3f(o.location,r[0],r[1],r[2]);case 4:return void e.uniform4f(o.location,r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&e.uniform1f(o.location,r)})}};var pt=c(9306),T=c(7139);function fe(i,t){return i[0]=t[0],i[1]=t[1],i[4]=t[2],i[5]=t[3],i[12]=t[4],i[13]=t[5],i}const w={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},ee={};function De(i){return"shared/"+i}let Ne=0;function Oe(i){switch(i){case w.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case w.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case w.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;default:return Float32Array.BYTES_PER_ELEMENT}}const _t=class yt extends lt.Z{constructor(t){super(),t=t||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=t.canvasCacheKey?De(t.canvasCacheKey):function ft(){const i="unique/"+Ne;return Ne+=1,i}(),this.canvas_=function gt(i){let t=ee[i];if(!t){const e=document.createElement("canvas");e.style.position="absolute",e.style.left="0",t={users:0,canvas:e},ee[i]=t}return t.users+=1,t.canvas}(this.canvasCacheKey_),this.gl_=ce(this.canvas_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.canvas_.addEventListener("webglcontextlost",this.boundHandleWebGLContextLost_),this.canvas_.addEventListener("webglcontextrestored",this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,T.Ue)(),this.offsetScaleMatrix_=(0,T.Ue)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.uniformLocations_={},this.attribLocations_={},this.uniforms_=[],t.uniforms&&this.setUniforms(t.uniforms);const e=this.getGL();this.postProcessPasses_=t.postProcesses?t.postProcesses.map(function(r){return new Ge({webGlContext:e,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})}):[new Ge({webGlContext:e})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(t){this.uniforms_=[];for(const e in t)this.uniforms_.push({name:e,value:t[e]});this.uniformLocations_={}}canvasCacheKeyMatches(t){return this.canvasCacheKey_===De(t)}getExtension(t){if(t in this.extensionCache_)return this.extensionCache_[t];const e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}bindBuffer(t){const e=this.getGL(),r=(0,G.sq)(t);let n=this.bufferCache_[r];n||(n={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[r]=n),e.bindBuffer(t.getType(),n.webGlBuffer)}flushBufferData(t){const e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}deleteBuffer(t){const e=this.getGL(),r=(0,G.sq)(t),n=this.bufferCache_[r];n&&!e.isContextLost()&&e.deleteBuffer(n.webGlBuffer),delete this.bufferCache_[r]}disposeInternal(){this.canvas_.removeEventListener("webglcontextlost",this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener("webglcontextrestored",this.boundHandleWebGLContextRestored_),function mt(i){const t=ee[i];if(!t||(t.users-=1,t.users>0))return;const n=ce(t.canvas).getExtension("WEBGL_lose_context");n&&n.loseContext(),delete ee[i]}(this.canvasCacheKey_),delete this.gl_,delete this.canvas_}prepareDraw(t,e){const r=this.getGL(),n=this.getCanvas(),o=t.size,l=t.pixelRatio;n.width=o[0]*l,n.height=o[1]*l,n.style.width=o[0]+"px",n.style.height=o[1]+"px";for(let a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(t);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,e?r.ZERO:r.ONE_MINUS_SRC_ALPHA)}prepareDrawToRenderTarget(t,e,r){const n=this.getGL(),o=e.getSize();n.bindFramebuffer(n.FRAMEBUFFER,e.getFramebuffer()),n.viewport(0,0,o[0],o[1]),n.bindTexture(n.TEXTURE_2D,e.getTexture()),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,r?n.ZERO:n.ONE_MINUS_SRC_ALPHA)}drawElements(t,e){const r=this.getGL();this.getExtension("OES_element_index_uint"),r.drawElements(r.TRIANGLES,e-t,r.UNSIGNED_INT,4*t)}finalizeDraw(t,e,r){for(let n=0,o=this.postProcessPasses_.length;n<o;n++)n===o-1?this.postProcessPasses_[n].apply(t,null,e,r):this.postProcessPasses_[n].apply(t,this.postProcessPasses_[n+1])}getCanvas(){return this.canvas_}getGL(){return this.gl_}applyFrameState(t){const e=t.size,r=t.viewState.rotation,n=t.pixelRatio,o=(0,T.mc)(this.offsetScaleMatrix_);(0,T.bA)(o,2/e[0],2/e[1]);const l=(0,T.mc)(this.offsetRotateMatrix_);0!==r&&(0,T.U1)(l,-r),this.setUniformMatrixValue("u_offsetScaleMatrix",fe(this.tmpMat4_,o)),this.setUniformMatrixValue("u_offsetRotateMatrix",fe(this.tmpMat4_,l)),this.setUniformFloatValue("u_time",.001*(Date.now()-this.startTime_)),this.setUniformFloatValue("u_zoom",t.viewState.zoom),this.setUniformFloatValue("u_resolution",t.viewState.resolution),this.setUniformFloatValue("u_pixelRatio",n),this.setUniformFloatVec2("u_sizePx",[e[0],e[1]])}applyUniforms(t){const e=this.getGL();let r,n=0;this.uniforms_.forEach(o=>{if(r="function"==typeof o.value?o.value(t):o.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData)o.texture||(o.prevValue=void 0,o.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${n}`]),e.bindTexture(e.TEXTURE_2D,o.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),(!(r instanceof HTMLImageElement)||r.complete)&&o.prevValue!==r&&(o.prevValue=r,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)),e.uniform1i(this.getUniformLocation(o.name),n++);else if(Array.isArray(r)&&6===r.length)this.setUniformMatrixValue(o.name,fe(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:return void e.uniform2f(this.getUniformLocation(o.name),r[0],r[1]);case 3:return void e.uniform3f(this.getUniformLocation(o.name),r[0],r[1],r[2]);case 4:return void e.uniform4f(this.getUniformLocation(o.name),r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&e.uniform1f(this.getUniformLocation(o.name),r)})}useProgram(t,e){this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},this.applyFrameState(e),this.applyUniforms(e)}compileShader(t,e){const r=this.getGL(),n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}getProgram(t,e){const r=this.getGL(),n=this.compileShader(t,r.FRAGMENT_SHADER),o=this.compileShader(e,r.VERTEX_SHADER),l=r.createProgram();if(r.attachShader(l,n),r.attachShader(l,o),r.linkProgram(l),!r.getShaderParameter(n,r.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${r.getShaderInfoLog(n)}`;throw new Error(a)}if(r.deleteShader(n),!r.getShaderParameter(o,r.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${r.getShaderInfoLog(o)}`;throw new Error(a)}if(r.deleteShader(o),!r.getProgramParameter(l,r.LINK_STATUS)){const a=`GL program linking failed: ${r.getShaderInfoLog(o)}`;throw new Error(a)}return l}getUniformLocation(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]}getAttributeLocation(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]}makeProjectionTransform(t,e){const r=t.size,n=t.viewState.rotation,o=t.viewState.resolution,l=t.viewState.center;return(0,T.mc)(e),(0,T.qC)(e,0,0,2/(o*r[0]),2/(o*r[1]),-n,-l[0],-l[1]),e}setUniformFloatValue(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)}setUniformFloatVec2(t,e){this.getGL().uniform2fv(this.getUniformLocation(t),e)}setUniformFloatVec4(t,e){this.getGL().uniform4fv(this.getUniformLocation(t),e)}setUniformMatrixValue(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)}enableAttributeArray_(t,e,r,n,o){const l=this.getAttributeLocation(t);l<0||(this.getGL().enableVertexAttribArray(l),this.getGL().vertexAttribPointer(l,e,r,!1,n,o))}enableAttributes(t){const e=function vt(i){let t=0;for(let e=0;e<i.length;e++){const r=i[e];t+=r.size*Oe(r.type)}return t}(t);let r=0;for(let n=0;n<t.length;n++){const o=t[n];this.enableAttributeArray_(o.name,o.size,o.type||5126,e,r),r+=o.size*Oe(o.type)}}handleWebGLContextLost(){(0,pt.Z)(this.bufferCache_),this.currentProgram_=null}handleWebGLContextRestored(){}createTexture(t,e,r){const n=this.getGL();r=r||n.createTexture();const l=n.RGBA,h=n.RGBA,u=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,r),e?n.texImage2D(n.TEXTURE_2D,0,l,h,u,e):n.texImage2D(n.TEXTURE_2D,0,l,t[0],t[1],0,h,u,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r}};class ge extends at.Z{constructor(t,e){super(t),e=e||{},this.inversePixelTransform_=(0,T.Ue)(),this.pixelContext_=null,this.postProcesses_=e.postProcesses,this.uniforms_=e.uniforms,t.addChangeListener(st.Z.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(t,e){const r=this.getLayer();if(r.hasListener(z.Z.PRECOMPOSE)){const n=new de.Z(z.Z.PRECOMPOSE,void 0,e,t);r.dispatchEvent(n)}}dispatchPostComposeEvent(t,e){const r=this.getLayer();if(r.hasListener(z.Z.POSTCOMPOSE)){const n=new de.Z(z.Z.POSTCOMPOSE,void 0,e,t);r.dispatchEvent(n)}}reset(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(t){if(this.getLayer().getRenderSource()){let n,e=!0,r=-1;for(let l=0,a=t.layerStatesArray.length;l<a;l++){const h=t.layerStatesArray[l].layer,u=h.getRenderer();if(!(u instanceof ge)){e=!0;continue}const d=h.getClassName();if((e||d!==n)&&(r+=1,e=!1),n=d,u===this)break}const o="map/"+t.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(o))&&(this.removeHelper(),this.helper=new _t({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:o}),n&&(this.helper.getCanvas().className=n),this.afterHelperCreated())}return this.prepareFrameInternal(t)}afterHelperCreated(){}prepareFrameInternal(t){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(t,e,r){const n=this.getLayer();if(n.hasListener(t)){(0,T.qC)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const o=new de.Z(t,this.inversePixelTransform_,r,e);n.dispatchEvent(o)}}preRender(t,e){this.dispatchRenderEvent_(z.Z.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(z.Z.POSTRENDER,t,e)}}const xt=ge;var Tt=c(142);const I=new Uint8Array(4);var F=c(9543);function At(i,t){const e=256,r=255;return(t=t||[])[0]=Math.floor(i/e/e/e)/r,t[1]=Math.floor(i/e/e)%e/r,t[2]=Math.floor(i/e)%e/r,t[3]=i%e/r,t}c(1604);var J=c(2716);const Pt=class bt extends xt{constructor(t,e){const r=e.uniforms||{},n=(0,T.Ue)();r.u_projectionMatrix=n,super(t,{uniforms:r,postProcesses:e.postProcesses}),this.ready=!1,this.sourceRevision_=-1,this.verticesBuffer_=new pe(Q,$),this.hitVerticesBuffer_=new pe(Q,$),this.indicesBuffer_=new pe(34963,$),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.hitDetectionEnabled_=!(!e.hitFragmentShader||!e.hitVertexShader),this.hitVertexShader_=e.hitVertexShader,this.hitFragmentShader_=e.hitFragmentShader;const o=e.attributes?e.attributes.map(function(a){return{name:"a_"+a.name,size:1,type:w.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:w.FLOAT},{name:"a_index",size:1,type:w.FLOAT}].concat(o),this.hitDetectionAttributes=[{name:"a_position",size:2,type:w.FLOAT},{name:"a_index",size:1,type:w.FLOAT},{name:"a_hitColor",size:4,type:w.FLOAT},{name:"a_featureUid",size:1,type:w.FLOAT}].concat(o),this.customAttributes=e.attributes?e.attributes:[],this.previousExtent_=(0,F.lJ)(),this.currentTransform_=n,this.renderTransform_=(0,T.Ue)(),this.invertRenderTransform_=(0,T.Ue)(),this.renderInstructions_=new Float32Array(0),this.hitRenderInstructions_=new Float32Array(0),this.generateBuffersRun_=0,this.worker_=function Ft(){const i='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS",r={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:\'`renderMode` must be `"hybrid"` or `"vector"`\',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class o extends Error{constructor(e){const t=r[e];super(t),this.code=e,this.name="AssertionError",this.message=t}}var i=o;function a(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function s(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new i(t)}(0!==n,32);const o=t[0],a=t[1],s=t[2],u=t[3],f=t[4],x=t[5];return e[0]=u/n,e[1]=-a/n,e[2]=-s/n,e[3]=o/n,e[4]=(s*x-u*f)/n,e[5]=-(o*x-a*f)/n,e}new Array(6);var u={};function f(e,t,n){n=n||2;var r,o,i,a,s,u,f,l=t&&t.length,c=l?t[0]*n:e.length,v=x(e,0,c,n,!0),d=[];if(!v||v.next===v.prev)return d;if(l&&(v=function(e,t,n,r){var o,i,a,s=[];for(o=0,i=t.length;o<i;o++)(a=x(e,t[o]*r,o<i-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(w(a));for(s.sort(p),o=0;o<s.length;o++)n=b(s[o],n);return n}(e,t,v,n)),e.length>80*n){r=i=e[0],o=a=e[1];for(var y=n;y<c;y+=n)(s=e[y])<r&&(r=s),(u=e[y+1])<o&&(o=u),s>i&&(i=s),u>a&&(a=u);f=0!==(f=Math.max(i-r,a-o))?32767/f:0}return h(v,d,n,r,o,f,0),d}function x(e,t,n,r,o){var i,a;if(o===B(e,t,n,r)>0)for(i=t;i<n;i+=r)a=k(i,e[i],e[i+1],a);else for(i=n-r;i>=t;i-=r)a=k(i,e[i],e[i+1],a);return a&&M(a,a.next)&&(z(a),a=a.next),a}function l(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!M(r,r.next)&&0!==Z(r.prev,r,r.next))r=r.next;else{if(z(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function h(e,t,n,r,o,i,a){if(e){!a&&i&&function(e,t,n,r){var o=e;do{0===o.z&&(o.z=m(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,r,o,i,a,s,u,f=1;do{for(n=e,e=null,i=null,a=0;n;){for(a++,r=n,s=0,t=0;t<f&&(s++,r=r.nextZ);t++);for(u=f;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,s--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,f*=2}while(a>1)}(o)}(e,r,o,i);for(var s,u,f=e;e.prev!==e.next;)if(s=e.prev,u=e.next,i?v(e,r,o,i):c(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(u.i/n|0),z(e),e=u.next,f=u.next;else if((e=u)===f){a?1===a?h(e=d(l(e),t,n),t,n,r,o,i,2):2===a&&y(e,t,n,r,o,i):h(l(e),t,n,r,o,i,1);break}}}function c(e){var t=e.prev,n=e,r=e.next;if(Z(t,n,r)>=0)return!1;for(var o=t.x,i=n.x,a=r.x,s=t.y,u=n.y,f=r.y,x=o<i?o<a?o:a:i<a?i:a,l=s<u?s<f?s:f:u<f?u:f,h=o>i?o>a?o:a:i>a?i:a,c=s>u?s>f?s:f:u>f?u:f,v=r.next;v!==t;){if(v.x>=x&&v.x<=h&&v.y>=l&&v.y<=c&&A(o,s,i,u,a,f,v.x,v.y)&&Z(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function v(e,t,n,r){var o=e.prev,i=e,a=e.next;if(Z(o,i,a)>=0)return!1;for(var s=o.x,u=i.x,f=a.x,x=o.y,l=i.y,h=a.y,c=s<u?s<f?s:f:u<f?u:f,v=x<l?x<h?x:h:l<h?l:h,d=s>u?s>f?s:f:u>f?u:f,y=x>l?x>h?x:h:l>h?l:h,p=m(c,v,t,n,r),b=m(d,y,t,n,r),g=e.prevZ,w=e.nextZ;g&&g.z>=p&&w&&w.z<=b;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&A(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,w.x>=c&&w.x<=d&&w.y>=v&&w.y<=y&&w!==o&&w!==a&&A(s,x,u,l,f,h,w.x,w.y)&&Z(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;g&&g.z>=p;){if(g.x>=c&&g.x<=d&&g.y>=v&&g.y<=y&&g!==o&&g!==a&&A(s,x,u,l,f,h,g.x,g.y)&&Z(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;w&&w.z<=b;){if(w.x>=c&&w.x<=d&&w.y>=v&&w.y<=y&&w!==o&&w!==a&&A(s,x,u,l,f,h,w.x,w.y)&&Z(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function d(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;!M(o,i)&&F(o,r,r.next,i)&&S(o,i)&&S(i,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),z(r),z(r.next),r=e=i),r=r.next}while(r!==e);return l(r)}function y(e,t,n,r,o,i){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&E(a,s)){var u=U(a,s);return a=l(a,a.next),u=l(u,u.next),h(a,t,n,r,o,i,0),void h(u,t,n,r,o,i,0)}s=s.next}a=a.next}while(a!==e)}function p(e,t){return e.x-t.x}function b(e,t){var n=function(e,t){var n,r=t,o=e.x,i=e.y,a=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=o&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===o))return n}r=r.next}while(r!==t);if(!n)return null;var u,f=n,x=n.x,l=n.y,h=1/0;r=n;do{o>=r.x&&r.x>=x&&o!==r.x&&A(i<l?o:a,i,x,l,i<l?a:o,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(o-r.x),S(r,e)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,h=u)),r=r.next}while(r!==f);return n}(e,t);if(!n)return t;var r=U(n,e);return l(r,r.next),l(n,n.next)}function g(e,t){return Z(e.prev,e,t.prev)<0&&Z(t.next,e,e.next)<0}function m(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function w(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function A(e,t,n,r,o,i,a,s){return(o-a)*(t-s)>=(e-a)*(i-s)&&(e-a)*(r-s)>=(n-a)*(t-s)&&(n-a)*(i-s)>=(o-a)*(r-s)}function E(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&F(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Z(e.prev,e,t.prev)||Z(e,t.prev,t))||M(e,t)&&Z(e.prev,e,e.next)>0&&Z(t.prev,t,t.next)>0)}function Z(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function F(e,t,n,r){var o=I(Z(e,t,n)),i=I(Z(e,t,r)),a=I(Z(n,r,e)),s=I(Z(n,r,t));return o!==i&&a!==s||(!(0!==o||!T(e,n,t))||(!(0!==i||!T(e,r,t))||(!(0!==a||!T(n,e,r))||!(0!==s||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function S(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function U(e,t){var n=new R(e.i,e.x,e.y),r=new R(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function k(e,t,n,r){var o=new R(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function R(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(e,t,n,r){for(var o=0,i=t,a=n-r;i<n;i+=r)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}({get exports(){return u},set exports(e){u=e}}).exports=f,u.default=f,f.deviation=function(e,t,n,r){var o=t&&t.length,i=o?t[0]*n:e.length,a=Math.abs(B(e,0,i,n));if(o)for(var s=0,u=t.length;s<u;s++){var f=t[s]*n,x=s<u-1?t[s+1]*n:e.length;a-=Math.abs(B(e,f,x,n))}var l=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,c=r[s+1]*n,v=r[s+2]*n;l+=Math.abs((e[h]-e[v])*(e[c+1]-e[h+1])-(e[h]-e[c])*(e[v+1]-e[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},f.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;a<t;a++)n.vertices.push(e[o][i][a]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};const N=[],P={vertexPosition:0,indexPosition:0};function C(e,t,n,r,o){e[t+0]=n,e[t+1]=r,e[t+2]=o}function _(e,t,n,r,o,i){const a=3+o,s=e[t+0],u=e[t+1],f=N;f.length=o;for(let n=0;n<f.length;n++)f[n]=e[t+2+n];let x=i?i.vertexPosition:0,l=i?i.indexPosition:0;const h=x/a;return C(n,x,s,u,0),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,1),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,2),f.length&&n.set(f,x+3),x+=a,C(n,x,s,u,3),f.length&&n.set(f,x+3),x+=a,r[l++]=h,r[l++]=h+1,r[l++]=h+3,r[l++]=h+1,r[l++]=h+2,r[l++]=h+3,P.vertexPosition=x,P.indexPosition=l,P}function q(e,t,n,r,o,i,s,u,f,x){const l=5+u.length,h=i.length/l,c=[e[t+0],e[t+1]],v=[e[n],e[n+1]],d=a(x,[...c]),y=a(x,[...v]);function p(e,t,n){const r=1e4;return Math.round(1500*t)+Math.round(1500*n)*r+e*r*r}function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),o=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-o[1],o[0]],a=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),s=[(n[0]-e[0])/a,(n[1]-e[1])/a],u=0===r||0===a?0:Math.acos((f=s[0]*o[0]+s[1]*o[1],x=-1,l=1,Math.min(Math.max(f,x),l)));var f,x,l;return s[0]*i[0]+s[1]*i[1]>0?u:2*Math.PI-u}const g=null!==o;let m=0,w=0;if(null!==r){m=b(d,y,a(x,[...[e[r],e[r+1]]]))}if(g){w=b(y,d,a(x,[...[e[o],e[o+1]]]))}i.push(c[0],c[1],v[0],v[1],p(0,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(1,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(2,m,w)),i.push(...u),i.push(c[0],c[1],v[0],v[1],p(3,m,w)),i.push(...u),s.push(h,h+1,h+2,h+1,h+3,h+2)}function L(e,t,n,r,o){const i=2+o;let a=t;const s=e.slice(a,a+o);a+=o;const f=e[a++];let x=0;const l=new Array(f-1);for(let t=0;t<f;t++)x+=e[a++],t<f-1&&(l[t]=x);const h=e.slice(a,a+2*x),c=u(h,l,2);for(let e=0;e<c.length;e++)r.push(c[e]+n.length/i);for(let e=0;e<h.length;e+=2)n.push(h[e],h[e+1],...s);return a+2*x}const G=self;G.onmessage=r=>{const o=r.data;switch(o.type){case t:{const e=3,t=2,n=o.customAttributesCount,r=t+n,i=new Float32Array(o.renderInstructions),a=i.length/r,s=4*a*(n+e),u=new Uint32Array(6*a),f=new Float32Array(s);let x;for(let e=0;e<i.length;e+=r)x=_(i,e,f,u,n,x);const l=Object.assign({vertexBuffer:f.buffer,indexBuffer:u.buffer,renderInstructions:i.buffer},o);G.postMessage(l,[f.buffer,u.buffer,i.buffer]);break}case n:{const e=[],t=[],n=o.customAttributesCount,r=2,i=new Float32Array(o.renderInstructions);let a=0;const u=o.renderInstructionsTransform,f=[1,0,0,1,0,0];let x,l;for(s(f,u);a<i.length;){l=Array.from(i.slice(a,a+n)),a+=n,x=i[a++];for(let n=0;n<x-1;n++)q(i,a+n*r,a+(n+1)*r,n>0?a+(n-1)*r:null,n<x-2?a+(n+2)*r:null,e,t,l,0,f);a+=x*r}const h=Uint32Array.from(t),c=Float32Array.from(e),v=Object.assign({vertexBuffer:c.buffer,indexBuffer:h.buffer,renderInstructions:i.buffer},o);G.postMessage(v,[c.buffer,h.buffer,i.buffer]);break}case e:{const e=[],t=[],n=o.customAttributesCount,r=new Float32Array(o.renderInstructions);let i=0;for(;i<r.length;)i=L(r,i,e,t,n);const a=Uint32Array.from(t),s=Float32Array.from(e),u=Object.assign({vertexBuffer:s.buffer,indexBuffer:a.buffer,renderInstructions:r.buffer},o);G.postMessage(u,[s.buffer,a.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(i,"binary").toString("base64"):URL.createObjectURL(new Blob([i],{type:"application/javascript"})))}(),this.worker_.addEventListener("message",a=>{const h=a.data;if("GENERATE_POINT_BUFFERS"===h.type){const u=h.projectionTransform;h.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(h.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(h.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(h.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=u,(0,T.nb)(this.invertRenderTransform_,this.renderTransform_),h.hitDetection?this.hitRenderInstructions_=new Float32Array(a.data.renderInstructions):(this.renderInstructions_=new Float32Array(a.data.renderInstructions),h.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const l=this.getLayer().getSource();this.sourceListenKeys_=[(0,J.oL)(l,k.Z.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,J.oL)(l,k.Z.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,J.oL)(l,k.Z.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,J.oL)(l,k.Z.CLEAR,this.handleSourceFeatureClear_,this)],l.forEachFeature(a=>{this.featureCache_[(0,G.sq)(a)]={feature:a,properties:a.getProperties(),geometry:a.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new class Et{constructor(t,e){this.helper_=t;const r=t.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(t){(0,Tt.fS)(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I;this.readAll();const r=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return I[0]=this.data_[4*r],I[1]=this.data_[4*r+1],I[2]=this.data_[4*r+2],I[3]=this.data_[4*r+3],I}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}updateSize_(){const t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)}}(this.helper))}handleSourceFeatureAdded_(t){const e=t.feature;this.featureCache_[(0,G.sq)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(t){const e=t.feature;this.featureCache_[(0,G.sq)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}}handleSourceFeatureDelete_(t){delete this.featureCache_[(0,G.sq)(t.feature)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(t){const e=this.helper.getGL();this.preRender(e,t);const r=t.viewState.projection,l=this.getLayer().getSource().getWrapX()&&r.canWrapX(),a=r.getExtent(),h=t.extent,u=l?(0,F.dz)(a):null,d=l?Math.ceil((h[2]-a[2])/u)+1:1,g=l?Math.floor((h[0]-a[0])/u):0;let p=g;const y=this.indicesBuffer_.getSize();do{this.helper.makeProjectionTransform(t,this.currentTransform_),(0,T.Iu)(this.currentTransform_,p*u,0),(0,T.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(t),this.helper.drawElements(0,y)}while(++p<d);this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const m=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(t,g,d,u),this.hitRenderTarget_.clearCachedData()),this.postRender(e,t),m}prepareFrameInternal(t){const e=this.getLayer(),r=e.getSource(),n=t.viewState,o=!t.viewHints[Ie.Z.ANIMATING]&&!t.viewHints[Ie.Z.INTERACTING],l=!(0,F.fS)(this.previousExtent_,t.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),o&&(l||a)){const h=n.projection,u=n.resolution,d=e instanceof Le.Z?e.getRenderBuffer():0,g=(0,F.f3)(t.extent,d*u);r.loadFeatures(g,u,h),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()}return this.helper.useProgram(this.program_,t),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(t){const e=(0,T.Ue)();this.helper.makeProjectionTransform(t,e);const r=(2+this.customAttributes.length)*this.featureCount_;if((!this.renderInstructions_||this.renderInstructions_.length!==r)&&(this.renderInstructions_=new Float32Array(r)),this.hitDetectionEnabled_){const p=(7+this.customAttributes.length)*this.featureCount_;(!this.hitRenderInstructions_||this.hitRenderInstructions_.length!==p)&&(this.hitRenderInstructions_=new Float32Array(p))}let n,o;const l=[],a=[];let d,h=0,u=0;for(const p in this.featureCache_){if(n=this.featureCache_[p],o=n.geometry,!o||"Point"!==o.getType())continue;let y;l[0]=o.getFlatCoordinates()[0],l[1]=o.getFlatCoordinates()[1],(0,T.nn)(e,l),d=At(u+6,a),this.renderInstructions_[h++]=l[0],this.renderInstructions_[h++]=l[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=l[0],this.hitRenderInstructions_[u++]=l[1],this.hitRenderInstructions_[u++]=d[0],this.hitRenderInstructions_[u++]=d[1],this.hitRenderInstructions_[u++]=d[2],this.hitRenderInstructions_[u++]=d[3],this.hitRenderInstructions_[u++]=Number(p));for(let m=0;m<this.customAttributes.length;m++)y=this.customAttributes[m].callback(n.feature,n.properties),this.renderInstructions_[h++]=y,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=y)}const g={id:0,type:"GENERATE_POINT_BUFFERS",renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(g.projectionTransform=e,g.generateBuffersRun=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(g,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){const p={id:0,type:"GENERATE_POINT_BUFFERS",renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};p.projectionTransform=e,p.hitDetection=!0,this.worker_.postMessage(p,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}}forEachFeatureAtCoordinate(t,e,r,n,o){if((0,Me.h)(this.hitDetectionEnabled_,66),!this.hitRenderInstructions_)return;const l=(0,T.nn)(e.coordinateToPixelTransform,t.slice()),a=this.hitRenderTarget_.readPixel(l[0]/2,l[1]/2),u=function wt(i){let t=0;const e=256,r=255;return t+=Math.round(i[0]*e*e*e*r),t+=Math.round(i[1]*e*e*r),t+=Math.round(i[2]*e*r),t+=Math.round(i[3]*r),t}([a[0]/255,a[1]/255,a[2]/255,a[3]/255]),g=Math.floor(this.hitRenderInstructions_[u]).toString(),y=this.getLayer().getSource().getFeatureByUid(g);return y?n(y,this.getLayer(),null):void 0}renderHitDetection(t,e,r,n){if(!this.hitVerticesBuffer_.getSize())return;let o=e;this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.hitProgram_,t),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(t,this.currentTransform_),(0,T.Iu)(this.currentTransform_,o*n,0),(0,T.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(t);const l=this.indicesBuffer_.getSize();this.helper.drawElements(0,l)}while(++o<r)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(t){(0,J.bN)(t)}),this.sourceListenKeys_=null,super.disposeInternal()}};var Ct=c(4331),ve=c(3842);const Lt=["#00f","#0ff","#0f0","#ff0","#f00"],Ut=class It extends Le.Z{constructor(t){t=t||{};const e=Object.assign({},t);delete e.gradient,delete e.radius,delete e.blur,delete e.weight,super(e),this.gradient_=null,this.addChangeListener("gradient",this.handleGradientChanged_),this.setGradient(t.gradient?t.gradient:Lt),this.setBlur(void 0!==t.blur?t.blur:15),this.setRadius(void 0!==t.radius?t.radius:8);const r=t.weight?t.weight:"weight";this.weightFunction_="string"==typeof r?function(n){return n.get(r)}:r,this.setRenderOrder(null)}getBlur(){return this.get("blur")}getGradient(){return this.get("gradient")}getRadius(){return this.get("radius")}handleGradientChanged_(){this.gradient_=function Zt(i){const r=(0,ve.E4)(1,256),n=r.createLinearGradient(0,0,1,256),o=1/(i.length-1);for(let l=0,a=i.length;l<a;++l)n.addColorStop(l*o,i[l]);return r.fillStyle=n,r.fillRect(0,0,1,256),r.canvas}(this.getGradient())}setBlur(t){this.set("blur",t)}setGradient(t){this.set("gradient",t)}setRadius(t){this.set("radius",t)}createRenderer(){return new Pt(this,{className:this.getClassName(),attributes:[{name:"weight",callback:t=>{const e=this.weightFunction_(t);return void 0!==e?(0,Ct.uZ)(e,0,1):1}}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:()=>2*(this.get("radius")+this.get("blur")),u_blurSlope:()=>this.get("radius")/Math.max(1,this.get("blur"))},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}};var _e=c(7356),re=c(4203),ne=c(6906),xe=c(993),Mt=c(1591),Gt=c(585),Z=c(3149),Dt=c(3044),Te=c(9375),Nt=c(1501),Ot=c(1309),Ee=c(9015);const Be=class Bt extends Te.ZP{constructor(t){const e=void 0!==t.crossOrigin?t.crossOrigin:null,r=void 0!==t.imageLoadFunction?t.imageLoadFunction:Te.r6;super({attributions:t.attributions,interpolate:t.interpolate,projection:(0,Ee.U2)(t.projection)}),this.url_=t.url,this.imageExtent_=t.imageExtent,this.image_=new Ot.Z(this.imageExtent_,void 0,1,this.url_,e,r,(0,ve.E4)(1,1)),this.imageSize_=t.imageSize?t.imageSize:null,this.image_.addEventListener(Dt.Z.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(t,e,r,n){return(0,F.kK)(t,this.image_.getExtent())?this.image_:null}getUrl(){return this.url_}handleImageChange(t){if(this.image_.getState()==Nt.Z.LOADED){const e=this.image_.getExtent(),r=this.image_.getImage();let n,o;this.imageSize_?(n=this.imageSize_[0],o=this.imageSize_[1]):(n=r.width,o=r.height);const l=(0,F.dz)(e),a=(0,F.Cr)(e),h=l/n,u=a/o;let d=n,g=o;if(h>u?d=Math.round(l/u):g=Math.round(a/h),d!==n||g!==o){const p=(0,ve.E4)(d,g);this.getInterpolate()||(p.imageSmoothingEnabled=!1);const y=p.canvas;p.drawImage(r,0,0,n,o,0,0,y.width,y.height),this.image_.setImage(y)}}super.handleImageChange(t)}};var Se=c(7274),Ve=c(3298),We=c(2663),Vt=c(978),Wt=c(6819),Ht=c(443);const jt=class zt extends Te.ZP{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions,state:t.state}),this.canvasFunction_=t.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5}getImageInternal(t,e,r,n){e=this.findNearestResolution(e);let o=this.canvas_;if(o&&this.renderedRevision_==this.getRevision()&&o.getResolution()==e&&o.getPixelRatio()==r&&(0,F.r4)(o.getExtent(),t))return o;t=t.slice(),(0,F.H9)(t,this.ratio_);const l=(0,F.dz)(t)/e,a=(0,F.Cr)(t)/e,u=this.canvasFunction_.call(this,t,e,r,[l*r,a*r],n);return u&&(o=new Ht.Z(t,e,r,u)),this.canvas_=o,this.renderedRevision_=this.getRevision(),o}};var He=c(524),ze=c(8898),Xt=c(4007),Jt=c(3413),Yt=c(7680),Kt=c(23),kt=c(7090),Qt=c(1537),$t=c(4034),qt=c(7026),er=c(7464),tr=c(1122);const nr={Point:function or(i,t,e){const r=i.coordinates;return t&&e&&Re(r,t,e),new qt.Z(r)},LineString:function sr(i,t){const e=oe(i.arcs,t);return new Kt.Z(e)},Polygon:function lr(i,t){const e=[];for(let r=0,n=i.arcs.length;r<n;++r)e[r]=oe(i.arcs[r],t);return new er.ZP(e)},MultiPoint:function ir(i,t,e){const r=i.coordinates;if(t&&e)for(let n=0,o=r.length;n<o;++n)Re(r[n],t,e);return new Qt.Z(r)},MultiLineString:function ar(i,t){const e=[];for(let r=0,n=i.arcs.length;r<n;++r)e[r]=oe(i.arcs[r],t);return new kt.Z(e)},MultiPolygon:function cr(i,t){const e=[];for(let r=0,n=i.arcs.length;r<n;++r){const o=i.arcs[r],l=[];for(let a=0,h=o.length;a<h;++a)l[a]=oe(o[a],t);e[r]=l}return new $t.Z(e)}};function oe(i,t){const e=[];let r;for(let n=0,o=i.length;n<o;++n)if(r=i[n],n>0&&e.pop(),r>=0){const l=t[r];for(let a=0,h=l.length;a<h;++a)e.push(l[a].slice(0))}else{const l=t[~r];for(let a=l.length-1;a>=0;--a)e.push(l[a].slice(0))}return e}function ur(i,t,e,r,n,o,l){const a=i.geometries,h=[];for(let u=0,d=a.length;u<d;++u)h[u]=je(a[u],t,e,r,n,o,l);return h}function je(i,t,e,r,n,o,l){let a=null;const h=i.type;if(h){const g=nr[h];a="Point"===h||"MultiPoint"===h?g(i,e,r):g(i,t),a=(0,tr.fI)(a,!1,l)}const u=new Jt.Z({geometry:a});void 0!==i.id&&u.setId(i.id);let d=i.properties;return n&&(d||(d={}),d[n]=o),d&&u.setProperties(d,!0),u}function pr(i,t,e){let r=0,n=0;for(let o=0,l=i.length;o<l;++o){const a=i[o];r+=a[0],n+=a[1],a[0]=r,a[1]=n,Re(a,t,e)}}function Re(i,t,e){i[0]=i[0]*t[0]+e[0],i[1]=i[1]*t[1]+e[1]}const dr=class rr extends Yt.Z{constructor(t){super(),this.layerName_=(t=t||{}).layerName,this.layers_=t.layers?t.layers:null,this.dataProjection=(0,Ee.U2)(t.dataProjection?t.dataProjection:"EPSG:4326")}readFeaturesFromObject(t,e){if("Topology"==t.type){const r=t;let n,o=null,l=null;r.transform&&(n=r.transform,o=n.scale,l=n.translate);const a=r.arcs;n&&function hr(i,t,e){for(let r=0,n=i.length;r<n;++r)pr(i[r],t,e)}(a,o,l);const h=[],u=r.objects,d=this.layerName_;let g;for(const p in u)this.layers_&&!this.layers_.includes(p)||("GeometryCollection"===u[p].type?(g=u[p],h.push.apply(h,ur(g,a,o,l,d,p,e))):(g=u[p],h.push(je(g,a,o,l,d,p,e))));return h}return[]}readProjectionFromObject(t){return this.dataProjection}};var fr=c(6114),U=c(1786),j=c(5253),P=c(694),Xe=c(795),gr=c(8185),s=c(4537),x=c(6799);let mr=(()=>{class i{constructor(){this.privValue=1,this.valueChange=new s.vpe}set value(e){this.privValue!==e&&(this.privValue=e,this.layer?.custom_layer&&this.layer.custom_layer.setRadius(e))}get value(){return this.privValue}ngOnInit(){this.layer.custom_layer.setRadius(this.value)}changeValue(e){const r=parseInt(e.target.value,10);this.value=r,this.valueChange.emit(r),this.layer.custom_layer&&this.layer.custom_layer.setRadius(r)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-example-layer-action"]],inputs:{layer:"layer",value:"value"},outputs:{valueChange:"valueChange"},decls:6,vars:2,consts:[[1,"heatmap-range"],["type","range","clrRange","","name","two","min","1","max","50","step","1",1,"ukis-range-input",3,"value","change"]],template:function(e,r){1&e&&(s.TgZ(0,"clr-range-container",0)(1,"label"),s._uU(2,"Heatmap radius:"),s.qZA(),s.TgZ(3,"input",1),s.NdJ("change",function(o){return r.changeValue(o)}),s.qZA(),s.TgZ(4,"clr-control-helper"),s._uU(5),s.qZA()()),2&e&&(s.xp6(3),s.Q6J("value",r.value),s.xp6(2),s.Oqu(" "+r.value))},dependencies:[x.MgK,x.CM6,x.blk,x.XTz],styles:[".heatmap-range[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}"]}),i})();const Je={type:"FeatureCollection",features:[{type:"Feature",properties:{height:2},geometry:{type:"Polygon",coordinates:[[[11.539764404296875,48.17707562779612,2],[11.53289794921875,48.13126755117026],[11.51641845703125,48.12301775410865],[11.517791748046875,48.10926514749487],[11.56036376953125,48.11384975871469],[11.564483642578125,48.12301775410865],[11.58233642578125,48.130350972491556],[11.592292785644531,48.14043243818811],[11.594696044921875,48.14730502988628],[11.602935791015625,48.15715413998257],[11.595039367675781,48.1640244926387],[11.59950256347656,48.17226770127996],[11.587142944335938,48.177533502046636],[11.572036743164062,48.177533502046636],[11.539764404296875,48.17707562779612]]]}},{type:"Feature",properties:{height:1},geometry:{type:"Polygon",coordinates:[[[11.605682373046875,48.156238023440835],[11.596412658691406,48.147534100428686],[11.59332275390625,48.13699579726703],[11.583709716796875,48.12851776605501],[11.564826965332031,48.121413473016034],[11.561737060546875,48.11247441829591],[11.575126647949217,48.11155750423242],[11.581993103027344,48.10490938797694],[11.614608764648438,48.11178673428214],[11.620101928710938,48.12462198509838],[11.614952087402344,48.12920522613733],[11.614265441894531,48.13905780942574],[11.61529541015625,48.15165719536032],[11.605682373046875,48.156238023440835]]]}},{type:"Feature",properties:{height:3},geometry:{type:"Polygon",coordinates:[[[11.516075134277344,48.12347611093252],[11.532554626464844,48.131496693283744],[11.538734436035156,48.176388808753124],[11.52191162109375,48.175701980509444],[11.511268615722656,48.17249666038475],[11.507148742675781,48.16379549570767],[11.492729187011719,48.165398452755674],[11.486892700195312,48.16379549570767],[11.458740234375,48.164482483433744],[11.457366943359375,48.15188624647704],[11.455307006835938,48.148221305921446],[11.436767578124998,48.133329793382636],[11.430244445800781,48.12874692043826],[11.443977355957031,48.12828861064926],[11.45050048828125,48.12553866602599],[11.4862060546875,48.124392812310205],[11.503028869628904,48.12553866602599],[11.516075134277344,48.12347611093252]]]}},{type:"Feature",properties:{height:0},geometry:{type:"Polygon",coordinates:[[[11.517448425292969,48.10972362702285],[11.487579345703125,48.095738161288885],[11.488265991210938,48.08381312049231],[11.485176086425781,48.075785093732456],[11.487922668457031,48.07486752519069],[11.493759155273438,48.07693203139914],[11.506805419921875,48.0762438718672],[11.517448425292969,48.06890293081563],[11.536331176757812,48.068214663899795],[11.538734436035156,48.07349114169717],[11.540107727050781,48.08427182703979],[11.548004150390625,48.09367440979962],[11.549720764160154,48.10559716402152],[11.559333801269531,48.11407897853892],[11.517448425292969,48.10972362702285]]]}}]},Ae={type:"FeatureCollection",features:[{type:"Feature",properties:{pid:1},geometry:{type:"Point",coordinates:[10.9423828125,49.001843917978526]}},{type:"Feature",properties:{pid:2},geometry:{type:"Point",coordinates:[11.18408203125,49.088257784724675]}},{type:"Feature",properties:{pid:3},geometry:{type:"Point",coordinates:[11.030273437499998,49.35375571830993]}},{type:"Feature",properties:{pid:4},geometry:{type:"Point",coordinates:[10.72265625,49.24629332459796]}},{type:"Feature",properties:{pid:5},geometry:{type:"Point",coordinates:[12.76611328125,48.011975126709956]}},{type:"Feature",properties:{pid:6},geometry:{type:"Point",coordinates:[13.55712890625,49.15296965617042]}},{type:"Feature",properties:{pid:7},geometry:{type:"Point",coordinates:[13.3154296875,48.545705491847464]}},{type:"Feature",properties:{pid:8},geometry:{type:"Point",coordinates:[4.482421875,49.224772722794825]}}]},yr={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Feature 1 - Polygon"},geometry:{type:"Polygon",coordinates:[[[7.91015625,50.233151832472245],[9.140625,47.81315451752768],[13.33740234375,48.28319289548349],[13.7109375,50.17689812200107],[7.91015625,50.233151832472245]]]}}]},vr={type:"FeatureCollection",features:[{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.3",geometry:{type:"Point",coordinates:[14.354708,54.004536]},geometry_name:"geom",properties:{lat:"54.004536",lon:"14.354708",id:"3",timestamp:"2020-09-13T16:52:57Z",SWH:"1.13",plength:"209.7",windSpeed:"4.25",pdirection:"125.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.4",geometry:{type:"Point",coordinates:[14.445045,54.013187]},geometry_name:"geom",properties:{lat:"54.013187",lon:"14.445045",id:"4",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"251.0",windSpeed:"3.75",pdirection:"11.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.5",geometry:{type:"Point",coordinates:[14.535383,54.021835]},geometry_name:"geom",properties:{lat:"54.021835",lon:"14.535383",id:"5",timestamp:"2020-09-13T16:52:57Z",SWH:"1.08",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.6",geometry:{type:"Point",coordinates:[14.625798,54.030346]},geometry_name:"geom",properties:{lat:"54.030346",lon:"14.625798",id:"6",timestamp:"2020-09-13T16:52:57Z",SWH:"0.99",plength:"194.6",windSpeed:"4.00",pdirection:"171.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.7",geometry:{type:"Point",coordinates:[14.716214,54.038853]},geometry_name:"geom",properties:{lat:"54.038853",lon:"14.716214",id:"7",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"475.4",windSpeed:"4.05",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.8",geometry:{type:"Point",coordinates:[13.978081,54.022915]},geometry_name:"geom",properties:{lat:"54.022915",lon:"13.978081",id:"8",timestamp:"2020-09-13T16:52:57Z",SWH:"0.66",plength:"475.4",windSpeed:"3.50",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.9",geometry:{type:"Point",coordinates:[14.068372,54.031853]},geometry_name:"geom",properties:{lat:"54.031853",lon:"14.068372",id:"9",timestamp:"2020-09-13T16:52:57Z",SWH:"1.03",plength:"452.5",windSpeed:"4.20",pdirection:"135.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.10",geometry:{type:"Point",coordinates:[14.158684,54.040756]},geometry_name:"geom",properties:{lat:"54.040756",lon:"14.158684",id:"10",timestamp:"2020-09-13T16:52:57Z",SWH:"0.47",plength:"199.9",windSpeed:"4.40",pdirection:"51.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.11",geometry:{type:"Point",coordinates:[14.249058,54.049553]},geometry_name:"geom",properties:{lat:"54.049553",lon:"14.249058",id:"11",timestamp:"2020-09-13T16:52:57Z",SWH:"1.36",plength:"420.9",windSpeed:"4.40",pdirection:"80.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.12",geometry:{type:"Point",coordinates:[14.339441,54.058331]},geometry_name:"geom",properties:{lat:"54.058331",lon:"14.339441",id:"12",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"134.6",windSpeed:"3.95",pdirection:"3.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.13",geometry:{type:"Point",coordinates:[14.429894,54.066982]},geometry_name:"geom",properties:{lat:"54.066982",lon:"14.429894",id:"13",timestamp:"2020-09-13T16:52:57Z",SWH:"1.01",plength:"351.6",windSpeed:"4.15",pdirection:"164.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.14",geometry:{type:"Point",coordinates:[14.52035,54.075634]},geometry_name:"geom",properties:{lat:"54.075634",lon:"14.520350",id:"14",timestamp:"2020-09-13T16:52:57Z",SWH:"1.16",plength:"310.4",windSpeed:"4.45",pdirection:"166.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.15",geometry:{type:"Point",coordinates:[14.610882,54.084145]},geometry_name:"geom",properties:{lat:"54.084145",lon:"14.610882",id:"15",timestamp:"2020-09-13T16:52:57Z",SWH:"1.00",plength:"210.4",windSpeed:"4.05",pdirection:"170.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.16",geometry:{type:"Point",coordinates:[14.701414,54.092651]},geometry_name:"geom",properties:{lat:"54.092651",lon:"14.701414",id:"16",timestamp:"2020-09-13T16:52:57Z",SWH:"0.98",plength:"254.7",windSpeed:"4.40",pdirection:"174.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.17",geometry:{type:"Point",coordinates:[14.792017,54.101032]},geometry_name:"geom",properties:{lat:"54.101032",lon:"14.792017",id:"17",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"475.4",windSpeed:"4.45",pdirection:"158.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.18",geometry:{type:"Point",coordinates:[14.882627,54.109398]},geometry_name:"geom",properties:{lat:"54.109398",lon:"14.882627",id:"18",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"188.2",windSpeed:"4.25",pdirection:"107.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.19",geometry:{type:"Point",coordinates:[14.973297,54.117649]},geometry_name:"geom",properties:{lat:"54.117649",lon:"14.973297",id:"19",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"404.8",windSpeed:"4.00",pdirection:"161.6"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.20",geometry:{type:"Point",coordinates:[15.063984,54.12587]},geometry_name:"geom",properties:{lat:"54.125870",lon:"15.063984",id:"20",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"170.3",windSpeed:"4.10",pdirection:"176.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.21",geometry:{type:"Point",coordinates:[15.154721,54.133991]},geometry_name:"geom",properties:{lat:"54.133991",lon:"15.154721",id:"21",timestamp:"2020-09-13T16:52:57Z",SWH:"0.69",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.22",geometry:{type:"Point",coordinates:[14.052757,54.085644]},geometry_name:"geom",properties:{lat:"54.085644",lon:"14.052757",id:"22",timestamp:"2020-09-13T16:52:57Z",SWH:"0.28",plength:"475.4",windSpeed:"4.25",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.26",geometry:{type:"Point",coordinates:[14.414745,54.120781]},geometry_name:"geom",properties:{lat:"54.120781",lon:"14.414745",id:"26",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"129.3",windSpeed:"4.20",pdirection:"45.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.27",geometry:{type:"Point",coordinates:[14.505316,54.129433]},geometry_name:"geom",properties:{lat:"54.129433",lon:"14.505316",id:"27",timestamp:"2020-09-13T16:52:57Z",SWH:"0.50",plength:"310.4",windSpeed:"4.60",pdirection:"14.0"}}]};var v=c(92);let _r=(()=>{class i{constructor(){this.sunlightForm=new v.cw({x:new v.NI(0,v.kI.required),y:new v.NI(0,v.kI.required)})}ngOnInit(){this.sunlightForm.valueChanges.subscribe(e=>{this.changeHandler(parseInt(e.x.toString(),10)/100,parseInt(e.y.toString(),10)/100)})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-sunlight"]],inputs:{changeHandler:"changeHandler"},decls:15,vars:1,consts:[["clrForm","","clrLayout","horizontal",3,"formGroup"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","x",1,"ukis-range-input"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","y",1,"ukis-range-input"]],template:function(e,r){1&e&&(s.TgZ(0,"form",0)(1,"label"),s._uU(2,"Sun position"),s.qZA(),s.TgZ(3,"clr-input-container")(4,"label"),s._uU(5,"x"),s.qZA(),s._UZ(6,"input",1),s.TgZ(7,"clr-control-helper"),s._uU(8,"east -> west"),s.qZA()(),s.TgZ(9,"clr-input-container")(10,"label"),s._uU(11,"y"),s.qZA(),s._UZ(12,"input",2),s.TgZ(13,"clr-control-helper"),s._uU(14,"south -> north"),s.qZA()()()),2&e&&s.Q6J("formGroup",r.sunlightForm)},dependencies:[x.MgK,x.CM6,x.YAP,x.mIp,x.xRP,x.G55,v._Y,v.Fj,v.eT,v.JJ,v.JL,v.sg,v.u]}),i})(),xr=(()=>{class i{constructor(){this.interpolationForm=new v.cw({power:new v.NI(2,v.kI.required),smooth:new v.NI(!0,v.kI.required),labels:new v.NI(!1,v.kI.required)})}ngOnInit(){this.interpolationForm.valueChanges.subscribe(e=>{this.changeHandler(e.power,e.smooth,e.labels)})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-interpolation-settings"]],inputs:{changeHandler:"changeHandler"},decls:21,vars:1,consts:[["clrForm","","clrLayout","vertical",3,"formGroup"],["type","range","min","1","max","7","value","1","clrInput","","formControlName","power",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","true","formControlName","smooth",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","false","formControlName","labels",1,"ukis-range-input"]],template:function(e,r){1&e&&(s.TgZ(0,"form",0)(1,"clr-input-container")(2,"label"),s._uU(3,"Power"),s.qZA(),s._UZ(4,"input",1),s.TgZ(5,"clr-control-helper"),s._uU(6,"inverse distance weighting power"),s.qZA()(),s.TgZ(7,"clr-checkbox-container")(8,"label"),s._uU(9,"Smoothing"),s.qZA(),s.TgZ(10,"clr-checkbox-wrapper"),s._UZ(11,"input",2),s.TgZ(12,"label"),s._uU(13,"Smoothing"),s.qZA()()(),s.TgZ(14,"clr-checkbox-container")(15,"label"),s._uU(16,"Labels"),s.qZA(),s.TgZ(17,"clr-checkbox-wrapper"),s._UZ(18,"input",3),s.TgZ(19,"label"),s._uU(20,"Show labels"),s.qZA()()()()),2&e&&s.Q6J("formGroup",r.interpolationForm)},dependencies:[x.MgK,x.CM6,x.YAP,x.mIp,x.KKC,x.Y_4,x.PEh,x.xRP,x.G55,v._Y,v.Fj,v.eT,v.Wl,v.JJ,v.JL,v.sg,v.u]}),i})();var C=c(5560),Tr=c(4230),Er=c(2308);class Sr extends _e.Z{constructor(t){super(t)}createRenderer(){return new Rr(this)}}class Rr extends Er.Z{constructor(t){super(t);const e=document.createElement("canvas");e.width=800,e.height=600,e.style.position="absolute";const n=t.getSource().getFeatures(),o=this.featuresToMeshes(n),l=new C.CP7({canvas:e,alpha:!0}),a=new C.cPb(45,e.width/e.height,.01,3e7);a.position.set(0,0,10),a.lookAt(new C.Pa4(0,0,0));const h=new C.xsS;for(const d of o)h.add(d);const u=new C.Ox3(16777215,1);u.position.set(-1,2,4),h.add(u),this.canvas=e,this.scene=h,this.meshes=o,this.renderer=l,this.camera=a}prepareFrame(t){const e=t.pixelRatio,r=t.size,n=Math.round(r[0]*e),o=Math.round(r[1]*e),a=t.viewState.center,d=this.extent2Height(t.extent,45);return this.camera.aspect=n/o,this.camera.fov=45,this.camera.near=.01,this.camera.far=3e8,this.camera.position.set(a[0],a[1],d),this.camera.lookAt(new C.Pa4(a[0],a[1],0)),this.camera.updateProjectionMatrix(),(r[0]!==this.canvas.width||r[1]!==this.canvas.height)&&(this.canvas.width=r[0],this.canvas.height=r[1],this.renderer.setSize(this.canvas.width,this.canvas.height)),this.canvas.style.opacity=""+t.layerStatesArray[t.layerIndex].opacity,!0}renderFrame(t,e){return this.renderer.render(this.scene,this.camera),this.canvas}renderDeclutter(t){}featuresToMeshes(t){const e=[];for(const r of t){const n=r.getGeometry(),o=r.get("height"),l=this.fGeom2tGeom(n,.1*o),a=new C.Ilk(16777215);a.setHex(16777215*Math.random());const h=new C.xoR({color:a}),u=new C.Kj0(l,h);e.push(u)}return e}fGeom2tGeom(t,e){const r=t.getCoordinates()[0],n=new C.bnF;n.moveTo(r[0][0],r[0][1]);for(let o=1;o<r.length;o++){const l=r[o];n.lineTo(l[0],l[1])}return new C.O7d(n,{depth:e,bevelEnabled:!1})}extent2Height(t,e){return(0,Tr.oP)(t[3]-t[1],e)}}var Ye=c(4879),Ar=c(400);const wr=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"name":"Polygon 1"},"geometry":{"type":"Polygon","coordinates":[[[-0.703125,56.12106042504407],[-2.197265625,49.15296965617042],[5.009765625,45.460130637921004],[16.435546875,46.37725420510028],[20.0390625,55.229023057406344],[4.658203125,58.03137242177637],[-0.703125,56.12106042504407]]]}},{"type":"Feature","properties":{"name":"Polygon 2"},"geometry":{"type":"Polygon","coordinates":[[[6.6796875,58.768200159239576],[19.86328125,56.80087831233043],[22.5,62.99515845212052],[10.01953125,64.88626540914477],[6.328125,62.062733258846514],[6.6796875,58.768200159239576]]]}},{"type":"Feature","properties":{"name":"Polygon 3"},"geometry":{"type":"Polygon","coordinates":[[[30.937499999999996,62.02152819100765],[23.994140624999996,62.062733258846514],[22.587890625,55.3791104480105],[37.79296875,55.62799595426723],[30.937499999999996,62.02152819100765]]]}},{"type":"Feature","properties":{"name":"Polygon 4"},"geometry":{"type":"Polygon","coordinates":[[[-8.876953125,39.436192999314095],[-11.689453125,28.459033019728043],[0.615234375,25.562265014427492],[8.173828125,33.137551192346145],[-0.9667968749999999,38.8225909761771],[-8.876953125,39.436192999314095]]]}},{"type":"Feature","properties":{"name":"Polygon 5"},"geometry":{"type":"Polygon","coordinates":[[[-140.44921875,-52.26815737376816],[-70.83984375,-52.26815737376816],[-70.83984375,59.17592824927136],[-140.44921875,59.17592824927136],[-140.44921875,-52.26815737376816]]]}}]}');function Fr(i,t){if(1&i&&(s.TgZ(0,"li"),s._uU(1),s.qZA()),2&i){const e=t.$implicit,r=s.oxw();s.xp6(1),s.AsE(" ",e,": ",r.group[e]||"undefined"," ")}}let br=(()=>{class i{constructor(e){this.layersSvc=e}ngOnInit(){this.groupkeys=["bbox","cssClass","displayName","filtertype","id","name","removable"]}}return i.\u0275fac=function(e){return new(e||i)(s.Y36(_.KD))},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-example-group-action"]],inputs:{group:"group"},decls:5,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,r){1&e&&(s.TgZ(0,"div")(1,"span"),s._uU(2,"some properties of the group:"),s.qZA(),s.TgZ(3,"ul"),s.YNc(4,Fr,2,2,"li",0),s.qZA()()),2&e&&(s.xp6(4),s.Q6J("ngForOf",r.groupkeys))},dependencies:[K.sg]}),i})();var Pr=c(6852);function Cr(i,t){if(1&i&&(s.TgZ(0,"th"),s._uU(1),s.qZA()),2&i){const e=t.$implicit;s.xp6(1),s.Oqu(e.key)}}function Lr(i,t){if(1&i&&(s.TgZ(0,"td"),s._uU(1),s.qZA()),2&i){const e=t.$implicit;s.xp6(1),s.Oqu(e.value)}}let Ir=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-popup2"]],inputs:{data:"data"},decls:11,vars:6,consts:[[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,r){1&e&&(s.TgZ(0,"table",0)(1,"caption"),s._uU(2," Demo for a basic Clarity table. "),s.qZA(),s.TgZ(3,"thead")(4,"tr"),s.YNc(5,Cr,2,1,"th",1),s.ALo(6,"keyvalue"),s.qZA()(),s.TgZ(7,"tbody")(8,"tr"),s.YNc(9,Lr,2,1,"td",1),s.ALo(10,"keyvalue"),s.qZA()()()),2&e&&(s.xp6(5),s.Q6J("ngForOf",s.lcZ(6,2,r.data)),s.xp6(4),s.Q6J("ngForOf",s.lcZ(10,4,r.data)))},dependencies:[K.sg,K.Nd]}),i})();var Zr=c(408),Ur=c(3307);let Mr=(()=>{class i{constructor(e,r,n){this.layersSvc=e,this.mapStateSvc=r,this.mapSvc=n,this.class="content-container",this.test=[],this.inputValue={value:15},this.controls={attribution:!0,scaleLine:!0,overviewMap:!0}}ngOnInit(){this.addLayers()}setInput(){const e=this.layersSvc.getLayerById("heatmap_layer");this.inputValue.value=40,e.action.inputs.value=this.inputValue.value}addLayers(){const e=new Qe.gY({id:"OSM1",visible:!1,bbox:[-66.408,3.577,113.592,64.94]}),r=new _.AO({id:"heatmap_layer",name:"Heatmap Layer",actions:[{title:"test",icon:"",action:f=>{}}],popup:{event:"click"},action:{component:mr,inputs:this.inputValue,outputs:{valueChange:f=>{this.inputValue.value=f}}},custom_layer:new Ut({source:new Z.Z({features:this.mapSvc.geoJsonToFeatures(Ae),format:new ze.Z}),radius:this.inputValue.value}),visible:!1}),n=new _.DJ({id:"Vector Layer1",name:"Vector Layer",type:"geojson",data:Ae,visible:!0,popup:{single:!0}}),o=new _.AO({id:"Layer_KML",name:"KML - VectorLayer",popup:!0,custom_layer:new _e.Z({source:new Z.Z({url:"assets/kml/TimeZones.kml",format:new Xt.ZP({extractStyles:!0})})}),visible:!1,bbox:[-180,-90,180,90]}),l=new _.AO({id:"topo_json_layer",name:"Topo Json - VectorImageLayer",custom_layer:new re.Z({source:new Z.Z({url:"https://openlayers.org/en/latest/examples/data/topojson/world-110m.json",format:new dr({layers:["countries"]}),overlaps:!1}),style:(f,R)=>((0,G.sq)(f),[new U.ZP({stroke:new j.Z({color:"gray",width:1}),fill:new P.Z({color:"rgba(0, 153, 255, 0.2)"})})])}),visible:!1}),a=new _.AO({id:"geo_json_layer_ocean",name:"GeoJson - VectorImageLayer ocean",popup:{event:"move"},custom_layer:new re.Z({source:new Z.Z({features:this.mapSvc.geoJsonToFeatures(Ar)}),style:(f,R)=>new U.ZP({stroke:new j.Z({color:"gray",width:1}),fill:new P.Z({color:"rgba(20,20,20,0.9)"})})}),visible:!0,bbox:[-180.35156249999997,-22.268764039073968,-129.375,29.84064389983441]}),h=new _.AO({id:"geo_json_layer_polys",name:"GeoJson polys - VectorImageLayer",popup:[{event:"click",single:!0,options:{autoPan:!1},dynamicPopup:{component:Pr.F,getAttributes:f=>({data:f.properties})}},{event:"move",options:{autoPan:!1},dynamicPopup:{component:Ir,getAttributes:f=>({data:f.properties})}}],custom_layer:new re.Z({source:new Z.Z({features:this.mapSvc.geoJsonToFeatures(wr)}),style:(f,R)=>new U.ZP({stroke:new j.Z({color:"gray",width:1}),fill:new P.Z({color:"rgba(51,153,51,1)"})})}),visible:!0}),u=new _.AO({id:"geo_json_layer_collection",name:"GeoJson Collection - VectorImageLayer",popup:{event:"click",single:!0,options:{autoPan:!1}},custom_layer:new re.Z({source:new Z.Z({url:"assets/geojson/test.collection.json",format:new ze.Z}),style:(f,R)=>new U.ZP({stroke:new j.Z({color:"rgba(153,51,51,1)",width:2}),fill:new P.Z({color:"rgba(153,51,51,1)"}),image:new Xe.Z({radius:5,fill:new P.Z({color:"rgba(153,51,51,1)"})})})}),visible:!0}),d=new _.AO({id:"static_image_layer",name:"Static Image",visible:!1,popup:{popupFunction:f=>f.color.toString()},custom_layer:new ne.Z({source:new Be({url:"assets/image/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326"})})}),g=new _.AO({id:"osm_clip_layer",name:"OSM Clip",visible:!0,popup:{popupFunction:f=>f.color.toString()},custom_layer:new xe.Z({source:new Se.Z}),bbox:[-105.41888884797893,6.480590573390401,-15.540298246016693,42.53496284727569]}),p=new _.AO({id:"customLayerOlGroup",name:"Custom Layer OlGroup",visible:!0,opacity:.6,popup:{event:"move",popupFunction:f=>`${f.color.toString()}`,options:{autoPan:!1}},custom_layer:new Mt.Z({layers:[new xe.Z({source:new Ve.Z({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"litemap",TILED:!0},serverType:"geoserver",transition:0})}),new xe.Z({source:new Ve.Z({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"liteoverlay",TILED:!0},serverType:"geoserver",transition:0})})]}),bbox:[-18.213,-26.814,68.344,11.783]}),y=new _.AO({id:"clusterLayer",name:"cluster Layer - VectorLayer",visible:!1,popup:!0,custom_layer:new _e.Z({source:new We.Z({distance:10,source:new Z.Z({features:this.mapSvc.geoJsonToFeatures(Ae)})})})}),m=new _.AO({id:"vectorTile",name:"VectorTileLayer",visible:!1,popup:{event:"move",filterkeys:["name","layer","class"],properties:{name:"Name"},options:{autoPan:!1}},custom_layer:new Gt.Z({source:new Vt.Z({format:new fr.Z,url:"https://tiles.geoservice.dlr.de/service/tms/1.0.0/planet_eoc@EPSG%3A900913@pbf/{z}/{x}/{y}.pbf?flipy=true"}),style:(f,R)=>{const A=f.get("layer"),N=f.get("class");if(this.test.includes(A)||this.test.push(A),A){if("water"===A)return new U.ZP({fill:new P.Z({color:"rgba(67,162,202,0.9)"})});if("boundary"===A)return new U.ZP({stroke:new j.Z({color:"gray",width:1}),fill:new P.Z({color:"rgba(0,0,0,0)"})});if("landcover"===A&&N){if("wood"===N)return new U.ZP({fill:new P.Z({color:"rgba(53,151,143,0.7)"})});if("grass"===N)return new U.ZP({fill:new P.Z({color:"rgba(168,221,181,0.7)"})})}}}})}),M=new _.ex({name:"Heatmap Group",filtertype:"Layers",id:"group1",layers:[r,n],description:"This is a custom layer group with some custom angular components in the UI",action:{component:br}}),ie=new _.AO({id:"image_wms",name:"Image WMS",custom_layer:new ne.Z({source:new Wt.Z({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"})}),visible:!1,popup:{popupFunction:f=>f.color.toString()},bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),O=new _.AO({id:"dtmLayer",name:"SRTM DTM",filtertype:"Layers",custom_layer:new Ye.UT({source:new Be({url:"assets/image/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326"})}),action:{component:_r,inputs:{changeHandler:(f,R)=>{O.custom_layer.updateSunAngle([f,R])}}},opacity:.6,visible:!1,description:"<p>This layer uses SRTM data to calculate surface-normals and uses them to dynamically create shades on hilltops. Things like these might be a nice illustration for time-enabled maps.</p>\n      <p>Use the controls to dynamically change the sun's angle.</p>"}),Y=this.mapSvc.getProjection().getMetersPerUnit(),we=new Ee.kv({code:"EPSG:4326",units:"degrees"}).getMetersPerUnit();Je.features.map(f=>f.properties.height=f.properties.height*we/Y);const Fe=new _.AO({id:"three",name:"Bars layer",custom_layer:new Sr({source:new Z.Z({features:this.mapSvc.geoJsonToFeatures(Je)})}),filtertype:"Layers",opacity:.7,visible:!1,description:"<p>This layer demonstrates how a common 3d-library, three.js, can be integrated in a 2d-map. Using three.js often yields less verbose code than calling WebGL directly.</p>"}),B=new Z.Z({features:this.mapSvc.geoJsonToFeatures(vr)}),V=new We.Z({source:B,distance:25}),L=new _.AO({id:"interpolation",name:"Interpolation",custom_layer:new Ye.qS({source:V,style:(f,R)=>{const A=f.getProperties().features;let N;return N=A.length>1?`${f.getProperties().features.length}`:`${Number.parseFloat(A[0].getProperties().SWH).toPrecision(3)}`,new U.ZP({image:new Xe.Z({radius:13,fill:new P.Z({color:"rgba(0, 153, 255, 0.2)"}),stroke:new j.Z({color:"rgba(255, 255, 255, 0.2)",width:1})}),text:new gr.Z({text:N,overflow:!0,offsetX:-5*N.length/2,offsetY:1,textAlign:"left",fill:new P.Z({color:"#ffffff"})})})},renderSettings:{maxEdgeLength:15e3/Y,power:2,colorRamp:[{val:0,rgb:[166,97,26]},{val:.4,rgb:[223,194,125]},{val:.8,rgb:[247,247,247]},{val:2,rgb:[128,205,193]},{val:22.5,rgb:[1,133,113]}],smooth:!0,showLabels:!1,valueProperty:"SWH",storeInterpolatedPixelData:!1}}),action:{component:xr,inputs:{changeHandler:(f,R,A)=>{L.custom_layer.updateParas(f,R,A)}}},filtertype:"Layers",opacity:.7,visible:!1,description:"This layer is an example of how WebGL can be used to outsource computationally expensive operations. For inverse-distance interpolation we need to account for every datapoint at every pixel."}),X=new _.ex({name:"Webgl Group",filtertype:"Layers",id:"group2",layers:[O,Fe,L]}),W=new _.AO({name:"Transparenter Hintergrund",id:"blank",type:"custom",visible:!1,custom_layer:new ne.Z({source:new jt({canvasFunction:()=>document.createElement("canvas")})})}),H=new _.AO({name:"Ol Raster Source OSM",id:"rasterSourceLayer",type:"custom",visible:!1,removable:!0,custom_layer:new ne.Z({source:new He.ZP({sources:[new Se.Z],operation:f=>f[0],operationType:"image"})})});[W,H,e,m,X,y,ie,o,d,g,l,h,u,M,a,p].forEach(f=>{f instanceof _.mh?this.layersSvc.addLayer(f,"Layers"):f instanceof _.ex&&this.layersSvc.addLayerGroup(f)}),setTimeout(()=>{H.visible=!0,H.custom_layer.setSource(new He.ZP({sources:[new Se.Z],operation:f=>f[0],operationType:"image"})),this.layersSvc.updateLayer(H)},2e3)}ngAfterViewInit(){const e=new _.DJ({id:"Vector Layer2",name:"async add Layer",type:"geojson",data:yr,visible:!1,popup:!0});setTimeout(()=>{this.layersSvc.addLayer(e,"Layers")},2e3)}}return i.\u0275fac=function(e){return new(e||i)(s.Y36(_.KD),s.Y36(Ce.I3),s.Y36(ae.BR))},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-route-map4"]],hostVars:2,hostBindings:function(e,r){2&e&&s.Tol(r.class)},features:[s._Bn([_.KD,Ce.I3,ae.BR])],decls:15,vars:10,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","set input of dynamic component from parent when it is created or the input changed",1,"btn","btn-primary",3,"click"]],template:function(e,r){1&e&&(s.TgZ(0,"main",0),s._UZ(1,"ukis-map-ol",1),s.qZA(),s.TgZ(2,"clr-vertical-nav",2)(3,"clr-vertical-nav-group",3),s._UZ(4,"clr-icon",4),s._uU(5," Layers "),s.TgZ(6,"clr-vertical-nav-group-children",5),s._UZ(7,"ukis-layer-control",6),s.qZA()(),s.TgZ(8,"clr-vertical-nav-group",3),s._UZ(9,"clr-icon",4),s._uU(10," Test to set dynamic component "),s.TgZ(11,"clr-vertical-nav-group-children",5)(12,"button",7),s.NdJ("click",function(){return r.setInput()}),s._uU(13,"Set Heatmap Layer radius"),s.qZA(),s._uU(14),s.qZA()()()),2&e&&(s.xp6(1),s.Q6J("layersSvc",r.layersSvc)("mapState",r.mapStateSvc)("controls",r.controls),s.xp6(1),s.Q6J("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.xp6(1),s.Q6J("clrVerticalNavGroupExpanded",!0),s.xp6(4),s.Q6J("layersSvc",r.layersSvc)("mapStateSvc",r.mapStateSvc),s.xp6(1),s.Q6J("clrVerticalNavGroupExpanded",!0),s.xp6(6),s.hij(" ",r.inputValue.value," "))},dependencies:[x.qvL,x.saT,x.fzC,x.A0B,x.d6G,x.ogR,Zr.E,Ur.j]}),i})();var Gr=c(5508);const Dr=[{path:"",component:Mr}];let Ke=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=s.oAB({type:i}),i.\u0275inj=s.cJS({imports:[Pe.Bz.forChild(Dr),Pe.Bz]}),i})(),Nr=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=s.oAB({type:i}),i.\u0275inj=s.cJS({imports:[K.ez,ke.q,Ke,x.K6A,Gr.cE,ae.oC]}),i})()}}]);