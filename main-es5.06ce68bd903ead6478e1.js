!function(){function e(t,r,n){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(t,r,n||t)}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==r)return;var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(c){s=!0,a=c}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var a=p(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,r){e.exports=r("GPX4")},"94f5":function(e){e.exports=JSON.parse('{"type":"FeatureCollection","poperties":{"description":"This are a few test cities and locations collected with geojson.io"},"features":[{"type":"Feature","properties":{"name":"Munich"},"geometry":{"type":"Point","coordinates":[11.575899124145508,48.137740422322295]}},{"type":"Feature","properties":{"name":"Landshut"},"geometry":{"type":"Point","coordinates":[12.152938842773436,48.5370678355958]}},{"type":"Feature","properties":{"name":"Ulm"},"geometry":{"type":"Point","coordinates":[9.986572265624998,48.40003249610685]}},{"type":"Feature","properties":{"name":"Ingolstadt"},"geometry":{"type":"Point","coordinates":[11.42578125,48.75618876280552]}},{"type":"Feature","properties":{"name":"Paris"},"geometry":{"type":"Point","coordinates":[2.3291015625,48.83579746243093]}},{"type":"Feature","properties":{"name":"Dreux"},"geometry":{"type":"Point","coordinates":[1.3677978515625,48.73445537176822]}},{"type":"Feature","properties":{"name":"Meaux"},"geometry":{"type":"Point","coordinates":[2.8729248046875,48.95497369808868]}},{"type":"Feature","properties":{"name":"Rome"},"geometry":{"type":"Point","coordinates":[12.480468749999998,41.86956082699455]}},{"type":"Feature","properties":{"name":"Anzio"},"geometry":{"type":"Point","coordinates":[12.6287841796875,41.4509614012039]}},{"type":"Feature","properties":{"name":"Berlin"},"geometry":{"type":"Point","coordinates":[13.403320312499998,52.50953477032727]}},{"type":"Feature","properties":{"name":"Potsdam"},"geometry":{"type":"Point","coordinates":[13.058624267578125,52.40074312027673]}}]}')},GPX4:function(a,i,s){"use strict";s.r(i);var d=s("cUpR"),v=s("8Y7J"),y=s("iInd"),m="wms",b="wmts",g="xyz",w="geojson",S="wfs",x="custom";function P(e){return[w,S,x].includes(e)}function k(e){return[m,b,g,x].includes(e)}var _,L,E=function(){function e(t){f(this,e),this.name="",this.id="",this.opacity=1,this.visible=!0,this.removable=!1,this.filtertype="Layers",this.continuousWorld=!1,this.expanded=!1,Object.assign(this,t)}return h(e,[{key:"time",get:function(){return this.protTime},set:function(e){this.protTime=e}}]),e}(),O=function(e){o(r,e);var t=c(r);function r(e){var n;if(f(this,r),(n=t.call(this,e)).styles&&n.styles.length>0){var a=n.styles.find(function(e){return e.default});a||(a=n.styles[0]),n.legendImg=a.legendURL,n.params?(n.type===m?n.params.STYLES=a.name:n.type===b&&(n.params.style=a.name),n.params.STYLES=a.name):n.type===b&&(n.params||(n.params={}),n.params.style=a.name)}return l(n)}return h(r,[{key:"time",get:function(){return this.protTime},set:function(e){this.params&&(this.params.TIME=e),this.protTime=e}}]),r}(E),T=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return r}(E),C=function(e){o(r,e);var t=c(r);function r(e){var n;return f(this,r),(n=t.call(this,e)).type="custom",n.custom_layer={},Object.assign(u(n),e),n}return r}(E),R=function(){function e(t){f(this,e),this.filtertype="Layers",this.removable=!0,this.layerRemovable=!0,this.expanded=!1,t&&void 0!==t.visible&&t.layers&&t.layers.length&&(t.layers=t.layers.map(function(e){return e.visible=t.visible,e})),Object.assign(this,t)}return h(e,[{key:"visible",get:function(){return this.layers&&this.layers.length&&(this.protVisible=this.layers.filter(function(e){return e.visible}).length>0),this.protVisible},set:function(e){this.protVisible=e,this.layers&&this.layers.length&&(this.layers=this.layers.map(function(t){return t.visible=e,t}))}}]),e}(),I=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return r}(O),F=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return r}(O),M=s("2Vo4"),G=((_=function(){function e(){f(this,e),this.store=new M.a(Array()),this.baseLayers=new M.a(Array()),this.overlays=new M.a(Array()),this.layers=new M.a(Array())}return h(e,[{key:"addLayer",value:function(e,t,r){if(this.isInLayergroups(e))console.error("layer or Group with id: ".concat(e.id," already exists!"));else{t?e.filtertype=t:t=e.filtertype;var n=this.store.getValue();r||(n.push(e),this.store.next(n)),this.filterFiltertype(t)}}},{key:"removeLayer",value:function(e,t,r){this.isInLayergroups(e)?r?(console.log("layer: ".concat(e.id," is removed with force!")),this._removeLayer(e,t)):e.removable?this._removeLayer(e,t):e.removable||console.log("layer: ".concat(e.id," is not removable!")):console.error("layer with id: ".concat(e.id," not in storeItems!"))}},{key:"_removeLayer",value:function(e,t){t?t!==e.filtertype&&console.error("the layer with id: ".concat(e.id," you want to remove from ").concat(t," is from filtertype: ").concat(e.filtertype)):t=e.filtertype;var r=this.store.getValue().filter(function(t){return t instanceof E?t.id!==e.id:t});this.store.next(r),this.filterFiltertype(t)}},{key:"updateLayer",value:function(e,t){this.isInLayergroups(e)?(t?t!==e.filtertype&&console.error("the layer with id: ".concat(e.id," you want to update is from filtertype: ").concat(e.filtertype," and not from ").concat(t," ")):t=e.filtertype,"Overlays"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype)),"Layers"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype)),"Baselayers"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype))):console.error("layer with id: ".concat(e.id," you want to update not in storeItems!"))}},{key:"updateLayerOrGroupInStore",value:function(e){var t=this;this.store.getValue().filter(function(r,n,a){r instanceof E&&e instanceof E?r.id===e.id&&(a[n]=e,t.store.next(a)):r instanceof R&&e instanceof R&&r.id===e.id&&(a[n]=e,t.store.next(a))})}},{key:"removeLayerOrGroupById",value:function(e,t,r){var n=this;this.store.getValue().filter(function(a){a instanceof E?a.id===e&&n.removeLayer(a,a.filtertype||"Layers",r):a instanceof R&&(a.id===e?n.removeLayerGroup(a,r):a.layers.forEach(function(i){i.id===e&&n.removeLayerFromGroup(i,a,t,r)}))})}},{key:"addLayerToGroup",value:function(e,t){this.isInLayergroups(e)?console.error("layer with id: ".concat(e.id," already exists!")):(e.filtertype!==t.filtertype&&(e.filtertype=t.filtertype),this.isInLayergroups(e,[t])?console.error("layer with id: ".concat(e.id," already exists in ").concat(t.id,"!"),t):(t.layers.push(e),this.updateLayerGroup(t)))}},{key:"addLayerToGroupById",value:function(e,t){var r=this;this.store.getValue().forEach(function(n){n instanceof R&&n.id===t&&r.addLayerToGroup(e,n)})}},{key:"removeLayerFromGroup",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;t.layers=t.layers.filter(function(t){return t.id!==e.id}),this.updateLayerGroup(t),this.filterFiltertype(e.filtertype),0===t.layers.length&&r&&this.removeLayerGroup(t,n)}},{key:"setLayerIndexInGroup",value:function(e,t,r){var n=r.layers.indexOf(e);switch(t){case"up":if(0===n)break;this.arrayMove(r.layers,n,n-1);break;case"down":if(n===r.layers.length-1)break;this.arrayMove(r.layers,n,n+1)}this.updateLayer(e,r.filtertype||"Layers")}},{key:"addLayerGroup",value:function(e,t){if(!this.isInLayergroups(e)){t?e.filtertype=t:t=e.filtertype;var r=this.store.getValue();this.isInLayergroups(e,e.layers)&&(e.layers=e.layers.filter(function(t){return t.id!==e.id})),e.layers=e.layers.map(function(t){return t.filtertype=e.filtertype,t}),r.push(e),this.store.next(r),this.updateLayerGroup(e)}}},{key:"removeLayerGroup",value:function(e,t){this.isInLayergroups(e)?t?(console.log("layerGroup: ".concat(e.id," is removed with force!")),this._removeLayerGroup(e)):e.removable?this._removeLayerGroup(e):e.removable||console.log("layerGroup: ".concat(e.id," is not removable!")):console.error("layer or Group with id: ".concat(e.id," not in storeItems!"))}},{key:"_removeLayerGroup",value:function(e){var t,r=n(e.layers);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.removeLayerFromGroup(a,e)}}catch(o){r.e(o)}finally{r.f()}var i=this.store.getValue().filter(function(t,r){return t.id!==e.id});this.store.next(i)}},{key:"updateLayerGroup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&(e=this.sortLayerGroup(e)),this.updateLayerOrGroupInStore(e);var r,a=n(e.layers);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.updateLayer(i,e.filtertype||"Layers")}}catch(o){a.e(o)}finally{a.f()}}},{key:"arrayMove",value:function(e,t,r){e.splice(r<0?e.length+r:r,0,e.splice(t,1)[0])}},{key:"setGroupLayerIndex",value:function(e,t){var r;if((e instanceof E&&e.filtertype||e instanceof R)&&(r=this.getNumOfGroups(e.filtertype)),r>1){var n=this.store.getValue(),a=n.indexOf(e);this.isGroupFirst(e)&&this.isGroupLast(e)||("number"==typeof t?this.arrayMove(n,a,t):"up"===t?this.arrayMove(n,a,a-1):"down"===t&&this.arrayMove(n,a,a+1)),this.store.next(n),this.baseLayers.next(this.filterBaseLayers()),this.layers.next(this.filterLayers()),this.overlays.next(this.filterOverlays())}}},{key:"getNumOfGroups",value:function(e){var t,r=0,a=n(this.store.getValue());try{for(a.s();!(t=a.n()).done;)t.value.filtertype===e&&r++}catch(i){a.e(i)}finally{a.f()}return r}},{key:"isGroupFirst",value:function(e,t,r){var n=!1,a=this.store.getValue();return t&&(a=t),r&&(a=a.filter(function(e){return e.filtertype===r})),0===a.indexOf(e)&&(n=!0),n}},{key:"isGroupLast",value:function(e,t,r){var n=!1,a=this.store.getValue();return t&&(a=t),r&&(a=a.filter(function(e){return e.filtertype===r})),a.indexOf(e)===a.length-1&&(n=!0),n}},{key:"isInLayergroups",value:function(e,t){var r,n=!1;r=e instanceof E||e instanceof R?e.id:e;var a=this.getLayerOrGroupById(r,t);return(a&&a instanceof E||a instanceof R)&&(n=!0),n}},{key:"getLayerOrGroupById",value:function(e,t){var r=[],n=this.store.getValue();return t&&(n=t),n.map(function(t){t instanceof R?t.id===e?r.push(t):t.layers.map(function(t){t.id===e&&r.push(t)}):t instanceof E&&t.id===e&&r.push(t)}),r.length?1===r.length?r[0]:void(r.length>1&&console.log("there is a duplicate ID in the Layer Groups!")):null}},{key:"getLayerById",value:function(e,t){var r,n=this.flattenDeepArray(this.store.getValue());return t&&(n=t),n.map(function(t){t.id===e&&(r=t)}),r}},{key:"getBaseLayers",value:function(){return this.baseLayers.asObservable()}},{key:"removeBaseLayers",value:function(e){var t=this,r=this.filterBaseLayers();return e&&(r=r.filter(e)),r.forEach(function(e){t.removeLayerOrGroupById(e.id)}),this.baseLayers.asObservable()}},{key:"getBaseLayersCount",value:function(){return this.baseLayers.getValue().length}},{key:"getOverlays",value:function(){return this.overlays.asObservable()}},{key:"removeOverlays",value:function(e){var t=this,r=this.filterOverlays();return e&&(r=r.filter(e)),r.forEach(function(e){t.removeLayerOrGroupById(e.id)}),this.overlays.asObservable()}},{key:"getOverlaysCount",value:function(){return this.overlays.getValue().length}},{key:"getLayers",value:function(){return this.layers.asObservable()}},{key:"removeLayers",value:function(e){var t=this,r=this.filterLayers();return e&&(r=r.filter(e)),r.forEach(function(e){t.removeLayerOrGroupById(e.id)}),this.layers.asObservable()}},{key:"getLayersCount",value:function(){return this.layers.getValue().length}},{key:"getLayerGroups",value:function(){return this.store.asObservable()}},{key:"setLayerGroups",value:function(e,t){var r=this;return e.length>0&&e.map(function(e){e instanceof R&&e.layers.length>0&&(e.layers=e.layers.map(function(t){return t.filtertype=e.filtertype,t}))}),t?("Baselayers"===t?this.removeBaseLayers():"Layers"===t?this.removeLayers():"Overlays"===t&&this.removeOverlays(),e.map(function(e){e instanceof E?r.addLayer(e,t):e instanceof R&&r.addLayerGroup(e,t)})):(this.store.next(e),this.baseLayers.next(this.filterBaseLayers()),this.layers.next(this.filterLayers()),this.overlays.next(this.filterOverlays())),this.store.asObservable()}},{key:"getLayerGroupsCount",value:function(){return this.store.getValue().length}},{key:"flattenDeepArray",value:function(e){var t=this;return e.reduce(function(e,r){return r instanceof R&&Array.isArray(r.layers)?e.concat(t.flattenDeepArray(r.layers)):e.concat(r)},[])}},{key:"filterOverlays",value:function(){var e=this.store.getValue();return this.flattenDeepArray(e.filter(function(e){return"Overlays"===e.filtertype}))}},{key:"filterBaseLayers",value:function(){var e=this.store.getValue();return this.flattenDeepArray(e.filter(function(e){return"Baselayers"===e.filtertype}))}},{key:"filterLayers",value:function(){var e=this.store.getValue();return this.flattenDeepArray(e.filter(function(e){return"Layers"===e.filtertype}))}},{key:"filterFiltertype",value:function(e){"Baselayers"===e?this.baseLayers.next(this.filterBaseLayers()):"Overlays"===e?this.overlays.next(this.filterOverlays()):"Layers"===e&&this.layers.next(this.filterLayers())}},{key:"sortLayerGroup",value:function(e){return e.layers.sort(function(e,t){var r=0;return e instanceof O?r=1:t instanceof O&&(r=-1),r}),e}}]),e}()).\u0275fac=function(e){return new(e||_)},_.\u0275prov=v.Gb({token:_,factory:_.\u0275fac,providedIn:"root"}),_),A=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[-180,-90,180,90],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(new Date).toISOString();f(this,e),this.zoom=t,this.center=r,this.extent=a,this.time=i,this.options=Object.assign({maxzoom:0,minzoom:0,notifier:"map"},n)}return h(e,[{key:"sameCenter",value:function(e){return this.center.lat===e.lat&&this.center.lon===e.lon}},{key:"sameZoom",value:function(e){return this.zoom===e}},{key:"sameExtent",value:function(e){var t=!1;return this.extent.length===e.length&&(t=this.extent.every(function(t,r){return e[r]===t})),t}},{key:"sameNotifier",value:function(e){return this.options.notifier===e}}]),e}(),j=s("lJxs"),D=new A(0,{lat:0,lon:0}),z=((L=function(){function e(){f(this,e),this.mapState=new M.a(D),this.lastAction=new M.a(null)}return h(e,[{key:"getMapState",value:function(){return this.mapState}},{key:"setMapState",value:function(e){if(e)if(this.lastAction.next("setState"),e instanceof A){var t=new A(e.zoom,e.center,e.options,e.extent);this.mapState.next(t)}else{var r=Object.assign({notifier:"user"},e.options),n=new A(e.zoom,e.center,r,e.extent);this.mapState.next(n)}}},{key:"getExtent",value:function(){return this.mapState.pipe(Object(j.a)(function(e){return e.extent}))}},{key:"setExtent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";if(e){this.lastAction.next("setExtent");var r=this.getMapState().getValue();r.options.notifier=t;var n=new A(r.zoom,r.center,r.options,e);this.mapState.next(n)}}},{key:"getLastAction",value:function(){return this.lastAction}}]),e}()).\u0275fac=function(e){return new(e||L)},L.\u0275prov=v.Gb({token:L,factory:L.\u0275fac,providedIn:"root"}),L),V=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"OpenStreetMap",displayName:"OpenStreetMap",id:"osm",visible:!1,type:"xyz",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",subdomains:["a","b","c"],attribution:'&copy, <a href="https://www.openstreetmap.org">OpenStreetMap</a> contributors',continuousWorld:!1,legendImg:"https://a.tile.openstreetmap.org/3/4/3.png",description:"OpenStreetMap z-x-y Tiles",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(O),Q=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"OpenSeaMap",displayName:"OpenSeaMap",id:"OpenSeaMap",visible:!1,type:"xyz",removable:!1,url:"https://{s}.openseamap.org/seamark/{z}/{x}/{y}.png",subdomains:["t1"],attribution:'&copy, <a href="https://map.openseamap.org/legend.php?lang=de&page=license">OpenSeaMap</a>',continuousWorld:!1,legendImg:"https://t1.openseamap.org/seamark/10/554/321.png",description:"http://map.openseamap.org/",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(O),N=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"EOC Litemap",displayName:"EOC Litemap",id:"eoc_litemap",visible:!1,type:"wms",removable:!1,params:{LAYERS:"litemap",FORMAT:"image/png",TRANSPARENT:!0},url:"https://geoservice.dlr.de/eoc/basemap/wms",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://geoservice.dlr.de/eoc/basemap/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&FORMAT=image%2Fpng&TRANSPARENT=true&LAYERS=litemap&ATTRIBUTION=&WIDTH=256&HEIGHT=256&CRS=EPSG%3A3857&STYLES=&BBOX=0%2C0%2C10018754.171394622%2C10018754.171394622",description:"http://www.naturalearthdata.com/about/",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(F),B=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"EOC Litemap Tile",displayName:"EOC Litemap Tile",id:"eoc_litemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:litemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Alitemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"EOC Litemap as web map tile service",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),U=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"EOC Liteoverlay Tile",displayName:"EOC LiteoverlayTile",id:"eoc_Liteoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:liteoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aliteoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the liteoverlay provided for EOC Service Portals",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),W=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"EOC Basemap Tile",displayName:"EOC Basemap Tile",id:"eoc_basemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:basemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abasemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),Z=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"EOC Baseoverlay Tile",displayName:"EOC Baseoverlay Tile",id:"eoc_Baseoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:baseoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abaseoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),H=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"BlueMarble Tile",displayName:"BlueMarble Tile",id:"blueMarble_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"bmng_topo_bathy",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=bmng_topo_bathy&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Blue Marble NG dataset with topography and bathymetry",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),X=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"World Relief B/W Tile",displayName:"World Relief B/W Tile",id:"eoc:world_relief_bw",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:world_relief_bw",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aworld_relief_bw&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"World Relief Black / White",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),q=function(e){o(r,e);var t=c(r);function r(e){f(this,r);var n={name:"Hillshade Tile",displayName:"Hillshade Tile",id:"eoc_hillshade",visible:!1,type:"wmts",removable:!1,params:{layer:"hillshade",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=hillshade&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Global Hillshade based on GMTED2010",opacity:1};return e&&Object.assign(n,e),t.call(this,n)}return r}(I),Y=s("m1H0"),K=s("ci6y"),J=s("U1NS"),$=s("DsyP"),ee=s("2tVv"),te=s("DwgT"),re=s("zmPu"),ne=s("y5Nx"),ae=s("ZII/"),ie=s("JlTo"),oe=s("qsxt"),se=s("wuBr"),ce=s("llT+"),le=s("PxdU"),ue=s("M/FA"),pe=s("XEES"),fe=s("XheB"),de=s("Fnjr"),he=s("Dm0N"),ve=s("8yCo"),ye=s("IAcf"),me=s("rCez"),be=s("LXzw"),ge=s("Msoz"),we=s("Znq9"),Se=s("c7WQ"),xe=s("p5/s"),Pe=s("hKKC"),ke=s("1rej"),_e=s("orbG"),Le=s("sOX2"),Ee=s("OT4/"),Oe=s("fyJ9"),Te=s("0T8a"),Ce=s("kEUA"),Re=s("dPhe"),Ie=s("2I+J"),Fe=s("XNiG"),Me=s("0o2U");function Ge(e){var t,r=[],a=n(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i instanceof $.a){var o=Ge(i.getLayers().getArray());r=Array.prototype.concat(r,o)}else r.push(i)}}catch(s){a.e(s)}finally{a.f()}return r}var Ae=s("PhKu"),je=s("QQLW"),De=function e(t){var r,a=[],i=n(t);try{for(i.s();!(r=i.n()).done;){var o,s=r.value;o=Array.isArray(s[0])?e(s):s,a=Array.prototype.concat(a,o)}}catch(c){i.e(c)}finally{i.f()}return a},ze=function(e,t){return Math.log(e)/Math.log(t)},Ve=function(e,t){return ze(e,t)%1==0},Qe=function(e,t,r){var n=e.createShader(t);if(!n)throw new Error("No shader was created");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw e.deleteShader(n),new Error("An error occurred compiling the shader: ".concat(e.getShaderInfoLog(n),".    \n\n Shader code: ").concat(r));return n},Ne=function(e,t){e.useProgram(t)},Be=function(e,t,r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.vectorSize,r.type,r.normalize,r.stride,r.offset)},Ue=function(e,t,r,n){if(r>e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS))throw new Error("There are only ".concat(e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)," texture bind points, but you tried to bind to point nr. ").concat(r,"."));7===r&&console.error("You are about to bind to the dedicated texture-construction bind point (nr. ".concat(r,").\n        If after this call another texture is built, your shader will now use that new texture instead of this one!\n        Consider using another bind point.")),e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(n,r)},We=function(e,t,r){var n=e.getUniformLocation(t,r);if(null===n)throw new Error("Couldn't find uniform ".concat(r," in program."));return n},Ze=function(e,t,r,n){switch(r){case"bool":e.uniform1i(t,n[0]);break;case"bvec2":e.uniform2i(t,n[0],n[1]);break;case"bvec3":e.uniform3i(t,n[0],n[1],n[2]);break;case"bvec4":e.uniform4i(t,n[0],n[1],n[2],n[3]);break;case"bool[]":e.uniform1iv(t,n);break;case"bvec2[]":e.uniform2iv(t,n);break;case"bvec3[]":e.uniform3iv(t,n);break;case"bvec4[]":e.uniform4iv(t,n);break;case"int":e.uniform1i(t,n[0]);break;case"ivec2":e.uniform2i(t,n[0],n[1]);break;case"ivec3":e.uniform3i(t,n[0],n[1],n[2]);break;case"ivec4":e.uniform4i(t,n[0],n[1],n[2],n[3]);break;case"int[]":e.uniform1iv(t,n);break;case"ivec2[]":e.uniform2iv(t,n);break;case"ivec3[]":e.uniform3iv(t,n);break;case"ivec4[]":e.uniform4iv(t,n);break;case"float":e.uniform1f(t,n[0]);break;case"vec2":e.uniform2f(t,n[0],n[1]);break;case"vec3":e.uniform3f(t,n[0],n[1],n[2]);break;case"vec4":e.uniform4f(t,n[0],n[1],n[2],n[3]);break;case"float[]":e.uniform1fv(t,n);break;case"vec2[]":e.uniform2fv(t,n);break;case"vec3[]":e.uniform3fv(t,n);break;case"vec4[]":e.uniform4fv(t,n);break;case"mat2":e.uniformMatrix2fv(t,!1,n);break;case"mat3":e.uniformMatrix3fv(t,!1,n);break;case"mat4":e.uniformMatrix4fv(t,!1,n);break;default:throw Error("Type ".concat(r," not implemented."))}},He=function e(t,r,a){f(this,e),this.vertexShaderSource=r,this.fragmentShaderSource=a,this.program=function(e,t,r){var n=e.createProgram();if(!n)throw new Error("No program was created");var a=Qe(e,e.VERTEX_SHADER,t),i=Qe(e,e.FRAGMENT_SHADER,r);if(e.attachShader(n,a),e.attachShader(n,i),e.linkProgram(n),e.detachShader(n,a),e.detachShader(n,i),e.deleteShader(a),e.deleteShader(i),!e.getProgramParameter(n,e.LINK_STATUS))throw e.deleteProgram(n),new Error("Unable to initialize the shader program: "+e.getProgramInfoLog(n));return n}(t,r,a),this.id=function(e){var t,r=0,a=n(e);try{for(a.s();!(t=a.n()).done;){r+=t.value.charCodeAt(0)}}catch(i){a.e(i)}finally{a.f()}return"".concat(r)}(r+a)},Xe=function e(t,r,n,a,i){f(this,e),this.location=We(t,r.program,n),this.type=a,this.value=i,this.variableName=n},qe=function e(t,r,n,a,i){f(this,e),this.location=We(t,r.program,n),this.texture=a instanceof HTMLImageElement||a instanceof HTMLCanvasElement?function(e,t){var r=e.createTexture();if(!r)throw new Error("No texture was created");e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,r);var n,a,i=e.RGBA,o=e.RGBA,s=e.UNSIGNED_BYTE;return e.texImage2D(e.TEXTURE_2D,0,i,o,s,t),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),t instanceof HTMLImageElement?(n=t.naturalWidth,a=t.naturalHeight):(n=t.width,a=t.height),{texture:r,level:0,internalformat:i,format:o,type:s,width:n,height:a,border:0}}(t,a):a,this.bindPoint=i,this.variableName=n},Ye=function e(t,r,n,a,i){f(this,e),this.location=We(t,r.program,n),this.texture=function(e,t){var r=t.length,n=t[0].length,a=t[0][0].length;if(!Ve(n,2)||!Ve(r,2))throw new Error("Texture-data-dimensions must be a power of two, but are ".concat(n," x ").concat(r));if(4!==a)throw new Error("Expecting 4 channels, but ".concat(a," provided"));var i=e.createTexture();if(!i)throw new Error("No texture was created");e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,i);var o=e.RGBA,s=e.RGBA,c=e.UNSIGNED_BYTE,l=new Uint8Array(De(t));return 4!==a&&e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,o,n,r,0,s,c,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),{texture:i,level:0,internalformat:o,format:s,type:c,width:n,height:r,border:0}}(t,a),this.bindPoint=i,this.variableName=n},Ke=function e(t,r,n,a){var i,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"triangles";switch(f(this,e),o){case"triangles":i=t.TRIANGLES;break;case"lines":i=t.LINES;break;case"points":i=t.POINTS;break;default:throw new Error("Invalid drawing mode ".concat(o))}this.location=function(e,t,r){var n=e.getAttribLocation(t,r);if(-1===n)throw new Error("Couldn't find attribute ".concat(r," in program."));return n}(t,r.program,n),this.value=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.TRIANGLES,n=new Float32Array(De(t)),a=e.createBuffer();if(!a)throw new Error("No buffer was created");return e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),{buffer:a,vectorSize:t[0].length,vectorCount:t.length,type:e.FLOAT,normalize:!1,stride:0,offset:0,drawingMode:r}}(t,a,i),this.variableName=n,this.drawingMode=i},Je=function e(t,r){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"triangles";switch(f(this,e),a){case"triangles":n=t.TRIANGLES;break;case"lines":n=t.LINES;break;case"points":n=t.POINTS;break;default:throw new Error("Invalid drawing mode ".concat(a))}this.index=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.TRIANGLES,n=new Uint16Array(De(t)),a=e.createBuffer();if(!a)throw new Error("No buffer was created");return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),{buffer:a,count:n.length,type:e.UNSIGNED_SHORT,offset:0,drawingMode:r}}(t,r,n)};function $e(e,t){var r,a=n(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(t(i))return i}}catch(o){a.e(o)}finally{a.f()}return null}var et=function(){function e(a,i,o,s,c){f(this,e),this.program=a,this.attributes=i,this.uniforms=o,this.textures=s,this.index=c;var l,u=r(function(e){for(var t,r=/^\s*attribute (int|float|vec2|vec3|vec4|mat2|mat3|mat4) (\w*);/gm,n=/^\s*uniform (int|float|vec2|vec3|vec4|mat2|mat3|mat4) (\w*)(\[\d\])*;/gm,a=/^\s*uniform sampler2D (\w*);/gm,i=/^\s*precision (\w*) float;/gm,o=e.fragmentShaderSource+"\n\n\n"+e.vertexShaderSource,s=[];null!==(t=r.exec(o));)s.push(t[2]);for(var c,l=[];null!==(c=n.exec(o));)l.push(c[2]);for(var u,p=[];null!==(u=a.exec(o));)p.push(u[1]);for(var f,d=[];null!==(f=i.exec(o));)d.push(f[1]);return[s,l,p,d]}(a),4),p=u[0],d=u[1],h=u[2],v=u[3],y=n(p);try{var m=function(){var e=l.value,t=i.filter(function(t){return t.variableName===e});if(1!==t.length)throw new Error("Provided ".concat(t.length," values for shader's attribute ").concat(e,"."))};for(y.s();!(l=y.n()).done;)m()}catch(_){y.e(_)}finally{y.f()}var b,g=n(d);try{var w=function(){var e=b.value,t=o.filter(function(t){return t.variableName===e});if(1!==t.length)throw new Error("Provided ".concat(t.length," values for shader's uniform ").concat(e,"."))};for(g.s();!(b=g.n()).done;)w()}catch(_){g.e(_)}finally{g.f()}var S,x=n(h);try{var P=function(){var e=S.value,t=s.filter(function(t){return t.variableName===e});if(1!==t.length)throw new Error("Provided ".concat(t.length," values for shader's texture ").concat(e,"."))};for(x.s();!(S=x.n()).done;)P()}catch(_){x.e(_)}finally{x.f()}1===v.length&&console.warn("You have only provided one precision qualifier.\n            This can cause issues when you want to use a uniform in both the vertex- and the fragment-shader.");var k=this.attributes.map(function(e){return e.value.vectorCount});if(Math.min.apply(Math,t(k))!==Math.max.apply(Math,t(k)))throw new Error("Your attributes are not of the same length!")}return h(e,[{key:"bind",value:function(e){var t=this;Ne(e,this.program.program);var r,a=n(this.attributes);try{for(a.s();!(r=a.n()).done;){var i=r.value;Be(e,i.location,i.value)}}catch(f){a.e(f)}finally{a.f()}var o,s=n(this.uniforms);try{for(s.s();!(o=s.n()).done;){var c=o.value;Ze(e,c.location,c.type,c.value)}}catch(f){s.e(f)}finally{s.f()}var l,u=n(this.textures);try{for(u.s();!(l=u.n()).done;){var p=l.value;Ue(e,p.texture.texture,p.bindPoint,p.location)}}catch(f){u.e(f)}finally{u.f()}this.index&&function(e,r){e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.index.index.buffer)}(e)}},{key:"render",value:function(e,r,n,a){n?function(e,r,n){e.bindFramebuffer(e.FRAMEBUFFER,r.framebuffer),n?(r.width/r.height!=n[2]/n[3]&&console.warn("Your viewport-aspect is different from the framebuffer-aspect."),e.viewport.apply(e,t(n))):e.viewport(0,0,r.width,r.height)}(e,n,a):function(e,r){e.bindFramebuffer(e.FRAMEBUFFER,null),r?(e.canvas.width/e.canvas.height!=r[2]/r[3]&&console.warn("Your viewport-aspect is different from the canvas-aspect."),e.viewport.apply(e,t(r))):e.viewport(0,0,e.canvas.width,e.canvas.height)}(e,a),r&&function(e,t){e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}(e,r),this.index?function(e,t){e.drawElements(t.drawingMode,t.count,t.type,t.offset)}(e,this.index.index):function(e,t){e.drawArrays(t.drawingMode,t.offset,t.vectorCount)}(e,this.attributes[0].value)}},{key:"updateAttributeData",value:function(e,t,r){var n=$e(this.attributes,function(e){return e.variableName===t});if(!n)throw new Error("No such attribute ".concat(t," to be updated."));!function(e,t,r){var n=new Float32Array(De(r));e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)}(e,n.value,r)}},{key:"updateUniformData",value:function(e,t,r){var n=$e(this.uniforms,function(e){return e.variableName===t});if(!n)throw new Error("No such uniform ".concat(t," to be updated."));n.value=r}},{key:"updateTextureData",value:function(e,t,r){var n=$e(this.textures,function(e){return e.variableName===t});if(!n)throw new Error("No such texture ".concat(t," to be updated."));var a=function(e,t,r){if(e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,t.texture),r instanceof HTMLImageElement||r instanceof HTMLCanvasElement)e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);else{var n=r[0].length,a=r.length;if(!Ve(n,2)||!Ve(a,2))throw new Error("Texture-data-dimensions must be a power of two, but are ".concat(a," x ").concat(n));var i=new Uint8Array(De(r));e.texImage2D(e.TEXTURE_2D,t.level,t.internalformat,t.width,t.height,t.border,t.format,t.type,i)}return e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),r instanceof HTMLImageElement?(t.width=r.naturalWidth,t.height=r.naturalHeight):r instanceof HTMLCanvasElement?(t.width=r.width,t.height=r.height):(t.width=r[0].length,t.height=r.length),t}(e,n.texture,r);n.texture=a}}]),e}(),tt=function e(t,r,n){f(this,e);var a=function(e){var t=e.createFramebuffer();if(!t)throw new Error("Error creating framebuffer");return t}(t),i=function(e,t,r){if(t<=0||r<=0)throw new Error("Width and height must be positive.");var n=e.createTexture();if(!n)throw new Error("No texture was created");return e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),{texture:n,level:0,internalformat:e.RGBA,format:e.RGBA,type:e.UNSIGNED_BYTE,width:t,height:r,border:0}}(t,r,n),o=function(e,t,r){if(e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.texture,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error creating framebuffer: framebuffer-status: ".concat(e.checkFramebufferStatus(e.FRAMEBUFFER)," ; error-code: ").concat(e.getError()));return e.bindFramebuffer(e.FRAMEBUFFER,null),{framebuffer:r,texture:t,width:t.width,height:t.height}}(t,i,a);this.fbo=o},rt=function(e,t){return{vertices:[[-e/2,t/2,0],[-e/2,-t/2,0],[e/2,-t/2,0],[-e/2,t/2,0],[e/2,-t/2,0],[e/2,t/2,0]],texturePositions:[[0,1],[0,0],[1,0],[0,1],[1,0],[1,1]]}},nt=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return h(r,[{key:"createRenderer",value:function(){return this.renderer=new at(this),this.renderer}},{key:"updateSunAngle",value:function(e){this.renderer.updateSunAngle(e)}}]),r}(je.a),at=function(t){o(a,t);var r=c(a);function a(t){var n,i;f(this,a),(i=r.call(this,t)).state="loading";var o=document.createElement("canvas");o.width=1200,o.height=800,o.style.position="absolute";var s=o.getContext("webgl"),c=t.getSource(),l=c.getProjection(),d=c.getImageExtent(),h=i.bboxOntoRectangle(2,2,d),v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"red",a=document.createElement("canvas").getContext("2d");if(!a)throw new Error("no context");return a.canvas.width=t,a.canvas.height=r,a.font="bold ".concat(5*r/6|0,"px sans-serif"),a.textAlign="center",a.textBaseline="middle",a.fillStyle=n,a.fillText(e,t/2,r/2),a.canvas}("test",2048,2048,"red"),y=new He(s,"\n            attribute vec3 a_position;\n            attribute vec2 a_texturePosition;\n            uniform mat3 u_world2pix;\n            uniform mat3 u_pix2canv;\n            varying vec2 v_texturePosition;\n            void main() {\n                vec3 pixelPosition = u_world2pix * vec3(a_position.x, a_position.y, 1.);\n                vec3 canvasPosition = u_pix2canv * pixelPosition;\n                gl_Position = vec4(canvasPosition.x, canvasPosition.y, 0., 1.);\n                v_texturePosition = a_texturePosition;\n            }\n        ","\n            precision mediump float;\n            uniform sampler2D u_srtm;\n            uniform float u_imageSize;\n            uniform vec3 u_sun;\n            varying vec2 v_texturePosition;\n            void main() {\n                float delta = 4. / u_imageSize;\n                float top = texture2D(u_srtm, vec2(v_texturePosition.x,         1. - v_texturePosition.y + delta)).r;\n                float bot = texture2D(u_srtm, vec2(v_texturePosition.x,         1. - v_texturePosition.y - delta)).r;\n                float lft = texture2D(u_srtm, vec2(v_texturePosition.x + delta, 1. - v_texturePosition.y        )).r;\n                float rgt = texture2D(u_srtm, vec2(v_texturePosition.x - delta, 1. - v_texturePosition.y        )).r;\n\n                vec3 surfaceNormal = vec3(\n                    lft - rgt,\n                    bot - top,\n                    2. * delta\n                );\n                surfaceNormal = normalize(surfaceNormal);\n                vec3 sunNormal = normalize(u_sun);\n                float alignment = abs(dot(sunNormal, surfaceNormal));\n\n                gl_FragColor = vec4(0., 0., 0., 0.5 * alignment);\n            }\n        ");Ne(s,y.program);var m=new et(y,[new Ke(s,y,"a_position",h.vertices),new Ke(s,y,"a_texturePosition",h.texturePositions)],[new Xe(s,y,"u_imageSize","float",[2048]),new Xe(s,y,"u_sun","vec3",[0,0,1]),new Xe(s,y,"u_world2pix","mat3",De([[1,0,0],[0,1,0],[0,0,1]])),new Xe(s,y,"u_pix2canv","mat3",De([[1/(o.width/2),0,0],[0,-1/(o.height/2),0],[-1,1,1]]))],[new qe(s,y,"u_srtm",v,0)]);m.bind(s),i.shader=m,i.canvas=o,i.gl=s,i.projection=l;var b=c.getImage(d,.02197265625,2.440000295639038,l);return b.addEventListener("change",function(t){var r=b.getImage();i.shader.updateTextureData(i.gl,"u_srtm",r),i.shader.bind(i.gl),i.state="ready",e((n=u(i),p(a.prototype)),"getLayer",n).call(n).changed()}),b.load(),i}return h(a,[{key:"prepareFrame",value:function(e){if("ready"===this.state){var t=e.coordinateToPixelTransform;this.shader.updateUniformData(this.gl,"u_world2pix",De([[t[0],t[1],0],[t[2],t[3],0],[t[4],t[5],1]])),this.shader.bind(this.gl),e.viewState.projection!==this.projection&&this.reprojectImage(e.viewState.projection)}return!0}},{key:"renderFrame",value:function(e,t){return"ready"===this.state&&(this.shader.render(this.gl),this.transformCanvas(e)),this.canvas}},{key:"renderDeclutter",value:function(e){}},{key:"updateSunAngle",value:function(e){this.shader.updateUniformData(this.gl,"u_sun",[e[0],e[1],1]),this.shader.bind(this.gl),this.shader.render(this.gl)}},{key:"bboxOntoRectangle",value:function(e,t,r){var a,i=rt(e,t),o=n(i.vertices);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=s[1];s[0]=s[0]===e/2?r[2]:r[0],s[1]=c===t/2?r[3]:r[1]}}catch(l){o.e(l)}finally{o.f()}return i}},{key:"reprojectImage",value:function(t){var r=e(p(a.prototype),"getLayer",this).call(this).getSource(),n=r.getProjection(),i=r.getImageExtent(),o=Object(we.r)(i,n,t),s=this.bboxOntoRectangle(2,2,o);this.shader.updateAttributeData(this.gl,"a_position",s.vertices),this.shader.bind(this.gl)}},{key:"transformCanvas",value:function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.size,a=Math.round(n[0]*r),i=Math.round(n[1]*r),o=t.opacity;this.canvas.width=a,this.canvas.height=i,this.canvas.style.opacity="".concat(o),this.shader.updateUniformData(this.gl,"u_pix2canv",De([[1/(this.canvas.width/2),0,0],[0,-1/(this.canvas.height/2),0],[-1,1,1]]))}}]),a}(Ae.a),it=s("gB+7"),ot=s("Cw4B"),st=function(t){o(n,t);var r=c(n);function n(e){var t;return f(this,n),(t=r.call(this,e)).options=e,t}return h(n,[{key:"createRenderer",value:function(){return new ct(this,this.options.renderSettings)}},{key:"updateParas",value:function(t,r,a){var i={colorRamp:this.options.renderSettings.colorRamp,maxEdgeLength:this.options.renderSettings.maxEdgeLength,storeInterpolatedPixelData:this.options.renderSettings.storeInterpolatedPixelData,valueProperty:this.options.renderSettings.valueProperty,power:t,showLabels:a,smooth:r};e(p(n.prototype),"getRenderer",this).call(this).updateSettings(i),this.options.renderSettings=i}}]),n}(ie.a),ct=function(t){o(n,t);var r=c(n);function n(e,t){var a;f(this,n),(a=r.call(this,e)).settings=t,a.container=document.createElement("div"),a.container.classList.add("ol-layer"),a.container.style.setProperty("position","absolute"),a.container.style.setProperty("width","100%"),a.container.style.setProperty("height","100%"),a.webGlCanvas=document.createElement("canvas"),a.webGlCanvas.style.setProperty("position","absolute"),a.webGlCanvas.style.setProperty("left","0px"),a.webGlCanvas.style.setProperty("top","0px"),a.webGlCanvas.style.setProperty("width","100%"),a.webGlCanvas.style.setProperty("height","100%"),a.webGlCanvas.width=1e3,a.webGlCanvas.height=1e3,a.gl=a.webGlCanvas.getContext("webgl"),a.container.appendChild(a.webGlCanvas),a.pointRenderer=new it.a(e);var i=e.getSource();a.projection=i.getProjection();var o=a.parseData(i,a.settings.valueProperty,a.settings.maxEdgeLength),s=o.coords,c=o.values,l=o.bboxDelta,u=o.maxVal,p=a.parseDataBbox(l,s,c,u,a.settings.maxEdgeLength),d=p.observationsBbox,h=p.maxEdgeLengthBbox;a.bbox=l;var v=[[1,0,0],[0,1,0],[0,0,1]];return a.interpolationShader=ut(a.gl,d,u,a.settings.power,h),a.valueFb=new tt(a.gl,a.webGlCanvas.width,a.webGlCanvas.height),a.colorizationShader=pt(a.gl,a.settings.colorRamp,u,a.settings.smooth,a.valueFb),a.colorFb=new tt(a.gl,a.webGlCanvas.width,a.webGlCanvas.height),a.arrangementShader=ft(a.gl,v,v,l,a.colorFb),a.runInterpolationShader(a.valueFb.fbo),a.runColorizationShader(a.colorFb.fbo),a}return h(n,[{key:"prepareFrame",value:function(t){if(this.webGlCanvas.style.opacity="".concat(t.layerStatesArray[t.layerIndex].opacity),t.viewState.projection!==this.projection){this.projection=t.viewState.projection;var r=e(p(n.prototype),"getLayer",this).call(this).getSource(),a=this.parseData(r,this.settings.valueProperty,this.settings.maxEdgeLength),i=a.coords,o=a.values,s=a.bboxDelta,c=a.maxVal,l=this.parseDataBbox(s,i,o,c,this.settings.maxEdgeLength),u=l.observationsBbox,f=l.maxEdgeLengthBbox;this.updateInterpolationShader(this.settings.power,u,f),this.runInterpolationShader(this.valueFb.fbo),this.runColorizationShader(this.colorFb.fbo),this.bbox=s}return this.updateArrangementShader(t.coordinateToPixelTransform,t.size[0],t.size[1],this.bbox),this.pointRenderer.prepareFrame(t),!0}},{key:"renderFrame",value:function(e,t){if(this.runArrangementShader(),this.settings.showLabels){var r=this.pointRenderer.renderFrame(e,this.container);Object(ot.f)(this.container,[this.webGlCanvas,r])}else Object(ot.f)(this.container,[this.webGlCanvas]);return this.container}},{key:"renderDeclutter",value:function(e){}},{key:"updateSettings",value:function(t){var r=this.settings;this.settings=t,t.power!==r.power?(this.updateInterpolationShader(t.power),this.runInterpolationShader(this.valueFb.fbo),this.updateColorizationShader(t.smooth),this.runColorizationShader(this.colorFb.fbo)):t.smooth!==r.smooth&&(this.updateColorizationShader(t.smooth),this.runColorizationShader(this.colorFb.fbo)),e(p(n.prototype),"getLayer",this).call(this).changed()}},{key:"updateArrangementShader",value:function(e,t,r,n){var a=[[1/(t/2),0,0],[0,-1/(r/2),0],[-1,1,1]];this.arrangementShader.updateUniformData(this.gl,"u_world2pix",De([[e[0],e[1],0],[e[2],e[3],0],[e[4],e[5],1]])),this.arrangementShader.updateUniformData(this.gl,"u_pix2clip",De(a)),this.arrangementShader.updateUniformData(this.gl,"u_bbox",n)}},{key:"runArrangementShader",value:function(e){this.arrangementShader.bind(this.gl),this.arrangementShader.render(this.gl,[0,0,0,0],e)}},{key:"updateInterpolationShader",value:function(e,t,r){this.interpolationShader.updateUniformData(this.gl,"u_power",[e]),t&&this.interpolationShader.updateTextureData(this.gl,"u_dataTexture",[t]),r&&this.interpolationShader.updateUniformData(this.gl,"u_maxDistance",[r])}},{key:"runInterpolationShader",value:function(e){this.interpolationShader.bind(this.gl),this.interpolationShader.render(this.gl,[0,0,0,0],e),this.settings.storeInterpolatedPixelData&&(this.interpolatedValues=function(e){var t=e.getContext("webgl");if(!t)throw new Error("no context");var r,n=t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT),a=t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE);if(a===t.UNSIGNED_BYTE)r=new Uint8Array(t.drawingBufferWidth*t.drawingBufferHeight*4);else if(a===t.UNSIGNED_SHORT_5_6_5||a===t.UNSIGNED_SHORT_4_4_4_4||a===t.UNSIGNED_SHORT_5_5_5_1)r=new Uint16Array(t.drawingBufferWidth*t.drawingBufferHeight*4);else{if(a!==t.FLOAT)throw new Error("Did not understand pixel data type ".concat(a," for format ").concat(n));r=new Float32Array(t.drawingBufferWidth*t.drawingBufferHeight*4)}return t.readPixels(0,0,e.width,e.height,n,a,r),r}(this.webGlCanvas))}},{key:"updateColorizationShader",value:function(e){this.colorizationShader.updateUniformData(this.gl,"u_smooth",[e?1:0])}},{key:"runColorizationShader",value:function(e){this.colorizationShader.bind(this.gl),this.colorizationShader.render(this.gl,[0,0,0,0],e)}},{key:"parseData",value:function(e,t,r){var n,a,i=e.getFeatures(),o=(i=e instanceof ye.a?e.getSource().getFeatures():e.getFeatures()).map(function(e){return e.getGeometry().getCoordinates()}),s=i.map(function(e){return parseFloat(e.getProperties()[t])}),c=dt(o),l=c[2]-c[0],u=c[3]-c[1];l>u?(a=l-u,n=0):(a=0,n=u-l);var p=[c[0]-r,c[1]-r,c[2]+n+r,c[3]+a+r],f=s.reduce(function(e,t){return t>e?t:e},0);return{coords:o,values:s,bboxDelta:p,maxVal:f}}},{key:"parseDataBbox",value:function(e,t,r,n,a){for(var i,o,s=ht(t,r).map(function(t){var r=lt([t[0],t[1]],e);return[255*(r[0]+1)/2,255*(r[1]+1)/2,255*t[2]/n,255]}),c=s.length,l=(i=c,o=Math.ceil(ze(i,2)),Math.pow(2,o)),u=0;u<l-c;u++)s.push([0,0,0,0]);return{observationsBbox:s,maxEdgeLengthBbox:a/Math.max(e[2]-e[0],e[3]-e[1])}}}]),n}(Ae.a),lt=function(e,t){return[(e[0]-t[0])/(t[2]-t[0])*2-1,(e[1]-t[1])/(t[3]-t[1])*2-1]},ut=function(e,t,r,n,a){var i=new He(e,"\n            precision mediump float;\n            attribute vec3 a_position;\n            attribute vec2 a_texturePosition;\n            varying vec2 v_position;\n            varying vec2 v_texturePosition;\n\n            void main() {\n                v_position = a_position.xy;\n                v_texturePosition = a_texturePosition;\n                gl_Position = vec4(a_position.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform float u_power;\n            uniform sampler2D u_dataTexture;\n            uniform int u_nrDataPoints;\n            uniform float u_maxValue;\n            uniform float u_maxDistance;\n            varying vec2 v_position;\n            varying vec2 v_texturePosition;\n\n            void main() {\n\n                float valSum = 0.0;\n                float wSum = 0.0;\n                float minD = 10000.0;\n                for (int i = 0; i < 10000; i++) {\n                    if (i > u_nrDataPoints) {\n                        break;\n                    }\n                    vec4 dataPoint = texture2D(u_dataTexture, vec2(float(i) / float(u_nrDataPoints), 0.5));\n                    if (dataPoint.w > 0.0) {  // texture is padded to next power of two with transparent 0-values.\n                        vec2 coords = dataPoint.xy * 2.0 - 1.0;  // transforming coords from [0, 1] to [-1, 1]\n                        float value = dataPoint.z * u_maxValue;  // transforming value from [0, 1] to [0, maxValue]\n\n                        float d = distance(v_position, coords);\n                        float w = 1.0 / pow(d, u_power);\n                        valSum += value * w;\n                        wSum += w;\n                        if (d < minD) {\n                            minD = d;\n                        }\n                    }\n                }\n                float interpolatedValue = valSum / wSum;\n                float alpha = 1.0;\n                if (minD > u_maxDistance) {\n                    alpha = 0.0;\n                }\n                vec4 color = vec4(interpolatedValue / u_maxValue, 0.0, 0.0, alpha);\n\n                gl_FragColor = color;\n            }\n        ");return new et(i,[new Ke(e,i,"a_position",[[-1,1,0],[-1,-1,0],[1,-1,0],[1,1,0]]),new Ke(e,i,"a_texturePosition",[[0,1],[0,0],[1,0],[1,1]])],[new Xe(e,i,"u_power","float",[n]),new Xe(e,i,"u_nrDataPoints","int",[t.length]),new Xe(e,i,"u_maxValue","float",[r]),new Xe(e,i,"u_maxDistance","float",[a])],[new Ye(e,i,"u_dataTexture",[t],0)],new Je(e,[[0,1,2],[0,2,3]]))},pt=function(e,t,r,n,a){var i=new He(e,"\n            precision mediump float;\n            attribute vec2 a_position;\n            attribute vec2 a_textureCoord;\n            varying vec2 v_textureCoord;\n\n            void main() {\n                v_textureCoord = a_textureCoord;\n                gl_Position = vec4(a_position.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform float u_colorRampValues[15];\n            uniform vec3 u_colorRampColors[15];\n            uniform int u_nrColorRampValues;\n            uniform float u_maxValue;\n            uniform bool u_smooth;\n            uniform sampler2D u_valueTexture;\n            varying vec2 v_textureCoord;\n\n            vec3 valueToSmoothColor(in float value) {\n                if (value < u_colorRampValues[0]) {\n                    return u_colorRampColors[0];\n                }\n                for (int i = 1; i < 15; i++) {\n                    if (i > u_nrColorRampValues) {\n                        break;\n                    }\n                    if (value < u_colorRampValues[i]) {\n                        float alpha = (value - u_colorRampValues[i-1]) / (u_colorRampValues[i] - u_colorRampValues[i-1]);\n                        vec3 color = alpha * (u_colorRampColors[i] - u_colorRampColors[i-1]) + u_colorRampColors[i-1];\n                        return color;\n                    }\n                    if (i == u_nrColorRampValues) {\n                        return u_colorRampColors[i];\n                    }\n                }\n            }\n\n            vec3 valueToStepColor(in float value) {\n                for (int i = 0; i < 15; i++) {\n                    if (i > u_nrColorRampValues) {\n                        break;\n                    }\n                    if (value < u_colorRampValues[i]) {\n                        return u_colorRampColors[i];\n                    }\n                    if (i == u_nrColorRampValues) {\n                        return u_colorRampColors[i];\n                    }\n                }\n            }\n\n            void main() {\n                vec4 pixelData = texture2D(u_valueTexture, v_textureCoord);\n                float val = pixelData.r * u_maxValue;\n                float alpha = pixelData.w;\n                vec3 rgb = vec3(0.0, 0.0, 0.0);\n                if (alpha > 0.01) {\n                    if (u_smooth) {\n                        rgb = valueToSmoothColor(val);\n                    } else {\n                        rgb = valueToStepColor(val);\n                    }\n                }\n                gl_FragColor = vec4(rgb.x / 255.0, rgb.y / 255.0, rgb.z / 255.0, alpha);\n            }\n        ");return new et(i,[new Ke(e,i,"a_position",rt(2,2).vertices),new Ke(e,i,"a_textureCoord",rt(2,2).texturePositions)],[new Xe(e,i,"u_colorRampValues","float[]",t.map(function(e){return e.val})),new Xe(e,i,"u_colorRampColors","vec3[]",De(t.map(function(e){return e.rgb}))),new Xe(e,i,"u_nrColorRampValues","int",[t.length]),new Xe(e,i,"u_maxValue","float",[r]),new Xe(e,i,"u_smooth","bool",[n?1:0])],[new qe(e,i,"u_valueTexture",a.fbo.texture,0)])},ft=function(e,t,r,n,a){var i=new He(e,"\n            precision mediump float;\n            attribute vec3 a_pos;\n            attribute vec2 a_posTexture;\n            uniform mat3 u_world2pix;\n            uniform mat3 u_pix2clip;\n            uniform vec4 u_bbox;\n            varying vec2 v_posTexture;\n\n            vec2 clipBbx2worldCoords(vec2 clipCoords, vec4 bbox) {\n                float xPerct = ( clipCoords.x + 1.0 ) / 2.0;\n                float yPerct = ( clipCoords.y + 1.0 ) / 2.0;\n                float xWorld = xPerct * (bbox.z - bbox.x) + bbox.x;\n                float yWorld = yPerct * (bbox.w - bbox.y) + bbox.y;\n                return vec2(xWorld, yWorld);\n            }\n\n            void main() {\n                v_posTexture = a_posTexture;\n                vec2 worldPos = clipBbx2worldCoords(a_pos.xy, u_bbox);\n                vec3 clipPos = u_pix2clip * u_world2pix * vec3(worldPos.xy, 1.0);\n                gl_Position = vec4(clipPos.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform sampler2D u_texture;\n            varying vec2 v_posTexture;\n\n            void main() {\n                gl_FragColor = texture2D(u_texture, v_posTexture);\n            }\n        ");return new et(i,[new Ke(e,i,"a_pos",rt(2,2).vertices),new Ke(e,i,"a_posTexture",rt(2,2).texturePositions)],[new Xe(e,i,"u_world2pix","mat3",De(t)),new Xe(e,i,"u_pix2clip","mat3",De(r)),new Xe(e,i,"u_bbox","vec4",n)],[new qe(e,i,"u_texture",a.fbo.texture,0)])},dt=function(e){var r=e.map(function(e){return e[0]}),n=e.map(function(e){return e[1]}),a=Math.min.apply(Math,t(r)),i=Math.max.apply(Math,t(r));return[a,Math.min.apply(Math,t(n)),i,Math.max.apply(Math,t(n))]},ht=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(e[n].concat(t[n]));return r};s("jqAh");var vt,yt=s("xXok"),mt="EPSG:4326",bt=((vt=function(){function e(t,r,n){f(this,e),this.crf=t,this.app=r,this.injector=n,this.hitTolerance=0,this.projectionChange=new Fe.a,this.dynamicPopupComponents=new Map,this.map=new Y.a({controls:[]}),this.view=new K.a,this.EPSG="EPSG:3857"}return h(e,[{key:"createMap",value:function(e){var t=this,r=new $.a({layers:[]});r.set("filtertype","baselayers"),r.set("title","Base maps"),r.set("id","ID_filtertype_baselayers");var n=new $.a({layers:[]});n.set("filtertype","layers"),n.set("title","Layers"),n.set("id","ID_filtertype_layers");var a=new $.a({layers:[]});a.set("filtertype","overlays"),a.set("title","Overlays"),a.set("id","ID_filtertype_overlays"),this.viewOptions={center:Object(we.q)([0,0],mt,this.EPSG),zoom:0,projection:Object(we.i)(this.EPSG)},this.view.constrainRotation&&(this.viewOptions.constrainRotation=this.view.constrainRotation),this.view.enableRotation&&(this.viewOptions.enableRotation=this.view.enableRotation),this.view.extent&&(this.viewOptions.extent=this.view.extent),this.view.constrainOnlyCenter&&(this.viewOptions.constrainOnlyCenter=this.view.constrainOnlyCenter),this.view.smoothExtentConstraint&&(this.viewOptions.smoothExtentConstraint=this.view.smoothExtentConstraint),this.view.getMaxResolution()&&(this.viewOptions.maxResolution=this.view.getMaxResolution()),this.view.getMinResolution()&&(this.viewOptions.minResolution=this.view.getMinResolution()),this.view.getMaxZoom()&&(this.viewOptions.maxZoom=this.view.getMaxZoom()),this.view.getMinZoom()&&(this.viewOptions.minZoom=this.view.getMinZoom()),this.view.multiWorld&&(this.viewOptions.multiWorld=this.view.multiWorld),this.view.constrainResolution&&(this.viewOptions.constrainResolution=this.view.constrainResolution),this.view.smoothResolutionConstraint&&(this.viewOptions.smoothResolutionConstraint=this.view.smoothResolutionConstraint),this.view.getResolution()&&(this.viewOptions.resolution=this.view.getResolution()),this.view.getResolutions()&&(this.viewOptions.resolutions=this.view.getResolutions()),this.view.rotation&&(this.viewOptions.rotation=this.view.rotation),this.view.zoomFactor&&(this.viewOptions.zoomFactor=this.view.zoomFactor);var i=new K.a(this.viewOptions);return[r,n,a].map(function(e){return t.map.addLayer(e)}),this.map.setView(i),this.view=this.map.getView(),this.setProjection(this.EPSG),e&&this.map.setTarget(e),{map:this.map,view:this.view}}},{key:"setHitTolerance",value:function(e){this.hitTolerance=e}},{key:"getHitTolerance",value:function(){return this.hitTolerance}},{key:"addBboxSelection",value:function(e,t,r,n){Object.assign({className:"ol-drag-select",condition:e},n);var a=new Re.a(n);return t&&a.on("boxstart",function(e){t(e)}),r&&a.on("boxend",function(e){var t=a.getGeometry().getExtent();r(t,e)}),this.map.addInteraction(a),a}},{key:"getLayers",value:function(e){var t,r=e.toLowerCase();return this.map.getLayers().getArray().forEach(function(e){e.get("filtertype")===r&&(t=e.getLayers().getArray())}),t}},{key:"getLayersFromGroup",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.getLayers().getArray(),i=a;if(n){var o=[].concat(a);a.forEach(function(e){e instanceof $.a&&(o=o.concat(r.getLayersFromGroup(e,t,!0)))}),i=o}return t?i.filter(function(e){return e.get("filtertype")&&e.get("filtertype").toLowerCase()===t.toLowerCase()}):i}},{key:"getLayerByKey",value:function(e,t){var r=Ge(this.getLayersFromGroup(this.map.getLayerGroup(),t)),n=[];if(r.forEach(function(t){t.get(e.key)&&t.get(e.key)===e.value&&-1===n.indexOf(t)&&n.push(t)}),!n.length){var a=this.getLayersFromGroup(this.map.getLayerGroup(),t,!0);a.length&&a.forEach(function(t){t.get(e.key)&&t.get(e.key)===e.value&&-1===n.indexOf(t)&&n.push(t)})}return 1===n.length?n[0]:null}},{key:"setRecursiveKey",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"filtertype";e.set(n,t),e instanceof $.a&&e.getLayers().forEach(function(e){r.setRecursiveKey(e,t,n)})}},{key:"addLayer",value:function(e,t){var r,n=this,a=t.toLowerCase();return this.map.getLayers().getArray().forEach(function(t){t.get("filtertype")===a&&(n.isLayerInGroup(e,t)||(r=t.getLayers().getArray(),n.setRecursiveKey(e,a,"filtertype"),r.push(e),t.setLayers(new me.a(r))))}),r}},{key:"isLayerInGroup",value:function(e,t){return!!t.getLayers().getArray().filter(function(t){return t.get("id")===e.get("id")}).length}},{key:"getLayerGroups",value:function(e){var t=[];return this.map.getLayers().forEach(function(r){r instanceof $.a&&(e?r.get("filtertype")&&r.get("filtertype").toLowerCase()===e.toLowerCase()&&t.push(r):t.push(r))}),t}},{key:"addLayers",value:function(e,t){var r,n=this,a=t.toLocaleLowerCase();return this.getLayerGroups(a).forEach(function(t){t.getLayers().getLength()>0?(r=t.getLayers().getArray(),e.map(function(e){n.isLayerInGroup(e,t)||r.push(e)})):r=e,r.forEach(function(e){e instanceof $.a&&n.setRecursiveKey(e,a,"filtertype")}),t.setLayers(new me.a(r))}),r}},{key:"setLayers",value:function(e,t){var r=this,n=t.toLocaleLowerCase(),a=this.getLayerGroups(n);return e.forEach(function(e){e instanceof $.a&&r.setRecursiveKey(e,t.toLocaleLowerCase(),"filtertype")}),a.forEach(function(t){t.setLayers(new me.a(e))}),e}},{key:"getLayerGroupForLayer",value:function(e){var t=this,r=this.getLayersFromGroup(this.map.getLayerGroup(),null,!0);r.push(this.map.getLayerGroup());var n=null;return r.forEach(function(r){if(r instanceof $.a){var a=t.getLayersFromGroup(r).find(function(t){return t===e});a&&(n={group:r,layer:a})}}),n}},{key:"removeLayerByKey",value:function(e,t){var r=t.toLocaleLowerCase(),n=this.getLayerByKey(e,r);if(n){var a=this.getLayerGroupForLayer(n);if(a.group){var i=this.getLayersFromGroup(a.group).filter(function(e){return e!==n});a.group.setLayers(new me.a(i))}}}},{key:"updateLayerByKey",value:function(e,t,r){var n=r.toLocaleLowerCase();this.map.getLayers().forEach(function(r){if(r.get("filtertype")===n){var a=r.getLayers();a.forEach(function(r,n){if(r.get(e.key)&&r.get(e.key)===e.value){var i=t.getProperties(),o=t.getExtent(),s=t.getMaxZoom(),c=t.getMinZoom(),l=t.getOpacity(),u=t.getVisible(),p=t.getZIndex();if(r instanceof J.a&&t instanceof J.a){var f=t.getSource();r.setSource(f)}i&&r.setProperties(i),o&&r.setExtent(o),s&&r.setMaxZoom(s),c&&r.setMinZoom(c),l&&r.setOpacity(l),u&&r.setVisible(u),p&&r.setZIndex(p),r.changed(),a.setAt(n,r)}}),r.setLayers(a)}})}},{key:"removeAllLayers",value:function(e){var t=e.toLowerCase();this.map.getLayers().getArray().forEach(function(e){e.get("filtertype")===t&&e.getLayers().clear()})}},{key:"setUkisLayers",value:function(e,t){var r=this,n=t.toLowerCase(),a=[];if(e.length<1&&"baselayers"!==n?this.removeAllLayers(n):e.forEach(function(e){var t=r.create_layers(e);t&&a.push(t)}),a.length>0)return this.setLayers(a,n),{type:n,layers:a}}},{key:"setUkisLayer",value:function(e,t){t||(t=e.filtertype);var r=t.toLowerCase(),n=this.getLayers(r).find(function(t){return t.get("id")===e.id}),a=this.create_layers(e);n?(this.removeLayerByKey({key:"id",value:n.get("id")},t),this.addLayer(a,t)):this.addLayer(a,t)}},{key:"updateUkisLayer",value:function(e,t){t||(t=e.filtertype);var r=t.toLowerCase(),n=this.getLayers(r).find(function(t){return t.get("id")===e.id}),a=this.create_layers(e);a&&this.updateLayerByKey({key:"id",value:n.get("id")},a,t)}},{key:"create_layers",value:function(e){var t;switch(e.type){case"xyz":t=this.create_xyz_layer(e);break;case"wms":t=this.create_wms_layer(e);break;case"wmts":t=this.create_wmts_layer(e);break;case"geojson":t=this.create_geojson_layer(e);break;case"wfs":t=this.create_wfs_layer(e);break;case"custom":t=this.create_custom_layer(e)}return t}},{key:"create_xyz_layer",value:function(e){var t={wrapX:!1};e.crossOrigin&&(t.crossOrigin=e.crossOrigin);var r=new se.a(t);if(e.attribution&&r.setAttributions([e.attribution]),e.continuousWorld&&r.set("wrapX",e.continuousWorld),e.subdomains){var n=e.subdomains.map(function(t){return e.url.replace("{s}","".concat(t))});r.setUrls(n)}else r.setUrl(e.url);var a={type:"xyz",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:r};return e.popup&&(a.popup=e.popup),e.bbox&&(a.extent=Object(we.r)(e.bbox.slice(0,4),mt,this.getProjection().getCode())),e.maxResolution&&(a.maxResolution=e.maxResolution),e.minResolution&&(a.minResolution=e.minResolution),e.maxZoom&&(a.maxZoom=e.maxZoom),e.minZoom&&(a.minZoom=e.minZoom),new ae.a(a)}},{key:"create_wms_layer",value:function(e){var t={params:Object.assign({},e.params),wrapX:!1};e.tileSize&&(t.tileGrid=this.getTileGrid("default",null,e.tileSize),delete t.params.tileSize),e.crossOrigin&&(t.crossOrigin=e.crossOrigin),t.params=this.keysToUppercase(t.params);var r=new ue.a(t);if(e.attribution&&r.setAttributions([e.attribution]),e.continuousWorld&&r.set("wrapX",e.continuousWorld),e.subdomains){var n=e.subdomains.map(function(t){return e.url.replace("{s}","".concat(t))});r.setUrls(n)}else r.setUrl(e.url);var a={type:"wms",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:r};return e.popup&&(a.popup=e.popup,a.className=e.id),e.maxResolution&&(a.maxResolution=e.maxResolution),e.minResolution&&(a.minResolution=e.minResolution),e.maxZoom&&(a.maxZoom=e.maxZoom),e.minZoom&&(a.minZoom=e.minZoom),e.bbox&&(a.extent=Object(we.r)(e.bbox.slice(0,4),mt,this.getProjection().getCode())),new ae.a(a)}},{key:"create_wmts_layer",value:function(e){if(e instanceof I){var t=this.getTileGrid("wmts"),r=this.EPSG;e.params.matrixSetOptions&&(r=e.params.matrixSetOptions.matrixSet,"resolutions"in e.params.matrixSetOptions?t=this.getTileGrid("wmts",null,e.tileSize,null,e.params.matrixSetOptions.resolutions):("resolutionLevels"in e.params.matrixSetOptions||"tileMatrixPrefix"in e.params.matrixSetOptions)&&(t=this.getTileGrid("wmts",e.params.matrixSetOptions.resolutionLevels,e.tileSize,e.params.matrixSetOptions.tileMatrixPrefix,null)),"matrixIds"in e.params.matrixSetOptions&&(t=this.getTileGrid("wmts",null,e.tileSize,null,null,e.params.matrixSetOptions.matrixIds)));var n={url:e.url,tileGrid:t,matrixSet:r,wrapX:!1,layer:e.params.layer,style:e.params.style};n=Object.assign(n,e.params),e.crossOrigin&&(n.crossOrigin=e.crossOrigin);var a=new pe.a(n);if(e.attribution&&a.setAttributions([e.attribution]),e.continuousWorld&&a.set("wrapX",e.continuousWorld),e.subdomains){var i=e.subdomains.map(function(t){return e.url.replace("{s}","".concat(t))});a.setUrls(i)}else a.setUrl(e.url);var o={type:"wmts",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:a};return e.popup&&(o.popup=e.popup,o.className=e.id),e.maxResolution&&(o.maxResolution=e.maxResolution),e.minResolution&&(o.minResolution=e.minResolution),e.maxZoom&&(o.maxZoom=e.maxZoom),e.minZoom&&(o.minZoom=e.minZoom),e.bbox&&(o.extent=Object(we.r)(e.bbox.slice(0,4),mt,this.getProjection().getCode())),new ae.a(o)}console.error("layer with id: ".concat(e.id," and type ").concat(e.type," is no instanceof WmtsLayer!"))}},{key:"create_wfs_layer",value:function(e){var t,r=new URL(e.url);r.searchParams.set("srsname",this.EPSG);var n=new he.a({format:new be.a,url:r.toString()}),a=(null===(t=e.options)||void 0===t?void 0:t.style)||void 0;return new ie.a({type:"wfs",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:n,style:a})}},{key:"create_geojson_layer",value:function(e){var t;e.data?t=new he.a({features:this.geoJsonToFeatures(e.data),format:new be.a,wrapX:!1}):e.url&&(t=new ve.a({url:e.url,crossOrigin:"anonymous",wrapX:!1})),e.continuousWorld&&t.set("wrapX",e.continuousWorld);var r={type:"geojson",name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:t};if(e.popup&&(r.popup=e.popup,r.className=e.id),e.maxResolution&&(r.maxResolution=e.maxResolution),e.minResolution&&(r.minResolution=e.minResolution),e.maxZoom&&(r.maxZoom=e.maxZoom),e.minZoom&&(r.minZoom=e.minZoom),e.bbox&&(r.extent=Object(we.r)(e.bbox.slice(0,4),mt,this.getProjection().getCode())),e.cluster){var n={};"object"==typeof e.cluster&&Object.assign(n,e.cluster),n.source=t;var a=new ye.a(n);r.source=a;var i={};r.style=function(e){var t=e.get("features").length,r=i[t];return r||(r=new Le.b({image:new Te.a({radius:10,stroke:new Ce.a({color:"#fff"}),fill:new Oe.a({color:"#3399CC"})}),text:new Ee.a({text:t.toString(),fill:new Oe.a({color:"#fff"})})}),i[t]=r),r}}return e.options&&Object.assign(r,e.options),new ie.a(r)}},{key:"setCrossOrigin",value:function(e){if(e instanceof J.a){var t=e.getSource();(t instanceof ce.a||t instanceof le.a)&&(t.crossOrigin_="anonymous")}}},{key:"create_custom_layer",value:function(e){var t=this;if(e.custom_layer){var r=e.custom_layer;if(r instanceof J.a){var n=r.getSource();n.set("wrapX",!1),e.attribution&&n.setAttributions([e.attribution]),e.continuousWorld&&n.set("wrapX",e.continuousWorld),this.setCrossOrigin(r)}else r instanceof $.a?r.getLayers().forEach(function(e){return t.setCrossOrigin(e)}):console.error("The custom_layer of ".concat(e.id," in not a openlayers Layer"));var a={type:"custom",name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1};if(e.maxResolution&&r.setMaxResolution(e.maxResolution),e.minResolution&&r.setMinResolution(e.minResolution),e.maxZoom&&r.setMaxZoom(e.maxZoom),e.minZoom&&r.setMinZoom(e.minZoom),e.popup&&(a.popup=e.popup,r.className_=e.id),e.bbox){var i=Object(we.r)(e.bbox.slice(0,4),mt,this.getProjection().getCode());r.setExtent(i)}return r.setProperties(a),r}console.log("attribute custom_layer not set on layer type custom!")}},{key:"resolutionsFromExtent",value:function(e,t,r){for(var n=t,a=Object(Pe.B)(e),i=Object(Pe.F)(e),o=Math.max(i/r,a/r),s=n+1,c=new Array(s),l=0;l<s;++l)c[l]=o/Math.pow(2,l);return c}},{key:"matrixIdsFromResolutions",value:function(e,t){return Array.from(Array(e).keys()).map(function(e){return t?"".concat(t,":").concat(e):e})}},{key:"getTileGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=t||ke.a,s=r||ke.b,c=n||"",l=this.getProjection().getExtent(),u=this.resolutionsFromExtent(l,o,s),p=this.matrixIdsFromResolutions(u.length,c),f={extent:l,origin:Object(Pe.D)(l),resolutions:a||u,tileSize:[s,s]};return"wmts"===e?(f.matrixIds=i||p,new fe.b(f)):"default"===e?new de.a(f):void 0}},{key:"isMovePopup",value:function(e){return e&&"object"==typeof e&&"event"in e&&"move"===e.event}},{key:"layers_on_click",value:function(e){var t=this;this.layers_on_click_move(e,function(e){var r=e.get("popup");return!0===r||!t.isMovePopup(r)})}},{key:"layers_on_pointermove",value:function(e){var t=this;this.layers_on_click_move(e,function(e){var r=e.get("popup");return t.isMovePopup(r)})}},{key:"layers_on_click_move",value:function(e,t){var r=this,n=[],a=!1;this.map.forEachLayerAtPixel(e.pixel,function(e,t){a=!0,n.push({layer:e,color:t})},{layerFilter:t}),n.forEach(function(t,n){0===n&&r.layer_on_click(e,t.layer,t.color)}),a?this.map.getTargetElement().style.cursor="pointer":(this.removeAllPopups(function(e){return"pointermove"===e.get("addEvent")}),this.map.getTargetElement().style.cursor="")}},{key:"layer_on_click",value:function(e,t,r){t instanceof ne.a||t instanceof te.a?this.raster_on_click(e,t,r):t instanceof re.a&&this.vector_on_click(e)}},{key:"vector_on_click",value:function(e){var t=this,r=[];this.map.forEachFeatureAtPixel(e.pixel,function(e,t){r.push({feature:e,layer:t})},{layerFilter:function(e){if(e instanceof re.a){var t=e.getSource();return t instanceof ye.a?t.getSource()instanceof he.a:t instanceof he.a||t instanceof oe.a}},hitTolerance:this.hitTolerance}),r.forEach(function(r,n){if(0===n){var a=r.layer,i=r.feature,o=a.get("popup"),s={};if(a instanceof re.a&&o){var c=i.getProperties().features;if(c&&1===c.length)s=c[0].getProperties();else{if(c&&c.length>1){if("click"===e.type){var l=t.getFeaturesExtent(i.getProperties().features);return t.setExtent(l),!1}return!0}s=i.getProperties()}("boolean"==typeof o||Array.isArray(o)||"click"===o.event&&"click"===e.type||!o.event&&"click"===e.type||"move"===o.event&&"pointermove"===e.type)&&t.prepareAddPopup(s,a,i,e,o)}}})}},{key:"raster_on_click",value:function(e,t,r){var n=t.get("popup"),a={};n&&((a=t.getProperties()).evt=e,r&&(a.color=r),this.prepareAddPopup(a,t,null,e,n))}},{key:"prepareAddPopup",value:function(e,t,r,n,a){var i=this,o={modelName:e.id,properties:e,layer:t,feature:r,event:n},s=Object.assign({},e);if(s.geometry&&delete s.geometry,Array.isArray(a)&&(s=Object.keys(s).filter(function(e){return a.includes(e)}).reduce(function(e,t){return e[t]=s[t],e},{})),"object"==typeof a&&!Array.isArray(a)&&a.filterkeys&&(s=Object.keys(s).filter(function(e){return a.filterkeys.includes(e)}).reduce(function(e,t){return e[t]=s[t],e},{})),"object"==typeof a&&!Array.isArray(a))if(a.properties){var c=Object.keys(a.properties);Array.isArray(c)&&(s=Object.keys(s).reduce(function(e,t){var r=a.properties[t];return r?e[r]=s[t]:e[t]=s[t],e},{}))}else a.pupupFunktion?o.popupFn=a.pupupFunktion:a.dynamicPopup&&(o.dynamicPopup=a.dynamicPopup);"boolean"==typeof a||Array.isArray(a)?this.addPopup(o,s,null):a&&("asyncPupup"in a?a.asyncPupup(s,function(e){i.addPopup(o,null,e,a.event,a.single)}):this.addPopup(o,s,null,a.event,a.single))}},{key:"addPopup",value:function(e,t,r,n,a){var i=e.layer.get("popup"),o="popup_move_ID",s=this.getPopups().find(function(e){return e.getId()===o});if("move"===n&&s){var c;c=e.properties&&e.properties.geometry&&"Point"===e.properties.geometry.getType()?e.properties.geometry.getCoordinates():e.event.coordinate;var l=this.createPopupContainer(s,e,t,r,n);s.setElement(l),s.setPosition(c)}else if("pointermove"!==e.event.type||n){var u={autoPan:!0,id:"move"===n?o:e.feature?Object(Ie.c)(e.feature):e.layer?Object(Ie.c)(e.layer):"popup_".concat((new Date).getTime()),autoPanAnimation:{duration:250},positioning:yt.a.BOTTOM_CENTER,stopEvent:!0,insertFirst:!1},p=u;i&&"object"==typeof i&&!Array.isArray(i)&&i.options&&(p=Object.assign(u,i.options));var f,d=new ee.a(p),h=this.createPopupContainer(d,e,t,r,n);d.set("addEvent",e.event.type),d.set("type","popup"),d.setElement(h),f=e.properties&&e.properties.geometry&&"Point"===e.properties.geometry.getType()?e.properties.geometry.getCoordinates():e.event.coordinate,d.setPosition(f),a&&this.removeAllPopups();var v=this.getPopups().find(function(e){return e.getId()===d.getId()&&d.getId()!==o});v&&(this.map.removeOverlay(v),this.destroyDynamicPopupComponent(v.getId().toString())),this.map.addOverlay(d)}else s&&this.removeAllPopups(function(e){return"pointermove"===e.get("addEvent")})}},{key:"createPopupContainer",value:function(e,t,r,n,a){var i,o=this,s=document.createElement("div");if(s.className="ol-popup-content",i=t.popupFn?t.popupFn(r):!n||r&&0!==Object.keys(r).length?this.createPopupHtml(r):n,s.innerHTML=i,t.dynamicPopup){var c=e.getId().toString();this.destroyDynamicPopupComponent(c),this.createDynamicPopupComponent(c,s,{event:t.event,layer:t.layer,feature:t.feature||null,dynamicPopup:t.dynamicPopup,properties:r})}var l=document.createElement("div");if(l.className="ol-popup",l.id=e.getId().toString(),l.style.display="block",!a||"move"!==a){var u=document.createElement("a");u.className="ol-popup-closer",l.appendChild(u),u.addEventListener("click",function t(){u.removeEventListener("click",t,!1),o.map.removeOverlay(e),o.destroyDynamicPopupComponent(e.getId().toString())},!1)}return l.appendChild(s),l}},{key:"removeAllPopups",value:function(e){var t=this,r=this.getPopups();e&&(r=this.getPopups().filter(e)),r.forEach(function(e){"popup"===e.get("type")&&(t.map.removeOverlay(e),t.destroyDynamicPopupComponent(e.getId().toString()))})}},{key:"createPopupHtml",value:function(e){var t="<table>";for(var r in e)e.hasOwnProperty(r)&&(t+='<tr><td style="vertical-align: top; padding-right: 7px;"><b>'+r+": </b></td><td>"+e[r]+"</td></tr>");return t+="</table>"}},{key:"getPopups",value:function(){var e=[];return this.map.getOverlays().getArray().slice(0).forEach(function(t){"popup"===t.get("type")&&e.push(t)}),e}},{key:"destroyDynamicPopupComponent",value:function(e){this.dynamicPopupComponents.has(e)&&(this.dynamicPopupComponents.get(e).destroy(),this.dynamicPopupComponents.delete(e))}},{key:"createDynamicPopupComponent",value:function(e,t,r){var n=this.crf.resolveComponentFactory(r.dynamicPopup.component).create(this.injector,[],t),a=r.dynamicPopup.getAttributes(r);for(var i in a)"undefined"!==a[i]&&(n.instance[i]=a[i]);this.app.attachView(n.hostView),this.dynamicPopupComponents.set(e,n)}},{key:"setExtent",value:function(e,t,r){var n=t?Object(we.i)(mt):Object(we.i)(this.EPSG),a=Object(we.r)(e.slice(0,4),n,this.getProjection().getCode()),i={size:this.map.getSize()};return r&&Object.assign(i,r),this.map.getView().fit(a,r),a}},{key:"setCenter",value:function(e,t){var r=t?Object(we.i)(mt):Object(we.i)(this.EPSG),n=Object(we.q)(e,r,this.getProjection().getCode());return this.map.getView().setCenter(n),n}},{key:"getCenter",value:function(e){var t=e?Object(we.i)(mt):Object(we.i)(this.EPSG),r=Object(we.i)(this.getProjection().getCode());return Object(we.q)(this.map.getView().getCenter(),r,t)}},{key:"getFeaturesExtent",value:function(e,t){var r=e[0].getGeometry().getExtent().slice(0);if(e.forEach(function(e){Object(Pe.r)(r,e.getGeometry().getExtent())}),t){var n=Object(we.i)(mt);return Object(we.r)(r,this.getProjection().getCode(),n)}return r}},{key:"getCurrentExtent",value:function(e){var t=e?Object(we.i)(mt):Object(we.i)(this.EPSG),r=this.map.getView().calculateExtent();return Object(we.r)(r,this.getProjection().getCode(),t)}},{key:"setZoom",value:function(e,t){this.map.getView().setZoom(e)}},{key:"getZoom",value:function(){return this.map.getView().getZoom()}},{key:"zoomInOut",value:function(e){var t=this.map.getView();if(t){var r=t.getZoom();if(void 0!==r){var n=t.getConstrainedZoom(r+1);t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:n,duration:250,easing:_e.b})}}}},{key:"geoJsonToFeature",value:function(e){return new be.a({dataProjection:mt,featureProjection:this.EPSG}).readFeature(e)}},{key:"geoJsonToFeatures",value:function(e){return new be.a({dataProjection:mt,featureProjection:this.EPSG}).readFeatures(e)}},{key:"getProjection",value:function(){return this.map.getView().getProjection()}},{key:"reprojectFeatures",value:function(e,t,r){e.getFeatures().forEach(function(e){e.getGeometry().transform(t,r)})}},{key:"setProjection",value:function(e){var t=this;if(e){var r={};if(this.viewOptions&&((r=this.viewOptions).minResolution=void 0,r.maxResolution=void 0,r.resolution=void 0,r.resolutions=void 0),e instanceof ge.a){r.projection=e;var n=Object(we.q)(this.map.getView().getCenter(),this.map.getView().getProjection(),e);r.center=n,r.zoom=this.map.getView().getZoom()}else"string"==typeof e&&(r.projection=e,r.center=this.map.getView().getCenter(),r.zoom=this.map.getView().getZoom());var a=new K.a(r),i=this.EPSG;this.EPSG=a.getProjection().getCode(),this.map.setView(a),this.view=this.map.getView(),this.map.getLayers().getArray().forEach(function(e){e.getLayers().getArray().forEach(function(e){if(e instanceof J.a){for(var r=e.getSource();r.source;)r=r.source;r instanceof he.a&&t.reprojectFeatures(r,i,t.EPSG)}})}),this.projectionChange.next(this.getProjection())}}},{key:"registerProjection",value:function(e){xe.a.defs(e.code,e.proj4js),Object(Se.a)(xe.a)}},{key:"getOlProjection",value:function(e){return new ge.a({code:e.code,extent:e.extent?e.extent:void 0,worldExtent:e.worldExtent?e.worldExtent:void 0,global:!!e.global&&e.global,units:e.units?e.units:void 0})}},{key:"keysToUppercase",value:function(e){return Object.keys(e).forEach(function(t){var r=t.toUpperCase();r!==t&&(e[r]=e[t],delete e[t])}),e}}]),e}()).\u0275fac=function(e){return new(e||vt)(v.Ub(v.j),v.Ub(v.g),v.Ub(v.s))},vt.\u0275prov=v.Gb({token:vt,factory:vt.\u0275fac,providedIn:"root"}),vt),gt=s("zP0r"),wt=s("6kTr"),St=s("XdCU"),xt=s("Yjhu"),Pt=s("Gufx"),kt=s("rA9B"),_t=s("1N7p"),Lt=s("kMZc"),Et=s("+L8p"),Ot=s("WpFC"),Tt=s("SVse"),Ct=["mapDiv"];function Rt(e,t){1&e&&(v.Qb(0,"div",3),v.yc(1,"+"),v.Pb())}var It,Ft,Mt=((Ft=function(){function e(t,r){var n=this;f(this,e),this.mapSvc=t,this.ngZone=r,this.subs=[],this.privMapwidth=0,this.removePopupsOnMouseLeave=function(e){n.mapSvc.removeAllPopups(function(e){return"pointermove"===e.get("addEvent")})}}return h(e,[{key:"mapwidth",get:function(){return this.privMapwidth},set:function(e){this.privMapwidth=e,this.map.updateSize()}},{key:"ngOnInit",value:function(){this.subscribeToMapState(),this.initMap(),this.subscribeToLayers()}},{key:"ngAfterViewInit",value:function(){this.map.setTarget(this.mapDivView.nativeElement);var e=this.mapStateSvc.getMapState().getValue();this.setMapState(e),this.subscribeToMapEvents(),this.map.getTargetElement().addEventListener("mouseleave",this.removePopupsOnMouseLeave)}},{key:"ngAfterViewChecked",value:function(){var e=this;if(this.mapDivView){var t=this.mapDivView.nativeElement.offsetWidth;t!==this.mapwidth&&this.ngZone.runOutsideAngular(function(){setTimeout(function(){e.mapwidth=t},100)})}}},{key:"ngOnDestroy",value:function(){var e=this;this.subs.forEach(function(e){return e.unsubscribe()}),this.map&&(this.map.un("moveend",this.mapOnMoveend),this.map.un("click",this.mapOnClick),this.map.un("dblclick",this.mapOnDclick),this.map.un("pointermove",this.mapOnPointermove),this.map.getTargetElement().removeEventListener("mouseleave",this.removePopupsOnMouseLeave),this.map.getInteractions().forEach(function(t){e.map.removeInteraction(t)}))}},{key:"addUpdateLayers",value:function(e,t,r){var a=this,i=0;if(r.forEach(function(e){i+=a.mapSvc.getLayers(e).length}),e.length!==this.mapSvc.getLayers(t).length){if(this.mapSvc.setUkisLayers(e,t),i>0){var o,s=n(e);try{var c=function(){var r=o.value,n=a.mapSvc.getLayerByKey({key:"id",value:r.id},t);n&&n.getZIndex()!==e.indexOf(r)+i&&(n.setZIndex(e.indexOf(r)+i),n instanceof $.a&&n.getLayers().forEach(function(t){t.setZIndex(e.indexOf(r)+i)}))};for(s.s();!(o=s.n()).done;)c()}catch(v){s.e(v)}finally{s.f()}}}else{var l,u=n(e);try{for(u.s();!(l=u.n()).done;){var p=l.value,f=this.mapSvc.getLayerByKey({key:"id",value:p.id},t);if(f){if(f.getVisible()!==p.visible&&f.setVisible(p.visible),f.getOpacity()!==p.opacity&&f.setOpacity(p.opacity),p instanceof C&&f instanceof J.a){var d=p.custom_layer.getSource(),h=f.getSource();d&&Object(Ie.c)(h)!==Object(Ie.c)(d)&&f.setSource(d)}else p instanceof C&&p.custom_layer instanceof $.a&&f instanceof $.a&&function(){var e=p.custom_layer.getLayers().getArray();f.getLayers().getArray().forEach(function(t,r){var n=e[r];if(t instanceof J.a&&n instanceof J.a){var a=t.getSource(),i=n.getSource();i&&Object(Ie.c)(a)!==Object(Ie.c)(i)&&t.setSource(i)}})}();i>0?f.getZIndex()!==e.indexOf(p)+i&&f.setZIndex(e.indexOf(p)+i):f.getZIndex()!==e.indexOf(p)&&f.setZIndex(e.indexOf(p)),this.updateLayerParamsWith(f,p)}}}catch(v){u.e(v)}finally{u.f()}}}},{key:"updateLayerParamsWith",value:function(e,t){switch(t.type){case m:this.updateWmsLayerParamsWith(e,t);break;case b:this.updateWmtsLayerParamsWith(e,t);break;case w:this.updateGeojsonLayerParamsWith(e,t);break;case S:this.updateWfsLayerParamsWith(e,t)}}},{key:"updateWfsLayerParamsWith",value:function(e,t){t.options&&t.options.style!==e.getStyle()&&e.setStyle(t.options.style),e.getSource().getUrl()!==t.url&&e.getSource().setUrl(t.url)}},{key:"updateGeojsonLayerParamsWith",value:function(e,t){var r,n=e.getSource();if(n){if(t.data){var a=this.mapSvc.geoJsonToFeatures(t.data);if(n instanceof ye.a){var i=n.getSource();i.clear(),i.addFeatures(a)}else n.clear(),n.addFeatures(a)}else t.url&&(n instanceof ye.a?n.getSource().setUrl(t.url):n.setUrl(t.url));"object"==typeof(null==t?void 0:t.cluster)&&"distance"in t.cluster&&n instanceof ye.a&&n.setDistance(t.cluster.distance)}(null===(r=null==t?void 0:t.options)||void 0===r?void 0:r.style)&&e.setStyle(t.options.style)}},{key:"updateWmsLayerParamsWith",value:function(e,t){if(e instanceof J.a){var r=e.getSource().getParams(),n=t.params;this.shallowEqual(r,n)||e.getSource().updateParams(n)}}},{key:"updateWmtsLayerParamsWith",value:function(e,t){if(e instanceof J.a){var r=e.getSource(),n=r.getStyle(),a=r.getFormat(),i=r.getVersion(),o=r.getMatrixSet(),s=t.params.style,c=t.params.format,l=t.params.version,u=t.params.matrixSetOptions.matrixSet;if(void 0!==s&&n!==s||void 0!==c&&a!==c||void 0!==l&&i!==l||void 0!==u&&o!==u){var p=t.filtertype.toLowerCase();this.mapSvc.updateUkisLayer(t,p)}}}},{key:"shallowEqual",value:function(e,t){var r=Object.getOwnPropertyNames(e),a=Object.getOwnPropertyNames(t);if(r.length!==a.length)return!1;var i,o=n(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(e[s]!==t[s])return!1}}catch(c){o.e(c)}finally{o.f()}return!0}},{key:"addUpdateBaseLayers",value:function(e){if(e.length!==this.mapSvc.getLayers("baselayers").length){var t=e.filter(function(e){return!0===e.visible});0===t.length?e[0].visible=!0:t.length>1&&(e.forEach(function(e){return e.visible=!1}),e[0].visible=!0),this.mapSvc.setUkisLayers(e,"baselayers")}else{var r,a=n(e);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=this.mapSvc.getLayerByKey({key:"id",value:i.id},"baselayers");o&&(o.getVisible()!==i.visible&&o.setVisible(i.visible),o.getZIndex()!==e.indexOf(i)&&o.setZIndex(e.indexOf(i)),o.getOpacity()!==i.opacity&&o.setOpacity(i.opacity))}}catch(s){a.e(s)}finally{a.f()}}}},{key:"subscribeToLayers",value:function(){var e=this;if(this.layersSvc){var t=this.layersSvc.getBaseLayers().subscribe(function(t){return e.addUpdateBaseLayers(t)});this.subs.push(t);var r=this.layersSvc.getLayers().subscribe(function(t){return e.addUpdateLayers(t,"layers",["baselayers"])});this.subs.push(r);var n=this.layersSvc.getOverlays().subscribe(function(t){return e.addUpdateLayers(t,"overlays",["baselayers","layers"])});this.subs.push(n)}}},{key:"setMapState",value:function(e){var t=this.mapStateSvc.getLastAction().getValue();"user"===e.options.notifier&&("setExtent"===t?this.mapSvc.setExtent(e.extent,!0):"setState"===t&&(this.mapSvc.setZoom(e.zoom,e.options.notifier),this.mapSvc.setCenter([e.center.lon,e.center.lat],!0)))}},{key:"subscribeToMapState",value:function(){var e=this;if(this.mapStateSvc){var t=this.mapStateSvc.getMapState().pipe(Object(gt.a)(1)).subscribe(function(t){return e.setMapState(t)});this.subs.push(t)}}},{key:"subscribeToMapEvents",value:function(){var e=this;this.mapOnMoveend=function(t){var r=e.mapSvc.getZoom(),n=e.mapSvc.getCenter(!0),a=e.mapSvc.getCurrentExtent(!0),i={lat:parseFloat(n[1]),lon:parseFloat(n[0])},o=new A(r,i,{notifier:"map"},a);e.mapStateSvc.setMapState(o)},this.map.on("moveend",this.mapOnMoveend),this.mapOnClick=function(t){e.mapSvc.layers_on_click(t)},this.map.on("click",this.mapOnClick),this.mapOnDclick=function(t){e.mapSvc.removeAllPopups()},this.map.on("dblclick",this.mapOnDclick),this.mapOnPointermove=function(t){e.mapSvc.layers_on_pointermove(t)},this.map.on("pointermove",this.mapOnPointermove)}},{key:"initMap",value:function(){var e=this.mapSvc.createMap();this.map=e.map,this.setControls(),this.layersSvc||console.log("there is no layersSvc as defined!"),this.mapStateSvc||console.log("there is no mapStateSvc as defined!")}},{key:"setControls",value:function(){var e=[],t=[];if(this.map&&(this.map.getControls().getArray().forEach(function(e){return t.push(e)}),this.map.getControls().clear()),this.controls&&this.map){if(!1!==this.controls.attribution){var r={collapsible:!0,collapsed:!1};"object"==typeof this.controls.attribution&&(r=Object.assign(r,this.controls.attribution));var n=new wt.a(r);e.push(n)}if(this.controls.scaleLine){var a={};"object"==typeof this.controls.scaleLine&&(a=Object.assign(a,this.controls.scaleLine));var i=new St.a(a);e.push(i)}if(!1!==this.controls.zoom){var o={};"object"==typeof this.controls.zoom&&(o=Object.assign(o,this.controls.zoom));var s=new xt.a(o);e.push(s)}if(this.controls.mousePosition){var c={coordinateFormat:function(e){return Object(kt.g)(e,2)},projection:"EPSG:4326"};"object"==typeof this.controls.mousePosition&&(c=Object.assign(c,this.controls.mousePosition));var l=new Pt.a(c);e.push(l)}if(this.controls.fullScreen){var u={};"object"==typeof this.controls.fullScreen&&(u=Object.assign(u,this.controls.fullScreen));var p=new _t.a(u);e.push(p)}if(this.controls.overviewMap){var f=document.createElement("spawn");f.innerHTML='<clr-icon shape="world"></clr-icon>';var d={layers:[new ae.a({source:new Et.a})],label:f};"object"==typeof this.controls.overviewMap&&(d=Object.assign(d,this.controls.overviewMap));var h=new Lt.a(d);e.push(h)}if(this.controls.rotate){var v={};"object"==typeof this.controls.rotate&&(v=Object.assign(v,this.controls.rotate));var y=new Ot.a(v);e.push(y)}e.length&&(t.filter(function(t){return!e.includes(t)}).forEach(function(t){return e.push(t)}),this.map.getControls().extend(e))}}}]),e}()).\u0275fac=function(e){return new(e||Ft)(v.Kb(bt),v.Kb(v.A))},Ft.\u0275cmp=v.Eb({type:Ft,selectors:[["ukis-map-ol"]],viewQuery:function(e,t){var r;1&e&&v.Dc(Ct,1),2&e&&v.kc(r=v.Yb())&&(t.mapDivView=r.first)},inputs:{layersSvc:"layersSvc",mapStateSvc:["mapState","mapStateSvc"],controls:"controls"},decls:3,vars:1,consts:[["id","map","ref","map",1,"map"],["mapDiv",""],["id","crosshair","class","crosshair",4,"ngIf"],["id","crosshair",1,"crosshair"]],template:function(e,t){1&e&&(v.Qb(0,"div",0,1),v.wc(2,Rt,2,0,"div",2),v.Pb()),2&e&&(v.zb(2),v.fc("ngIf",t.controls&&t.controls.crosshair))},directives:[Tt.n],styles:['@charset "UTF-8";.ol-box{box-sizing:border-box;border-radius:2px;border:2px solid #00f}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:rgba(0,60,136,.3);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid #eee;border-top:none;color:#eee;font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-step-marker{width:1px;height:15px;background-color:#000;float:right;z-Index:10}.ol-scale-step-text{bottom:-5px;font-size:12px;z-Index:11}.ol-scale-step-text,.ol-scale-text{position:absolute;color:#000;text-shadow:-2px 0 #fff,0 2px #fff,2px 0 #fff,0 -2px #fff}.ol-scale-text{font-size:14px;text-align:center;bottom:25px}.ol-scale-singlebar{position:relative;height:10px;z-Index:9;box-sizing:border-box;border:1px solid #000}.ol-unsupported{display:none}.ol-unselectable,.ol-viewport{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:grab}.ol-control{position:absolute;background-color:hsla(0,0%,100%,.4);border-radius:4px;padding:2px}.ol-control:hover{background-color:hsla(0,0%,100%,.6)}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:#fff;font-size:1.14em;font-weight:700;text-decoration:none;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:rgba(0,60,136,.5);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;font-size:1.2em;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:focus,.ol-control button:hover{text-decoration:none;background-color:rgba(0,60,136,.7)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em)}.ol-attribution ul{margin:0;padding:0 .5em;color:#000;text-shadow:0 0 2px #fff}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button,.ol-attribution ul{display:inline-block}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:inline-block}.ol-overviewmap .ol-overviewmap-map{border:1px solid #7b98bc;height:150px;margin:2px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:1px;left:2px;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-overviewmap-box{border:2px dotted rgba(0,60,136,.7)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}:root{--ukis-crosshair-color:#ff0004;--ukis-popup-bg-color:#eee;--ukis-drop-shadow:drop-shadow(0 1px 4px rgba(0,0,0,0.2));--ukis-ol-bbox-bg-color:hsla(0,0%,100%,0.4);--ukis-ol-bbox-border-color:rgba(87,87,87,0.4);--ukis-ol-overviewmap-left:0.5em;--ukis-ol-overviewmap-bottom:3.0em;--ukis-ol-control-bg-color:rgba(87,87,87,0.6);--ukis-ol-control-border-color:rgba(87,87,87,0.4)}.map{width:100%;height:100%;position:relative}.ol-popup{position:absolute;background-color:var(--ukis-popup-bg-color);filter:var(--ukis-drop-shadow);padding:15px;border-radius:2px;bottom:12px;left:-50px;min-width:280px;display:none;z-index:1000000}.ol-popup .ol-popup-closer{text-decoration:none;position:absolute;top:0;right:8px;cursor:pointer}.ol-popup .ol-popup-closer:after{content:"\u2716"}.ol-popup:after,.ol-popup:before{top:100%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.ol-popup:after{border-top-color:var(--ukis-popup-bg-color);border-width:10px;left:48px;margin-left:-10px}.ol-popup:before{border-width:11px;left:48px;margin-left:-11px}.crosshair{top:50%;left:50%;font-size:large;color:var(--ukis-crosshair-color);z-index:1;position:absolute;cursor:default}.ol-control button{cursor:pointer}.ol-control button,.ol-control button:focus{background-color:var(--ukis-ol-control-bg-color)}.ol-control button:hover{background-color:var(--ukis-ol-control-border-color)}.ol-scale-line{background:hsla(0,0%,100%,.4);line-height:1.375em}.ol-scale-line .ol-scale-line-inner{background:var(--ukis-ol-control-bg-color);border-color:var(--ukis-ol-control-bg-color)}.ol-attribution ul{font-size:.5rem}.ol-box{background-color:var(--ukis-ol-bbox-bg-color);border-color:var(--ukis-ol-bbox-border-color)!important}.ol-box.ol-drag-select{border-color:var(--clr-color-action-600,var(--fallback-color-no-clr))!important}.ol-overviewmap{left:var(--ukis-ol-overviewmap-left)!important;bottom:var(--ukis-ol-overviewmap-bottom)!important}'],encapsulation:2}),Ft),Gt=((It=function e(){f(this,e)}).\u0275fac=function(e){return new(e||It)},It.\u0275mod=v.Ib({type:It}),It.\u0275inj=v.Hb({providers:[bt],imports:[[Tt.c]]}),It),At=s("jnTo"),jt=s("FHfp"),Dt=function(t){o(n,t);var r=c(n);function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,n);var a=t;(e=r.call(this,{element:document.createElement("div"),target:a.target})).toggle="zoom";var i=void 0!==a.className?a.className:"zoom-number ol-unselectable ol-control",o=document.createElement("button");o.className=i+"-reset",o.setAttribute("type","button"),o.innerHTML="Z",o.addEventListener("click",e.toggleZoomResolution.bind(u(e)),!1);var s=e.element;return s.className=i+" ",s.appendChild(o),e}return h(n,[{key:"setMap",value:function(t){e(p(n.prototype),"setMap",this).call(this,t),t&&this.listenerKeys.push(Object(jt.a)(t,"moveend",this.handleMapMoveend_,this))}},{key:"getMapZoom",value:function(){return this.getMap().getView().getZoom()}},{key:"getMapResolution",value:function(){return this.getMap().getView().getResolution()}},{key:"toggleZoomResolution",value:function(){this.toggle="zoom"===this.toggle?"resolution":"zoom",this.handleMapMoveend_()}},{key:"handleMapMoveend_",value:function(){if(this.element instanceof HTMLElement&&this.element.firstElementChild instanceof HTMLElement)if("zoom"===this.toggle){var e=this.getMapZoom();this.element.firstElementChild.innerHTML=""+Math.round(1*e)/1,this.element.firstElementChild.title="z: ".concat(e)}else{var t=this.getMapResolution();this.element.firstElementChild.innerHTML=""+Math.round(1*t)/1,this.element.firstElementChild.title="r: ".concat(t)}}}]),n}(At.a),zt=s("X69f");function Vt(e,t){if(1&e&&(v.Qb(0,"clr-dg-column"),v.yc(1),v.Pb()),2&e){var r=t.$implicit;v.zb(1),v.zc(r.key)}}function Qt(e,t){if(1&e&&(v.Qb(0,"clr-dg-cell"),v.yc(1),v.Pb()),2&e){var r=t.$implicit;v.zb(1),v.zc(r.value)}}var Nt,Bt,Ut=((Nt=function(){function e(){f(this,e)}return h(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Nt)},Nt.\u0275cmp=v.Eb({type:Nt,selectors:[["app-table-popup"]],inputs:{data:"data"},decls:6,vars:6,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(v.Qb(0,"clr-datagrid"),v.wc(1,Vt,2,1,"clr-dg-column",0),v.ac(2,"keyvalue"),v.Qb(3,"clr-dg-row"),v.wc(4,Qt,2,1,"clr-dg-cell",0),v.ac(5,"keyvalue"),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("ngForOf",v.bc(2,2,t.data)),v.zb(3),v.fc("ngForOf",v.bc(5,4,t.data)))},directives:[zt.g,zt.K,zt.M,zt.H,zt.N,Tt.m,zt.k,zt.L,zt.i,zt.J,zt.h,zt.I],pipes:[Tt.h],styles:[""]}),Nt),Wt=s("94f5"),Zt=s("IheW"),Ht=s("dmaU"),Xt=s("39Zw"),qt=s("YakL"),Yt=s("Tu8L"),Kt=s("eW8D"),Jt=s("RZOP"),$t=s("51Rc"),er=Xt.XLink_1_0,tr=qt.OWS_1_1_0,rr=Yt.SMIL_2_0,nr=Kt.SMIL_2_0_Language,ar=Jt.GML_3_1_1,ir=$t.WMTS_1_0,or=((Bt=function(){function e(t){f(this,e),this.http=t;var r=new Ht.Jsonix.Context([rr,nr,ar,er,tr,ir]);this.xmlunmarshaller=r.createUnmarshaller(),this.xmlmarshaller=r.createMarshaller()}return h(e,[{key:"getCapabilities",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.1.0",n="".concat(e,"?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=").concat(r),a=new Zt.c({"Content-Type":"text/xml",Accept:"text/xml, application/xml"});return this.http.get(n,{headers:a,responseType:"text"}).pipe(Object(j.a)(function(e){return t.xmlunmarshaller.unmarshalString(e)}))}}]),e}()).\u0275fac=function(e){return new(e||Bt)(v.Ub(Zt.a))},Bt.\u0275prov=v.Gb({token:Bt,factory:Bt.\u0275fac,providedIn:"root"}),Bt),sr=s("mxoJ"),cr=s("M4FE"),lr=s("LRne"),ur=s("5+tZ"),pr=s("vkgz"),fr=s("eIep"),dr=s("w1tV"),hr=s("wgT7"),vr=s("LuQ5"),yr=s("GS9G"),mr=s("cp0P"),br=s("PqYM"),gr=s("MtjB"),wr=s("3E0/");function Sr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=1;return function(n){return n.pipe(Object(gr.a)(function(n){return n.pipe(Object(wr.a)(e),Object(ur.a)(function(e){if(e.status&&400===e.status)throw e;if(r<=t)return console.log("http-error. Retrying ..."),r+=1,Object(lr.a)(e);throw console.log("Persistent http-errors after ".concat(r," attempts. Giving up.")),e}))}))}}var xr,Pr,kr=function(){function e(){f(this,e)}return h(e,[{key:"set",value:function(e,t){return Object(lr.a)(!0)}},{key:"get",value:function(e){return Object(lr.a)(null)}}]),e}(),_r=Xt.XLink_1_0,Lr=qt.OWS_1_1_0,Er=hr.OWS_2_0,Or=vr.WPS_1_0_0,Tr=yr.WPS_2_0,Cr=Ht.Jsonix,Rr=s("o1q9"),Ir=((Pr=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return r}(function(){function e(t){f(this,e),this.http=t,this.parser=new Rr.a}return h(e,[{key:"getCapabilities",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.1.0";return this.http.get("".concat(e,"?SERVICE=WMS&REQUEST=GetCapabilities&VERSION=").concat(r),{headers:{"Content-Type":"text/xml",Accept:"text/xml, application/xml"},responseType:"text"}).pipe(Object(j.a)(function(e){return t.parser.read(e)}))}},{key:"getLayerFromCapabilities",value:function(e,t){return this.getLayerFromCapabilitiesLayer(e,t.Capability.Layer)}},{key:"getLayerFromCapabilitiesLayer",value:function(e,t){var r=this,n=t;return n?n.Name&&n.Name===e?n:n.Layer&&Array.isArray(n.Layer)?n.Layer.find(function(t){return r.getLayerFromCapabilitiesLayer(e,t)}):n.Layer&&n.Layer.Name&&n.Layer.Name===e?n.Layer:void 0:null}},{key:"getTimeDimensionFromLayer",value:function(e){var t;return null===(t=e.Dimension)||void 0===t?void 0:t.find(function(e){return"time"===e.name})}}]),e}())).\u0275fac=function(e){return new(e||Pr)(v.Ub(Zt.a))},Pr.\u0275prov=v.Gb({token:Pr,factory:Pr.\u0275fac}),Pr),Fr=((xr=function(e){o(r,e);var t=c(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1.0.0",a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return f(this,r),(e=t.call(this,n,a,i)).webClient=a,e}return r}(function(){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1.0.0",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(f(this,e),this.webclient=n,this.cache=new kr,this.version=r,a&&(this.cache=a),"1.0.0"===this.version)this.wpsmarshaller=new sr.a,t=new Cr.Context([_r,Lr,Or]);else{if("2.0.0"!==this.version)throw new Error("You entered a WPS version other than 1.0.0 or 2.0.0.");this.wpsmarshaller=new cr.a,t=new Cr.Context([_r,Er,Tr])}this.xmlunmarshaller=t.createUnmarshaller(),this.xmlmarshaller=t.createMarshaller()}return h(e,[{key:"getCapabilities",value:function(e){var t=this,r=this.wpsmarshaller.getCapabilitiesUrl(e);return this.getRaw(r).pipe(Object(j.a)(function(e){var r=t.xmlunmarshaller.unmarshalString(e);return t.wpsmarshaller.unmarshalCapabilities(r.value)}))}},{key:"describeProcess",value:function(e,t){var r=this,n=this.wpsmarshaller.getDescribeProcessUrl(e,t);return this.getRaw(n).pipe(Object(j.a)(function(e){var t=r.xmlunmarshaller.unmarshalString(e);return r.wpsmarshaller.unmarshalProcessDescription(t.value)}))}},{key:"executeAsync",value:function(e,t,r,a){var i=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,l=this.executeAsyncBasic(e,t,r,a).pipe(Object(ur.a)(function(n){return function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;r&&r(null);var a=e.pipe(Object(pr.a)(function(e){r&&r(e)})),i=Object(mr.a)(a,Object(br.a)(n)).pipe(Object(j.a)(function(e){return e[0]})).pipe(Object(ur.a)(function(e){return t(e)?Object(lr.a)(e):i}));return i}(i.getNextState(n,e,t,r,a),function(e){if("Failed"===e.status)throw new Error("Error during execution of process ".concat(t,": ")+e.statusLocation);return"Succeeded"===e.status},s,o)}),Object(ur.a)(function(n){return i.fetchResults(n,e,t,r,a,c)}),Object(pr.a)(function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if("error"===a.description.type)throw console.log("server responded with 200, but body contained an error-result: ",a),new Error(a.value)}}catch(i){r.e(i)}finally{r.f()}}));return this.cachedQuery(e,t,r,a,l)}},{key:"cachedQuery",value:function(e,t,r,n,a){var i=this;return this.cache.get({url:e,processId:t,inputs:r,outputs:n}).pipe(Object(fr.a)(function(o){return o?Object(lr.a)(o):a.pipe(Object(pr.a)(function(a){i.cache.set({url:e,processId:t,inputs:r,outputs:n},a).subscribe(function(e){console.log("set data in cache",e)})}))}))}},{key:"getNextState",value:function(e,t,r,n,a){var i,o=this;if("1.0.0"===this.version){if(!e.statusLocation)throw Error("No status location");i=this.getRaw(e.statusLocation)}else{if("2.0.0"!==this.version)throw new Error("'GetStatus' has not yet been implemented for this WPS-Version (".concat(this.version,")."));if(!e.jobID)throw Error("No job-Id");var s=this.wpsmarshaller.marshallGetStatusBody(t,r,e.jobID),c=this.xmlmarshaller.marshalString(s);i=this.postRaw(t,c)}return i.pipe(Sr(2e3,2),Object(j.a)(function(e){var i=o.xmlunmarshaller.unmarshalString(e);return o.wpsmarshaller.unmarshalGetStateResponse(i,t,r,n,a)}))}},{key:"fetchResults",value:function(e,t,r,n,a,i){var o,s=this;if(e.results)return o=i?i(e.results):this.wpsmarshaller.unmarshalSyncExecuteResponse(e.results,t,r,n,a),Object(lr.a)(o);if(!e.jobID)throw new Error("You want me to get a result, but I can't find a jobId. I don't know what to do now!");var c=this.wpsmarshaller.marshallGetResultBody(t,r,e.jobID),l=this.xmlmarshaller.marshalString(c);return this.postRaw(t,l).pipe(Object(j.a)(function(e){var o=s.xmlunmarshaller.unmarshalString(e);return i?i(o):s.wpsmarshaller.unmarshalSyncExecuteResponse(o,t,r,n,a)}))}},{key:"executeAsyncBasic",value:function(e,t,r,n){var a=this,i=this.wpsmarshaller.executeUrl(e,t),o=this.wpsmarshaller.marshalExecBody(t,r,n,!0),s=this.xmlmarshaller.marshalString(o);return this.postRaw(i,s).pipe(Object(j.a)(function(i){var o=a.xmlunmarshaller.unmarshalString(i);return a.wpsmarshaller.unmarshalAsyncExecuteResponse(o,e,t,r,n)}))}},{key:"execute",value:function(e,t,r,n,a){var i=this,o=this.wpsmarshaller.executeUrl(e,t),s=this.wpsmarshaller.marshalExecBody(t,r,n,!1),c=this.xmlmarshaller.marshalString(s);return this.postRaw(o,c).pipe(Object(j.a)(function(o){var s=i.xmlunmarshaller.unmarshalString(o);return a?a(s):i.wpsmarshaller.unmarshalSyncExecuteResponse(s,e,t,r,n)}))}},{key:"dismiss",value:function(e,t,r){var n=this,a=this.wpsmarshaller.dismissUrl(e,t,r),i=this.wpsmarshaller.marshalDismissBody(r),o=this.xmlmarshaller.marshalString(i);return this.postRaw(a,o).pipe(Object(j.a)(function(r){var a=n.xmlunmarshaller.unmarshalString(r);return n.wpsmarshaller.unmarshalDismissResponse(a,e,t)}))}},{key:"postRaw",value:function(e,t){var r=this;return this.webclient.post(e,t,{headers:{"Content-Type":"text/xml",Accept:"text/xml, application/xml"},responseType:"text"}).pipe(Sr(2e3,2),Object(pr.a)(function(t){r.parseResponseForErrors(e,t)}),Object(dr.a)())}},{key:"getRaw",value:function(e){var t=this;return this.webclient.get(e,{headers:{Accept:"text/xml, application/xml"},responseType:"text"}).pipe(Sr(2e3,2),Object(pr.a)(function(r){t.parseResponseForErrors(e,r)}))}},{key:"parseResponseForErrors",value:function(e,t){if(t.match("<title>404 Not Found</title>")||t.match("ows:ExceptionReport"))throw new Error("From ".concat(e,":  ")+t)}},{key:"setCache",value:function(e){this.cache=e}}]),e}())).\u0275fac=function(e){return new(e||xr)(v.Ub("WPS_VERSION"),v.Ub(Zt.a),v.Ub("WPS_CACHE"))},xr.\u0275prov=v.Gb({token:xr,factory:xr.\u0275fac}),xr);function Mr(e,t){var r,a=n(e);try{for(a.s();!(r=a.n()).done;){if(!t(r.value))return!1}}catch(i){a.e(i)}finally{a.f()}return!0}function Gr(e){return"id"in e&&"properties"in e&&function(e){return"title"in e&&"updated"in e&&(!e.authors||Mr(e.authors,jr))&&(!e.offerings||Mr(e.offerings,Ar))&&(!e.categories||Mr(e.categories,Dr))}(e.properties)}function Ar(e){return"code"in e&&(!e.operations||Mr(e.operations,Vr))&&(!e.contents||Mr(e.contents,Qr))&&(!e.styles||Mr(e.styles,Nr))}function jr(e){return"name"in e||"email"in e||"uri"in e}function Dr(e){return"scheme"in e||"term"in e||"label"in e}function zr(e){return"pixelWidth"in e||"pixelHeight"in e||"mmPerPixel"in e}function Vr(e){return"code"in e&&"method"in e&&(!e.request||Qr(e.request))&&(!e.result||Qr(e.result))}function Qr(e){return"type"in e}function Nr(e){return"name"in e&&"title"in e}function Br(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wms"===e||"http://schemas.opengis.net/wms/1.1.1"===e||"http://schemas.opengis.net/wms/1.1.0"===e}function Ur(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wfs"===e}function Wr(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wmts"===e||"http://schemas.opengis.net/wmts/1.0.0"===e||"http://schemas.opengis.net/wmts/1.1.0"===e}function Zr(e){if(e){var t=[],r=e.split(",");for(var n in r)if(r[n]){var a=r[n].split("-");if(1===a.length)t.push(r[n]);else if(2===a.length){var i=a[0].charCodeAt(0),o=a[1].charCodeAt(0);if(i<=o)for(var s=i;s<=o;s++)t.push(String.fromCharCode(s).toLowerCase());else for(var c=i;c>=o;c--)t.push(String.fromCharCode(c).toLowerCase())}}return t}}var Hr,Xr,qr=((Xr=function(){function e(t){f(this,e),this.wmtsClient=t}return h(e,[{key:"checkContext",value:function(e){return"id"in(t=e)&&"properties"in t&&"links"in t.properties&&"lang"in t.properties&&"title"in t.properties&&"updated"in t.properties&&(!t.properties.authors||Mr(t.properties.authors,jr))&&(!t.properties.creator||function(e){return"title"in e||"uri"in e||"version"in e}(t.properties.creator))&&(!t.properties.display||Mr(t.properties.display,zr))&&(!t.properties.categories||Mr(t.properties.categories,Dr))&&"features"in t&&Mr(t.features,Gr);var t}},{key:"getContextTitle",value:function(e){return e.properties.title}},{key:"getContextPublisher",value:function(e){return e.properties.publisher?e.properties.publisher:null}},{key:"getContextExtent",value:function(e){return e.bbox?e.bbox:null}},{key:"getResources",value:function(e){return e.features}},{key:"getResourceTitle",value:function(e){return e.properties.title}},{key:"getResourceUpdated",value:function(e){return e.properties.updated}},{key:"getResourceDate",value:function(e){return e.properties.date?e.properties.date:null}},{key:"getResourceOfferings",value:function(e){return e.properties.offerings?e.properties.offerings:null}},{key:"isActive",value:function(e){var t=!0;return e.properties.hasOwnProperty("active")&&(t=e.properties.active),t}},{key:"getResourceOpacity",value:function(e){var t=1;return e.properties.hasOwnProperty("opacity")&&(t=e.properties.opacity),t}},{key:"getResourceAttribution",value:function(e){var t="";return e.properties.hasOwnProperty("attribution")&&(t=e.properties.attribution),t}},{key:"getResourceShards",value:function(e){if(e.properties.hasOwnProperty("shards"))return e.properties.shards}},{key:"convertOwcTimeToIsoTimeAndPeriodicity",value:function(e){var t=e.split("/"),r=3===t.length?t[0]+"/"+t[1]:e,n=3===t.length?t[2]:null;return n?{interval:r,periodicity:n}:r}},{key:"getTimeValueFromDimensions",value:function(e){var t=this,r=RegExp(",","g").test(e);return r?e?e.split(",").map(function(e){return t.convertOwcTimeToIsoTimeAndPeriodicity(e)}):null:!r&&e?this.convertOwcTimeToIsoTimeAndPeriodicity(e):void 0}},{key:"getResourceDimensions",value:function(e){if(e.properties.hasOwnProperty("dimensions")){var t={},r={};if(Array.isArray(e.properties.dimensions)){var a,i=n(e.properties.dimensions);try{for(i.s();!(a=i.n()).done;){var o=a.value;r[o.name]=o}}catch(l){i.e(l)}finally{i.f()}}else r=e.properties.dimensions;for(var s in r)if(r[s]){var c;c="time"===s||"ISO8601"===r[s].units?this.getTimeDimensions(r):r[s],t[s]=c}return t}}},{key:"getTimeDimensions",value:function(e){var t={values:null,units:null},r=e.time.value;r||console.log("check to get dimensions value from OGC Service later!!",e);var n=this.getTimeValueFromDimensions(r);return t={values:null,units:e.time.units,display:{format:"YYYMMDD",period:e.time.display,default:"end"}},(Array.isArray(n)||n&&"string"!=typeof n&&n.interval&&n.periodicity)&&(t.values=n),t}},{key:"getLayertypeFromOfferingCode",value:function(e){return Br(e.code)?m:Wr(e.code)?b:Ur(e.code)?S:"http://www.opengis.net/spec/owc-geojson/1.0/req/geojson"===e.code?w:"http://www.opengis.net/spec/owc-geojson/1.0/req/xyz"===e.code?g:e.code}},{key:"checkIfServiceOffering",value:function(e){return!(e.contents||!e.operations)}},{key:"checkIfDataOffering",value:function(e){return!(!e.contents||e.operations)}},{key:"getOfferingContents",value:function(e){return this.checkIfServiceOffering(e)?e.operations:this.checkIfDataOffering(e)?e.contents:void 0}},{key:"getLegendUrl",value:function(e){var t="";if(e.hasOwnProperty("styles")){var r=e.styles.filter(function(e){return e.default});if(r.length>0)return r[0].legendURL}else e.hasOwnProperty("legendUrl")&&(t=e.legendUrl);return t}},{key:"getIconUrl",value:function(e){var t="";return e.hasOwnProperty("iconUrl")&&(t=e.iconUrl),t}},{key:"getLayers",value:function(e,t){var r,a=[],i=n(e.features);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.properties.offerings;if(s.length>0){var c=s.find(function(e){return Br(e.code)})||s.find(function(e){return Wr(e.code)})||s.find(function(e){return Ur(e.code)})||s[0];a.push(this.createLayerFromOffering(c,o,e,t))}}}catch(l){i.e(l)}finally{i.f()}return Object(mr.a)(a)}},{key:"createLayerFromOffering",value:function(e,t,r,n){var a=this.getLayertypeFromOfferingCode(e);return k(a)?this.createRasterLayerFromOffering(e,t,r,n):P(a)?this.createVectorLayerFromOffering(e,t,r):void console.error("This type of service (".concat(a,") has not been implemented yet."))}},{key:"createVectorLayerFromOffering",value:function(e,t,r){var a,i,o=this.getLayertypeFromOfferingCode(e);if(!P(o))return console.error("This type of layer '".concat(o,"' / offering '").concat(e.code,"' cannot be converted into a Vectorlayer")),null;if(this.getIconUrl(e),e.operations){var s,c=n(e.operations);try{for(c.s();!(s=c.n()).done;){var l=s.value;"GetFeature"===l.code&&(a=l.href)}}catch(d){c.e(d)}finally{c.f()}}e.contents&&(i=e.contents[0].content);var u=this.getLegendUrl(e),p={id:t.id,name:this.getResourceTitle(t),displayName:this.getDisplayName(e,t),visible:this.isActive(t),type:o,removable:!0,attribution:this.getResourceAttribution(t),continuousWorld:!1,opacity:this.getResourceOpacity(t),url:a||null,legendImg:u||null,data:i},f=new T(p);return t.bbox?f.bbox=t.bbox:r&&r.bbox&&(f.bbox=r.bbox),Object(lr.a)(f)}},{key:"createRasterLayerFromOffering",value:function(e,t,r,n){var a,i=this.getLayertypeFromOfferingCode(e);if(!k(i))return console.error("This type of offering '".concat(e.code,"' cannot be converted into a rasterlayer.")),null;switch(i){case m:a=this.createWmsLayerFromOffering(e,t,r);break;case b:a=this.createWmtsLayerFromOffering(e,t,r,n)}return a}},{key:"createWmtsLayerFromOffering",value:function(e,t,r,n){return this.getWmtsOptions(e,t,r,n).pipe(Object(j.a)(function(e){return new I(e)}))}},{key:"createWmsLayerFromOffering",value:function(e,t,r){var n=this.getWmsOptions(e,t,r),a=new F(n);return Object(lr.a)(a)}},{key:"getWmtsOptions",value:function(e,t,r,n){var a,i=this.getRasterLayerOptions(e,t,r),o=this.getLayerForWMTS(e,t);if(e.styles){var s=e.styles.find(function(e){return e.default});s&&(a=s.name)}return this.getMatrixSetForWMTS(e,t,n).pipe(Object(j.a)(function(e){var t={matrixSet:e.matrixSet,matrixIds:e.matrixIds,resolutions:e.resolutions};return Object.assign(Object.assign({},i),{type:"wmts",params:{layer:o,matrixSetOptions:t,projection:n,style:a,format:"image/png"}})}))}},{key:"getLayerForWMTS",value:function(e,t){var n=r(this.parseOperationUrl(e,"GetTile"),2),a=(n[0],n[1]);if(a.LAYER)return a.LAYER;console.error("There is no layer-parameter in the offering ".concat(e.code," for resource ").concat(t.id,".\n      Cannot infer layer."),e)}},{key:"parseOperationUrl",value:function(e,t){if(e.operations){var r=e.operations.find(function(e){return e.code===t});if(r)return[this.getUrlFromUri(r.href),this.getJsonFromUri(r.href)];console.error("There is no ".concat(t,"-operation in the offering ").concat(e.code,"."),e)}else console.error("The offering ".concat(e.code," has no operations."),e)}},{key:"getMatrixSetForWMTS",value:function(e,t,n){if(e.matrixSets){var a=e.matrixSets.find(function(e){return e.srs===n});return Object(lr.a)(a)}var i=r(this.parseOperationUrl(e,"GetCapabilities"),2),o=i[0];return i[1],this.wmtsClient.getCapabilities(o).pipe(Object(j.a)(function(e){var t=e.value.contents.tileMatrixSet.find(function(e){return e.identifier.value===n});return{srs:n,matrixSet:t.identifier.value,matrixIds:t.tileMatrix.map(function(e){return e.identifier.value}),resolutions:t.tileMatrix.map(function(e){return e.scaleDenominator}),origin:{x:t.tileMatrix[0].topLeftCorner[1],y:t.tileMatrix[0].topLeftCorner[0]},tilesize:t.tileMatrix[0].tileHeight}}))}},{key:"getWmsOptions",value:function(e,t,r){var n=this.getRasterLayerOptions(e,t,r);if(n.type===m){var a,i=this.getJsonFromUri(e.operations[0].href);e.styles&&(a=e.styles.find(function(e){return e.default}).name);var o={LAYERS:i.LAYERS,FORMAT:i.FORMAT,TIME:i.TIME,VERSION:i.VERSION,TILED:i.TILED,TRANSPARENT:!0,STYLES:a};return Object.assign(Object.assign({},n),{type:"wms",params:o})}console.error("resource ".concat(t.id," cannot be converted into a WMS-Layer"),e)}},{key:"getRasterLayerOptions",value:function(e,t,r){var n=this.getLayerOptions(e,t,r);if(k(n.type))return Object.assign(Object.assign({},n),{type:n.type,url:this.getUrlFromUri(e.operations[0].href),subdomains:Zr(this.getResourceShards(t))});console.error("The layer ".concat(n.id," is not a rasterlayer"),n)}},{key:"getLayerOptions",value:function(e,t,r){var n={id:t.id,type:this.getLayertypeFromOfferingCode(e),name:this.getResourceTitle(t),removable:!0,continuousWorld:!1,opacity:this.getResourceOpacity(t),displayName:this.getDisplayName(e,t),visible:this.isActive(t),attribution:this.getResourceAttribution(t),dimensions:this.getResourceDimensions(t),legendImg:this.getLegendUrl(e),styles:e.styles};return t.bbox?n.bbox=t.bbox:r&&r.bbox&&(n.bbox=r.bbox),n}},{key:"getUrlFromUri",value:function(e){return e.substring(0,e.indexOf("?"))}},{key:"getJsonFromUri",value:function(e){var t=e.substr(e.lastIndexOf("?")+1),r={};return t.split("&").forEach(function(e){var t=e.split("=");r[t[0].toUpperCase()]=decodeURIComponent(t[1])}),r}},{key:"getDisplayName",value:function(e,t){var r="";return e.hasOwnProperty("title")&&(r=e.title?e.title:this.getResourceTitle(t)),r}},{key:"generateOwsContextFrom",value:function(e,t,r,a){a||(a={lang:"",links:[],title:"",updated:""});var i={id:e,type:"FeatureCollection",properties:a,features:[]};r&&(i.bbox=r);var o,s=n(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=this.generateResourceFromLayer(c);i.features.push(l)}}catch(u){s.e(u)}finally{s.f()}return i}},{key:"generateResourceFromLayer",value:function(e){return{id:e.id,properties:{title:e.name,updated:null,offerings:[this.generateOfferingFromLayer(e)],opacity:e.opacity,attribution:e.attribution},type:"Feature",geometry:null}}},{key:"generateOfferingFromLayer",value:function(e,t,r){var n={code:this.getOfferingCodeFromLayer(e),title:e.name};return e.type===w?n.contents=this.getContentsFromLayer(e):n.operations=this.getOperationsFromLayer(e),t&&(n.legendUrl=t),r&&(n.iconUrl=r),n}},{key:"getOfferingCodeFromLayer",value:function(e){switch(e.type){case m:return"http://www.opengis.net/spec/owc-geojson/1.0/req/wms";case b:return"http://www.opengis.net/spec/owc-geojson/1.0/req/wmts";case w:return"http://www.opengis.net/spec/owc-geojson/1.0/req/geojson";case g:return"http://www.opengis.net/spec/owc-geojson/1.0/req/xyz";default:return console.error("This type of layer (".concat(e.type,") has not been implemented yet.")),null}}},{key:"getContentsFromLayer",value:function(e){var t=[];switch(e.type){case w:var r={type:"FeatureCollection",content:JSON.stringify(e.data)};t.push(r);break;default:console.error("Cannot get contents for this type of vectorlayer: (".concat(e.type,")"))}return t}},{key:"getOperationsFromLayer",value:function(e){if(e instanceof O)switch(e.type){case m:return this.getWmsOperationsFromLayer(e);case b:return this.getWmtsOperationsFromLayer(e);case g:return this.getXyzOperationsFromLayer(e);default:return console.error("Cannot get operations for this type of layer: (".concat(e.type,")")),[]}else if(e instanceof T)return console.error("This type of service (".concat(e.type,") has not been implemented yet.")),[]}},{key:"getXyzOperationsFromLayer",value:function(e){return[{code:"REST",method:"GET",type:"text/html",href:"".concat(e.url)}]}},{key:"getTmsOperationsFromLayer",value:function(e){return[]}},{key:"getWfsOperationsFromLayer",value:function(e){return[{code:"GetFeature",method:"GET",type:"application/json",href:"".concat(e.url,"?service=WFS&version=").concat(e.options.version?e.options.version:"1.1.0","&request=GetFeature")}]}},{key:"getWmsOperationsFromLayer",value:function(e){var t=e.url,r=e.params.VERSION,n=e.id,a="image/vnd.jpeg-png";return e.params&&e.params.FORMAT&&(a=e.params.FORMAT),[{code:"GetMap",method:"GET",type:a,href:"".concat(t,"?service=WMS&version=").concat(r,"&request=GetMap&TRANSPARENT=TRUE&LAYERS=").concat(n,"&FORMAT=").concat(a,"&TILED=true")},{code:"GetCapabilities",method:"GET",type:"application/xml",href:"".concat(t,"?service=WMS&version=").concat(r,"&request=GetCapabilities")},{code:"GetFeatureInfo",method:"GET",type:"text/html",href:"".concat(t,"?service=WMS&version=").concat(r,"&request=GetFeatureInfo&TRANSPARENT=TRUE&LAYERS=").concat(n,"&FORMAT=").concat(a)}]}},{key:"getWmtsOperationsFromLayer",value:function(e){var t=e.url,r=e.params.version,n="image/vnd.jpeg-png";return e.params&&e.params.FORMAT&&(n=e.params.FORMAT),[{code:"GetTile",href:"".concat(t,"?SERVICE=WMTS&REQUEST=GetTile&FORMAT=").concat(n,"&LAYER=").concat(e.id,"&VERSION=").concat(r),method:"GET",type:n},{code:"GetCapabilities",href:"".concat(t,"?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=").concat(r),method:"GET",type:"application/xml"},{code:"GetFeatureInfo",href:"".concat(t,"?SERVICE=WMS&REQUEST=GetFeatureInfo&VERSION=").concat(r),method:"GET",type:"text/html"}]}}]),e}()).\u0275fac=function(e){return new(e||Xr)(v.Ub(or))},Xr.\u0275prov=v.Gb({token:Xr,factory:Xr.\u0275fac,providedIn:"root"}),Xr),Yr=((Hr=function e(){f(this,e)}).\u0275fac=function(e){return new(e||Hr)},Hr.\u0275mod=v.Ib({type:Hr}),Hr.\u0275inj=v.Hb({providers:[or,Ir,qr,Fr],imports:[[]]}),Hr),Kr=s("ltgo");function Jr(e,t){}var $r,en,tn=((en=function e(t){f(this,e),this.viewContainerRef=t}).\u0275fac=function(e){return new(e||en)(v.Kb(v.P))},en.\u0275dir=v.Fb({type:en,selectors:[["","ukisAddHost",""]]}),en),rn=(($r=function(){function e(t){f(this,e),this.componentFactoryResolver=t,this.dynamicComponentChange=new v.n}return h(e,[{key:"loadComponent",value:function(){if(this.dynamicComponent){this.subs=[];var e=this.componentFactoryResolver.resolveComponentFactory(this.dynamicComponent.component),t=this.ukisAddHost.viewContainerRef;t.clear(),this.componentRef=t.createComponent(e),this.setInputOutputs()}}},{key:"setInputOutputs",value:function(){var e=this;this.componentRef&&this.dynamicComponent.inputs&&Object.keys(this.dynamicComponent.inputs).map(function(t){var r=t;if(e.dynamicComponent.inputs){e.componentRef.instance[r]=e.dynamicComponent.inputs[r];var n="".concat(r,"Change");if(e.componentRef.instance[n]&&e.componentRef.instance[n]instanceof v.n){var a=e.componentRef.instance[n].subscribe(function(t){e.dynamicComponent.inputs&&(e.dynamicComponent.inputs[r]=t),e.dynamicComponent.outputs&&e.dynamicComponent.outputs[n]&&e.dynamicComponent.outputs[n](t),e.dynamicComponentChange.emit(e.dynamicComponent)});e.subs.push(a)}}})}},{key:"ngOnChanges",value:function(e){e.dynamicComponent&&(Array.isArray(this.subs)&&this.subs.map(function(e){return e.unsubscribe()}),this.setInputOutputs())}},{key:"ngOnInit",value:function(){this.loadComponent()}},{key:"ngOnDestroy",value:function(){this.componentRef&&(this.subs.map(function(e){return e.unsubscribe()}),this.componentRef.destroy(),this.componentRef=null)}}]),e}()).\u0275fac=function(e){return new(e||$r)(v.Kb(v.j))},$r.\u0275cmp=v.Eb({type:$r,selectors:[["ukis-dynamic-component"]],viewQuery:function(e,t){var r;1&e&&v.Dc(tn,3),2&e&&v.kc(r=v.Yb())&&(t.ukisAddHost=r.first)},inputs:{dynamicComponent:"dynamicComponent"},outputs:{dynamicComponentChange:"dynamicComponentChange"},features:[v.xb],decls:1,vars:0,consts:[["ukisAddHost",""]],template:function(e,t){1&e&&v.wc(0,Jr,0,0,"ng-template",0)},directives:[tn],encapsulation:2}),$r),nn=s("s7LF");function an(e,t){if(1&e){var r=v.Rb();v.Qb(0,"span",12),v.Xb("click",function(){return v.pc(r),v.Zb().showProperties()}),v.yc(1),v.Pb()}if(2&e){var n=v.Zb();v.fc("title",n.getLayerName(n.layer)),v.zb(1),v.Ac(" ",n.getLayerName(n.layer)," ")}}var on=function(e){return{disabled:e}};function sn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"span"),v.Qb(1,"clr-icon",13),v.Xb("click",function(){v.pc(r);var e=v.Zb();return e.setLayerIndex(e.layer,"down",e.group)}),v.Pb(),v.Qb(2,"clr-icon",14),v.Xb("click",function(){v.pc(r);var e=v.Zb();return e.setLayerIndex(e.layer,"up",e.group)}),v.Pb(),v.Pb()}if(2&e){var n=v.Zb();v.zb(1),v.fc("hidden",n.layerGroups&&1==n.layerGroups.length)("ngClass",v.jc(4,on,n.isLast(n.layer))),v.zb(1),v.fc("hidden",n.layerGroups&&1==n.layerGroups.length)("ngClass",v.jc(6,on,n.isFirst(n.layer)))}}var cn=function(e){return{"is-solid":e}};function ln(e,t){if(1&e&&v.Lb(0,"clr-icon",15),2&e){var r=v.Zb();v.gc("title",r.layer.visible?"Choose another layer":"Show layer"),v.fc("ngClass",v.jc(3,cn,r.layer.visible)),v.Ab("shape",r.layer.visible?"dot-circle":"circle")}}function un(e,t){if(1&e&&v.Lb(0,"clr-icon",15),2&e){var r=v.Zb();v.gc("title",r.layer.visible?"Hide layer":"Show layer"),v.fc("ngClass",v.jc(3,cn,r.layer.visible)),v.Ab("shape",r.layer.visible?"eye":"eye-hide")}}var pn=function(e){return{active:e}};function fn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",27),v.Xb("click",function(){return v.pc(r),v.Zb(2).switchTab("settings")}),v.Pb()}if(2&e){var n=v.Zb(2);v.fc("ngClass",v.jc(1,pn,n.activeTabs.settings))}}function dn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",28),v.Xb("click",function(){return v.pc(r),v.Zb(2).switchTab("legend")}),v.Pb()}if(2&e){var n=v.Zb(2);v.fc("ngClass",v.jc(1,pn,n.activeTabs.legend))}}function hn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",29),v.Xb("click",function(){return v.pc(r),v.Zb(2).switchTab("description")}),v.Pb()}if(2&e){var n=v.Zb(2);v.fc("ngClass",v.jc(1,pn,n.activeTabs.description))}}function vn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",30),v.Xb("click",function(){return v.pc(r),v.Zb(2).switchTab("changeStyle")}),v.Pb()}if(2&e){var n=v.Zb(2);v.fc("ngClass",v.jc(1,pn,n.activeTabs.changeStyle))}}function yn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",31),v.Xb("click",function(){v.pc(r);var e=t.$implicit,n=v.Zb(2);return e.action(n.layer)}),v.Pb()}if(2&e){var n=t.$implicit;v.fc("title",n.title),v.Ab("shape",n.icon)}}function mn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",32),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.zoomTo(e.layer)}),v.Pb()}}function bn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",33),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.removeLayer(e.group,e.layer)}),v.Pb()}}function gn(e,t){if(1&e){var r=v.Rb();v.Ob(0),v.Qb(1,"ukis-dynamic-component",37),v.Xb("dynamicComponentChange",function(e){return v.pc(r),v.Zb(3).layer.action=e}),v.Pb(),v.Nb()}if(2&e){var n=v.Zb(3);v.zb(1),v.fc("dynamicComponent",n.layer.action)}}function wn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"div",34),v.Qb(1,"div",35),v.Qb(2,"label",8),v.yc(3,"Opacity:"),v.Pb(),v.Qb(4,"input",36),v.Xb("change",function(){v.pc(r);var e=v.Zb(2);return e.setLayerOpacity(e.layer)})("ngModelChange",function(e){return v.pc(r),v.Zb(2).layer.opacity=e}),v.Pb(),v.Qb(5,"span"),v.yc(6),v.Pb(),v.Pb(),v.wc(7,gn,2,1,"ng-container",6),v.Pb()}if(2&e){var n=v.Zb(2);v.zb(2),v.fc("for","layer_transparency_slider_"+n.layer.id),v.zb(2),v.fc("id","layer_transparency_slider_"+n.layer.id)("value",n.layer.opacity)("min",0)("max",1)("step",.1)("ngModel",n.layer.opacity),v.zb(2),v.zc(" "+n.layer.opacity),v.zb(1),v.fc("ngIf",n.checkIsComponentItem(n.layer,"action"))}}function Sn(e,t){if(1&e){var r=v.Rb();v.Ob(0),v.Qb(1,"ukis-dynamic-component",37),v.Xb("dynamicComponentChange",function(e){return v.pc(r),v.Zb(3).layer.legendImg=e}),v.Pb(),v.Nb()}if(2&e){var n=v.Zb(3);v.zb(1),v.fc("dynamicComponent",n.layer.legendImg)}}function xn(e,t){if(1&e&&v.Lb(0,"img",40),2&e){var r=v.Zb(3);v.fc("src",r.layer.legendImg,v.rc)}}function Pn(e,t){if(1&e&&(v.Qb(0,"div"),v.wc(1,Sn,2,1,"ng-container",38),v.wc(2,xn,1,1,"ng-template",null,39,v.xc),v.Pb()),2&e){var r=v.lc(3),n=v.Zb(2);v.zb(1),v.fc("ngIf",n.checkIsComponentItem(n.layer,"legendImg"))("ngIfElse",r)}}function kn(e,t){if(1&e&&(v.Qb(0,"div"),v.Lb(1,"span",41),v.Pb()),2&e){var r=v.Zb(2);v.zb(1),v.fc("innerHTML",r.layer.description,v.qc)}}function _n(e,t){if(1&e&&(v.Qb(0,"option",44),v.yc(1),v.Pb()),2&e){var r=t.$implicit,n=v.Zb(3);v.fc("value",r.name),v.Ab("selected",!!n.isSelectedStyle(r.name)||null),v.zb(1),v.zc(r.title)}}function Ln(e,t){if(1&e){var r=v.Rb();v.Qb(0,"div"),v.Qb(1,"select",42),v.Xb("change",function(e){return v.pc(r),v.Zb(2).executeChangeStyle(e.target.value)}),v.wc(2,_n,2,3,"option",43),v.Pb(),v.Pb()}if(2&e){var n=v.Zb(2);v.zb(2),v.fc("ngForOf",n.layer.styles)}}function En(e,t){if(1&e&&(v.Qb(0,"div",16),v.Qb(1,"div",17),v.wc(2,fn,1,3,"clr-icon",18),v.wc(3,dn,1,3,"clr-icon",19),v.wc(4,hn,1,3,"clr-icon",20),v.wc(5,vn,1,3,"clr-icon",21),v.wc(6,yn,1,2,"clr-icon",22),v.Lb(7,"span"),v.wc(8,mn,1,0,"clr-icon",23),v.wc(9,bn,1,0,"clr-icon",24),v.Pb(),v.Qb(10,"div",25),v.wc(11,wn,8,9,"div",26),v.wc(12,Pn,4,2,"div",6),v.wc(13,kn,2,1,"div",6),v.wc(14,Ln,3,1,"div",6),v.Pb(),v.Pb()),2&e){var r=v.Zb();v.zb(2),v.fc("ngIf",!r.checkBaselayer(r.layer,r.group)),v.zb(1),v.fc("ngIf",r.layer.legendImg),v.zb(1),v.fc("ngIf",r.layer.description),v.zb(1),v.fc("ngIf",(null==r.layer.styles?null:r.layer.styles.length)>1),v.zb(1),v.fc("ngForOf",r.layer.actions),v.zb(2),v.fc("ngIf",r.canZoomToLayer),v.zb(1),v.fc("ngIf",r.layer.removable),v.zb(2),v.fc("ngIf",r.activeTabs.settings),v.zb(1),v.fc("ngIf",r.activeTabs.legend&&r.layer.legendImg),v.zb(1),v.fc("ngIf",r.activeTabs.description&&r.layer.description),v.zb(1),v.fc("ngIf",r.activeTabs.changeStyle&&r.layer.styles&&(null==r.layer.styles?null:r.layer.styles.length)>1)}}var On,Tn,Cn,Rn=["*"],In=((Cn=function(){function e(){f(this,e),this.expandable=!0,this.update=new v.n,this.canZoomToLayer=!1,this.activeTabs={settings:!1,legend:!0,description:!1,changeStyle:!1}}return h(e,[{key:"visible",get:function(){return this.layer.visible}},{key:"cssClass",get:function(){return this.layer.cssClass}},{key:"expanded",get:function(){return!!this.layer&&this.layer.expanded},set:function(e){this.layer&&(this.layer.expanded=e)}},{key:"checkIsComponentItem",value:function(e,t){var r=e[t],n=!1;if(r&&"object"==typeof r&&"component"in r){if(r.inputs){if(r.inputs&&!r.inputs.layer){var a=Object.assign({__proto__:this.layer.__proto__},e);console.log(a),a&&a[t]&&delete a[t],r.inputs=Object.assign({layer:a},r.inputs)}}else{var i=Object.assign({__proto__:this.layer.__proto__},e);console.log(i),i&&i[t]&&delete i[t],r.inputs={layer:i}}n=!0}return n}},{key:"getLayerName",value:function(e){return e.displayName?e.displayName:e.name}},{key:"ngOnInit",value:function(){this.layersSvc||console.error("you need to provide a layersService!"),this.layer.legendImg||(this.activeTabs.description=!0,this.activeTabs.legend=!1,this.activeTabs.settings=!1,this.activeTabs.changeStyle=!1),this.layer.legendImg||this.layer.description||(this.activeTabs.description=!1,this.activeTabs.legend=!1,this.activeTabs.settings=!0),this.layer.bbox&&this.layer.bbox.length>=4&&(this.canZoomToLayer=!0)}},{key:"setLayerVisibility",value:function(e,t){if(t){if(t.layers.length>0)if("Baselayers"===t.filtertype){var r,a=n(t.layers);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.visible=i===e}}catch(u){a.e(u)}finally{a.f()}this.update.emit({layer:this.layer})}else{var o=t.visible;e.visible=!e.visible,o!==t.visible?this.update.emit({layer:this.layer}):this.layersSvc.updateLayer(e,e.filtertype||"Layers")}}else if("Baselayers"===e.filtertype){e.visible=!e.visible;var s,c=n(this.layerGroups.filter(function(e){return"Baselayers"===e.filtertype}));try{for(c.s();!(s=c.n()).done;){var l=s.value;l instanceof E&&l.id!==e.id&&(l.visible=!e.visible,this.layersSvc.updateLayer(l,l.filtertype||"Baselayers"))}}catch(u){c.e(u)}finally{c.f()}}else e.visible=!e.visible,this.layersSvc.updateLayer(e,e.filtertype||"Layers")}},{key:"setLayerIndex",value:function(e,t,r){r?this.layersSvc.setLayerIndexInGroup(e,t,r):this.layersSvc.setGroupLayerIndex(e,t)}},{key:"removeLayer",value:function(e,t){e?this.layersSvc.removeLayerFromGroup(t,e):this.layersSvc.removeLayer(t,t.filtertype)}},{key:"zoomTo",value:function(e){this.mapState&&e.bbox&&e.bbox.length>=4&&this.mapState.setExtent(e.bbox)}},{key:"setLayerOpacity",value:function(e){this.group?this.update.emit({layer:e}):this.layersSvc.updateLayer(e,e.filtertype||"Layers")}},{key:"checkBaselayer",value:function(e,t){return!!("Baselayers"===e.filtertype||t&&"Baselayers"===t.filtertype)}},{key:"is_expandable",value:function(){return!!this.group&&!this.layer.legendImg&&"Baselayers"===this.group.filtertype}},{key:"showProperties",value:function(){this.is_expandable()||(this.expanded=!this.expanded)}},{key:"switchTab",value:function(e){for(var t=0,r=Object.keys(this.activeTabs);t<r.length;t++){var n=r[t];this.activeTabs[n]=e===n}}},{key:"isSelectedStyle",value:function(e){var t=this;if(k(this.layer.type)){if(this.layer.type===m)return this.layer.params.STYLES===e;if(this.layer.type===b)return this.layer.params.style===e}else if(P(t.layer.type))return!1;return!1}},{key:"executeChangeStyle",value:function(e){if(k(this.layer.type)&&this.layer.styles){var t=this.layer.styles.find(function(t){return t.name===e});t&&(this.layer.legendImg=t.legendURL,this.layer.type===m?this.layer.params.STYLES=t.name:this.layer.type===b&&(this.layer.params.style=t.name),this.layersSvc.updateLayer(this.layer,this.layer.filtertype))}}},{key:"isFirst",value:function(e){return this.group?this.layersSvc.isGroupFirst(e,this.group.layers):this.layersSvc.isGroupFirst(e,null,e.filtertype)}},{key:"isLast",value:function(e){return this.group?this.layersSvc.isGroupLast(e,this.group.layers):this.layersSvc.isGroupLast(e,null,e.filtertype)}},{key:"getExpandShape",value:function(){return this.expanded?{transform:"rotate(180deg)"}:{transform:"rotate(90deg)"}}}]),e}()).\u0275fac=function(e){return new(e||Cn)},Cn.\u0275cmp=v.Eb({type:Cn,selectors:[["ukis-layerentry"]],hostVars:4,hostBindings:function(e,t){2&e&&(v.Bb(t.cssClass),v.Cb("layer-visible",t.visible))},inputs:{layersSvc:"layersSvc",mapState:"mapState",layer:"layer",group:"group",layerGroups:"layerGroups",expanded:"expanded",expandable:"expandable"},outputs:{update:"update"},ngContentSelectors:Rn,decls:14,vars:15,consts:[[1,"layer"],[1,"head"],["shape","angle","title","Details",1,"iconButton",3,"ngStyle","ngClass","click"],[1,"item-title-replacement","title",3,"title","click"],["ref",""],["class","title",3,"title","click",4,"ngIf"],[4,"ngIf"],[1,"hide",3,"type","name","id","checked","change"],[3,"for"],["class","iconButton",3,"ngClass","title",4,"ngIf","ngIfElse"],["notBaselayer",""],["class","body",4,"ngIf"],[1,"title",3,"title","click"],["shape","arrow","title","up",1,"iconButton",3,"hidden","ngClass","click"],["shape","arrow","title","down","dir","down",1,"iconButton",3,"hidden","ngClass","click"],[1,"iconButton",3,"ngClass","title"],[1,"body"],[1,"tools"],["title","Layer settings","shape","cog","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Layer Legend","shape","image","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Layer info","shape","info-standard","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Change style","shape","cloud-chart","class","iconButton",3,"ngClass","click",4,"ngIf"],["class","iconButton",3,"title","click",4,"ngFor","ngForOf"],["shape","zoom-in","class","iconButton","title","Zoom to layer",3,"click",4,"ngIf"],["shape","trash","class","iconButton","title","Remove layer",3,"click",4,"ngIf"],[1,"tabsbody"],["class","layersettings",4,"ngIf"],["title","Layer settings","shape","cog",1,"iconButton",3,"ngClass","click"],["title","Layer Legend","shape","image",1,"iconButton",3,"ngClass","click"],["title","Layer info","shape","info-standard",1,"iconButton",3,"ngClass","click"],["title","Change style","shape","cloud-chart",1,"iconButton",3,"ngClass","click"],[1,"iconButton",3,"title","click"],["shape","zoom-in","title","Zoom to layer",1,"iconButton",3,"click"],["shape","trash","title","Remove layer",1,"iconButton",3,"click"],[1,"layersettings"],[1,"form-group"],["type","range","name","points",1,"ukis-range-input","opacity-input",3,"id","value","min","max","step","ngModel","change","ngModelChange"],[3,"dynamicComponent","dynamicComponentChange"],[4,"ngIf","ngIfElse"],["imageUrl",""],[3,"src"],[3,"innerHTML"],["clrSelect","",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(v.ec(),v.Qb(0,"div",0),v.Qb(1,"div",1),v.Qb(2,"clr-icon",2),v.Xb("click",function(){return t.showProperties()}),v.Pb(),v.Qb(3,"div",3,4),v.Xb("click",function(){return t.showProperties()}),v.dc(5),v.Pb(),v.wc(6,an,2,2,"span",5),v.wc(7,sn,3,8,"span",6),v.Qb(8,"input",7),v.Xb("change",function(){return t.setLayerVisibility(t.layer,t.group)}),v.Pb(),v.Qb(9,"label",8),v.wc(10,ln,1,5,"clr-icon",9),v.wc(11,un,1,5,"ng-template",null,10,v.xc),v.Pb(),v.Pb(),v.wc(13,En,15,11,"div",11),v.Pb()),2&e){var r=v.lc(4),n=v.lc(12);v.zb(2),v.fc("ngStyle",t.getExpandShape())("ngClass",v.jc(13,on,t.is_expandable())),v.zb(1),v.fc("title",t.getLayerName(t.layer)),v.zb(3),v.fc("ngIf",0==r.children.length),v.zb(1),v.fc("ngIf",!t.checkBaselayer(t.layer,t.group)),v.zb(1),v.fc("type",t.checkBaselayer(t.layer,t.group)?"radio":"checkbox")("name","layer")("id",t.layer.id)("checked",t.layer.visible),v.zb(1),v.fc("for",t.layer.id),v.zb(1),v.fc("ngIf",t.checkBaselayer(t.layer,t.group))("ngIfElse",n),v.zb(3),v.fc("ngIf",t.expandable&&t.expanded)}},directives:[zt.n,Tt.o,Tt.l,Tt.n,zt.r,Tt.m,nn.r,nn.b,nn.j,nn.m,rn,zt.x,nn.o,nn.x],styles:[".title[_ngcontent-%COMP%]{cursor:pointer}.item-title-replacement[_ngcontent-%COMP%]:empty{display:none}.tabsbody[_ngcontent-%COMP%]{overflow:hidden;word-break:break-all}"]}),Cn),Fn=((Tn=function(){function e(){f(this,e)}return h(e,[{key:"transform",value:function(e){return"string"==typeof e?e.split("").reverse().join(""):Array.isArray(e)?e.slice().reverse():e}}]),e}()).\u0275fac=function(e){return new(e||Tn)},Tn.\u0275pipe=v.Jb({name:"reverse",type:Tn,pure:!1}),Tn),Mn=((On=function(){function e(){f(this,e)}return h(e,[{key:"transform",value:function(e,t){return e.filter(t)}}]),e}()).\u0275fac=function(e){return new(e||On)},On.\u0275pipe=v.Jb({name:"itemsfilter",type:On,pure:!1}),On);function Gn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"span",8),v.Xb("click",function(){return v.pc(r),v.Zb().showProperties()}),v.yc(1),v.Pb()}if(2&e){var n=v.Zb();v.fc("title",n.getLayerName(n.group)),v.zb(1),v.Ac(" ",n.getLayerName(n.group)," ")}}var An=function(e){return{disabled:e}};function jn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"span"),v.Qb(1,"clr-icon",9),v.Xb("click",function(){v.pc(r);var e=v.Zb();return e.setLayerGroupIndex(e.group,"down")}),v.Pb(),v.Qb(2,"clr-icon",10),v.Xb("click",function(){v.pc(r);var e=v.Zb();return e.setLayerGroupIndex(e.group,"up")}),v.Pb(),v.Pb()}if(2&e){var n=v.Zb();v.zb(1),v.fc("ngClass",v.jc(2,An,n.isLast(n.group))),v.zb(1),v.fc("ngClass",v.jc(4,An,n.isFirst(n.group)))}}var Dn=function(e){return{"is-solid":e}};function zn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"span"),v.Qb(1,"input",11),v.Xb("change",function(){return v.pc(r),v.Zb().setGroupLayersVisibility()}),v.Pb(),v.Qb(2,"label",12),v.Lb(3,"clr-icon",13),v.Pb(),v.Pb()}if(2&e){var n=v.Zb();v.zb(1),v.fc("type","checkbox")("checked",n.group.visible)("name","group")("id",n.group.id),v.zb(1),v.fc("for",n.group.id),v.zb(1),v.gc("title",n.group.visible?"Hide Group":"Show Group"),v.fc("ngClass",v.jc(8,Dn,n.group.visible)),v.Ab("shape",n.group.visible?"eye":"eye-hide")}}function Vn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",2),v.Xb("click",function(){v.pc(r);var e=t.$implicit,n=v.Zb(2);return e.action(n.group)}),v.Pb()}if(2&e){var n=t.$implicit;v.fc("title",n.title),v.Ab("shape",n.icon)}}function Qn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",26),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.showAction=!e.showAction}),v.Pb()}if(2&e){var n=v.Zb(2);v.gc("title",n.showAction?"Hide settings":"Show settings"),v.fc("ngClass",v.jc(2,Dn,n.showAction))}}function Nn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",27),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.showInfo=!e.showInfo}),v.Pb()}if(2&e){var n=v.Zb(2);v.gc("title",n.showInfo?"Hide Info":"Show Info"),v.fc("ngClass",v.jc(2,Dn,n.showInfo))}}function Bn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",28),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.zoomTo(e.group)}),v.Pb()}}function Un(e,t){if(1&e){var r=v.Rb();v.Qb(0,"clr-icon",29),v.Xb("click",function(){v.pc(r);var e=v.Zb(2);return e.removeLayerGroup(e.group)}),v.Pb()}}function Wn(e,t){if(1&e&&(v.Qb(0,"div",30),v.Lb(1,"span",31),v.Pb()),2&e){var r=v.Zb(2);v.zb(1),v.fc("innerHTML",r.group.description,v.qc)}}function Zn(e,t){if(1&e){var r=v.Rb();v.Ob(0),v.Qb(1,"ukis-dynamic-component",33),v.Xb("dynamicComponentChange",function(e){return v.pc(r),v.Zb(3).group.action=e}),v.Pb(),v.Nb()}if(2&e){var n=v.Zb(3);v.zb(1),v.fc("dynamicComponent",n.group.action)}}function Hn(e,t){if(1&e&&(v.Qb(0,"div",32),v.wc(1,Zn,2,1,"ng-container",6),v.Pb()),2&e){var r=v.Zb(2);v.zb(1),v.fc("ngIf",r.checkIsComponentItem(r.group,"action"))}}var Xn=function(e){return{id:e}};function qn(e,t){if(1&e){var r=v.Rb();v.Ob(0),v.Qb(1,"div",34),v.Qb(2,"ukis-layerentry",35),v.Xb("update",function(e){v.pc(r);var t=v.Zb(2);return t.layerUpdate(e,t.group)}),v.Qb(3,"span",36),v.yc(4),v.Pb(),v.Pb(),v.Pb(),v.Nb()}if(2&e){var n=t.$implicit,a=v.Zb(2);v.zb(1),v.fc("cdkDragData",v.jc(7,Xn,n.id)),v.zb(1),v.fc("expanded",a.openAllLayersProperties)("layersSvc",a.layersSvc)("mapState",a.mapState)("layer",n)("group",a.group),v.zb(2),v.Ac(" ",n.displayName||n.name," ")}}function Yn(e,t){if(1&e){var r=v.Rb();v.Qb(0,"div",14),v.Qb(1,"div",15),v.wc(2,Vn,1,2,"clr-icon",16),v.wc(3,Qn,1,4,"clr-icon",17),v.wc(4,Nn,1,4,"clr-icon",18),v.Qb(5,"clr-icon",19),v.Xb("click",function(){return v.pc(r),v.Zb().showHideAllDetails()}),v.Pb(),v.Lb(6,"span"),v.wc(7,Bn,1,0,"clr-icon",20),v.wc(8,Un,1,0,"clr-icon",21),v.Pb(),v.wc(9,Wn,2,1,"div",22),v.wc(10,Hn,2,1,"div",23),v.Qb(11,"div",24),v.Xb("cdkDropListDropped",function(e){return v.pc(r),v.Zb().drop(e)}),v.ac(12,"reverse"),v.ac(13,"itemsfilter"),v.wc(14,qn,5,9,"ng-container",25),v.ac(15,"reverse"),v.ac(16,"itemsfilter"),v.Pb(),v.Pb()}if(2&e){var n=v.Zb();v.zb(2),v.fc("ngForOf",n.group.actions),v.zb(1),v.fc("ngIf",n.group.action),v.zb(1),v.fc("ngIf",n.group.description),v.zb(1),v.gc("title",n.openAllLayersProperties?"Hide all layers details":"Show all layers details"),v.fc("ngClass",v.jc(21,Dn,n.openAllLayersProperties)),v.zb(2),v.fc("ngIf",n.canZoomToGroup),v.zb(1),v.fc("ngIf",n.group.removable),v.zb(1),v.fc("ngIf",n.showInfo),v.zb(1),v.fc("ngIf",n.group.action&&n.showAction),v.zb(1),v.fc("cdkDropListData",v.bc(12,11,v.cc(13,13,n.group.layers,n.checkClassHide))),v.zb(3),v.fc("ngForOf",v.bc(15,16,v.cc(16,18,n.group.layers,n.checkClassHide)))}}var Kn,Jn=["*"],$n=((Kn=function(){function e(){f(this,e),this.canZoomToGroup=!1,this.showInfo=!1,this.showAction=!0}return h(e,[{key:"visible",get:function(){return this.group.visible}},{key:"cssClass",get:function(){return this.group.cssClass}},{key:"openAllLayersProperties",get:function(){return!(!this.group||!this.group.layers.length)&&this.group.layers.filter(function(e){return!0===e.expanded}).length===this.group.layers.length},set:function(e){this.group&&this.group.layers.length&&this.group.layers.forEach(function(t){return t.expanded=e})}},{key:"ngOnInit",value:function(){var e;this.group.bbox&&this.group.bbox.length>=4&&(this.canZoomToGroup=!0),(null===(e=this.group)||void 0===e?void 0:e.action)||(this.showAction=!1)}},{key:"checkIsComponentItem",value:function(e,t){var r=e[t],n=!1;if(r&&"object"==typeof r&&"component"in r){if(r.inputs){if(r.inputs&&!r.inputs.group){var a=Object.assign({__proto__:this.group.__proto__},e);a&&a[t]&&delete a[t],r.inputs=Object.assign({group:a},r.inputs)}}else{var i=Object.assign({__proto__:this.group.__proto__},e);i&&i[t]&&delete i[t],r.inputs={group:i}}n=!0}return n}},{key:"checkBaselayer",value:function(e){return!(!e||"Baselayers"!==e.filtertype)}},{key:"checkClassHide",value:function(e){var t;return!(null===(t=null==e?void 0:e.cssClass)||void 0===t?void 0:t.includes("hide"))}},{key:"getLayerName",value:function(e){return e.displayName?e.displayName:e.name}},{key:"setLayerGroupIndex",value:function(e,t){this.layersSvc.setGroupLayerIndex(e,t)}},{key:"setGroupLayersVisibility",value:function(){this.group.visible=!this.group.visible,this.layersSvc.updateLayerGroup(this.group)}},{key:"removeLayerGroup",value:function(e){this.layersSvc.removeLayerGroup(e)}},{key:"zoomTo",value:function(e){this.mapState&&e.bbox&&e.bbox.length>=4&&this.mapState.setExtent(e.bbox)}},{key:"layerUpdate",value:function(e,t){this.layersSvc.updateLayerGroup(t)}},{key:"showProperties",value:function(){this.group.expanded=!this.group.expanded}},{key:"showHideAllDetails",value:function(){this.openAllLayersProperties=!this.openAllLayersProperties,this.showAction=this.openAllLayersProperties,this.showInfo=this.openAllLayersProperties}},{key:"isFirst",value:function(e){return this.layersSvc.isGroupFirst(e,this.layerGroups,e.filtertype)}},{key:"isLast",value:function(e){return this.layersSvc.isGroupLast(e,this.layerGroups,e.filtertype)}},{key:"drop",value:function(e){var t,r,n=this.group.layers,a=n.length,i=e.container.data;if(a===i.length)t=a-e.previousIndex-1,r=a-e.currentIndex-1;else{var o=i[e.currentIndex],s=n.findIndex(function(t){return t.id===e.item.data.id}),c=n.findIndex(function(e){return e.id===o.id});e.previousIndex===e.currentIndex&&(c=s),t=s,r=c}Object(Kr.e)(this.group.layers,t,r),this.layersSvc.updateLayerGroup(this.group)}}]),e}()).\u0275fac=function(e){return new(e||Kn)},Kn.\u0275cmp=v.Eb({type:Kn,selectors:[["ukis-layerentry-group"]],hostVars:4,hostBindings:function(e,t){2&e&&(v.Bb(t.cssClass),v.Cb("group-visible",t.visible))},inputs:{layersSvc:"layersSvc",mapState:"mapState",group:"group",layerGroups:"layerGroups"},ngContentSelectors:Jn,decls:10,vars:7,consts:[[1,"layergroup"],[1,"head"],[1,"iconButton",3,"title","click"],[1,"item-title-replacement","title",3,"title","click"],["ref",""],["class","title",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","body",4,"ngIf"],[1,"title",3,"title","click"],["shape","arrow","title","up",1,"iconButton","move-item",3,"ngClass","click"],["shape","arrow","title","down","dir","down",1,"iconButton","move-item",3,"ngClass","click"],[1,"hide",3,"type","checked","name","id","change"],[3,"for"],[1,"iconButton",3,"ngClass","title"],[1,"body"],[1,"tools"],["class","iconButton",3,"title","click",4,"ngFor","ngForOf"],["shape","cog","class","iconButton",3,"ngClass","title","click",4,"ngIf"],["shape","info-standard","class","iconButton",3,"ngClass","title","click",4,"ngIf"],["shape","details",1,"iconButton",3,"ngClass","title","click"],["shape","zoom-in","class","iconButton","title","Zoom to group",3,"click",4,"ngIf"],["shape","trash","class","iconButton","title","Remove group",3,"click",4,"ngIf"],["class","info",4,"ngIf"],["class","tabsbody",4,"ngIf"],["cdkDropList","",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf"],["shape","cog",1,"iconButton",3,"ngClass","title","click"],["shape","info-standard",1,"iconButton",3,"ngClass","title","click"],["shape","zoom-in","title","Zoom to group",1,"iconButton",3,"click"],["shape","trash","title","Remove group",1,"iconButton",3,"click"],[1,"info"],[3,"innerHTML"],[1,"tabsbody"],[3,"dynamicComponent","dynamicComponentChange"],["cdkDragLockAxis","y","cdkDrag","",1,"sublayers",3,"cdkDragData"],[3,"expanded","layersSvc","mapState","layer","group","update"],["cdkDragHandle","",1,"move-item"]],template:function(e,t){if(1&e&&(v.ec(),v.Qb(0,"div",0),v.Qb(1,"div",1),v.Qb(2,"clr-icon",2),v.Xb("click",function(){return t.showProperties()}),v.Pb(),v.Qb(3,"div",3,4),v.Xb("click",function(){return t.showProperties()}),v.dc(5),v.Pb(),v.wc(6,Gn,2,2,"span",5),v.wc(7,jn,3,6,"span",6),v.wc(8,zn,4,10,"span",6),v.Pb(),v.wc(9,Yn,17,23,"div",7),v.Pb()),2&e){var r=v.lc(4);v.zb(2),v.gc("title",t.group.expanded?"Close":"Open"),v.Ab("shape",t.group.expanded?"folder-open":"folder"),v.zb(1),v.fc("title",t.getLayerName(t.group)),v.zb(3),v.fc("ngIf",0==r.children.length),v.zb(1),v.fc("ngIf",t.layerGroups.length>1),v.zb(1),v.fc("ngIf",!t.checkBaselayer(t.group)),v.zb(1),v.fc("ngIf",t.group.expanded)}},directives:[zt.n,Tt.n,Tt.l,zt.r,Tt.m,Kr.c,rn,Kr.a,In,Kr.b],pipes:[Fn,Mn],styles:[".title[_ngcontent-%COMP%]{cursor:pointer}.item-title-replacement[_ngcontent-%COMP%]:empty{display:none}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px;box-sizing:border-box;border-radius:2px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .sublayers[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.info[_ngcontent-%COMP%]{padding-left:.2rem}"]}),Kn);function ea(e,t){if(1&e&&(v.Qb(0,"ukis-layerentry-group",5),v.Qb(1,"span",6),v.yc(2),v.Pb(),v.Pb()),2&e){var r=v.Zb().$implicit,n=v.Zb();v.fc("layersSvc",n.layersSvc)("mapState",n.mapStateSvc)("group",r)("layerGroups",n.layergroups),v.zb(2),v.Ac(" ",r.displayName||r.name," ")}}function ta(e,t){if(1&e&&(v.Qb(0,"ukis-layerentry",7),v.Qb(1,"span",6),v.yc(2),v.Pb(),v.Pb()),2&e){var r=v.Zb().$implicit,n=v.Zb();v.fc("layerGroups",n.layergroups)("expanded",!1)("layersSvc",n.layersSvc)("mapState",n.mapStateSvc)("layer",r)("group",null),v.zb(2),v.Ac(" ",r.displayName||r.name," ")}}var ra=function(e){return{id:e}};function na(e,t){if(1&e&&(v.Ob(0),v.Qb(1,"div",2),v.wc(2,ea,3,5,"ukis-layerentry-group",3),v.wc(3,ta,3,7,"ukis-layerentry",4),v.Pb(),v.Nb()),2&e){var r=t.$implicit,n=v.Zb();v.zb(1),v.fc("cdkDragData",v.jc(3,ra,r.id)),v.zb(1),v.fc("ngIf",n.isLayerGroup(r)&&r.filtertype===n.layerfilter),v.zb(1),v.fc("ngIf",!n.isLayerGroup(r)&&r.filtertype===n.layerfilter)}}var aa,ia=((aa=function(){function e(){f(this,e),this.layerfilter="Layers",this.layergroups=[]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.layerGroupsSubscription=this.layersSvc.getLayerGroups().subscribe(function(t){e.layergroups=t})}},{key:"isLayerGroup",value:function(e){return e instanceof R}},{key:"ngOnDestroy",value:function(){this.layerGroupsSubscription.unsubscribe()}},{key:"drop",value:function(e){var t,r,n=this.layergroups,a=n.length,i=e.container.data;if(a===i.length)t=a-e.previousIndex-1,r=a-e.currentIndex-1;else{var o=i[e.currentIndex],s=n.findIndex(function(t){return t.id===e.item.data.id}),c=n.findIndex(function(e){return e.id===o.id});e.previousIndex===e.currentIndex&&(c=s),t=s,r=c}this.layersSvc.arrayMove(this.layergroups,t,r),this.layersSvc.setLayerGroups(this.layergroups)}},{key:"checkBaselayer",value:function(e,t){return!!("Baselayers"===e.filtertype||t&&"Baselayers"===t.filtertype)}},{key:"checkClassHide",value:function(e){var t;return!(null===(t=null==e?void 0:e.cssClass)||void 0===t?void 0:t.includes("hide"))}}]),e}()).\u0275fac=function(e){return new(e||aa)},aa.\u0275cmp=v.Eb({type:aa,selectors:[["ukis-layer-control"]],inputs:{layersSvc:"layersSvc",mapStateSvc:"mapStateSvc",layerfilter:"layerfilter"},decls:6,vars:12,consts:[["cdkDropList","",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf"],["cdkDragLockAxis","y","cdkDrag","",1,"list-item",3,"cdkDragData"],[3,"layersSvc","mapState","group","layerGroups",4,"ngIf"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group",4,"ngIf"],[3,"layersSvc","mapState","group","layerGroups"],["cdkDragHandle","",1,"move-item"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group"]],template:function(e,t){1&e&&(v.Qb(0,"div",0),v.Xb("cdkDropListDropped",function(e){return t.drop(e)}),v.ac(1,"reverse"),v.ac(2,"itemsfilter"),v.wc(3,na,4,5,"ng-container",1),v.ac(4,"reverse"),v.ac(5,"itemsfilter"),v.Pb()),2&e&&(v.fc("cdkDropListData",v.bc(1,2,v.cc(2,4,t.layergroups,t.checkClassHide))),v.zb(3),v.fc("ngForOf",v.bc(4,7,v.cc(5,9,t.layergroups,t.checkClassHide))))},directives:[Kr.c,Tt.m,Kr.a,Tt.n,$n,Kr.b,In],pipes:[Fn,Mn],styles:[".list-item[_ngcontent-%COMP%]{cursor:pointer}.move-item[_ngcontent-%COMP%]{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px 10px;box-sizing:border-box;border-radius:2px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),aa);function oa(e,t){if(1&e&&v.Lb(0,"ukis-layerentry-group",4),2&e){var r=v.Zb().$implicit,n=v.Zb();v.fc("layersSvc",n.layersSvc)("mapState",n.mapStateSvc)("group",r)("layerGroups",n.layergroups)}}function sa(e,t){if(1&e&&v.Lb(0,"ukis-layerentry",5),2&e){var r=v.Zb().$implicit,n=v.Zb();v.fc("layerGroups",n.layergroups)("expanded",!1)("layersSvc",n.layersSvc)("mapState",n.mapStateSvc)("layer",r)("group",null)}}function ca(e,t){if(1&e&&(v.Qb(0,"div",1),v.wc(1,oa,1,4,"ukis-layerentry-group",2),v.wc(2,sa,1,6,"ukis-layerentry",3),v.Pb()),2&e){var r=t.$implicit,n=v.Zb();v.zb(1),v.fc("ngIf",n.isLayerGroup(r)),v.zb(1),v.fc("ngIf",!n.isLayerGroup(r))}}var la,ua,pa,fa=((pa=function(){function e(){f(this,e),this.layergroups=[]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.layerGroupsSubscription=this.layersSvc.getLayerGroups().subscribe(function(t){e.layergroups=t.filter(function(e){return"Baselayers"===e.filtertype})})}},{key:"isLayerGroup",value:function(e){return e instanceof R}},{key:"ngOnDestroy",value:function(){this.layerGroupsSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||pa)},pa.\u0275cmp=v.Eb({type:pa,selectors:[["ukis-base-layer-control"]],inputs:{layersSvc:"layersSvc",mapStateSvc:"mapStateSvc"},decls:2,vars:3,consts:[["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],[3,"layersSvc","mapState","group","layerGroups",4,"ngIf"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group",4,"ngIf"],[3,"layersSvc","mapState","group","layerGroups"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group"]],template:function(e,t){1&e&&(v.wc(0,ca,3,2,"div",0),v.ac(1,"reverse")),2&e&&v.fc("ngForOf",v.bc(1,1,t.layergroups))},directives:[Tt.m,Tt.n,$n,In],pipes:[Fn],styles:[""]}),pa),da=((ua=function(){function e(t){f(this,e),this.owcSvc=t,this.baselayers=[],this.overlays=[],this.layers=[],this.sub=[]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.sub.push(this.layerSvc.getBaseLayers().subscribe(function(t){e.baselayers=t})),this.sub.push(this.layerSvc.getOverlays().subscribe(function(t){e.overlays=t})),this.layerSvc.getLayers().subscribe(function(t){e.layers=t}),this.sub.push(this.mapStateSvc.getExtent().subscribe(function(t){e.extent=t})),this.sub.push(this.mapStateSvc.getMapState().subscribe(function(t){e.state=t}))}},{key:"ngOnDestroy",value:function(){this.sub.map(function(e){return e.unsubscribe()})}},{key:"onClickExport",value:function(){var e="myContext",r=this.owcSvc.generateOwsContextFrom(e,[].concat(t(this.baselayers),t(this.overlays),t(this.layers)),this.extent);this.downloadFile(r,"".concat(e,".json"))}},{key:"downloadFile",value:function(e,t){var r=JSON.stringify(e),n=new Blob([r],{type:"text/json;charset=utf-8;"}),a=window.URL.createObjectURL(n),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=a,i.download=t,i.click(),window.URL.revokeObjectURL(a),document.body.removeChild(i)}}]),e}()).\u0275fac=function(e){return new(e||ua)(v.Kb(qr))},ua.\u0275cmp=v.Eb({type:ua,selectors:[["ukis-owc-control"]],inputs:{layerSvc:"layerSvc",mapStateSvc:"mapStateSvc"},decls:2,vars:0,consts:[[1,"btn",3,"click"]],template:function(e,t){1&e&&(v.Qb(0,"button",0),v.Xb("click",function(){return t.onClickExport()}),v.yc(1,"Export map as OWC"),v.Pb())},encapsulation:2}),ua),ha=((la=function(){function e(t,r,n,a){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.mapSvc=n,this.wmsSvc=a,this.class="content-container",this.controls={attribution:!0,scaleLine:!0}}return h(e,[{key:"ngOnInit",value:function(){this.mapSvc.map.addControl(new Dt),this.addBaseLayers(),this.addLayers(),this.addOverlays(),this.setExtent()}},{key:"setExtent",value:function(){this.mapStateSvc.setExtent([-14,33,40,57])}},{key:"parseCapabilities",value:function(){var e=this;this.wmsSvc.getCapabilities("https://geoservice.dlr.de/eoc/land/wms").subscribe(function(t){var r=e.wmsSvc.getLayerFromCapabilities("AGRODE_S2_EVI_P1M",t);console.log(r)})}},{key:"addBaseLayers",value:function(){var e=this;[new T({name:"Transparenter Hintergrund",id:"blank",type:"geojson",visible:!0}),new B({visible:!1}),new I({type:"wmts",url:"https://tiles.geoservice.dlr.de/service/wmts",name:"Relief",id:"world_relief_bw",params:{layer:"eoc:world_relief_bw",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},visible:!1,description:"eoc:world_relief_bw as web map tile service",attribution:'Relief: <a src="https://www.dlr.de/eoc">DLR/EOC</>',legendImg:""}),new V({id:"OSM_Base"})].map(function(t){return e.layersSvc.addLayer(t,"Baselayers")})}},{key:"addLayers",value:function(){var e=this,t=new O({type:"wms",url:"https://geoservice.dlr.de/eoc/land/wms",name:"GUF Mosaic",id:"GUF28_DLR_v1_Mosaic",params:{LAYERS:"GUF28_DLR_v1_Mosaic",STYLES:"guf_8bit"},tileSize:512,visible:!1,description:"GUF28_DLR_v1_Mosaic",attribution:' | GUF\xae: <a href="https://www.dlr.de/eoc/en/desktopdefault.aspx/tabid-9628/16557_read-40454/">DLR License</a>',legendImg:"",popup:{asyncPupup:function(t,r){!function(e,t,r){var n=e.source,a=e.evt,i=t.map.getView().getResolution(),o=n.getFeatureInfoUrl(a.coordinate,i,t.EPSG,{INFO_FORMAT:"application/json"});fetch(o).then(function(e){return e.json()}).catch(function(e){console.log(e)}).then(function(e){if(e.features.length){var n=t.createPopupHtml(e.features[0].properties);r(n)}else r("<p>No Data!</p>")})}(t,e.mapSvc,r)}}}),r=new I({type:"wmts",url:"https://tiles.geoservice.dlr.de/service/wmts",name:"TDM90 DEM",id:"TDM90_DEM",params:{layer:"TDM90_DEM",style:"default",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"},format:"image/png"},visible:!1,maxZoom:8,description:"TDM90_DEM maxZoom: 8",attribution:' | TDM90 Data \xa9: <a href="http://www.dlr.de" target="_blank">DLR</a>  licensed for <a rel="license" target="_blank" href="https://geoservice.dlr.de/resources/licenses/tdm90/License_for_the_Utilization_of_90m_DEM_for_Scientific_Use.pdf">scientific use</a>',legendImg:"",expanded:!0,cssClass:"custom-layer"}),n=new T({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Polygon"},geometry:{type:"Polygon",coordinates:[[[11.53564453125,48.80686346108517],[11.42578125,48.61838518688487],[11.97509765625,48.516604348867475],[12.2607421875,48.69096039092549],[12.0849609375,48.99463598353405],[11.53564453125,48.80686346108517]]]}},{type:"Feature",properties:{title:"Rectangle"},geometry:{type:"Polygon",coordinates:[[[10.986328125,43.89789239125797],[11.755371093749998,43.89789239125797],[11.755371093749998,44.41808794374846],[10.986328125,44.41808794374846],[10.986328125,43.89789239125797]]]}},{type:"Feature",properties:{title:"Line"},geometry:{type:"LineString",coordinates:[[13.29345703125,48.268569112964336],[15.073242187499998,47.56170075451973],[14.1064453125,46.40756396630067],[15.886230468750002,44.94924926661153]]}},{type:"Feature",properties:{title:"Point"},geometry:{type:"Point",coordinates:[11.513671874999998,46.42271253466717]}}]},visible:!1,popup:{event:"move",dynamicPopup:{component:Ut,getAttributes:function(e){return{data:e.properties}}}}}),a=new T({id:"geojson_test_3",name:"GeoJSON Point Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Munich",type:"City",image:"https://en.wikipedia.org/wiki/Munich#/media/File:Stadtbild_M%C3%BCnchen.jpg",wiki:"https://en.wikipedia.org/wiki/Munich"},geometry:{type:"Point",coordinates:[11.557617187499998,48.151428143221224]}}]},visible:!1,popup:{properties:{title:"Title",type:"Type"}}}),i=new T({id:"geojson_test_2",name:"Vector Layer in Group",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{type:"Polygon",name:"Vector Layer in Group",data:"geojson"},geometry:{type:"Polygon",coordinates:[[[-4.9658203125,41.09591205639546],[-6.459960937499999,39.52099229357195],[-5.009765625,38.42777351132902],[-1.8896484375,38.77121637244273],[-.68115234375,40.84706035607122],[-2.900390625,41.65649719441145],[-4.9658203125,41.09591205639546]]]}}]},visible:!1,cssClass:"hide",popup:["type","name"],actions:[{title:"download",icon:"download-cloud",action:function(e){console.log(e)}}]}),o=new T({id:"geojson_test_cluster",name:"Cluster - GeoJSON Vector Layer",type:"geojson",cluster:{distance:20},data:Wt,visible:!0,actions:[{title:"update Layer",icon:"sync",action:function(t){t.cluster.distance=25,t.options||(t.options={}),t.options.style=function(e){var t=e.get("features").length;return new Le.b({image:new Te.a({radius:t<=1?6:10,stroke:new Ce.a({color:"#fff"}),fill:new Oe.a({color:t<=1?"green":"red"})})})},e.layersSvc.updateLayer(t)}}],popup:{pupupFunktion:function(e){return"<div>".concat(JSON.stringify(e)," </div>")}}}),s=new T({id:"WfsLayer",name:"WFS Layer",type:"wfs",url:"https://ahocevar.com/geoserver/wfs?service=WFS&request=GetFeature&outputFormat=application/json&version=1.1.0&srsname=EPSG:3857&typenames=usa:states&cql_filter=STATE_NAME='Pennsylvania'",bbox:[-83.1005859375,38.37611542403604,-72.50976562499999,43.03677585761058]}),c=new W;c.cssClass="hide";var l=new Z,u=new U,p=new V,f=new R({id:"group_1",name:"Test Group",layers:[p,c,l],description:"this is a group with OsmLayer, eocBasemap, eocBaseoverlay",actions:[{title:"download",icon:"download-cloud",action:function(e){console.log(e)}}]}),d=new R({id:"group_2",name:"Test Group 2",expanded:!0,cssClass:"custom-layer-group",layers:[r,i,u]}),h=new R({id:"group_3",name:"Test Group Vector-Data",expanded:!1,layers:[n,a,s]});[t,new q({popup:{pupupFunktion:function(e){return'\n            <table>\n              <tbody>\n                <tr>\n                  <td style="vertical-align: top; padding-right: 7px;"><b>Name: '.concat(e.name,'</b></td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td style="vertical-align: top; padding-right: 7px;"><b>type: ').concat(e.type,'</b></td>\n                  <td></td>\n                </tr>\n              </tbody>\n            </table>\n            <img src="').concat(e.legendImg,'">\n            ')}}}),h,d,f,o].map(function(t){t instanceof E?e.layersSvc.addLayer(t,"Layers"):t instanceof R&&e.layersSvc.addLayerGroup(t)})}},{key:"addOverlays",value:function(){var e=new H({crossOrigin:"anonymous"}),t=new Q({crossOrigin:"anonymous"});this.layersSvc.addLayer(e,"Overlays"),this.layersSvc.addLayer(t,"Overlays")}},{key:"updateLayerGroup",value:function(){var e=this.layersSvc.getLayerOrGroupById("group_1");e.expanded=!0,e.layers[1].cssClass=null,this.layersSvc.updateLayerGroup(e);var t=this.layersSvc.getLayerOrGroupById("group_2");t.layers[1].visible=!0,this.layersSvc.updateLayerGroup(t)}},{key:"addLayerToGroup",value:function(){var e=this.layersSvc.getLayerOrGroupById("group_2"),t=new X;this.layersSvc.addLayerToGroup(t,e)}},{key:"removeAllLayers",value:function(){this.layersSvc.removeLayers()}}]),e}()).\u0275fac=function(e){return new(e||la)(v.Kb(G),v.Kb(z),v.Kb(bt),v.Kb(Ir))},la.\u0275cmp=v.Eb({type:la,selectors:[["app-route-map"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:37,vars:18,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","world","title","Overlays","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc","layerfilter"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""],["shape","cog","title","Actions","clrVerticalNavIcon",""],[1,"btn","btn-primary",3,"click"],["shape","export","title","Export","clrVerticalNavIcon",""],[3,"layerSvc","mapStateSvc"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Overlays "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",3),v.Lb(9,"clr-icon",7),v.yc(10," Layers "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-layer-control",8),v.Pb(),v.Pb(),v.Qb(13,"clr-vertical-nav-group",3),v.Lb(14,"clr-icon",9),v.yc(15," Baselayers "),v.Qb(16,"clr-vertical-nav-group-children",5),v.Lb(17,"ukis-base-layer-control",8),v.Pb(),v.Pb(),v.Qb(18,"clr-vertical-nav-group",3),v.Lb(19,"clr-icon",10),v.yc(20," Actions "),v.Qb(21,"clr-vertical-nav-group-children",5),v.Qb(22,"button",11),v.Xb("click",function(){return t.updateLayerGroup()}),v.yc(23,"update LayerGroup"),v.Pb(),v.Qb(24,"button",11),v.Xb("click",function(){return t.addLayerToGroup()}),v.yc(25,"add Layer to LayerGroup"),v.Pb(),v.Qb(26,"button",11),v.Xb("click",function(){return t.removeAllLayers()}),v.yc(27,"remove All Layers"),v.Pb(),v.Qb(28,"button",11),v.Xb("click",function(){return t.setExtent()}),v.yc(29,"set Extent"),v.Pb(),v.Qb(30,"button",11),v.Xb("click",function(){return t.parseCapabilities()}),v.yc(31,"Parse WMS capabilities"),v.Pb(),v.Pb(),v.Pb(),v.Qb(32,"clr-vertical-nav-group"),v.Lb(33,"clr-icon",12),v.yc(34," OWC Control "),v.Qb(35,"clr-vertical-nav-group-children",5),v.Lb(36,"ukis-owc-control",13),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc)("layerfilter","Overlays"),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(18),v.fc("layerSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia,fa,da],styles:["[_nghost-%COMP%]     .custom-layer-group .head>.title{color:#660f00}[_nghost-%COMP%]     .custom-layer .head>.title{color:#b87d00}[_nghost-%COMP%]     .zoom-number{bottom:2.5em;left:8px}"]}),la),va=function(e){return{"is-solid":e}};function ya(e,t){if(1&e){var r=v.Rb();v.Qb(0,"div",2),v.Xb("click",function(){v.pc(r);var e=t.$implicit;return v.Zb(2).setNewProjection(e)}),v.Qb(1,"div",3),v.Qb(2,"div",4),v.Qb(3,"span",5),v.Xb("click",function(){v.pc(r);var e=t.$implicit;return v.Zb(2).setNewProjection(e)}),v.yc(4),v.Pb(),v.Lb(5,"clr-icon",6),v.Pb(),v.Pb(),v.Pb()}if(2&e){var n=t.$implicit,a=v.Zb(2);v.zb(3),v.fc("title",n.title),v.zb(1),v.Ac(" ",n.title||n.code," "),v.zb(1),v.gc("title",n.code),v.fc("ngClass",v.jc(5,va,n===a.selectedProj)),v.Ab("shape",n===a.selectedProj?"eye":"eye-hide")}}function ma(e,t){if(1&e&&(v.Qb(0,"div"),v.wc(1,ya,6,7,"div",1),v.Pb()),2&e){var r=v.Zb();v.zb(1),v.fc("ngForOf",r.projList)}}var ba,ga=((ba=function(){function e(){f(this,e)}return h(e,[{key:"ngOnInit",value:function(){this.projList[0]&&this.setNewProjection(this.projList[0])}},{key:"setNewProjection",value:function(e){this.mapSvc.registerProjection(e);var t=this.mapSvc.getOlProjection(e);this.mapSvc.setProjection(t),this.selectedProj=e}}]),e}()).\u0275fac=function(e){return new(e||ba)},ba.\u0275cmp=v.Eb({type:ba,selectors:[["ukis-projection-switch"]],inputs:{mapSvc:"mapSvc",projList:["projectionList","projList"]},decls:1,vars:1,consts:[[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"layergroup"],[1,"head"],[1,"title",3,"title","click"],[1,"iconButton",3,"ngClass","title"]],template:function(e,t){1&e&&v.wc(0,ma,2,1,"div",0),2&e&&v.fc("ngIf",t.projList)},directives:[Tt.n,Tt.m,zt.n,Tt.l],encapsulation:2}),ba);function wa(e,t){if(1&e&&(v.Qb(0,"option",9),v.yc(1),v.Pb()),2&e){var r=t.$implicit;v.fc("value",r.value),v.zb(1),v.zc(r.title)}}var Sa,xa,Pa,ka,_a,La,Ea,Oa,Ta=((Pa=function(){function e(t){var r=this;f(this,e),this.mapSvc=t,this.mapCoordinates=[0,0],this.zoom=0,this.precision=2,this.x="Lon",this.y="Lat",this.mapMoveSubscription=function(e){e.coordinate&&(r.mapCoordinates=Object(we.q)(e.coordinate,r.mapProjection,Object(we.i)(r.selectedProjection)))},this.mapOnMoveend=function(e){var t=e.map.getView().getZoom();r.zoom!==t&&(r.zoom=t)},this.mapSub=this.mapSvc.projectionChange.subscribe(function(e){r.mapProjection=e,r.setProjection(e)})}return h(e,[{key:"ngOnInit",value:function(){this.mapSvc.map.on("pointermove",this.mapMoveSubscription),this.mapSvc.map.on("moveend",this.mapOnMoveend)}},{key:"setProjection",value:function(e){var t=e.getCode();this.projections="EPSG:4326"===t?[{title:t,value:t}]:[{title:"EPSG:4326",value:"EPSG:4326"},{title:t,value:t}],this.selectedProjection=this.projections[0].value}},{key:"ngOnDestroy",value:function(){this.mapSvc.map.un("pointermove",this.mapMoveSubscription),this.mapSvc.map.un("moveend",this.mapOnMoveend),this.mapSub.unsubscribe()}},{key:"onChangeProj",value:function(e){"EPSG:4326"===e?(this.x="Lon",this.y="Lat"):(this.x="X",this.y="Y");var t=this.selectedProjection;this.selectedProjection=e,this.mapCoordinates=Object(we.q)(this.mapCoordinates,Object(we.i)(t),Object(we.i)(this.selectedProjection))}},{key:"toPrecision",value:function(e,t){return e.toFixed(t)}}]),e}()).\u0275fac=function(e){return new(e||Pa)(v.Kb(bt))},Pa.\u0275cmp=v.Eb({type:Pa,selectors:[["ukis-mouse-position"]],decls:27,vars:7,consts:[[1,"mouse-position-control"],[1,"clr-row"],[1,"clr-col-7"],[1,"output-container"],[1,"clr-col-5"],[1,"input-container"],["clrSelect","",3,"change"],[3,"value",4,"ngFor","ngForOf"],["type","number","min","0","max","12","name","precision","clrInput","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(e,t){1&e&&(v.Qb(0,"div",0),v.Qb(1,"div",1),v.Qb(2,"div",2),v.Qb(3,"div",3),v.Qb(4,"div"),v.Qb(5,"b"),v.yc(6),v.Pb(),v.yc(7),v.Pb(),v.Qb(8,"div"),v.Qb(9,"b"),v.yc(10),v.Pb(),v.yc(11),v.Pb(),v.Qb(12,"div"),v.Qb(13,"b"),v.yc(14,"Zoom"),v.Pb(),v.yc(15),v.Pb(),v.Pb(),v.Pb(),v.Qb(16,"div",4),v.Qb(17,"div",5),v.Qb(18,"clr-select-container"),v.Qb(19,"label"),v.yc(20,"Projection "),v.Pb(),v.Qb(21,"select",6),v.Xb("change",function(e){return t.onChangeProj(e.target.value)}),v.wc(22,wa,2,2,"option",7),v.Pb(),v.Pb(),v.Qb(23,"clr-input-container"),v.Qb(24,"label"),v.yc(25,"Precision "),v.Pb(),v.Qb(26,"input",8),v.Xb("ngModelChange",function(e){return t.precision=e}),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(6),v.zc(t.x),v.zb(1),v.Ac(" ",t.toPrecision(t.mapCoordinates[0],t.precision),""),v.zb(3),v.zc(t.y),v.zb(1),v.Ac(" ",t.toPrecision(t.mapCoordinates[1],t.precision),""),v.zb(4),v.Ac(" ",t.toPrecision(t.zoom,t.precision),""),v.zb(7),v.fc("ngForOf",t.projections),v.zb(4),v.fc("ngModel",t.precision))},directives:[zt.y,zt.r,zt.x,Tt.m,zt.q,nn.p,nn.b,zt.p,nn.j,nn.m,nn.o,nn.x],styles:[".mouse-position-control[_ngcontent-%COMP%]{margin-left:.2rem;padding-bottom:.4rem}.mouse-position-control[_ngcontent-%COMP%]   .output-container[_ngcontent-%COMP%]{line-height:1.6rem}.mouse-position-control[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]:first-child{margin-top:0}"]}),Pa),Ca=((xa=function(){function e(){f(this,e),this.inputStep=.01,this.precision=2}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.subscription=this.mapState.getMapState().subscribe(function(t){e.mapstate=t})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"zoomIn",value:function(){this.mapstate.zoom++,this.setNewState(this.mapstate)}},{key:"zoomOut",value:function(){this.mapstate.zoom--,this.setNewState(this.mapstate)}},{key:"setNewState",value:function(e){e.options.notifier="user",this.mapState.setMapState(e)}},{key:"stateChange",value:function(e){this.setNewState(this.mapstate)}},{key:"setInputStep",value:function(e){var t=Array.from(Array(e),function(e,t){return"0"}).join("");this.inputStep=1/Number("1".concat(t))}},{key:"toPrecision",value:function(e,t){return e.toFixed(t)}}]),e}()).\u0275fac=function(e){return new(e||xa)},xa.\u0275cmp=v.Eb({type:xa,selectors:[["ukis-map-navigator"]],inputs:{mapState:"mapState"},decls:22,vars:7,consts:[[1,"clr-row"],[1,"clr-col-9"],[1,"output-container"],["clrForm",""],["clrInput","","type","number","name","lon",3,"ngModel","step","ngModelChange"],["clrInput","","type","number","name","lat",3,"ngModel","step","ngModelChange"],["clrInput","","type","number","name","zoom",3,"ngModel","step","ngModelChange"],[1,"clr-col-3"],[1,"input-container"],["type","number","min","0","max","8","step","1","name","precision","clrInput","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(v.Qb(0,"div",0),v.Qb(1,"div",1),v.Qb(2,"div",2),v.Qb(3,"form",3),v.Qb(4,"clr-input-container"),v.Qb(5,"label"),v.yc(6,"Lon"),v.Pb(),v.Qb(7,"input",4),v.Xb("ngModelChange",function(e){return t.mapstate.center.lon=e})("ngModelChange",function(e){return t.stateChange(e)}),v.Pb(),v.Pb(),v.Qb(8,"clr-input-container"),v.Qb(9,"label"),v.yc(10,"Lat"),v.Pb(),v.Qb(11,"input",5),v.Xb("ngModelChange",function(e){return t.mapstate.center.lat=e})("ngModelChange",function(e){return t.stateChange(e)}),v.Pb(),v.Pb(),v.Qb(12,"clr-input-container"),v.Qb(13,"label"),v.yc(14,"Zoom"),v.Pb(),v.Qb(15,"input",6),v.Xb("ngModelChange",function(e){return t.mapstate.zoom=e})("ngModelChange",function(e){return t.stateChange(e)}),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Qb(16,"div",7),v.Qb(17,"div",8),v.Qb(18,"clr-input-container"),v.Qb(19,"label"),v.yc(20,"Precision "),v.Pb(),v.Qb(21,"input",9),v.Xb("ngModelChange",function(e){return t.precision=e})("ngModelChange",function(e){return t.setInputStep(e)}),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(7),v.fc("ngModel",t.mapstate.center.lon)("step",t.inputStep),v.zb(4),v.fc("ngModel",t.mapstate.center.lat)("step",t.inputStep),v.zb(4),v.fc("ngModel",t.mapstate.zoom)("step",t.inputStep),v.zb(6),v.fc("ngModel",t.precision))},directives:[nn.w,nn.k,nn.l,zt.l,zt.q,zt.r,nn.p,nn.b,zt.p,nn.j,nn.m],styles:[".output-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]:first-child{margin-top:0}.output-container[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:90%}"]}),xa),Ra=((Sa=function(){function e(t,r,n){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.mapSvc=n,this.class="content-container",this.controls={attribution:!0,scaleLine:!0},this.projections=[{code:"EPSG:3857",proj4js:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",title:"Spherical Mercator",extent:[-20026376.39,-20048966.1,20026376.39,20048966.1],worldExtent:[-180,-85.06,180,85.06],global:!0,units:"m"},{code:"EPSG:3995",proj4js:"+proj=stere +lat_0=90 +lat_ts=71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs",title:"Arctic Polar Stereographic",extent:[-20048966.1,-20048966.1,20048966.1,20048966.1],worldExtent:[-180,60,180,90],global:!1,units:"m"},{code:"EPSG:3031",proj4js:"+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs",title:"Antarctic Polar Stereographic",extent:[-20048966.1,-20048966.1,20048966.1,20048966.1],worldExtent:[-180,-90,180,-60],global:!1,units:"m"}],this.addOverlays(),this.mapStateSvc.setExtent([-14,33,40,57])}return h(e,[{key:"ngOnInit",value:function(){}},{key:"addOverlays",value:function(){var e=this;[new V({removable:!0,legendImg:null,visible:!0,id:"osm"}),new O({type:"wms",url:"https://geoservice.dlr.de/eoc/land/wms",name:"GUF Mosaic",id:"GUF28_DLR_v1_Mosaic",params:{layers:"GUF28_DLR_v1_Mosaic",styles:"guf_8bit"},visible:!1,description:"GUF28_DLR_v1_Mosaic",attribution:' | GUF\xae: <a href="https://www.dlr.de/eoc/en/desktopdefault.aspx/tabid-9628/16557_read-40454/">DLR License</a>',legendImg:""}),new T({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[12.65625,49.61070993807422],[20.698242187499996,46.830133640447386],[22.5,49.781264058178344],[15.161132812500002,51.508742458803326],[12.65625,49.61070993807422]]]}}]},visible:!0})].map(function(t){return e.layersSvc.addLayer(t,"Layers")})}}]),e}()).\u0275fac=function(e){return new(e||Sa)(v.Kb(G),v.Kb(z),v.Kb(bt))},Sa.\u0275cmp=v.Eb({type:Sa,selectors:[["app-route-map2"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:23,vars:14,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","Projection",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","map","clrVerticalNavIcon",""],[3,"mapSvc","projectionList"],["title","Coordinates",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","compass","clrVerticalNavIcon",""],["title","Navigator",1,"layers",3,"clrVerticalNavGroupExpanded"],[3,"mapState"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Layers "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",7),v.Lb(9,"clr-icon",8),v.yc(10," Projection "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-projection-switch",9),v.Pb(),v.Pb(),v.Qb(13,"clr-vertical-nav-group",10),v.Lb(14,"clr-icon",11),v.yc(15," Coordinates "),v.Qb(16,"clr-vertical-nav-group-children",5),v.Lb(17,"ukis-mouse-position"),v.Pb(),v.Pb(),v.Qb(18,"clr-vertical-nav-group",12),v.Lb(19,"clr-icon",11),v.yc(20," Navigator "),v.Qb(21,"clr-vertical-nav-group-children",5),v.Lb(22,"ukis-map-navigator",13),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("mapSvc",t.mapSvc)("projectionList",t.projections),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(5),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("mapState",t.mapStateSvc))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia,ga,Ta,Ca],styles:[""]}),Sa),Ia=s("k9Tt"),Fa=s("CxY0"),Ma=s("Nr0W"),Ga=s("gOFd"),Aa=s("SxV6"),ja=s("JF1W"),Da=((_a=function(){function e(){f(this,e),this.progressSource=new Fe.a,this.progress$=this.progressSource.asObservable()}return h(e,[{key:"progress",value:function(e){this.progressSource.next(e)}}]),e}()).\u0275fac=function(e){return new(e||_a)},_a.\u0275prov=v.Gb({token:_a,factory:_a.\u0275fac,providedIn:"root"}),_a),za=((ka=function(){function e(t,r,n,a,i){var o=this;f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.mapSvc=n,this.progressService=a,this.route=i,this.class="content-container",this.subs=[],this.startBbox=null,this.updateLayerOnZoom=function(e){var t=o.mapStateSvc.getMapState().getValue(),r=function(e,t,r,n,a){var i=[],o=80;r>1&&(o=40),r>2&&(o=20),r>3&&(o=10),r>4&&(o=6),r>5&&(o=4),r>6&&(o=3),r>7&&(o=2),r>8&&(o=1);var s=.5*o,c=10;c>10&&(c=10),a=Object(Pe.d)(a,s);for(var l=e[0]+c,u=e[1]+c,p=e[3]-c-u,f=Math.floor((e[2]-c-l)/s),d=Math.floor(p/s),h=l,v=f;v>0;v--){for(var y=u,m=d;m>0;m--){var b=h+s,g=y+s,w=[h,y],S=[[w,[h,g],[b,g],[b,y],w]];if(console.log(),Object(Pe.i)(a,h,y)&&Object(Pe.i)(a,b,g)){var x=new Ga.a(S).transform("EPSG:4326",n),P=new Ma.a({geometry:x,column:v,row:m,id:i.length+1});i.push(P)}y+=s}h+=s}return i}([-180,-90,180,90],0,t.zoom,o.mapSvc.EPSG,t.extent),n=new he.a({features:r,wrapX:!1}),a=new Ia.a({id:"gridLayer",source:n}),i=o.layersSvc.getLayerById("gridLayer");if(i)i.custom_layer=a,o.layersSvc.updateLayer(i,i.filtertype);else{var s=new C({id:"gridLayer",name:"gridLayer",type:"custom",opacity:.3,custom_layer:a});o.layersSvc.addLayer(s,"Layers")}},this.controls={attribution:!0,scaleLine:!0}}return h(e,[{key:"ngOnInit",value:function(){this.addLayers(),this.subscribeToMapState(),this.subscribeToRoute(),this.startBbox&&this.mapStateSvc.setExtent(this.startBbox)}},{key:"ngAfterViewInit",value:function(){this.mapSvc.map.on("moveend",this.updateLayerOnZoom)}},{key:"ngOnDestroy",value:function(){this.subs.map(function(e){return e.unsubscribe()}),this.mapSvc.map.un("moveend",this.updateLayerOnZoom)}},{key:"addLayers",value:function(){var e=this,t=new V({visible:!0}),r=new ce.a({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"});r.on("imageloadstart",function(){e.progressService.progress({indeterminate:!0})}),r.on("imageloadend",function(){e.progressService.progress(null)}),r.on("imageloaderror",function(){e.progressService.progress(null)});var n=new C({id:"event_layer",name:"Image load Layer",type:"custom",custom_layer:new je.a({source:r}),visible:!1,bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),a=new T({id:"updatable_feature_layer",name:"Updatable feature layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-192.48046875,-24.686952411999144],[-88.06640625,-24.686952411999144],[-88.06640625,50.28933925329178],[-192.48046875,50.28933925329178],[-192.48046875,-24.686952411999144]]]}}]},actions:[{action:function(t){a.data=ja,e.layersSvc.updateLayer(a)},icon:"download",title:"Load data"}]});[t,n,a].forEach(function(t){return e.layersSvc.addLayer(t,"Layers")})}},{key:"updateSearchParamsHashRouting",value:function(e){var t=Object(Fa.parse)(window.location.href.replace("#/","")),r=Object(Fa.parse)(window.location.href),n=r.hash.split("?")[1],a=new URLSearchParams;n&&(a=new URLSearchParams(n)),Object.keys(e).map(function(t){a.set(t,e[t])});var i=decodeURIComponent("".concat(a));return"".concat(r.protocol,"//").concat(r.host).concat(r.pathname||"","#").concat(t.pathname,"?").concat(i)}},{key:"subscribeToMapState",value:function(){var e=this,t=this.mapStateSvc.getMapState().subscribe(function(t){if(history.pushState){var r=t.extent.map(function(e){return e.toFixed(3)}),n=e.updateSearchParamsHashRouting({bbox:r.join(","),zoom:t.zoom.toString()});window.history.pushState({path:n},"",n)}});this.subs.push(t)}},{key:"subscribeToRoute",value:function(){var e=this,t=this.route.queryParams.pipe(Object(Aa.a)()).subscribe(function(t){if(Object.keys(t).length>0&&t.bbox){var r=t.bbox.split(",").map(function(e){return parseFloat(e)});4===r.length&&(e.startBbox=r)}});this.subs.push(t)}}]),e}()).\u0275fac=function(e){return new(e||ka)(v.Kb(G),v.Kb(z),v.Kb(bt),v.Kb(Da),v.Kb(y.a))},ka.\u0275cmp=v.Eb({type:ka,selectors:[["app-route-map3"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:13,vars:9,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","Coordinates",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","compass","clrVerticalNavIcon",""]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Layers "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",7),v.Lb(9,"clr-icon",8),v.yc(10," Coordinates "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-mouse-position"),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!1))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia,Ta],styles:[""]}),ka),Va=s("b6O2"),Qa=s("dmYx"),Na=s("gayD"),Ba=s("itZQ"),Ua=s("NxsL"),Wa=s("eGOI"),Za=((La=function(){function e(){f(this,e),this.privValue=1,this.valueChange=new v.n}return h(e,[{key:"value",get:function(){return this.privValue},set:function(e){this.privValue=e,this.layer.custom_layer&&this.layer.custom_layer.setRadius(e)}},{key:"changeValue",value:function(e){var t=parseInt(e.target.value,10);this.value=t,this.valueChange.emit(t),this.layer.custom_layer&&this.layer.custom_layer.setRadius(t)}}]),e}()).\u0275fac=function(e){return new(e||La)},La.\u0275cmp=v.Eb({type:La,selectors:[["app-example-layer-action"]],inputs:{layer:"layer",value:"value"},outputs:{valueChange:"valueChange"},decls:6,vars:2,consts:[[1,"heatmap-range"],["type","range","clrRange","","name","two","min","1","max","50","step","1",1,"ukis-range-input",3,"value","change"]],template:function(e,t){1&e&&(v.Qb(0,"clr-range-container",0),v.Qb(1,"label"),v.yc(2,"Heatmap radius:"),v.Pb(),v.Qb(3,"input",1),v.Xb("change",function(e){return t.changeValue(e)}),v.Pb(),v.Qb(4,"clr-control-helper"),v.yc(5),v.Pb(),v.Pb()),2&e&&(v.zb(3),v.fc("value",t.value),v.zb(2),v.zc(" "+t.value))},directives:[zt.w,zt.r,zt.v,zt.f],styles:[".heatmap-range[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}"]}),La),Ha={type:"FeatureCollection",features:[{type:"Feature",properties:{height:2},geometry:{type:"Polygon",coordinates:[[[11.539764404296875,48.17707562779612,2],[11.53289794921875,48.13126755117026],[11.51641845703125,48.12301775410865],[11.517791748046875,48.10926514749487],[11.56036376953125,48.11384975871469],[11.564483642578125,48.12301775410865],[11.58233642578125,48.130350972491556],[11.592292785644531,48.14043243818811],[11.594696044921875,48.14730502988628],[11.602935791015625,48.15715413998257],[11.595039367675781,48.1640244926387],[11.59950256347656,48.17226770127996],[11.587142944335938,48.177533502046636],[11.572036743164062,48.177533502046636],[11.539764404296875,48.17707562779612]]]}},{type:"Feature",properties:{height:1},geometry:{type:"Polygon",coordinates:[[[11.605682373046875,48.156238023440835],[11.596412658691406,48.147534100428686],[11.59332275390625,48.13699579726703],[11.583709716796875,48.12851776605501],[11.564826965332031,48.121413473016034],[11.561737060546875,48.11247441829591],[11.575126647949217,48.11155750423242],[11.581993103027344,48.10490938797694],[11.614608764648438,48.11178673428214],[11.620101928710938,48.12462198509838],[11.614952087402344,48.12920522613733],[11.614265441894531,48.13905780942574],[11.61529541015625,48.15165719536032],[11.605682373046875,48.156238023440835]]]}},{type:"Feature",properties:{height:3},geometry:{type:"Polygon",coordinates:[[[11.516075134277344,48.12347611093252],[11.532554626464844,48.131496693283744],[11.538734436035156,48.176388808753124],[11.52191162109375,48.175701980509444],[11.511268615722656,48.17249666038475],[11.507148742675781,48.16379549570767],[11.492729187011719,48.165398452755674],[11.486892700195312,48.16379549570767],[11.458740234375,48.164482483433744],[11.457366943359375,48.15188624647704],[11.455307006835938,48.148221305921446],[11.436767578124998,48.133329793382636],[11.430244445800781,48.12874692043826],[11.443977355957031,48.12828861064926],[11.45050048828125,48.12553866602599],[11.4862060546875,48.124392812310205],[11.503028869628904,48.12553866602599],[11.516075134277344,48.12347611093252]]]}},{type:"Feature",properties:{height:0},geometry:{type:"Polygon",coordinates:[[[11.517448425292969,48.10972362702285],[11.487579345703125,48.095738161288885],[11.488265991210938,48.08381312049231],[11.485176086425781,48.075785093732456],[11.487922668457031,48.07486752519069],[11.493759155273438,48.07693203139914],[11.506805419921875,48.0762438718672],[11.517448425292969,48.06890293081563],[11.536331176757812,48.068214663899795],[11.538734436035156,48.07349114169717],[11.540107727050781,48.08427182703979],[11.548004150390625,48.09367440979962],[11.549720764160154,48.10559716402152],[11.559333801269531,48.11407897853892],[11.517448425292969,48.10972362702285]]]}}]},Xa={type:"FeatureCollection",features:[{type:"Feature",properties:{pid:1},geometry:{type:"Point",coordinates:[10.9423828125,49.001843917978526]}},{type:"Feature",properties:{pid:2},geometry:{type:"Point",coordinates:[11.18408203125,49.088257784724675]}},{type:"Feature",properties:{pid:3},geometry:{type:"Point",coordinates:[11.030273437499998,49.35375571830993]}},{type:"Feature",properties:{pid:4},geometry:{type:"Point",coordinates:[10.72265625,49.24629332459796]}},{type:"Feature",properties:{pid:5},geometry:{type:"Point",coordinates:[12.76611328125,48.011975126709956]}},{type:"Feature",properties:{pid:6},geometry:{type:"Point",coordinates:[13.55712890625,49.15296965617042]}},{type:"Feature",properties:{pid:7},geometry:{type:"Point",coordinates:[13.3154296875,48.545705491847464]}},{type:"Feature",properties:{pid:8},geometry:{type:"Point",coordinates:[4.482421875,49.224772722794825]}}]},qa={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Feature 1 - Polygon"},geometry:{type:"Polygon",coordinates:[[[7.91015625,50.233151832472245],[9.140625,47.81315451752768],[13.33740234375,48.28319289548349],[13.7109375,50.17689812200107],[7.91015625,50.233151832472245]]]}}]},Ya={type:"FeatureCollection",features:[{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.3",geometry:{type:"Point",coordinates:[14.354708,54.004536]},geometry_name:"geom",properties:{lat:"54.004536",lon:"14.354708",id:"3",timestamp:"2020-09-13T16:52:57Z",SWH:"1.13",plength:"209.7",windSpeed:"4.25",pdirection:"125.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.4",geometry:{type:"Point",coordinates:[14.445045,54.013187]},geometry_name:"geom",properties:{lat:"54.013187",lon:"14.445045",id:"4",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"251.0",windSpeed:"3.75",pdirection:"11.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.5",geometry:{type:"Point",coordinates:[14.535383,54.021835]},geometry_name:"geom",properties:{lat:"54.021835",lon:"14.535383",id:"5",timestamp:"2020-09-13T16:52:57Z",SWH:"1.08",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.6",geometry:{type:"Point",coordinates:[14.625798,54.030346]},geometry_name:"geom",properties:{lat:"54.030346",lon:"14.625798",id:"6",timestamp:"2020-09-13T16:52:57Z",SWH:"0.99",plength:"194.6",windSpeed:"4.00",pdirection:"171.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.7",geometry:{type:"Point",coordinates:[14.716214,54.038853]},geometry_name:"geom",properties:{lat:"54.038853",lon:"14.716214",id:"7",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"475.4",windSpeed:"4.05",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.8",geometry:{type:"Point",coordinates:[13.978081,54.022915]},geometry_name:"geom",properties:{lat:"54.022915",lon:"13.978081",id:"8",timestamp:"2020-09-13T16:52:57Z",SWH:"0.66",plength:"475.4",windSpeed:"3.50",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.9",geometry:{type:"Point",coordinates:[14.068372,54.031853]},geometry_name:"geom",properties:{lat:"54.031853",lon:"14.068372",id:"9",timestamp:"2020-09-13T16:52:57Z",SWH:"1.03",plength:"452.5",windSpeed:"4.20",pdirection:"135.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.10",geometry:{type:"Point",coordinates:[14.158684,54.040756]},geometry_name:"geom",properties:{lat:"54.040756",lon:"14.158684",id:"10",timestamp:"2020-09-13T16:52:57Z",SWH:"0.47",plength:"199.9",windSpeed:"4.40",pdirection:"51.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.11",geometry:{type:"Point",coordinates:[14.249058,54.049553]},geometry_name:"geom",properties:{lat:"54.049553",lon:"14.249058",id:"11",timestamp:"2020-09-13T16:52:57Z",SWH:"1.36",plength:"420.9",windSpeed:"4.40",pdirection:"80.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.12",geometry:{type:"Point",coordinates:[14.339441,54.058331]},geometry_name:"geom",properties:{lat:"54.058331",lon:"14.339441",id:"12",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"134.6",windSpeed:"3.95",pdirection:"3.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.13",geometry:{type:"Point",coordinates:[14.429894,54.066982]},geometry_name:"geom",properties:{lat:"54.066982",lon:"14.429894",id:"13",timestamp:"2020-09-13T16:52:57Z",SWH:"1.01",plength:"351.6",windSpeed:"4.15",pdirection:"164.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.14",geometry:{type:"Point",coordinates:[14.52035,54.075634]},geometry_name:"geom",properties:{lat:"54.075634",lon:"14.520350",id:"14",timestamp:"2020-09-13T16:52:57Z",SWH:"1.16",plength:"310.4",windSpeed:"4.45",pdirection:"166.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.15",geometry:{type:"Point",coordinates:[14.610882,54.084145]},geometry_name:"geom",properties:{lat:"54.084145",lon:"14.610882",id:"15",timestamp:"2020-09-13T16:52:57Z",SWH:"1.00",plength:"210.4",windSpeed:"4.05",pdirection:"170.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.16",geometry:{type:"Point",coordinates:[14.701414,54.092651]},geometry_name:"geom",properties:{lat:"54.092651",lon:"14.701414",id:"16",timestamp:"2020-09-13T16:52:57Z",SWH:"0.98",plength:"254.7",windSpeed:"4.40",pdirection:"174.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.17",geometry:{type:"Point",coordinates:[14.792017,54.101032]},geometry_name:"geom",properties:{lat:"54.101032",lon:"14.792017",id:"17",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"475.4",windSpeed:"4.45",pdirection:"158.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.18",geometry:{type:"Point",coordinates:[14.882627,54.109398]},geometry_name:"geom",properties:{lat:"54.109398",lon:"14.882627",id:"18",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"188.2",windSpeed:"4.25",pdirection:"107.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.19",geometry:{type:"Point",coordinates:[14.973297,54.117649]},geometry_name:"geom",properties:{lat:"54.117649",lon:"14.973297",id:"19",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"404.8",windSpeed:"4.00",pdirection:"161.6"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.20",geometry:{type:"Point",coordinates:[15.063984,54.12587]},geometry_name:"geom",properties:{lat:"54.125870",lon:"15.063984",id:"20",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"170.3",windSpeed:"4.10",pdirection:"176.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.21",geometry:{type:"Point",coordinates:[15.154721,54.133991]},geometry_name:"geom",properties:{lat:"54.133991",lon:"15.154721",id:"21",timestamp:"2020-09-13T16:52:57Z",SWH:"0.69",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.22",geometry:{type:"Point",coordinates:[14.052757,54.085644]},geometry_name:"geom",properties:{lat:"54.085644",lon:"14.052757",id:"22",timestamp:"2020-09-13T16:52:57Z",SWH:"0.28",plength:"475.4",windSpeed:"4.25",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.26",geometry:{type:"Point",coordinates:[14.414745,54.120781]},geometry_name:"geom",properties:{lat:"54.120781",lon:"14.414745",id:"26",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"129.3",windSpeed:"4.20",pdirection:"45.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.27",geometry:{type:"Point",coordinates:[14.505316,54.129433]},geometry_name:"geom",properties:{lat:"54.129433",lon:"14.505316",id:"27",timestamp:"2020-09-13T16:52:57Z",SWH:"0.50",plength:"310.4",windSpeed:"4.60",pdirection:"14.0"}}]},Ka=((Oa=function(){function e(){f(this,e),this.sunlightForm=new nn.e({x:new nn.c(0,nn.v.required),y:new nn.c(0,nn.v.required)})}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.sunlightForm.valueChanges.subscribe(function(t){e.changeHandler(parseInt(t.x,10)/100,parseInt(t.y,10)/100)})}}]),e}()).\u0275fac=function(e){return new(e||Oa)},Oa.\u0275cmp=v.Eb({type:Oa,selectors:[["app-sunlight"]],inputs:{changeHandler:"changeHandler"},decls:15,vars:1,consts:[["clrForm","","clrLayout","horizontal",3,"formGroup"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","x",1,"ukis-range-input"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","y",1,"ukis-range-input"]],template:function(e,t){1&e&&(v.Qb(0,"form",0),v.Qb(1,"label"),v.yc(2,"Sun position"),v.Pb(),v.Qb(3,"clr-input-container"),v.Qb(4,"label"),v.yc(5,"x"),v.Pb(),v.Lb(6,"input",1),v.Qb(7,"clr-control-helper"),v.yc(8,"east -> west"),v.Pb(),v.Pb(),v.Qb(9,"clr-input-container"),v.Qb(10,"label"),v.yc(11,"y"),v.Pb(),v.Lb(12,"input",2),v.Qb(13,"clr-control-helper"),v.yc(14,"south -> north"),v.Pb(),v.Pb(),v.Pb()),2&e&&v.fc("formGroup",t.sunlightForm)},directives:[nn.w,nn.k,zt.l,zt.s,nn.f,zt.r,zt.q,nn.r,nn.b,zt.p,nn.j,nn.d,zt.f],styles:[""]}),Oa),Ja=((Ea=function(){function e(){f(this,e),this.interpolationForm=new nn.e({power:new nn.c(2,nn.v.required),smooth:new nn.c(!0,nn.v.required),labels:new nn.c(!1,nn.v.required)})}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.interpolationForm.valueChanges.subscribe(function(t){e.changeHandler(t.power,t.smooth,t.labels)})}}]),e}()).\u0275fac=function(e){return new(e||Ea)},Ea.\u0275cmp=v.Eb({type:Ea,selectors:[["app-interpolation-settings"]],inputs:{changeHandler:"changeHandler"},decls:21,vars:1,consts:[["clrForm","","clrLayout","vertical",3,"formGroup"],["type","range","min","1","max","7","value","1","clrInput","","formControlName","power",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","true","formControlName","smooth",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","false","formControlName","labels",1,"ukis-range-input"]],template:function(e,t){1&e&&(v.Qb(0,"form",0),v.Qb(1,"clr-input-container"),v.Qb(2,"label"),v.yc(3,"Power"),v.Pb(),v.Lb(4,"input",1),v.Qb(5,"clr-control-helper"),v.yc(6,"inverse distance weighting power"),v.Pb(),v.Pb(),v.Qb(7,"clr-checkbox-container"),v.Qb(8,"label"),v.yc(9,"Smoothing"),v.Pb(),v.Qb(10,"clr-checkbox-wrapper"),v.Lb(11,"input",2),v.Qb(12,"label"),v.yc(13,"Smoothing"),v.Pb(),v.Pb(),v.Pb(),v.Qb(14,"clr-checkbox-container"),v.Qb(15,"label"),v.yc(16,"Labels"),v.Pb(),v.Qb(17,"clr-checkbox-wrapper"),v.Lb(18,"input",3),v.Qb(19,"label"),v.yc(20,"Show labels"),v.Pb(),v.Pb(),v.Pb(),v.Pb()),2&e&&v.fc("formGroup",t.interpolationForm)},directives:[nn.w,nn.k,zt.l,zt.s,nn.f,zt.q,zt.r,nn.r,nn.b,zt.p,nn.j,nn.d,zt.f,zt.d,zt.e,nn.a,zt.c],styles:[""]}),Ea),$a=s("Womt"),ei=s("RyHr");function ti(e){var t=e.map(function(e){return Math.pow(e,2)}).reduce(function(e,t){return e+t},0);return Math.sqrt(t)}function ri(e){return e%360*(2*Math.PI)/360}function ni(e,t){return e/2/Math.tan(ri(t/2))}var ai,ii,oi,si=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:360/(2*Math.PI),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2?arguments[2]:void 0;f(this,e),this.mapRadiusMU=t,this.mapWidthMU=2*Math.PI*t,this.mapUnitsPerSphereUnits=t/r,this.sphereRadiusSU=r,this.sphereCircumferenceSU=2*Math.PI*r,this.sphereUnitsPerMapUnits=r/t,this.fovDeg=n}return h(e,[{key:"mapWidth2SphereHeight",value:function(e){var t=ni(e,this.fovDeg);return this.sphereRadiusSU+t*this.sphereUnitsPerMapUnits}},{key:"sphereHeight2mapWidth",value:function(e){return(e-this.sphereRadiusSU)*this.mapUnitsPerSphereUnits*2*Math.tan(ri(this.fovDeg/2))}},{key:"sphereHeight2zoom",value:function(e){var t=this.sphereHeight2mapWidth(e);return this.widthMU2Zoom(t)}},{key:"zoom2sphereHeight",value:function(e){var t=this.zoom2WidthMU(e);return this.mapWidth2SphereHeight(t)}},{key:"spherePos2zoom",value:function(e,t,r){var n=ti([e,t,r]);return this.sphereHeight2zoom(n)}},{key:"zoom2WidthMU",value:function(e){return function(e,t){return t*Math.pow(.5,e)}(e,this.mapWidthMU)}},{key:"widthMU2Zoom",value:function(e){return Math.log2(this.mapWidthMU/e)}},{key:"lonLatZoom2XYZ",value:function(e,t,r){var n=this.mu2rad(e),a=this.mu2rad(t),i=this.zoom2WidthMU(r),o=this.mapWidth2SphereHeight(i);return[o*Math.cos(a)*Math.sin(n),o*Math.sin(a),o*Math.cos(a)*Math.cos(n)]}},{key:"xyz2LonLatZoom",value:function(e,t,r){var n=Math.asin(t/ti([e,t,r])),a=Math.asin(e/ti([e,r])),i=180*n/Math.PI,o=180*a/Math.PI;return r<=0&&(o=180-o),[o,i,this.spherePos2zoom(e,t,r)]}},{key:"mu2rad",value:function(e){return ri(e)}},{key:"rad2mu",value:function(e){return e%(2*Math.PI)*360/(2*Math.PI)}}]),e}(),ci=function(e){o(r,e);var t=c(r);function r(e,n){f(this,r);var a=new $a.f(e);return t.call(this,n,new $a.fb({vertexShader:"\n        varying vec2 vUv;\n        uniform vec4 bbox;\n        uniform vec2 textureSize;\n\n        vec2 positionToLonLat(vec3 position) {\n          float pi = 3.141592653589793;\n\n          float latRad = asin(position.y / length(position));\n          float latDeg = 180.0 * latRad / pi;\n\n          float lonRad = asin(position.x / length(position.xz));\n          float lonDeg = 180.0 * lonRad / pi;\n          if (position.z <= 0.0) {\n            lonDeg = 180.0 - lonDeg;\n          }\n          return vec2(lonDeg, latDeg);\n        }\n\n        void main() {\n          vec2 lonLat = positionToLonLat(position);\n          float u = (lonLat.x - bbox.x) / (bbox.z - bbox.x);\n          float v = (lonLat.y - bbox.y) / (bbox.w - bbox.y);\n          if  (u < 0.0) {\n            u = ((360.0 + lonLat.x) - bbox.x) / (bbox.z - bbox.x);\n          }\n          if (u > 1.0) {\n            u = ((lonLat.x - 360.0) - bbox.x) / (bbox.z - bbox.x);\n          }\n          vUv = vec2(u, v);\n          gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n        }\n        ",fragmentShader:"\n        uniform sampler2D texture1;\n        varying vec2 vUv;\n\n        void main() {\n          gl_FragColor = texture2D(texture1, vUv);\n          if (vUv.x > 1.0 || vUv.x < 0.0 || vUv.y > 1.0 || vUv.y < 0.0) {\n            gl_FragColor = vec4(0.3, 0.3, 0.3, 1.0); // <-- better: retrieve texture2D from *previous* texture.\n          }\n        }\n        ",uniforms:{texture1:{value:a},bbox:{value:[-180,-90,180,90]}}}))}return h(r,[{key:"perspectiveChanged",value:function(e){this.material.uniforms.bbox.value=e,this.material.uniforms.texture1.value.needsUpdate=!0}}]),r}($a.J),li=((ai=function(){function e(t,r){f(this,e),this.mapStateSvc=t,this.zone=r,this.subs=[],this.needsResize=!1}return h(e,[{key:"initScene",value:function(e,t,a){var i=this,o=new $a.ub({alpha:!0,antialias:!0,canvas:e});o.setSize(e.clientWidth,e.clientHeight,!1);var s=new $a.eb,c=new $a.V(50,e.clientWidth/e.clientHeight,.01,1e5);c.lookAt(0,0,0),c.position.set(-40,40,40);var l=new ei.a(c,o.domElement),u=(new $a.i).load(new Array(6).fill("assets/images/zpos.png"));s.background=u;var p=document.createElement("canvas");!function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.getContext("2d");if(!i)throw new Error("The target-canvas needs to use a 2d-context.");if(!t.width||!t.height)throw new Error("TargetCanvas: width or height have not been set.");i.clearRect(0,0,t.width,t.height);var o=e.getSize();e.getView().getResolution(),t.width=o[0],t.height=o[1];var s,c=Ge(e.getLayers().getArray()),l=[],u=n(c);try{for(u.s();!(s=u.n()).done;){var p=s.value;if(p.getVisible()&&p.getOpacity()>0){var f=p.on("postrender",function(e){var r=e.context.canvas;i.drawImage(r,0,0,r.clientWidth,r.clientHeight,0,0,t.width,t.height)});Array.isArray(f)?f.map(function(e){return l.push(e)}):l.push(f)}}}catch(d){u.e(d)}finally{u.f()}a?e.on("rendercomplete",function(e){r(t)}):e.once("rendercomplete",function(e){var a,i=n(l);try{for(i.s();!(a=i.n()).done;){var o=a.value;Object(Me.b)(o)}}catch(d){i.e(d)}finally{i.f()}r(t)}),e.renderSync()}(a,p,function(){},!0);var f=new ci(p,t.geometry);s.add(f);var d=new si(360/(2*Math.PI),15,50);a.on("postrender",function(e){var t=a.getView().calculateExtent(a.getSize()),n=r(a.getView().getCenter(),2),i=n[0],o=n[1],s=a.getView().getZoom();f.perspectiveChanged(t);var l=r(d.lonLatZoom2XYZ(i,o,s),3),u=l[0],p=l[1],h=l[2];c.position.set(u,p,h),c.lookAt(0,0,0)}),l.addEventListener("change",function(e){var t=c.position,n=r(d.xyz2LonLatZoom(t.x,t.y,t.z),3),a=n[0],o=n[1],s=n[2];i.mapStateSvc.setMapState({center:{lon:a,lat:o},zoom:s})}),this.zone.runOutsideAngular(function(){var t,r,n,a;a=33.333333333333336,function l(){t=window.performance.now(),i.needsResize&&(e.clientHeight===e.height&&e.clientWidth===e.width||(o.setSize(e.clientWidth,e.clientHeight,!1),c.aspect=e.clientWidth/e.clientHeight,c.updateProjectionMatrix()),i.needsResize=!1),o.render(s,c),r=window.performance.now(),a=r-t,n=Math.max(33.333333333333336-a,0),setTimeout(function(){requestAnimationFrame(l)},n)}()})}},{key:"onResize",value:function(e){this.needsResize=!0}},{key:"ngOnDestroy",value:function(){this.subs.map(function(e){return e.unsubscribe()})}}]),e}()).\u0275fac=function(e){return new(e||ai)(v.Ub(z),v.Ub(v.A))},ai.\u0275prov=v.Gb({token:ai,factory:ai.\u0275fac,providedIn:"root"}),ai),ui=s("NK00"),pi=["threeCanvas"],fi=((oi=function(){function e(t){f(this,e),this.mapThreeSvc=t,this.modelFilePath="https://solarsystem.nasa.gov/system/resources/gltf_files/2358_Phobos_1_1000.glb",this.modelName="phobos"}return h(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;new Promise(function(t){(new ui.a).load(e.modelFilePath,function(r){var n=r.scene.getObjectByName(e.modelName);if(!n)throw new Error("No object named ".concat(e.modelName," in glb!"));t(n)})}).then(function(t){e.mapThreeSvc.initScene(e.threeCanvas.nativeElement,t,e.mapOlSvc.map)})}},{key:"onResize",value:function(e){this.mapThreeSvc.onResize(e)}}]),e}()).\u0275fac=function(e){return new(e||oi)(v.Kb(li))},oi.\u0275cmp=v.Eb({type:oi,selectors:[["ukis-map-three"]],viewQuery:function(e,t){var r;1&e&&v.Dc(pi,1),2&e&&v.kc(r=v.Yb())&&(t.threeCanvas=r.first)},hostBindings:function(e,t){1&e&&v.Xb("resize",function(e){return t.onResize(e)},!1,v.oc)},inputs:{mapOlSvc:"mapOlSvc",modelFilePath:"modelFilePath",modelName:"modelName"},decls:2,vars:0,consts:[["id","threeCanvas",1,"threeCanvas"],["threeCanvas",""]],template:function(e,t){1&e&&v.Lb(0,"canvas",0,1)},styles:[".threeCanvas[_ngcontent-%COMP%]{width:100%;height:100%;margin:0;display:block}"]}),oi),di=((ii=function e(){f(this,e)}).\u0275fac=function(e){return new(e||ii)},ii.\u0275mod=v.Ib({type:ii}),ii.\u0275inj=v.Hb({imports:[[]]}),ii),hi=function(e){o(r,e);var t=c(r);function r(e){return f(this,r),t.call(this,e)}return h(r,[{key:"createRenderer",value:function(){return new vi(this)}}]),r}(ie.a),vi=function(e){o(r,e);var t=c(r);function r(e){var a;f(this,r),a=t.call(this,e);var i=document.createElement("canvas");i.width=800,i.height=600,i.style.position="absolute";var o=e.getSource().getFeatures(),s=a.featuresToMeshes(o),c=new $a.ub({canvas:i,alpha:!0}),l=new $a.V(45,i.width/i.height,.01,3e7);l.position.set(0,0,10),l.lookAt(new $a.sb(0,0,0));var u,p=new $a.eb,d=n(s);try{for(d.s();!(u=d.n()).done;){var h=u.value;p.add(h)}}catch(y){d.e(y)}finally{d.f()}var v=new $a.j(16777215,1);return v.position.set(-1,2,4),p.add(v),a.canvas=i,a.scene=p,a.meshes=s,a.renderer=c,a.camera=l,a}return h(r,[{key:"prepareFrame",value:function(e){var t=e.pixelRatio,r=e.size,n=Math.round(r[0]*t),a=Math.round(r[1]*t),i=e.viewState.center,o=this.extent2Height(e.extent,45);return this.camera.aspect=n/a,this.camera.fov=45,this.camera.near=.01,this.camera.far=3e8,this.camera.position.set(i[0],i[1],o),this.camera.lookAt(new $a.sb(i[0],i[1],0)),this.camera.updateProjectionMatrix(),r[0]===this.canvas.width&&r[1]===this.canvas.height||(this.canvas.width=r[0],this.canvas.height=r[1],this.renderer.setSize(this.canvas.width,this.canvas.height)),this.canvas.style.opacity=""+e.layerStatesArray[e.layerIndex].opacity,!0}},{key:"renderFrame",value:function(e,t){return this.renderer.render(this.scene,this.camera),this.canvas}},{key:"renderDeclutter",value:function(e){}},{key:"featuresToMeshes",value:function(e){var t,r=[],a=n(e);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=i.getGeometry(),s=i.get("height"),c=this.fGeom2tGeom(o,.1*s),l=new $a.h(16777215);l.setHex(16777215*Math.random());var u=new $a.L({color:l}),p=new $a.J(c,u);r.push(p)}}catch(f){a.e(f)}finally{a.f()}return r}},{key:"fGeom2tGeom",value:function(e,t){var r=e.getCoordinates()[0],n=new $a.gb;n.moveTo(r[0][0],r[0][1]);for(var a=1;a<r.length;a++){var i=r[a];n.lineTo(i[0],i[1])}return new $a.m(n,{depth:t,bevelEnabled:!1})}},{key:"extent2Height",value:function(e,t){return ni(e[3]-e[1],t)}}]),r}(Ae.a);function yi(e,t){if(1&e&&(v.Qb(0,"li"),v.yc(1),v.Pb()),2&e){var r=t.$implicit,n=v.Zb();v.zb(1),v.Bc(" ",r,": ",n.group[r]||"undefined"," ")}}var mi,bi,gi=((bi=function(){function e(t){f(this,e),this.layersSvc=t}return h(e,[{key:"ngOnInit",value:function(){this.groupkeys=["bbox","cssClass","displayName","filtertype","id","name","removable"]}}]),e}()).\u0275fac=function(e){return new(e||bi)(v.Kb(G))},bi.\u0275cmp=v.Eb({type:bi,selectors:[["app-example-group-action"]],inputs:{group:"group"},decls:5,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(v.Qb(0,"div"),v.Qb(1,"span"),v.yc(2,"some properties of the group:"),v.Pb(),v.Qb(3,"ul"),v.wc(4,yi,2,2,"li",0),v.Pb(),v.Pb()),2&e&&(v.zb(4),v.fc("ngForOf",t.groupkeys))},directives:[Tt.m],styles:[""]}),bi),wi=((mi=function(){function e(t,r,n){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.mapSvc=n,this.class="content-container",this.test=[],this.inputValue={value:15},this.controls={attribution:!0,scaleLine:!0,overviewMap:!0}}return h(e,[{key:"ngOnInit",value:function(){this.addLayers()}},{key:"setInput",value:function(){var e=this.layersSvc.getLayerById("heatmap_layer");this.inputValue.value=40,e.action.inputs=this.inputValue,e.action=Object.assign({},e.action)}},{key:"addLayers",value:function(){var e=this,t=new V({id:"OSM1",visible:!1}),r=new C({id:"heatmap_layer",name:"Heatmap Layer",actions:[{title:"test",icon:"",action:function(e){}}],action:{component:Za,inputs:this.inputValue,outputs:{valueChange:function(t){e.inputValue.value=t}}},custom_layer:new Va.a({source:new he.a({features:this.mapSvc.geoJsonToFeatures(Xa),format:new be.a}),radius:this.inputValue.value}),visible:!1}),n=new T({id:"Vector Layer1",name:"Vector Layer",type:"geojson",data:Xa,visible:!0,popup:{single:!0}}),a=new C({id:"Layer_KML",name:"KML - VectorLayer",popup:!0,custom_layer:new ie.a({source:new he.a({url:"assets/data/kml/TimeZones.kml",format:new Ba.a({extractStyles:!0})})}),visible:!1,bbox:[-180,-90,180,90]}),i=new C({id:"topo_json_layer",name:"Topo Json - VectorImageLayer",popup:{event:"move"},custom_layer:new Ia.a({source:new he.a({url:"https://openlayers.org/en/latest/examples/data/topojson/world-110m.json",format:new Ua.a({layers:["countries"]}),overlaps:!1}),style:function(e,t){return Object(Ie.c)(e),[new Le.b({stroke:new Ce.a({color:"gray",width:1}),fill:new Oe.a({color:"rgba(0, 153, 255, 0.2)"})})]}}),visible:!1}),o=new C({id:"geo_json_layer_ocean",name:"GeoJson - VectorImageLayer ocean",popup:{event:"move"},custom_layer:new Ia.a({source:new he.a({features:this.mapSvc.geoJsonToFeatures(ja)}),style:function(e,t){return new Le.b({stroke:new Ce.a({color:"gray",width:1}),fill:new Oe.a({color:"rgba(20,20,20,0.9)"})})}}),visible:!1,bbox:[-180.35156249999997,-22.268764039073968,-129.375,29.84064389983441]}),s=new C({id:"static_image_layer",name:"Static Image",visible:!1,popup:{filterkeys:["id","color","name"]},custom_layer:new je.a({source:new le.a({url:"assets/images/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326",crossOrigin:"anonymous"})})}),c=new C({id:"osm_clip_layer",name:"OSM Clip",visible:!1,popup:{filterkeys:["id","color","name"]},custom_layer:new ae.a({source:new Et.a}),bbox:[-105.41888884797893,6.480590573390401,-15.540298246016693,42.53496284727569]}),l=new C({id:"customLayerOlGroup",name:"Custom Layer OlGroup",visible:!1,popup:!0,custom_layer:new $.a({layers:[new ae.a({source:new ue.a({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"litemap",TILED:!0},serverType:"geoserver",transition:0})}),new ae.a({source:new ue.a({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"liteoverlay",TILED:!0},serverType:"geoserver",transition:0})})]})}),u=new C({id:"clusterLayer",name:"cluster Layer - VectorLayer",visible:!1,popup:!0,custom_layer:new ie.a({source:new ye.a({distance:10,source:new he.a({features:this.mapSvc.geoJsonToFeatures(Xa)})})})}),p=new C({id:"vectorTile",name:"VectorTileLayer",visible:!0,popup:{event:"move",filterkeys:["name","region_un","region_wb"],properties:{name:"Name"},options:{autoPan:!1}},custom_layer:new Qa.a({source:new oe.a({format:new Wa.a,url:"https://tiles.geoservice.dlr.de/service/tms/1.0.0/eoc:litemap@EPSG%3A3857@pbf/{z}/{x}/{-y}.pbf"}),style:function(t,r){var n=t.get("layer");if(e.test.includes(n)||e.test.push(n),n&&("ne_50m_land"===n||"ne_50m_admin_0_countries"===n||"ne_10m_admin_0_countries"===n))return new Le.b({stroke:new Ce.a({color:"gray",width:1}),fill:new Oe.a({color:"rgba(20,20,20,0.9)"})})}})}),f=new R({name:"Heatmap Group",filtertype:"Layers",id:"group1",layers:[r,n],description:"This is a custom layer group with some custom angular components in the UI",action:{component:gi}}),d=new C({id:"image_wms",name:"Image WMS",custom_layer:new je.a({source:new ce.a({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"})}),visible:!1,popup:{filterkeys:["id","color","name"]},bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),h=new C({id:"dtmLayer",name:"SRTM DTM",filtertype:"Layers",custom_layer:new nt({source:new le.a({url:"assets/images/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326"})}),action:{component:Ka,inputs:{changeHandler:function(e,t){h.custom_layer.updateSunAngle([e,t])}}},opacity:.6,visible:!1,description:"<p>This layer uses SRTM data to calculate surface-normals and uses them to dynamically create shades on hilltops. Things like these might be a nice illustration for time-enabled maps.</p>\n      <p>Use the controls to dynamically change the sun's angle.</p>"}),v=this.mapSvc.getProjection().getMetersPerUnit(),y=new ge.a({code:"EPSG:4326",units:"degrees"}).getMetersPerUnit();Ha.features.map(function(e){return e.properties.height=e.properties.height*y/v});var m=new C({id:"three",name:"Bars layer",custom_layer:new hi({source:new he.a({features:this.mapSvc.geoJsonToFeatures(Ha)})}),filtertype:"Layers",opacity:.7,visible:!1,description:"<p>This layer demonstrates how a common 3d-library, three.js, can be integrated in a 2d-map. Using three.js often yields less verbose code than calling WebGL directly.</p>"}),b=new he.a({features:this.mapSvc.geoJsonToFeatures(Ya)}),g=new ye.a({source:b,distance:25}),w=new C({id:"interpolation",name:"Interpolation",custom_layer:new st({source:g,style:function(e,t){var r,n=e.getProperties().features;return r=n.length>1?"".concat(e.getProperties().features.length):"".concat(Number.parseFloat(n[0].getProperties().SWH).toPrecision(3)),new Le.b({image:new Te.a({radius:13,fill:new Oe.a({color:"rgba(0, 153, 255, 0.2)"}),stroke:new Ce.a({color:"rgba(255, 255, 255, 0.2)",width:1})}),text:new Ee.a({text:r,overflow:!0,offsetX:-5*r.length/2,offsetY:1,textAlign:"left",fill:new Oe.a({color:"#ffffff"})})})},renderSettings:{maxEdgeLength:15e3/v,power:2,colorRamp:[{val:0,rgb:[166,97,26]},{val:.4,rgb:[223,194,125]},{val:.8,rgb:[247,247,247]},{val:2,rgb:[128,205,193]},{val:22.5,rgb:[1,133,113]}],smooth:!0,showLabels:!1,valueProperty:"SWH",storeInterpolatedPixelData:!1}}),action:{component:Ja,inputs:{changeHandler:function(e,t,r){w.custom_layer.updateParas(e,t,r)}}},filtertype:"Layers",opacity:.7,visible:!1,description:"This layer is an example of how WebGL can be used to outsource computationally expensive operations. For inverse-distance interpolation we need to account for every datapoint at every pixel."}),S=new R({name:"Webgl Group",filtertype:"Layers",id:"group2",layers:[h,m,w]});[new C({name:"Transparenter Hintergrund",id:"blank",type:"custom",visible:!1,custom_layer:new je.a({source:new Na.a({canvasFunction:function(){return document.createElement("canvas")}})})}),t,p,f,S,u,d,a,s,c,i,o,l].forEach(function(t){t instanceof E?e.layersSvc.addLayer(t,"Layers"):t instanceof R&&e.layersSvc.addLayerGroup(t)})}},{key:"ngAfterViewInit",value:function(){var e=this,t=new T({id:"Vector Layer2",name:"async add Layer",type:"geojson",data:qa,visible:!1,popup:!0});setTimeout(function(){e.layersSvc.addLayer(t,"Layers")},2e3)}}]),e}()).\u0275fac=function(e){return new(e||mi)(v.Kb(G),v.Kb(z),v.Kb(bt))},mi.\u0275cmp=v.Eb({type:mi,selectors:[["app-route-map4"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:15,vars:10,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","set input of dynamic component from parent when it is created or the input changed",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Layers "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",3),v.Lb(9,"clr-icon",4),v.yc(10," Test to set dynamic component "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Qb(12,"button",7),v.Xb("click",function(){return t.setInput()}),v.yc(13,"Set Heatmap Layer radius"),v.Pb(),v.yc(14),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(6),v.Ac(" ",t.inputValue.value," "))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia],styles:[""]}),mi);function Si(e,t){if(1&e&&(v.Qb(0,"tr"),v.Qb(1,"td",16),v.yc(2),v.Pb(),v.Qb(3,"td"),v.yc(4),v.Pb(),v.Qb(5,"td"),v.yc(6),v.Pb(),v.Qb(7,"td"),v.yc(8),v.Pb(),v.Pb()),2&e){var r=t.$implicit;v.zb(2),v.zc(r.properties.title),v.zb(2),v.zc(r.properties.foo),v.zb(2),v.zc(r.properties.bar),v.zb(2),v.zc(r.properties.baz)}}function xi(e,t){if(1&e&&(v.Qb(0,"table",15),v.Qb(1,"thead"),v.Qb(2,"tr"),v.Qb(3,"th",16),v.yc(4,"Title"),v.Pb(),v.Qb(5,"th"),v.yc(6,"Foo"),v.Pb(),v.Qb(7,"th"),v.yc(8,"Bar"),v.Pb(),v.Qb(9,"th"),v.yc(10,"Baz"),v.Pb(),v.Pb(),v.Pb(),v.Qb(11,"tbody"),v.wc(12,Si,9,4,"tr",17),v.Pb(),v.Pb()),2&e){var r=v.Zb();v.zb(12),v.fc("ngForOf",r.geojsonData.features)}}var Pi,ki,_i=function(){return{height:"95%"}},Li=function(){return{height:"5%"}},Ei=((ki=function(){function e(t,r){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.class="content-container",this.showTable=!1,this.subs=[],this.controls={attribution:!0,scaleLine:!0}}return h(e,[{key:"ngOnInit",value:function(){this.addBaseLayers(),this.addLayers(),this.addOverlays(),this.mapStateSvc.setExtent([-14,33,40,57]),this.checkVisibleLayers()}},{key:"addBaseLayers",value:function(){var e=this;[new N({visible:!0}),new X].map(function(t){return e.layersSvc.addLayer(t,"Baselayers")})}},{key:"addLayers",value:function(){this.geojsonData={type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Polygon",foo:"1",bar:"test",baz:"555"},geometry:{type:"Polygon",coordinates:[[[11.53564453125,48.80686346108517],[11.42578125,48.61838518688487],[11.97509765625,48.516604348867475],[12.2607421875,48.69096039092549],[12.0849609375,48.99463598353405],[11.53564453125,48.80686346108517]]]}},{type:"Feature",properties:{title:"Rectangle",foo:"2",bar:"test2",baz:"66667"},geometry:{type:"Polygon",coordinates:[[[10.986328125,43.89789239125797],[11.755371093749998,43.89789239125797],[11.755371093749998,44.41808794374846],[10.986328125,44.41808794374846],[10.986328125,43.89789239125797]]]}},{type:"Feature",properties:{title:"Line",foo:"3",bar:"test3",baz:"111"},geometry:{type:"LineString",coordinates:[[13.29345703125,48.268569112964336],[15.073242187499998,47.56170075451973],[14.1064453125,46.40756396630067],[15.886230468750002,44.94924926661153]]}},{type:"Feature",properties:{title:"Point",foo:"4",bar:"test4",baz:"444"},geometry:{type:"Point",coordinates:[11.513671874999998,46.42271253466717]}}]};var e=new T({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:this.geojsonData,visible:!1,popup:!0});this.layersSvc.addLayer(e,"Layers")}},{key:"checkVisibleLayers",value:function(){var e=this,t=this.layersSvc.getLayers().subscribe(function(t){t.map(function(t){t&&("geojson_test"===t.id&&!0===t.visible?e.showTable=!0:"geojson_test"===t.id&&!1===t.visible&&(e.showTable=!1))})});this.subs.push(t)}},{key:"addOverlays",value:function(){var e=new U;this.layersSvc.addLayer(e,"Overlays")}},{key:"ngOnDestroy",value:function(){this.subs.forEach(function(e){return e.unsubscribe()})}}]),e}()).\u0275fac=function(e){return new(e||ki)(v.Kb(G),v.Kb(z))},ki.\u0275cmp=v.Eb({type:ki,selectors:[["app-route-map5"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:27,vars:22,consts:[[1,"content-area",3,"ngStyle"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","world","title","Overlays","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc","layerfilter"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""],[3,"clrVerticalNavCollapsible"],[3,"clrVerticalNavGroupExpanded"],["shape","table","title","Overlays","clrVerticalNavIcon",""],["class","table",4,"ngIf"],[1,"footer","ukis-footer",3,"ngStyle"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Overlays "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",3),v.Lb(9,"clr-icon",7),v.yc(10," Layers "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-layer-control",8),v.Pb(),v.Pb(),v.Qb(13,"clr-vertical-nav-group",3),v.Lb(14,"clr-icon",9),v.yc(15," Baselayers "),v.Qb(16,"clr-vertical-nav-group-children",5),v.Lb(17,"ukis-base-layer-control",8),v.Pb(),v.Pb(),v.Pb(),v.Qb(18,"clr-vertical-nav",10),v.Qb(19,"clr-vertical-nav-group",11),v.Lb(20,"clr-icon",12),v.yc(21," Table "),v.Qb(22,"clr-vertical-nav-group-children",5),v.wc(23,xi,13,1,"table",13),v.Pb(),v.Pb(),v.Pb(),v.Qb(24,"div",14),v.Qb(25,"p"),v.yc(26,"this is the footer"),v.Pb(),v.Pb()),2&e&&(v.fc("ngStyle",v.ic(20,_i)),v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc)("layerfilter","Overlays"),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavCollapsible",!0),v.zb(1),v.fc("clrVerticalNavGroupExpanded",t.showTable),v.zb(4),v.fc("ngIf",t.showTable),v.zb(1),v.fc("ngStyle",v.ic(21,Li)))},directives:[Tt.o,Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia,fa,Tt.n,Tt.m],styles:[".content-container[_nghost-%COMP%]   .ukis-footer[_ngcontent-%COMP%], .content-container   [_nghost-%COMP%]   .ukis-footer[_ngcontent-%COMP%]{padding:0 1rem}"]}),ki),Oi=((Pi=function(){function e(t,r){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.class="content-container",this.subs=[],this.controls={attribution:!0,scaleLine:!0}}return h(e,[{key:"ngOnInit",value:function(){this.addBaseLayers(),this.addLayers(),this.mapStateSvc.setExtent([9.681317514755053,47.425291526740125,12.765729135848805,49.213103602937025]),this.layersSvc.getLayers().subscribe(function(e){return console.log("layers are now ",e)})}},{key:"addBaseLayers",value:function(){var e=new N({visible:!0,tileSize:512});this.layersSvc.addLayer(e,"Baselayers")}},{key:"addLayers",value:function(){var e=new I({type:"wmts",id:"TDM90_AMP",visible:!1,url:"https://tiles.geoservice.dlr.de/service/wmts?",name:"TDM90_AMP",filtertype:"Layers",attribution:'| TDM90 Data &copy; <a href="http://www.dlr.de" target="_blank">DLR</a> licensed for <a rel="license" target="_blank" href="https://geoservice.dlr.de/resources/licenses/tdm90/License_for_the_Utilization_of_90m_DEM_for_Scientific_Use.pdf">scientific use</a>',params:{layer:"TDM90_AMP",version:"1.1.0",format:"image/png",style:"default",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},styles:[{default:!0,name:"default",title:"default"},{default:!1,name:"none",title:"none"}]});this.layersSvc.addLayer(e,e.filtertype);var t=new F({type:"wms",id:"S2_L3A_WASP_FRC_P1M",url:"https://{s}.geoservice.dlr.de/eoc/imagery/wms?",name:"S2_L3A_WASP_FRC_P1M",subdomains:["a","b","c","d"],filtertype:"Layers",attribution:'| &copy; <a href="http://www.dlr.de" target="_blank">DLR</a> Contains modified Copernicus Sentinel Data [2020]',params:{LAYERS:"S2_L3A_WASP_FRC_P1M",VERSION:"1.1.0",FORMAT:"image/png"},styles:[{default:!0,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-ndvi",title:"NDVI"},{default:!1,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-infrared",title:"Infrared (8,4,3)"},{default:!1,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-l3a-wasp-frc",title:"Style for L3A MAJA/WASP Ground Reflectances"}]});this.layersSvc.addLayer(t,t.filtertype)}},{key:"ngOnDestroy",value:function(){this.subs.forEach(function(e){return e.unsubscribe()})}}]),e}()).\u0275fac=function(e){return new(e||Pi)(v.Kb(G),v.Kb(z))},Pi.\u0275cmp=v.Eb({type:Pi,selectors:[["app-route-map6"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:13,vars:11,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Layers "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-layer-control",6),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",3),v.Lb(9,"clr-icon",7),v.yc(10," Baselayers "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-base-layer-control",6),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,ia,fa],styles:[""]}),Pi);function Ti(e,t){1&e&&(v.Qb(0,"clr-signpost-content"),v.Qb(1,"h3"),v.yc(2,"Licenses setup"),v.Pb(),v.Qb(3,"p"),v.yc(4,"This component expects a "),v.Qb(5,"code"),v.yc(6,"assets/licenses.json"),v.Pb(),v.yc(7," file to be present in the project bundle."),v.Pb(),v.Qb(8,"p"),v.yc(9,"That file was created with the following command:"),v.Pb(),v.Qb(10,"code"),v.yc(11," cd ./frontend-libraries npm install -g license-checker npx license-checker --json --out ./dist/demo-maps/assets "),v.Pb(),v.yc(12," You might want to add this command to the build-process by adding a "),v.Qb(13,"code"),v.yc(14,'"postbuild"'),v.Pb(),v.yc(15," task to your package.json. "),v.Pb())}function Ci(e,t){if(1&e&&(v.Qb(0,"clr-dg-row"),v.Qb(1,"clr-dg-cell"),v.yc(2),v.Pb(),v.Qb(3,"clr-dg-cell"),v.yc(4),v.Pb(),v.Qb(5,"clr-dg-cell"),v.yc(6),v.Pb(),v.Qb(7,"clr-dg-cell"),v.Qb(8,"a",4),v.yc(9),v.Pb(),v.Pb(),v.Pb()),2&e){var r=t.$implicit;v.zb(2),v.zc(r.name),v.zb(2),v.zc(r.publisher),v.zb(2),v.zc(r.license),v.zb(2),v.gc("href",r.repository,v.rc),v.zb(1),v.zc(r.repository)}}function Ri(e,t){if(1&e&&(v.Ob(0),v.wc(1,Ci,10,5,"clr-dg-row",3),v.Qb(2,"clr-dg-footer"),v.yc(3),v.Pb(),v.Nb()),2&e){var r=t.ngIf;v.zb(1),v.fc("ngForOf",r),v.zb(2),v.Ac("",r.length," third party dependencies")}}var Ii,Fi,Mi=((Ii=function(){function e(t){f(this,e),this.http=t,this.class="content-container"}return h(e,[{key:"ngOnInit",value:function(){this.licenses$=this.http.get("assets/licenses.json").pipe(Object(j.a)(function(e){var t=[];for(var r in e)if(e[r]){var n=e[r];t.push({name:r,license:n.licenses,repository:n.repository,publisher:n.publisher})}return t}))}}]),e}()).\u0275fac=function(e){return new(e||Ii)(v.Kb(Zt.a))},Ii.\u0275cmp=v.Eb({type:Ii,selectors:[["app-route-licenses"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},decls:18,vars:3,consts:[[1,"content-area","licenses"],[4,"clrIfOpen"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Qb(1,"p"),v.yc(2,"A lot of third party libraries were used to create this project. Their licenses are listed here."),v.Pb(),v.Qb(3,"p"),v.yc(4,"For more information, click here: "),v.Qb(5,"clr-signpost"),v.wc(6,Ti,16,0,"clr-signpost-content",1),v.Pb(),v.Pb(),v.Qb(7,"clr-datagrid"),v.Qb(8,"clr-dg-column"),v.yc(9,"Library name"),v.Pb(),v.Qb(10,"clr-dg-column"),v.yc(11,"Publisher"),v.Pb(),v.Qb(12,"clr-dg-column"),v.yc(13,"License"),v.Pb(),v.Qb(14,"clr-dg-column"),v.yc(15,"Repository"),v.Pb(),v.wc(16,Ri,4,2,"ng-container",2),v.ac(17,"async"),v.Pb(),v.Pb()),2&e&&(v.zb(16),v.fc("ngIf",v.bc(17,1,t.licenses$)))},directives:[zt.z,zt.o,zt.g,zt.K,zt.M,zt.H,zt.N,zt.i,zt.J,Tt.n,zt.A,Tt.m,zt.j,zt.k,zt.L,zt.h,zt.I],pipes:[Tt.b],styles:[".content-area.licenses[_ngcontent-%COMP%]{padding:1em}"]}),Ii),Gi=s("1X1q"),Ai=((Fi=function(){function e(t,r){f(this,e),this.http=t,this.olSvc=r,xe.a.defs("EPSG:2966","+proj=tmerc +lat_0=37.5 +lon_0=-87.08333333333333 +k=0.999966667 +x_0=900000 +y_0=249999.9998983998 +datum=NAD83 +units=us-ft +no_defs"),Object(Se.a)(xe.a);var n=Object(we.i)("EPSG:2966");Object(we.k)(n,"EPSG:4326"),this.geojson2966To4326=new be.a({dataProjection:"EPSG:2966",featureProjection:"EPSG:4326"}),this.geojson4326=new be.a({featureProjection:"EPSG:4326"})}return h(e,[{key:"getWfsSource",value:function(e){var t=this;switch(e){case"all":return new he.a({format:new be.a,url:this.getRequestUrl(this.olSvc.EPSG),strategy:Gi.a});case"bbox":return new he.a({format:new be.a,url:function(e,r,n){var a=n.getCode();return t.getRequestUrl(a,e)},strategy:Gi.b});case"simplifyGeometry":var r=new he.a({loader:function(e,a,i){var o=i.getCode();t.http.get(t.getRequestUrl(o,e)).subscribe(function(e){var t,a=(new be.a).readFeatures(e),i=n(a);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.geometry=o.getGeometry().simplify(1e3)}}catch(s){i.e(s)}finally{i.f()}r.addFeatures(a)})},strategy:Gi.b});return r;case"noProps":var a=new he.a({loader:function(e,r,i){var o=i.getCode();t.http.get(t.getRequestUrl(o,e)).subscribe(function(e){var t,r=(new be.a).readFeatures(e),i=n(r);try{for(i.s();!(t=i.n()).done;)t.value.setProperties({})}catch(o){i.e(o)}finally{i.f()}a.addFeatures(r)})},strategy:Gi.b});return a;case"tile":throw new Error("Tile-Strategy source not yet implemented.")}}},{key:"getRequestUrl",value:function(e,t){e||(e="EPSG:4326");var r="https://ahocevar.com/geoserver/wfs?service=WFS&version=1.1.0&request=GetFeature";return r+="&outputFormat=application/json&srsname=".concat(e),r+="&typename=osm:water_areas",t&&(r+="&bbox=".concat(t.join(","),",").concat(e)),r}},{key:"createWfsLayer",value:function(e,t,r,n){var a=this.getWfsSource(r),i=new ie.a({source:a,style:n});return new C({id:e,name:t,custom_layer:i,popup:!0,visible:!1})}},{key:"createVectorTileLayer",value:function(e,t){var r=new oe.a({format:new Wa.a,url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:4326@pbf/{z}/{x}/{-y}.pbf"}),n=new Qa.a({source:r});return new C({id:e,name:t,custom_layer:n,popup:!0,visible:!1})}}]),e}()).\u0275fac=function(e){return new(e||Fi)(v.Ub(Zt.a),v.Ub(bt))},Fi.\u0275prov=v.Gb({token:Fi,factory:Fi.\u0275fac,providedIn:"root"}),Fi);function ji(e,t){1&e&&(v.Qb(0,"clr-signpost-content",4),v.Qb(1,"h3"),v.yc(2,"Change detection"),v.Pb(),v.Qb(3,"p"),v.yc(4,"This badge changes its color any time angular's change-detection was executed."),v.Pb(),v.Pb()),2&e&&v.fc("clrPosition","left-middle")}var Di,zi=((Di=function(){function e(){f(this,e),this.color="white"}return h(e,[{key:"ngAfterContentChecked",value:function(){this.color=this.getRandomColor()}},{key:"getRandomColor",value:function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}}]),e}()).\u0275fac=function(e){return new(e||Di)},Di.\u0275cmp=v.Eb({type:Di,selectors:[["ukis-blinker"]],decls:6,vars:2,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,t){1&e&&(v.Qb(0,"p",0),v.Qb(1,"clr-signpost"),v.wc(2,ji,5,1,"clr-signpost-content",1),v.Pb(),v.Qb(3,"span",2),v.yc(4," Change detected "),v.Lb(5,"span",3),v.Pb(),v.Pb()),2&e&&(v.zb(5),v.tc("background-color",t.color))},directives:[zt.z,zt.o,zt.A],styles:[".blinker[_ngcontent-%COMP%]{width:10px;height:10px}"]}),Di),Vi=s("mrSG");function Qi(e,t,r){return Object(Vi.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.then(function(n){return r.push(n),t>1?Qi(e,t-1,r):r}));case 1:case"end":return n.stop()}},n)}))}function Ni(e,t){1&e&&(v.Qb(0,"clr-signpost-content",4),v.Qb(1,"h3"),v.yc(2,"Frames per second"),v.Pb(),v.Qb(3,"p"),v.yc(4,"Estimates the number of frames that are rendered per second."),v.Pb(),v.Qb(5,"p"),v.yc(6,"This is done by periodically measuring the time a call to "),v.Qb(7,"code"),v.yc(8,"setTimeout(() => ..., 0)"),v.Pb(),v.yc(9," takes."),v.Pb(),v.Qb(10,"p"),v.yc(11,"That call is made outside the angular-zone, so as not to trigger change-detection."),v.Pb(),v.Qb(12,"p"),v.yc(13,"Please not that in Chrome you can also monitor FPS from the developer-tools: Hit "),v.Qb(14,"code"),v.yc(15,"ctrl-shift-p"),v.Pb(),v.yc(16," and enter "),v.Qb(17,"code"),v.yc(18,"fps"),v.Pb(),v.yc(19," to find the FPS-meter."),v.Pb(),v.Pb()),2&e&&v.fc("clrPosition","left-middle")}var Bi,Ui,Wi,Zi,Hi,Xi=((Wi=function(){function e(t,r){var n=this;f(this,e),this.ngZone=t,this.cdRef=r,this.pollingRate=1e3,this.precission=2,this.nrSamples=10,r.detach(),this.ngZone.runOutsideAngular(function(){n.updateFps(n.pollingRate)})}return h(e,[{key:"updateFps",value:function(e){var t=this;setTimeout(function(){(function(e){return Object(Vi.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Qi(function(){return Object(Vi.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){var r=window.performance.now();setTimeout(function(){var t=window.performance.now();e(1e3/(t-r))},0)}));case 1:case"end":return e.stop()}},e)}))}(),e,[]).then(function(e){return function(e){var t,r=0,a=n(e);try{for(a.s();!(t=a.n()).done;)r+=t.value}catch(i){a.e(i)}finally{a.f()}return r}(t=e)/t.length;var t}));case 1:case"end":return t.stop()}},t)}))})(t.nrSamples).then(function(r){var n,a,i;t.fps=(n=r,a=t.precission,i=Math.pow(10,a),Math.floor(n*i)/i),t.cdRef.detectChanges(),t.updateFps(e)})},e)}}]),e}()).\u0275fac=function(e){return new(e||Wi)(v.Kb(v.A),v.Kb(v.h))},Wi.\u0275cmp=v.Eb({type:Wi,selectors:[["ukis-fpser"]],decls:7,vars:1,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,t){1&e&&(v.Qb(0,"p",0),v.Qb(1,"clr-signpost"),v.wc(2,Ni,20,1,"clr-signpost-content",1),v.Pb(),v.Qb(3,"span",2),v.yc(4," FPS: "),v.Qb(5,"span",3),v.yc(6),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(6),v.zc(t.fps))},directives:[zt.z,zt.o,zt.A],styles:[""]}),Wi),qi=((Ui=function e(){f(this,e)}).\u0275fac=function(e){return new(e||Ui)},Ui.\u0275cmp=v.Eb({type:Ui,selectors:[["ukis-performance"]],decls:8,vars:0,consts:[[1,"clr-row"],[1,"clr-col-12"]],template:function(e,t){1&e&&(v.Qb(0,"p"),v.yc(1,"Load data and pan the map for a while to see a drop in performance."),v.Pb(),v.Qb(2,"div",0),v.Qb(3,"div",1),v.Lb(4,"ukis-blinker"),v.Pb(),v.Pb(),v.Qb(5,"div",0),v.Qb(6,"div",1),v.Lb(7,"ukis-fpser"),v.Pb(),v.Pb())},directives:[zi,Xi],styles:[""]}),Ui),Yi=((Bi=function(){function e(t,r,n,a){f(this,e),this.layersSvc=t,this.dataSvc=r,this.mapStateSvc=n,this.mapSvc=a,this.class="content-container",this.controls={attribution:!0,scaleLine:!0}}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.mapSvc.setProjection("EPSG:4326");var t=function(e,t){var r=e.getId().match(/(\d+)/)[0],n=r%255,a=(r+20)%255,i=(r+40)%255;return new Le.b({stroke:new Ce.a({color:"gray",width:1}),fill:new Oe.a({color:"rgba(".concat(n,", ").concat(a,", ").concat(i,",0.7)")})})},r=new V({visible:!0}),n=this.dataSvc.createWfsLayer("full","Fully loaded","all",t);n.description="Full dataset loaded at once.";var a=this.dataSvc.createWfsLayer("bbx","Current extent only","bbox",t);a.description="Bbox strategy: Only current bbox loaded at a time.";var i=this.dataSvc.createWfsLayer("simple","Simplified geometry","simplifyGeometry",t);i.description="Bbox strategy. Also: geometry simplified.";var o=this.dataSvc.createWfsLayer("noProps","No properties","noProps",t);o.description="Bbox strategy. Also: features have no properties.";var s=this.dataSvc.createWfsLayer("noStyle","No Styling","bbox");s.description="Bbox strategy. Also: no styling applied to features.",[r,n,a,i,o,s].map(function(t){return e.layersSvc.addLayer(t,"Layers")})}},{key:"ngAfterViewInit",value:function(){this.mapSvc.map.getView().fit([-107.14,51.85,-106.14,52.33],{size:this.mapSvc.map.getSize()})}}]),e}()).\u0275fac=function(e){return new(e||Bi)(v.Kb(G),v.Kb(Ai),v.Kb(z),v.Kb(bt))},Bi.\u0275cmp=v.Eb({type:Bi,selectors:[["app-route-map7"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,z,bt])],decls:13,vars:9,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","clock","title","Performance","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Lb(1,"ukis-map-ol",1),v.Pb(),v.Qb(2,"clr-vertical-nav",2),v.Qb(3,"clr-vertical-nav-group",3),v.Lb(4,"clr-icon",4),v.yc(5," Performance "),v.Qb(6,"clr-vertical-nav-group-children",5),v.Lb(7,"ukis-performance"),v.Pb(),v.Pb(),v.Qb(8,"clr-vertical-nav-group",3),v.Lb(9,"clr-icon",6),v.yc(10," Layers "),v.Qb(11,"clr-vertical-nav-group-children",5),v.Lb(12,"ukis-layer-control",7),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(1),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(5),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(4),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[Mt,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,qi,ia],styles:[""]}),Bi),Ki=s("cR4a"),Ji=[{path:"",redirectTo:"example-layers",pathMatch:"full"},{path:"example-layers",component:ha,data:{title:"Layers"}},{path:"example-projection",component:Ra,data:{title:"Projection"}},{path:"example-events",component:za,data:{title:"Events"}},{path:"example-custom-layers",component:wi,data:{title:"Custom Layers"}},{path:"example-layout",component:Ei,data:{title:"Two Vertical-Nav Layout"}},{path:"example-layer-style",component:Oi,data:{title:"Switching Layer-Style"}},{path:"ol-performance",component:Yi,data:{title:"Ol-Performance"}},{path:"threejs",component:(Zi=function(){function e(t,r,n,a){f(this,e),this.layersSvc=t,this.mapStateSvc=r,this.mapOlSvc=n,this.mapThreeSvc=a,this.class="content-container",this.controls={attribution:!0,mousePosition:!0,scaleLine:!0,zoom:!0}}return h(e,[{key:"ngOnInit",value:function(){var e=new ae.a({source:new ue.a({url:"https://planetarymaps.usgs.gov/cgi-bin/mapserv?map=/maps/mars/phobos_simp_cyl.map",params:{LAYERS:"VIKING"},crossOrigin:"anonymous"})}),t=new Ki.a({showLabels:!0,wrapX:!0,latLabelPosition:.5}),r=new C({id:"phobos",name:"Phobos",custom_layer:e,description:"There are a few objects that are very big, but still irregularly shaped.\n      Because they are big, it makes sense to serve their image-material per WMTS instead of a single, humongous file.\n      Because they are irregularly shaped, it makes sense to display them in 3d.\n\n      This demo shows how we can project openlayers-layers onto a three-js mesh to reap the benefits of both libraries."}),n=new C({id:"graticule",name:"Graticule",custom_layer:t,description:"Note how adding and removing this layer is reflected in both the map and the 3d-object."});this.layersSvc.addLayer(r),this.layersSvc.addLayer(n)}},{key:"ngAfterViewInit",value:function(){var e=Object(we.i)("EPSG:4326");this.mapOlSvc.setProjection(e),this.mapOlSvc.map.getView().setMaxZoom(4)}}]),e}(),Zi.\u0275fac=function(e){return new(e||Zi)(v.Kb(G),v.Kb(z),v.Kb(bt),v.Kb(li))},Zi.\u0275cmp=v.Eb({type:Zi,selectors:[["app-route-example-threejs"]],hostVars:2,hostBindings:function(e,t){2&e&&v.Bb(t.class)},features:[v.yb([G,bt])],decls:25,vars:10,consts:[[1,"content-area"],[2,"height","49.5%","width","100%"],["id","olMap",3,"layersSvc","mapState","controls"],[2,"height","50%","width","100%"],["id","threeMap",3,"mapOlSvc"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","info","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[1,"card",2,"margin","0px","margin-bottom","10px"],[1,"card-block"],[1,"card-text"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"alert-item","static"],[1,"alert-text"],[3,"layersSvc","mapStateSvc"]],template:function(e,t){1&e&&(v.Qb(0,"main",0),v.Qb(1,"div",1),v.Lb(2,"ukis-map-ol",2),v.Pb(),v.Qb(3,"div",3),v.Lb(4,"ukis-map-three",4),v.Pb(),v.Pb(),v.Qb(5,"clr-vertical-nav",5),v.Qb(6,"clr-vertical-nav-group",6),v.Lb(7,"clr-icon",7),v.yc(8," Phobos "),v.Qb(9,"clr-vertical-nav-group-children",8),v.Qb(10,"div",9),v.Qb(11,"div",10),v.Qb(12,"div",11),v.Qb(13,"p"),v.yc(14," This is a threejs/openlayers demo application. Here, we project an openlayers map as a canvas-texture onto a glTF model of the Mars-moon Phobos. "),v.Pb(),v.Qb(15,"p"),v.yc(16," There are some objects that are so irregular that they are better displayed with a three dimensional model, yet so large that their imagedata is best served per WMTS. Phobos is a good example of such an object. Note how the texture gets sharper when you zoom in: this is a new WMTS tile being loaded, projected and displayed on the fly. "),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Pb(),v.Qb(17,"clr-vertical-nav-group",6),v.Lb(18,"clr-icon",12),v.yc(19," Layers "),v.Qb(20,"clr-vertical-nav-group-children",8),v.Qb(21,"div",13),v.Qb(22,"span",14),v.yc(23," The controls of map and 3d-object are synced. Use the mouse to pan around in either and watch both displays change. "),v.Pb(),v.Pb(),v.Lb(24,"ukis-layer-control",15),v.Pb(),v.Pb(),v.Pb()),2&e&&(v.zb(2),v.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),v.zb(2),v.fc("mapOlSvc",t.mapOlSvc),v.zb(1),v.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),v.zb(1),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(11),v.fc("clrVerticalNavGroupExpanded",!0),v.zb(7),v.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[Mt,fi,zt.B,zt.u,zt.C,zt.n,zt.E,zt.D,zt.b,ia],styles:[""]}),Zi),data:{title:"Threejs"}},{path:"licenses",component:Mi,data:{title:"Licenses"}}],$i=((Hi=function e(){f(this,e)}).\u0275fac=function(e){return new(e||Hi)},Hi.\u0275mod=v.Ib({type:Hi}),Hi.\u0275inj=v.Hb({imports:[[y.f.forRoot(Ji,{useHash:!0,preloadingStrategy:y.b,relativeLinkResolution:"legacy"})],y.f]}),Hi);"undefined"!=typeof window&&window.hasOwnProperty("ClarityIcons")&&window.ClarityIcons.add({ukis:'\n                <svg version="1.1" viewBox="0 0 36 36" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>ukis</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M18,31.5c4.7,0,8.9-2.4,11.3-6.1H6.7C9.1,29.1,13.3,31.5,18,31.5z"/>\n                    <path class="clr-i-solid clr-i-solid-path-2" d="M4.5,17.1c0,0.3,0,0.6,0,0.9c0,1.7,0.3,3.4,0.9,4.9h21.2L4.5,17.1z"/>\n                    <path class="clr-i-solid clr-i-solid-path-3" d="M31,21.5c0.3-1.1,0.5-2.3,0.5-3.5c0-3-1-5.7-2.6-7.9L8.7,15.6L31,21.5z"/>\n                    <path class="clr-i-solid clr-i-solid-path-4" d="M18,4.5c-6,0-11.2,4-12.9,9.5l22-6C24.7,5.8,21.5,4.5,18,4.5z"/>\n                </svg>\n            ',dlr:'\n                <svg version="1.1" viewBox="0 0 36 36" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>dlr</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M25.8,13.2V3.8l-9.4,9.4h-8l-7.7,7.7l9.4,0v9.4l9.4-9.4h8l7.7-7.7H25.8L25.8,13.2z M23.9,8.5v4.7h-4.7L23.9,8.5\n                    L23.9,8.5z M5.4,18.9l3.8-3.8h5.3l-3.8,3.8H5.4L5.4,18.9z M12.1,25.6v-4.8h4.8L12.1,25.6L12.1,25.6z M18.8,18.9h-5.4l3.8-3.8h5.4\n                    L18.8,18.9L18.8,18.9z M26.8,18.9h-5.2l3.8-3.8h5.2L26.8,18.9L26.8,18.9z M19.6,26.5h1.6c1.8,0,3.3,0.6,3.3,2.9\n                    c0,2.3-1.6,2.9-3.3,2.9h-1.6V26.5L19.6,26.5z M20.8,31.3h0.6c1,0,1.9-0.7,1.9-2c0-1.2-0.9-2-1.9-2h-0.6V31.3L20.8,31.3z M25.7,26.5\n                    h1.1v4.8h2.2v0.9h-3.4V26.5L25.7,26.5z M30.1,26.5h1.2c1.2,0,2.7,0,2.7,1.6c0,0.7-0.5,1.2-1.2,1.3v0c0.3,0,0.5,0.3,0.6,0.6l0.9,2.2\n                    h-1.3l-0.7-1.8c-0.2-0.4-0.3-0.6-0.8-0.6h-0.4v2.4h-1.1V26.5L30.1,26.5z M31.3,28.9h0.4c0.6,0,1.2-0.1,1.2-0.8\n                    c0-0.7-0.6-0.7-1.2-0.7h-0.4V28.9L31.3,28.9z"/>\n                </svg>\n            ',eoc:'\n                <svg version="1.1" viewBox="0 0 580 220" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>eoc</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M284,210c-55.1,0-100-44.9-100-100S228.9,10,284,10s100,44.9,100,100S339.1,210,284,210z M284,28.2\n                    c-45.1,0-81.8,36.7-81.8,81.8s36.7,81.8,81.8,81.8s81.8-36.7,81.8-81.8S329.1,28.2,284,28.2z M566,180.7l-12.9-12.9\n                    c-31.9,31.9-83.8,31.9-115.7,0c-31.9-31.9-31.9-83.8,0-115.7c31.9-31.9,83.8-31.9,115.7,0L566,39.3c-39-39-102.5-39-141.5,0\n                    s-39,102.5,0,141.5c19.5,19.5,45.1,29.3,70.7,29.3S546.5,200.2,566,180.7z M184.7,180.7l-12.9-12.9c-31.9,31.9-83.8,31.9-115.7,0\n                    c-15.5-15.5-24-36-24-57.8c0-21.9,8.5-42.4,24-57.8c28.6-28.6,73.4-31.8,105.5-8.7l-67.8,75.2l13.5,12.2l80.3-89.1l-6.7-6.1\n                    C141.4,0.1,80.9,1.7,43.3,39.3C24.4,58.2,14,83.3,14,110c0,26.7,10.4,51.8,29.3,70.7C62.8,200.2,88.4,210,114,210\n                    C139.6,210,165.2,200.2,184.7,180.7z"/>\n                </svg>\n            '});var eo,to,ro=((eo=function(){function e(){f(this,e),this.alertSource=new Fe.a,this.alert$=this.alertSource.asObservable()}return h(e,[{key:"alert",value:function(e){this.alertSource.next(e)}}]),e}()).\u0275fac=function(e){return new(e||eo)},eo.\u0275prov=v.Gb({token:eo,factory:eo.\u0275fac,providedIn:"root"}),eo),no=[[["",8,"header-nav-el"]],"*",[["",8,"header-action-el"]]],ao=[".header-nav-el","*",".header-action-el"],io=((to=function(){function e(){f(this,e)}return h(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||to)},to.\u0275cmp=v.Eb({type:to,selectors:[["ukis-header"]],inputs:{title:["ukis-title","title"]},ngContentSelectors:ao,decls:14,vars:3,consts:[[1,"header-1"],[1,"branding"],["href","https://www.dlr.de","target","_blank","alt","link to dlr"],["shape","dlr","size","48","alt","dlr icon",1,"is-solid"],["href","https://www.dlr.de/eoc/desktopdefault.aspx/tabid-5413/10560_read-21914","target","_blank","alt","link to dlr ukis"],["shape","ukis","size","33","alt","ukis icon",1,"is-solid"],["routerLink","/","routerLinkActive","active",1,"nav-link","title"],[1,"title",3,"title"],[1,"header-nav",3,"clr-nav-level"],[1,"header-actions"]],template:function(e,t){1&e&&(v.ec(no),v.Qb(0,"clr-header",0),v.Qb(1,"div",1),v.Qb(2,"a",2),v.Lb(3,"clr-icon",3),v.Pb(),v.Qb(4,"a",4),v.Lb(5,"clr-icon",5),v.Pb(),v.Qb(6,"a",6),v.Qb(7,"span",7),v.yc(8),v.Pb(),v.Pb(),v.Pb(),v.Qb(9,"div",8),v.dc(10),v.Pb(),v.dc(11,1),v.Qb(12,"div",9),v.dc(13,2),v.Pb(),v.Pb()),2&e&&(v.zb(7),v.fc("title",t.title),v.zb(1),v.zc(t.title),v.zb(1),v.fc("clr-nav-level",1))},directives:[zt.m,zt.G,zt.n,y.e,y.d,zt.u],styles:[""]}),to);function oo(e,t){if(1&e&&(v.Qb(0,"button",11),v.Xb("click",function(){var e=t.$implicit;return e.callback&&e.callback()}),v.yc(1),v.Pb()),2&e){var r=t.$implicit;v.zb(1),v.zc(r.title)}}function so(e,t){if(1&e&&(v.Qb(0,"div",9),v.wc(1,oo,2,1,"button",10),v.Pb()),2&e){var r=v.Zb(2);v.zb(1),v.fc("ngForOf",r.alert.actions)}}function co(e,t){if(1&e){var r=v.Rb();v.Qb(0,"button",12),v.Xb("click",function(){return v.pc(r),v.Zb(2).close()}),v.Lb(1,"clr-icon",13),v.Pb()}}function lo(e,t){if(1&e&&(v.Qb(0,"div",1),v.Qb(1,"div",2),v.Qb(2,"div",3),v.Qb(3,"div",4),v.Lb(4,"clr-icon",5),v.Pb(),v.Lb(5,"div",6),v.wc(6,so,2,1,"div",7),v.Pb(),v.Pb(),v.wc(7,co,2,0,"button",8),v.Pb()),2&e){var r=v.Zb();v.fc("ngClass","alert-"+r.alert.type),v.zb(5),v.fc("innerHTML",r.alert.text,v.qc),v.zb(1),v.fc("ngIf",r.alert.actions),v.zb(1),v.fc("ngIf",r.alert.closeable)}}var uo,po=((uo=function(){function e(){f(this,e),this.alertChange=new v.n}return h(e,[{key:"close",value:function(){this.alert=null,this.alertChange.emit(this.alert)}}]),e}()).\u0275fac=function(e){return new(e||uo)},uo.\u0275cmp=v.Eb({type:uo,selectors:[["ukis-global-alert"]],inputs:{alert:"alert"},outputs:{alertChange:"alertChange"},decls:1,vars:1,consts:[["class","alert alert-app-level","role","alert",3,"ngClass",4,"ngIf"],["role","alert",1,"alert","alert-app-level",3,"ngClass"],[1,"alert-items"],[1,"alert-item","static"],[1,"alert-icon-wrapper"],["shape","info-circle",1,"alert-icon"],[1,"alert-text",3,"innerHTML"],["class","alert-actions",4,"ngIf"],["type","button","class","close","aria-label","alert close",3,"click",4,"ngIf"],[1,"alert-actions"],["class","btn alert-action","aria-label","alert action",3,"click",4,"ngFor","ngForOf"],["aria-label","alert action",1,"btn","alert-action",3,"click"],["type","button","aria-label","alert close",1,"close",3,"click"],["aria-hidden","true","shape","close"]],template:function(e,t){1&e&&v.wc(0,lo,8,4,"div",0),2&e&&v.fc("ngIf",t.alert)},directives:[Tt.n,Tt.l,zt.n,zt.b,Tt.m],styles:[""]}),uo);function fo(e,t){if(1&e&&(v.Qb(0,"span"),v.Qb(1,"div",1),v.Lb(2,"progress"),v.Pb(),v.Pb()),2&e){var r=v.Zb();v.zb(1),v.fc("ngClass",r.progress.class)}}function ho(e,t){if(1&e&&(v.Qb(0,"span"),v.Qb(1,"div",2),v.Lb(2,"progress",3),v.Pb(),v.Pb()),2&e){var r=v.Zb();v.zb(1),v.fc("ngClass",r.progress.class),v.zb(1),v.gc("max",r.progress.max),v.gc("value",r.progress.value)}}var vo,yo=((vo=function(){function e(){f(this,e)}return h(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||vo)},vo.\u0275cmp=v.Eb({type:vo,selectors:[["ukis-global-progress"]],inputs:{progress:"progress"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"progress","loop",3,"ngClass"],[1,"progress",3,"ngClass"],[3,"max","value"]],template:function(e,t){1&e&&(v.wc(0,fo,3,1,"span",0),v.wc(1,ho,3,3,"span",0)),2&e&&(v.fc("ngIf",t.progress&&t.progress.indeterminate),v.zb(1),v.fc("ngIf",t.progress&&!t.progress.indeterminate))},directives:[Tt.n,Tt.l],styles:[".progress[_ngcontent-%COMP%]{height:.5em}"]}),vo);function mo(e,t){if(1&e){var r=v.Rb();v.Qb(0,"ukis-global-alert",5),v.Xb("alertChange",function(e){return v.pc(r),v.Zb().ui.alert=e}),v.Pb()}if(2&e){var n=v.Zb();v.fc("alert",n.ui.alert)}}function bo(e,t){if(1&e){var r=v.Rb();v.Qb(0,"ukis-global-progress",6),v.Xb("progressChange",function(e){return v.pc(r),v.Zb().ui.progress=e}),v.Pb()}if(2&e){var n=v.Zb();v.fc("progress",n.ui.progress)}}function go(e,t){if(1&e&&(v.Qb(0,"a",7),v.yc(1),v.Pb()),2&e){var r=t.$implicit;v.hc("routerLink","/",r.path,""),v.zb(1),v.zc(r.data.title)}}var wo,So,xo,Po,ko,_o,Lo=function(e){return{floating:e}},Eo=((wo=function(){function e(t,r,n){var a=this;f(this,e),this.alertService=t,this.progressService=r,this.router=n,this.title="",this.shortTitle="",this.ui={floating:!1,flipped:!1,alert:null,progress:null},this.showProgress=function(e){a.ui.progress=e},this.setAlert=function(e){a.ui.alert=e},this.init(),this.routes=this.router.config.filter(function(e){return e.data})}return h(e,[{key:"init",value:function(){var e=this;this.getHtmlMeta(["title","version","description","short-title"]),this.TITLE&&(this.title=this.TITLE),this["SHORT-TITLE"]&&(this.shortTitle=this["SHORT-TITLE"]),this.alertService.alert$.subscribe(function(t){e.setAlert(t)}),this.progressService.progress$.subscribe(function(t){e.showProgress(t)})}},{key:"getHtmlMeta",value:function(e){for(var t=document.getElementsByTagName("meta"),r=0,n=t.length;r<n;r++){var a=t[r],i=a.getAttribute("name");e.includes(i)&&(this[i.toUpperCase()]=a.getAttribute("content")||a.getAttribute("value"))}}}]),e}()).\u0275fac=function(e){return new(e||wo)(v.Kb(ro),v.Kb(Da),v.Kb(y.c))},wo.\u0275cmp=v.Eb({type:wo,selectors:[["app-root"]],decls:6,vars:7,consts:[[3,"ngClass"],[3,"alert","alertChange",4,"ngIf"],[3,"progress","progressChange",4,"ngIf"],[3,"ukis-title"],["routerLinkActive","active","class","nav-link nav-text header-nav-el",3,"routerLink",4,"ngFor","ngForOf"],[3,"alert","alertChange"],[3,"progress","progressChange"],["routerLinkActive","active",1,"nav-link","nav-text","header-nav-el",3,"routerLink"]],template:function(e,t){1&e&&(v.Qb(0,"clr-main-container",0),v.wc(1,mo,1,1,"ukis-global-alert",1),v.wc(2,bo,1,1,"ukis-global-progress",2),v.Qb(3,"ukis-header",3),v.wc(4,go,2,2,"a",4),v.Pb(),v.Lb(5,"router-outlet"),v.Pb()),2&e&&(v.fc("ngClass",v.jc(5,Lo,t.ui.floating)),v.zb(1),v.fc("ngIf",t.ui.alert),v.zb(1),v.fc("ngIf",t.ui.progress),v.zb(1),v.fc("ukis-title",t.title),v.zb(1),v.fc("ngForOf",t.routes))},directives:[zt.t,zt.F,Tt.l,Tt.n,io,Tt.m,y.g,po,yo,y.e,y.d],styles:[""]}),wo),Oo=s("omvX"),To=function(){var e=function(){function e(){f(this,e),this.progressSource=new Fe.a,this.progress$=this.progressSource.asObservable()}return h(e,[{key:"progress",value:function(e){this.progressSource.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=v.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Co=function(){var e=function(){function e(){f(this,e),this.alertSource=new Fe.a,this.alert$=this.alertSource.asObservable()}return h(e,[{key:"alert",value:function(e){this.alertSource.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=v.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ro=((_o=function e(){f(this,e)}).\u0275fac=function(e){return new(e||_o)},_o.\u0275mod=v.Ib({type:_o}),_o.\u0275inj=v.Hb({providers:[Co,To],imports:[[Tt.c,zt.a]]}),_o),Io=((ko=function e(){f(this,e)}).\u0275fac=function(e){return new(e||ko)},ko.\u0275mod=v.Ib({type:ko}),ko.\u0275inj=v.Hb({imports:[[Tt.c,zt.a,nn.h,Kr.d,Ro]]}),ko),Fo=((Po=function e(){f(this,e)}).\u0275fac=function(e){return new(e||Po)},Po.\u0275mod=v.Ib({type:Po}),Po.\u0275inj=v.Hb({imports:[[Tt.c,nn.h,zt.a]]}),Po),Mo=((xo=function e(){f(this,e)}).\u0275fac=function(e){return new(e||xo)},xo.\u0275mod=v.Ib({type:xo}),xo.\u0275inj=v.Hb({imports:[[]]}),xo),Go=((So=function e(){f(this,e)}).\u0275fac=function(e){return new(e||So)},So.\u0275mod=v.Ib({type:So,bootstrap:[Eo]}),So.\u0275inj=v.Hb({providers:[ro,Da],imports:[[d.a,$i,zt.a,nn.h,nn.s,Oo.a,Gt,di,Io,Fo,Mo,Zt.b,Yr]]}),So);Object(v.S)(),d.b().bootstrapModule(Go).catch(function(e){return console.error(e)})},IDPa:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return a});var n=function(e){return e.hasOwnProperty("jobID")&&e.hasOwnProperty("status")},a=function(e){return e.hasOwnProperty("output")}},JF1W:function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"title":"Polygon 1"},"geometry":{"type":"Polygon","coordinates":[[[-178.59375,15.961329081596647],[-166.640625,15.961329081596647],[-166.640625,27.994401411046148],[-178.59375,27.994401411046148],[-178.59375,15.961329081596647]]]}},{"type":"Feature","properties":{"title":"Polygon 2"},"geometry":{"type":"Polygon","coordinates":[[[-179.296875,-1.4061088354351594],[-168.75,-1.4061088354351594],[-168.75,10.487811882056695],[-179.296875,10.487811882056695],[-179.296875,-1.4061088354351594]]]}},{"type":"Feature","properties":{"title":"Polygon 3"},"geometry":{"type":"Polygon","coordinates":[[[-158.203125,5.61598581915534],[-146.25,5.61598581915534],[-146.25,22.59372606392931],[-158.203125,22.59372606392931],[-158.203125,5.61598581915534]]]}},{"type":"Feature","properties":{"title":"Polygon 4"},"geometry":{"type":"Polygon","coordinates":[[[-162.0703125,-13.2399454992863],[-150.82031249999997,-13.2399454992863],[-150.82031249999997,-1.0546279422758742],[-162.0703125,-1.0546279422758742],[-162.0703125,-13.2399454992863]]]}},{"type":"Feature","properties":{"title":"Polygon 5"},"geometry":{"type":"Polygon","coordinates":[[[-142.3828125,-20.632784250388013],[-131.1328125,-20.632784250388013],[-131.1328125,-2.108898659243126],[-142.3828125,-2.108898659243126],[-142.3828125,-20.632784250388013]]]}},{"type":"Feature","properties":{"title":"Polygon 6"},"geometry":{"type":"Polygon","coordinates":[[[-106.171875,44.08758502824516],[-100.8984375,39.90973623453719],[-95.625,42.8115217450979],[-101.25,46.800059446787316],[-106.171875,44.08758502824516]]]}}]}')},M4FE:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return o});var a=r("IDPa"),i=r("l8mB"),o=function(){function t(){f(this,t)}return h(t,[{key:"getCapabilitiesUrl",value:function(e){return"".concat(e,"?service=WPS&request=GetCapabilities&version=2.0.0")}},{key:"getDescribeProcessUrl",value:function(e,t){return"".concat(e,"?service=WPS&request=DescribeProcess&version=2.0.0&Identifier=").concat(t)}},{key:"unmarshalProcessDescription",value:function(e){var t,r,a,i=e.processOffering[0],o=[],s=n(i.process.input);try{for(s.s();!(a=s.n()).done;){var c=a.value;o.push({description:this.unmarshalInputDescription(c),value:null})}}catch(d){s.e(d)}finally{s.f()}var l,u=[],p=n(i.process.output);try{for(p.s();!(l=p.n()).done;){var f=l.value;u.push({description:this.unmarshalOutputDescription(f),value:null})}}catch(d){p.e(d)}finally{p.f()}return{id:i.process.identifier.value,processVersion:i.processVersion||"",description:null===(t=i.process._abstract)||void 0===t?void 0:t.value,title:(null===(r=i.process.title)||void 0===r?void 0:r.value)||"",inputs:o,outputs:u}}},{key:"unmarshalInputDescription",value:function(e){var t,r,n,a,i,o;if("BoundingBoxData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e.abstract)||void 0===t?void 0:t.value};if("LiteralData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",defaultValue:null===(n=null===(r=e.dataDescription.value.literalDataDomain)||void 0===r?void 0:r.defaultValue)||void 0===n?void 0:n.value,options:null===(a=e.dataDescription.value.literalDataDomain)||void 0===a?void 0:a.allowedValues.valueOrRange.map(function(e){return e.value}),description:null===(i=e.abstract)||void 0===i?void 0:i.value};if("ComplexData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.dataDescription.value.format[0].mimeType,description:null===(o=e.abstract)||void 0===o?void 0:o.value};throw new Error("Cannot unmarshal input-description ".concat(e.identifier.value))}},{key:"unmarshalOutputDescription",value:function(e){var t,r,n;if("BoundingBoxData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e.abstract)||void 0===t?void 0:t.value};if("LiteralData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",description:null===(r=e.abstract)||void 0===r?void 0:r.value};if("ComplexData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.dataDescription.value.format[0].mimeType,description:null===(n=e.abstract)||void 0===n?void 0:n.value};throw new Error("Cannot unmarshal input-description ".concat(e.identifier.value))}},{key:"executeUrl",value:function(e,t){return"".concat(e,"?service=WPS&request=Execute&version=2.0.0&identifier=").concat(t)}},{key:"unmarshalCapabilities",value:function(e){var t=[];return e.contents.processSummary.forEach(function(e){t.push({id:e.identifier.value})}),t}},{key:"unmarshalSyncExecuteResponse",value:function(e,t,r,i,o){var s=this,c=[];if(Object(a.a)(e.value)){var l,u=n(e.value.output);try{var p=function(){var e=l.value,t=o.find(function(t){return t.id===e.id});if(!t)throw new Error("Could not find an output-description for the parameter ".concat(e.id,"."));var r=t.reference,n=t.type,a=t.format,i=void 0;if(e.reference)i=e.reference.href||null;else{if(!e.data)throw new Error("Output has neither reference nor data field.");i=s.unmarshalOutputData(e.data,t)}c.push({description:{id:e.id,title:t.title,format:a,reference:r,type:n},value:i})};for(u.s();!(l=u.n()).done;)p()}catch(f){u.e(f)}finally{u.f()}}else Object(a.b)(e.value)&&c.push({description:{id:r,title:"",reference:!0,type:"status"},value:{status:e.value.status,jobID:e.value.jobID,percentCompleted:e.value.percentCompleted}});return c}},{key:"unmarshalOutputData",value:function(t,r){if("complex"===r.type)switch("base64"===t.encoding&&t.content.map(e.exports?function(e){return new Buffer(e,"base64").toString("ascii")}:function(e){return atob(e)}),t.mimeType){case"application/vnd.geo+json":case"application/json":return t.content.map(function(e){return JSON.parse(e)});case"application/WMS":return t.content;case"text/xml":case"application/xml":return i.serializeToString(t.content[0]);default:throw new Error("Cannot unmarshal complex data of format ".concat(t.mimeType))}else if("literal"===r.type)return t.content;throw new Error("Not yet implemented: ".concat(t))}},{key:"unmarshalAsyncExecuteResponse",value:function(e,t,r,n,a){return this.unmarshalGetStateResponse(e,t,r,n,a)}},{key:"unmarshalGetStateResponse",value:function(e,t,r,n,i){if(Object(a.b)(e.value))return{status:e.value.status,jobID:e.value.jobID,percentCompleted:e.value.percentCompleted};throw new Error("Not a status-info: ".concat(e))}},{key:"marshalExecBody",value:function(e,t,r,n){return{name:{key:"{http://www.opengis.net/wps/2.0}Execute",localPart:"Execute",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:Execute"},value:{TYPE_NAME:"WPS_2_0.ExecuteRequestType",service:"WPS",version:"2.0.0",identifier:{value:e},input:this.marshalInputs(t),output:this.marshalOutputs(r),mode:n?"async":"sync",response:"document"}}}},{key:"marshalInputs",value:function(e){return e.map(function(e){return e.description.reference?{id:e.description.id,reference:{href:e.value,mimeType:e.description.format}}:{id:e.description.id,data:{content:[JSON.stringify(e.value)],mimeType:e.description.format}}})}},{key:"marshalOutputs",value:function(e){return e.map(function(e){return{id:e.id,mimeType:e.format,transmission:e.reference?"reference":"value"}})}},{key:"marshallGetStatusBody",value:function(e,t,r){return{name:{key:"{http://www.opengis.net/wps/2.0}GetStatus",localPart:"GetStatus",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:GetStatus"},value:{jobID:r,service:"WPS",version:"2.0.0"}}}},{key:"marshallGetResultBody",value:function(e,t,r){return{name:{key:"{http://www.opengis.net/wps/2.0}GetResult",localPart:"GetResult",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:GetResult"},value:{service:"WPS",version:"2.0.0",jobID:r}}}},{key:"dismissUrl",value:function(e,t,r){return e}},{key:"marshalDismissBody",value:function(e){return{name:{key:"{http://www.opengis.net/wps/2.0}Dismiss",localPart:"Dismiss",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:Dismiss"},value:{jobID:e,service:"WPS",version:"2.0.0"}}}},{key:"unmarshalDismissResponse",value:function(e,t,r){return{status:e.value.status,jobID:e.value.jobID}}}]),t}()}).call(this,r("3UD+")(e))},mxoJ:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return i});var a=r("l8mB"),i=function(){function t(){f(this,t)}return h(t,[{key:"getCapabilitiesUrl",value:function(e){return"".concat(e,"?service=WPS&request=GetCapabilities&version=1.0.0")}},{key:"getDescribeProcessUrl",value:function(e,t){return"".concat(e,"?service=WPS&request=DescribeProcess&version=1.0.0&Identifier=").concat(t)}},{key:"executeUrl",value:function(e,t){return"".concat(e,"?service=WPS&request=Execute&version=1.0.0&identifier=").concat(t)}},{key:"unmarshalCapabilities",value:function(e){var t=[];return e.processOfferings.process.forEach(function(e){t.push({id:e.identifier.value})}),t}},{key:"unmarshalProcessDescription",value:function(e){var t,r,a=e.processDescription[0],i=[],o=n(a.dataInputs.input);try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push({description:this.unmarshalInputDescription(s),value:null})}}catch(f){o.e(f)}finally{o.f()}var c,l=[],u=n(a.processOutputs.output);try{for(u.s();!(c=u.n()).done;){var p=c.value;l.push({description:this.unmarshalOutputDescription(p),value:null})}}catch(f){u.e(f)}finally{u.f()}return{id:a.identifier.value,processVersion:a.processVersion,description:null===(t=a._abstract)||void 0===t?void 0:t.value,title:a.title.value,inputs:i,outputs:l}}},{key:"unmarshalSyncExecuteResponse",value:function(e,t,r,a,i){var o=[];if(e.value.status.processFailed)o.push({description:{id:e.value.process.identifier.value,title:e.value.process.title.value,reference:!0,type:"error"},value:e.value.statusLocation});else if(e.value.processOutputs){var s,c=n(e.value.processOutputs.output);try{for(c.s();!(s=c.n()).done;){var l=s.value,u=!!l.reference,p=void 0,f=void 0,d=void 0;l.reference?(p="complex",f=l.reference.href||null,d=l.reference.mimeType):(l.data&&l.data.literalData?(p="literal",d=l.data.literalData.dataType):l.data&&l.data.complexData?(p="complex",d=l.data.complexData.mimeType):(p="bbox",d=void 0),f=this.unmarshalOutputData(l.data)),o.push({description:{id:l.identifier.value,title:l.title.value,format:d,reference:u,type:p},value:f})}}catch(h){c.e(h)}finally{c.f()}}else e.value.statusLocation&&o.push({description:{id:e.value.process.identifier.value,title:e.value.process.title.value,reference:!0,type:"status"},value:this.unmarshalGetStateResponse(e,t,r,a,i)});return o}},{key:"unmarshalOutputData",value:function(t){if(t.complexData)switch("base64"===t.complexData.encoding&&t.complexData.content.map(e.exports?function(e){return new Buffer(e,"base64").toString("ascii")}:function(e){return atob(e)}),t.complexData.mimeType){case"application/vnd.geo+json":case"application/json":return t.complexData.content.map(function(e){return JSON.parse(e)});case"application/WMS":return t.complexData.content;case"text/xml":case"application/xml":return a.serializeToString(t.complexData.content[0]);default:throw new Error("Cannot unmarshal data of format ".concat(t.complexData.mimeType))}else if(t.literalData)switch(t.literalData.dataType){case"string":default:return t.literalData.value}throw new Error("Not yet implemented: ".concat(t))}},{key:"unmarshalInputDescription",value:function(e){var t,r,n,a;if(e.boundingBoxData)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e._abstract)||void 0===t?void 0:t.value,format:"text/plain"};if(e.complexData)return{id:e.identifier.value,title:e.title.value,reference:e.storeSupported,type:"complex",description:null===(r=e._abstract)||void 0===r?void 0:r.value,format:e.complexData._default.format.mimeType};if(e.literalData)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",description:null===(n=e._abstract)||void 0===n?void 0:n.value,defaultValue:e.literalData.defaultValue,options:null===(a=e.literalData.allowedValues)||void 0===a?void 0:a.valueOrRange.map(function(e){return e.value}),format:"text/plain"};throw new Error("Cannot unmarshal the input-description for ".concat(e.identifier.value))}},{key:"unmarshalOutputDescription",value:function(e){if(e.complexOutput)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.complexOutput._default.format.mimeType};if(e.boundingBoxOutput)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox"};if(e.literalOutput)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal"};throw new Error("Cannot unmarshal the input-description for ".concat(e.identifier.value))}},{key:"unmarshalAsyncExecuteResponse",value:function(e,t,r,n,a){return this.unmarshalGetStateResponse(e,t,r,n,a)}},{key:"unmarshalGetStateResponse",value:function(e,t,r,n,a){var i=e.value,o={status:i.status.processSucceeded?"Succeeded":i.status.processAccepted?"Accepted":i.status.processStarted?"Running":"Failed",statusLocation:i.statusLocation};return i.processOutputs&&i.processOutputs.output&&(o.results=e),o}},{key:"marshalExecBody",value:function(e,t,r,n){return{name:{key:"{http://www.opengis.net/wps/1.0.0}Execute",localPart:"Execute",namespaceURI:"http://www.opengis.net/wps/1.0.0",prefix:"wps",string:"{http://www.opengis.net/wps/1.0.0}wps:Execute"},value:{dataInputs:this.marshalInputs(t),identifier:e,responseForm:this.marshalResponseForm(r,n),service:"WPS",version:"1.0.0"}}}},{key:"marshalResponseForm",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[],i=n(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,s=void 0;switch(o.type){case"literal":case"complex":s={identifier:{value:o.id},asReference:o.reference,mimeType:o.format};break;default:throw new Error("This Wps-outputtype has not been implemented yet! ".concat(o," "))}a.push(s)}}catch(c){i.e(c)}finally{i.f()}return{responseDocument:{output:a,status:!!r,storeExecuteResponse:!!r}}}},{key:"marshalInputs",value:function(e){var t,r=[],a=n(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(null==i.value)throw new Error("Value for input ".concat(i.description.id," is not set"));var o=this.marshalInput(i);r.push(o)}}catch(s){a.e(s)}finally{a.f()}return{input:r}}},{key:"marshalInput",value:function(e){var t={identifier:{value:e.description.id},title:{value:e.description.id},_abstract:{value:""}};return e.description.reference?t.reference=this.marshalReferenceInput(e):t.data=this.marshalDataInput(e),t}},{key:"marshalDataInput",value:function(e){var t;switch(e.description.type){case"literal":t={literalData:{value:String(e.value)}};break;case"bbox":var r=e.value;t={boundingBoxData:{lowerCorner:[r.lllat,r.lllon],upperCorner:[r.urlat,r.urlon]}};break;case"complex":switch(e.description.format){case"text/xml":t={complexData:{content:[e.value],mimeType:e.description.format}};break;default:t={complexData:{content:[JSON.stringify(e.value)],mimeType:e.description.format}}}break;default:throw Error("This input is of type ".concat(e.description.type,". We can only marshal input of type literal, bbox or complex."))}return t}},{key:"marshalReferenceInput",value:function(e){return{href:e.value,method:"GET",mimeType:e.description.format}}},{key:"marshallGetStatusBody",value:function(e,t,r){return{}}},{key:"marshallGetResultBody",value:function(e,t,r){return{}}},{key:"dismissUrl",value:function(e,t,r){throw new Error("Wps 1.0 does not support Dismiss-operations.")}},{key:"marshalDismissBody",value:function(e){throw new Error("Wps 1.0 does not support Dismiss-operations.")}},{key:"unmarshalDismissResponse",value:function(e,t,r){throw new Error("Wps 1.0 does not support Dismiss-operations.")}}]),t}()}).call(this,r("3UD+")(e))},zn8P:function(e,t){function r(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id="zn8P"}},[[0,0,5]]])}();