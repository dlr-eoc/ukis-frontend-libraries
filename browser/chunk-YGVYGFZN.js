import"./chunk-P2A36ZPD.js";import"./chunk-ICRMIR7D.js";import"./chunk-CVWQF2EP.js";import{a as pe}from"./chunk-P62NUZ5D.js";import{Ca as S,Da as Ce,Q as ue,R as fe,S as he,Xa as xe,Ya as W,eb as C,fb as we,la as ve,ma as ge,na as Se,ua as ye,va as T,w as me,wa as w,x as de}from"./chunk-OTRZYAA2.js";import{n as B,s as k,u as V,v as be}from"./chunk-RM6VSO6X.js";import{Dc as oe,E as m,Ec as re,Fc as ie,G as h,Ga as K,Gc as ne,Hc as se,I as v,Ic as ae,J as O,Kc as ce,La as Q,M,Oa as X,P as d,Q as $,S as U,X as i,Y as n,Ya as R,Z as l,dc as ee,ec as te,fc as E,gc as F,hd as le,ic as I,jb as Y,jc as L,kc as j,la as s,ma as z,p as q,q as G,r as _,sa as Z,xb as D,y as H,za as J}from"./chunk-G5LJQFAD.js";import{h as P}from"./chunk-FJYW2LMB.js";function _e(t,c){t&1&&(i(0,"clr-signpost-content",4)(1,"h3"),s(2,"Change detection"),n(),i(3,"p"),s(4,"This badge changes its color any time angular's change-detection was executed."),n()()),t&2&&d("clrPosition","left-middle")}var Me=(()=>{class t{constructor(){this.color="white"}ngAfterContentChecked(){this.color=this.getRandomColor()}getRandomColor(){let o="0123456789ABCDEF",e="#";for(let r=0;r<6;r++)e+=o[Math.floor(Math.random()*16)];return e}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=v({type:t,selectors:[["ukis-blinker"]],decls:6,vars:2,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,r){e&1&&(i(0,"p",0)(1,"clr-signpost"),M(2,_e,5,1,"clr-signpost-content",1),n(),i(3,"span",2),s(4," Change detected "),l(5,"span",3),n()()),e&2&&(m(5),$("background-color",r.color))},dependencies:[j,I,L,E,F],styles:[".blinker[_ngcontent-%COMP%]{width:10px;height:10px}"]})}}return t})();function Ee(t){return P(this,null,function*(){return Fe(Oe(),t,[]).then(c=>Re(c))})}function Fe(t,c,o){return P(this,null,function*(){return t.then(e=>(o.push(e),c>1?Fe(t,c-1,o):o))})}function Oe(){return P(this,null,function*(){return new Promise((c,o)=>{let e=window.performance.now();setTimeout(()=>{let u=1e3/(window.performance.now()-e);c(u)},0)})})}function Ie(t,c){let o=Math.pow(10,c);return Math.floor(t*o)/o}function Re(t){return De(t)/t.length}function De(t){let c=0;for(let o of t)c+=o;return c}function Be(t,c){t&1&&(i(0,"clr-signpost-content",4)(1,"h3"),s(2,"Frames per second"),n(),i(3,"p"),s(4,"Estimates the number of frames that are rendered per second."),n(),i(5,"p"),s(6,"This is done by periodically measuring the time a call to "),i(7,"code"),s(8,"setTimeout(() => ..., 0)"),n(),s(9," takes."),n(),i(10,"p"),s(11,"That call is made outside the angular-zone, so as not to trigger change-detection."),n(),i(12,"p"),s(13,"Please not that in Chrome you can also monitor FPS from the developer-tools: Hit "),i(14,"code"),s(15,"ctrl-shift-p"),n(),s(16," and enter "),i(17,"code"),s(18,"fps"),n(),s(19," to find the FPS-meter."),n()()),t&2&&d("clrPosition","left-middle")}var Le=(()=>{class t{constructor(o,e){this.ngZone=o,this.cdRef=e,this.pollingRate=1e3,this.precission=2,this.nrSamples=10,e.detach(),this.ngZone.runOutsideAngular(()=>{this.updateFps(this.pollingRate)})}updateFps(o){setTimeout(()=>{Ee(this.nrSamples).then(e=>{this.fps=Ie(e,this.precission),this.cdRef.detectChanges(),this.updateFps(o)})},o)}static{this.\u0275fac=function(e){return new(e||t)(h(H),h(J))}}static{this.\u0275cmp=v({type:t,selectors:[["ukis-fpser"]],decls:7,vars:1,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,r){e&1&&(i(0,"p",0)(1,"clr-signpost"),M(2,Be,20,1,"clr-signpost-content",1),n(),i(3,"span",2),s(4," FPS: "),i(5,"span",3),s(6),n()()()),e&2&&(m(6),z(r.fps))},dependencies:[j,I,L,E,F],encapsulation:2})}}return t})();var je=(()=>{class t{constructor(){}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=v({type:t,selectors:[["ukis-performance"]],decls:8,vars:0,consts:[[1,"clr-row"],[1,"clr-col-12"]],template:function(e,r){e&1&&(i(0,"p"),s(1,"Load data and pan the map for a while to see a drop in performance."),n(),i(2,"div",0)(3,"div",1),l(4,"ukis-blinker"),n()(),i(5,"div",0)(6,"div",1),l(7,"ukis-fpser"),n()())},dependencies:[Me,Le],encapsulation:2})}}return t})();var ke=(()=>{class t{constructor(o,e){this.http=o,this.olSvc=e,W.defs("EPSG:2966","+proj=tmerc +lat_0=37.5 +lon_0=-87.08333333333333 +k=0.999966667 +x_0=900000 +y_0=249999.9998983998 +datum=NAD83 +units=us-ft +no_defs"),xe(W);let r=me("EPSG:2966"),a=de(r,"EPSG:4326");this.geojson2966To4326=new S({dataProjection:"EPSG:2966",featureProjection:"EPSG:4326"}),this.geojson4326=new S({featureProjection:"EPSG:4326"})}getWfsSource(o){switch(o){case"all":return new w({format:new S,url:this.getRequestUrl(this.olSvc.EPSG),strategy:ye});case"bbox":return new w({format:new S,url:(a,u,p)=>{let f=p.getCode();return this.getRequestUrl(f,a)},strategy:T});case"simplifyGeometry":let e=new w({loader:(a,u,p)=>{let f=p.getCode();this.http.get(this.getRequestUrl(f,a)).subscribe(g=>{let y=new S().readFeatures(g);for(let x of y)x.geometry=x.getGeometry().simplify(1e3);e.addFeatures(y)})},strategy:T});return e;case"noProps":let r=new w({loader:(a,u,p)=>{let f=p.getCode();this.http.get(this.getRequestUrl(f,a)).subscribe(g=>{let y=new S().readFeatures(g);for(let x of y)x.setProperties({});r.addFeatures(y)})},strategy:T});return r;case"tile":throw new Error("Tile-Strategy source not yet implemented.")}}getRequestUrl(o,e){o||(o="EPSG:4326");let r="https://ahocevar.com/geoserver/wfs?service=WFS&version=1.1.0&request=GetFeature";return r+=`&outputFormat=application/json&srsname=${o}`,r+="&typename=osm:water_areas",e&&(r+=`&bbox=${e.join(",")},${o}`),r}createWfsLayer(o,e,r,a){let u=this.getWfsSource(r),p=new ve({source:u,style:a});return new B({id:o,name:e,custom_layer:p,popup:!0,visible:!1})}createVectorTileLayer(o,e){let r=new Se({format:new Ce,url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:4326@pbf/{z}/{x}/{-y}.pbf"}),a=new ge({source:r});return new B({id:o,name:e,custom_layer:a,popup:!0,visible:!1})}static{this.\u0275fac=function(e){return new(e||t)(_(Q),_(C))}}static{this.\u0275prov=q({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();X.addIcons(D,D,Y);var A=(()=>{class t{constructor(o,e,r,a){this.layersSvc=o,this.dataSvc=e,this.mapStateSvc=r,this.mapSvc=a,this.class="content-container",this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.mapSvc.setProjection("EPSG:4326");let o=(g,y)=>{let Ve=g.getId().toString().match(/(\d+)/)[0],N=parseFloat(Ve),Te=N%255,Ne=(N+20)%255,Ge=(N+40)%255;return new he({stroke:new fe({color:"gray",width:1}),fill:new ue({color:`rgba(${Te}, ${Ne}, ${Ge},0.7)`})})},e=new pe({visible:!0}),r=this.dataSvc.createWfsLayer("full","Fully loaded","all",o);r.description="Full dataset loaded at once.";let a=this.dataSvc.createWfsLayer("bbx","Current extent only","bbox",o);a.description="Bbox strategy: Only current bbox loaded at a time.";let u=this.dataSvc.createWfsLayer("simple","Simplified geometry","simplifyGeometry",o);u.description="Bbox strategy. Also: geometry simplified.";let p=this.dataSvc.createWfsLayer("noProps","No properties","noProps",o);p.description="Bbox strategy. Also: features have no properties.";let f=this.dataSvc.createWfsLayer("noStyle","No Styling","bbox");f.description="Bbox strategy. Also: no styling applied to features.",[e,r,a,u,p,f].map(g=>this.layersSvc.addLayer(g,"Layers"))}ngAfterViewInit(){let o=[-107.14,51.85,-106.14,52.33];this.mapSvc.map.getView().fit(o,{size:this.mapSvc.map.getSize()})}static{this.\u0275fac=function(e){return new(e||t)(h(k),h(ke),h(V),h(C))}}static{this.\u0275cmp=v({type:t,selectors:[["app-route-map7"]],hostVars:2,hostBindings:function(e,r){e&2&&U(r.class)},features:[Z([k,V,C])],decls:13,vars:9,consts:[[1,"content-area","map-view"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","clock","title","Performance","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"]],template:function(e,r){e&1&&(i(0,"main",0),l(1,"ukis-map-ol",1),n(),i(2,"clr-vertical-nav",2)(3,"clr-vertical-nav-group",3),l(4,"cds-icon",4),s(5," Performance "),i(6,"clr-vertical-nav-group-children",5),l(7,"ukis-performance"),n()(),i(8,"clr-vertical-nav-group",3),l(9,"cds-icon",6),s(10," Layers "),i(11,"clr-vertical-nav-group-children",5),l(12,"ukis-layer-control",7),n()()()),e&2&&(m(),d("layersSvc",r.layersSvc)("mapState",r.mapStateSvc)("controls",r.controls),m(),d("clrVerticalNavCollapsible",!0)("clr-nav-level",2),m(),d("clrVerticalNavGroupExpanded",!0),m(5),d("clrVerticalNavGroupExpanded",!0),m(4),d("layersSvc",r.layersSvc)("mapStateSvc",r.mapStateSvc))},dependencies:[we,ce,ie,ne,se,ae,ee,re,oe,te,je,be],encapsulation:2})}}return t})();var qe=[{path:"",component:A}],He=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=O({type:t})}static{this.\u0275inj=G({imports:[R.forChild(qe),R]})}}return t})(),Ot=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=O({type:t})}static{this.\u0275inj=G({imports:[K,He,le,A]})}}return t})();export{Ot as RouteMap7Module,He as RouteMap7RoutingModule};
