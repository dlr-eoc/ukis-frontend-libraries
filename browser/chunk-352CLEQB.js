import{D as C,G as u,I,Ka as L,Pa as D,T as w,a as x,ia as F,k as m,oa as P,q as v,r as _,ra as A,s as T,t as y,ua as E}from"./chunk-A6CGQVP3.js";var g=class extends A{constructor(e){super(e),this.vectorRenderer_=new E(e),this.layerImageRatio_=e.getImageRatio(),this.coordinateToVectorPixelTransform_=C(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(e){if(!this.vectorRenderer_)return Promise.resolve([]);let t=u(this.coordinateToVectorPixelTransform_,u(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(t)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(e){let t=e.pixelRatio,i=e.viewState,n=i.resolution,a=e.viewHints,r=this.vectorRenderer_,o=e.extent;this.layerImageRatio_!==1&&(o=o.slice(0),y(o,this.layerImageRatio_));let p=_(o)/n,R=v(o)/n;if(!a[m.ANIMATING]&&!a[m.INTERACTING]&&!T(o)){r.useContainer(null,null);let N=r.context,b=e.layerStatesArray[e.layerIndex],j=Object.assign({},b,{opacity:1}),d=Object.assign({},e,{extent:o,size:[p,R],viewState:Object.assign({},e.viewState,{rotation:0}),layerStatesArray:[j],layerIndex:0,declutter:null}),f=this.getLayer().getDeclutter();f&&(d.declutter={[f]:new w(9)});let s=new L(o,n,t,N.canvas,function(c){r.prepareFrame(d)&&r.replayGroupChanged&&(r.clipping=!1,r.renderFrame(d,null),r.renderDeclutter(d),r.renderDeferred(d),c())});s.addEventListener(x.CHANGE,()=>{if(s.getState()!==F.LOADED)return;this.image=s;let c=s.getPixelRatio(),l=D(s.getResolution())*t/c;this.renderedResolution=l,this.coordinateToVectorPixelTransform_=I(this.coordinateToVectorPixelTransform_,p/2,R/2,1/l,-1/l,0,-i.center[0],-i.center[1])}),s.load()}return this.image&&(this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice()),!this.getLayer().getSource().loading&&!!this.image}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(e,t,i,n,a){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,i,n,a):super.forEachFeatureAtCoordinate(e,t,i,n,a)}},O=g;var h=class extends P{constructor(e){e=e||{};let t=Object.assign({},e);delete t.imageRatio,super(t),this.imageRatio_=e.imageRatio!==void 0?e.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new O(this)}},X=h;export{X as a};
