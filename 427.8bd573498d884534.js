"use strict";(self.webpackChunkdemo_maps=self.webpackChunkdemo_maps||[]).push([[427],{2427:(C,T,r)=>{r.r(T),r.d(T,{RouteMap3Module:()=>yt,RouteMap3RoutingModule:()=>j});var H=r(6610),U=r(745),F=r(7925),v=r(8356),I=r(6138),M=r(2218),E=r(6924),B=r(7908),A=r(7659),X=r(2080),N=r(6370),O=r(9557),Z=r(4157),P=r(8507),z=r(8887),W=r(6715),$=r(6104),J=r(7327),Q=r(8201),K=r(1888),b=r(7915),k=r(3942),q=r(3982),_=r(479),tt=r(7846),et=r(509);const at=["download",(0,r(6256).s)({outline:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineAlerted:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>',outlineBadged:'<path d="M31,31H5a1,1,0,0,0,0,2H31a1,1,0,0,0,0-2Z"/><path d="M18,29.48,28.61,18.87a1,1,0,0,0-1.41-1.41L19,25.65V5a1,1,0,0,0-2,0V25.65L8.81,17.46a1,1,0,1,0-1.41,1.41Z"/>'})];var t=r(3279),ot=r(9284),st=r(792),u=r(5944),nt=r(6647),it=r(733),lt=r(3926);q.h.addIcons(_.Q,tt.F,et.G,at);let ct=(()=>{class c{constructor(o,s,a,n,i,p){this.layersSvc=o,this.mapStateSvc=s,this.mapSvc=a,this.alertSvc=n,this.progressService=i,this.route=p,this.class="content-container floating",this.subs=[],this.startBbox=null,this.updateLayerOnZoom=()=>{const e=this.getGridLayer(),l=this.layersSvc.getLayerById(e.id);l&&(l.custom_layer=e.layer,this.layersSvc.updateLayer(l,l.filtertype))},this.getGridLayer=()=>{const e=this.mapStateSvc.getMapState().getValue(),y="gridLayer",h=((c,vt,o,s,a)=>{const n=[];let i=80;o>1&&(i=40),o>2&&(i=20),o>3&&(i=10),o>4&&(i=6),o>5&&(i=4),o>6&&(i=3),o>7&&(i=2),o>8&&(i=1);const p=.5*i;let e=10;e>10&&(e=10),a=(0,P.r)(a,p);const l=c[0]+e,d=c[1]+e,h=c[3]-e-d,m=Math.floor((c[2]-e-l)/p),R=Math.floor(h/p);let f=l;for(let x=m;x>0;x--){let L=d;for(let G=R;G>0;G--){const V=f+p,w=L+p,Y=[f,L],ht=[[Y,[f,w],[V,w],[V,L],Y]];if((0,P.Rj)(a,f,L)&&(0,P.Rj)(a,V,w)){const mt=new Z.Ay(ht).transform("EPSG:4326",s),gt=new O.A({geometry:mt,column:x,row:G,id:n.length+1});n.push(gt)}L+=p}f+=p}return n})([-180,-90,180,90],0,e.zoom,this.mapSvc.EPSG,e.extent),m=new N.A({features:h,wrapX:!1}),R=new X.A({source:m});return R.set("id",y),{layer:R,id:y}},this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.addLayers(),this.subscribeToLayers(),this.subscribeToMapState(),this.subscribeToRoute(),this.startBbox&&this.mapStateSvc.setExtent(this.startBbox)}ngAfterViewInit(){this.mapSvc.map.on("moveend",this.updateLayerOnZoom)}ngOnDestroy(){this.subs.map(o=>o.unsubscribe()),this.mapSvc.map.un("moveend",this.updateLayerOnZoom)}addLayers(){const o=new E.dl({visible:!1}),s=new E.wl({visible:!0,tileSize:512}),a=new A.A({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"});a.on("imageloadstart",()=>{this.progressService.progress({indeterminate:!0})}),a.on("imageloadend",()=>{this.progressService.progress(null)}),a.on("imageloaderror",()=>{this.progressService.progress(null)});const n=new v.tr({id:"event_layer",name:"Image load Layer",type:"custom",custom_layer:new B.A({source:a}),visible:!1,bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),i=new v.vK({id:"updatable_feature_layer",name:"Updatable feature layer",type:"geojson",visible:!1,data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-192.48046875,-24.686952411999144],[-88.06640625,-24.686952411999144],[-88.06640625,50.28933925329178],[-192.48046875,50.28933925329178],[-192.48046875,-24.686952411999144]]]}}]},actions:[{action:d=>{i.data=J,this.layersSvc.updateLayer(i)},icon:"download",title:"Load data"}]}),p=this.getGridLayer(),e=new v.tr({id:p.id,name:"gridLayer",type:"custom",opacity:.3,custom_layer:p.layer});[s,o,n,i,e].forEach(d=>this.layersSvc.addLayer(d,"Layers"))}removeLayer(){this.layersSvc.removeLayerOrGroupById("event_layer2")}addLayer(){const o=new $.B,s=new $.B,a=new Q.A({source:new K.A({url:"https://geoservice.dlr.de/eoc/land/wms",params:{LAYERS:"GUF28_DLR_v1_Mosaic"}})}),n=e=>{var l=e.context,d=this.mapSvc.map.getSize(),y=.5*d[0],g=(0,b.FY)(e,[y,0]),S=(0,b.FY)(e,[d[0],0]),h=(0,b.FY)(e,[y,d[1]]),m=(0,b.FY)(e,d);l.save(),l.beginPath(),l.moveTo(g[0],g[1]),l.lineTo(h[0],h[1]),l.lineTo(m[0],m[1]),l.lineTo(S[0],S[1]),l.closePath(),l.clip()};a.on("prerender",e=>{n(e)}),a.on("postrender",e=>{(e=>{e.context.restore()})(e)});const p=new v.tr({id:"event_layer2",name:"Image load Layer 2",type:"custom",custom_layer:new k.A({layers:[a]}),visible:!0,removable:!0,events:{source:[{event:"tileloadstart",listener:e=>{o.next(e)}},{event:"tileloadend",listener:e=>{s.next(e)}}],layer:[{event:"prerender",listener:e=>{n(e)}},{event:"postrender",listener:e=>{n(e)}}]}});o.subscribe(e=>this.progressService.progress({indeterminate:!0})),s.pipe((0,z.B)(200)).subscribe(e=>this.progressService.progress(null)),this.layersSvc.addLayer(p,"Layers")}getSearchParamsHashRouting(o=window.location.href){-1===o.indexOf("http")&&(o=new URL(o,`${window.location.origin}${window.location.pathname}`).toString());const s=new URL(window.location.href,window.location.origin),[a,n]=s.hash.split("?");let i=new URLSearchParams;return n&&(i=new URLSearchParams(n)),{query:i,urlHashRouting:s,hash:a}}updateSearchParamsHashRouting(o){const{query:s,urlHashRouting:a,hash:n}=this.getSearchParamsHashRouting();Object.keys(o).map(e=>{s.set(e,o[e])});const i=decodeURIComponent(`${s}`);return`${a.protocol}//${a.host}${a.pathname||"/"}${n||"#/"}?${i}`}subscribeToMapState(){const o=this.mapStateSvc.getMapState().subscribe(s=>{if(history.pushState){const a=s.extent.map(i=>i.toFixed(3)),n=this.updateSearchParamsHashRouting({bbox:a.join(","),zoom:s.zoom.toString()});window.history.pushState({path:n},"",n)}});this.subs.push(o)}subscribeToRoute(){const o=this.route.queryParams.pipe((0,W.$)()).subscribe(s=>{if(Object.keys(s).length>0&&s.bbox){const a=s.bbox.split(",").map(n=>parseFloat(n));4===a.length&&(this.startBbox=a)}});this.subs.push(o)}subscribeToLayers(){if(this.layersSvc){const o=this.layersSvc.getLayers().subscribe(s=>{s.filter(n=>!0===n.visible).forEach(n=>{"updatable_feature_layer"===n.id&&n.data.features.length<=1&&this.alertSvc.alert({type:"info",text:"Click the layer setting down arrow icon to load new features.",closeable:!0})})});this.subs.push(o)}}static#t=this.\u0275fac=function(s){return new(s||c)(t.rXU(v._t),t.rXU(I.du),t.rXU(M.tC),t.rXU(ot.u),t.rXU(st.n),t.rXU(F.nX))};static#e=this.\u0275cmp=t.VBU({type:c,selectors:[["app-route-map3"]],hostVars:2,hostBindings:function(s,a){2&s&&t.HbH(a.class)},features:[t.Jv_([v._t,I.du,M.tC])],decls:21,vars:10,consts:[[1,"content-area","map-view"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","Coordinates",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","compass","clrVerticalNavIcon",""],["title","Test",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","cog","clrVerticalNavIcon",""],[1,"btn","btn-primary",3,"click"]],template:function(s,a){1&s&&(t.j41(0,"main",0),t.nrm(1,"ukis-map-ol",1),t.k0s(),t.j41(2,"clr-vertical-nav",2)(3,"clr-vertical-nav-group",3),t.nrm(4,"cds-icon",4),t.EFF(5," Layers "),t.j41(6,"clr-vertical-nav-group-children",5),t.nrm(7,"ukis-layer-control",6),t.k0s()(),t.j41(8,"clr-vertical-nav-group",7),t.nrm(9,"cds-icon",8),t.EFF(10," Coordinates "),t.j41(11,"clr-vertical-nav-group-children",5),t.nrm(12,"ukis-mouse-position"),t.k0s()(),t.j41(13,"clr-vertical-nav-group",9),t.nrm(14,"cds-icon",10),t.EFF(15," Test "),t.j41(16,"clr-vertical-nav-group-children",5)(17,"button",11),t.bIt("click",function(){return a.removeLayer()}),t.EFF(18,"remove Layer"),t.k0s(),t.j41(19,"button",11),t.bIt("click",function(){return a.addLayer()}),t.EFF(20,"add Layer"),t.k0s()()()()),2&s&&(t.R7$(),t.Y8G("layersSvc",a.layersSvc)("mapState",a.mapStateSvc)("controls",a.controls),t.R7$(),t.Y8G("clrVerticalNavCollapsible",!0)("clr-nav-level",2),t.R7$(),t.Y8G("clrVerticalNavGroupExpanded",!0),t.R7$(4),t.Y8G("layersSvc",a.layersSvc)("mapStateSvc",a.mapStateSvc),t.R7$(),t.Y8G("clrVerticalNavGroupExpanded",!1),t.R7$(5),t.Y8G("clrVerticalNavGroupExpanded",!0))},dependencies:[u.BlU,u.ndX,u.D2I,u.wqM,u.zLy,u.Wfw,nt.S,it.L,lt.c]})}return c})();var pt=r(6174),dt=r(6658);const ut=[{path:"",component:ct}];let j=(()=>{class c{static#t=this.\u0275fac=function(s){return new(s||c)};static#e=this.\u0275mod=t.$C({type:c});static#r=this.\u0275inj=t.G2t({imports:[F.iI.forChild(ut),F.iI]})}return c})(),yt=(()=>{class c{static#t=this.\u0275fac=function(s){return new(s||c)};static#e=this.\u0275mod=t.$C({type:c});static#r=this.\u0275inj=t.G2t({imports:[H.MD,U.u,j,u.PuD,pt.$y,M.Cf,dt.Yb]})}return c})()},7327:C=>{C.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"title":"Polygon 1"},"geometry":{"type":"Polygon","coordinates":[[[-178.59375,15.961329081596647],[-166.640625,15.961329081596647],[-166.640625,27.994401411046148],[-178.59375,27.994401411046148],[-178.59375,15.961329081596647]]]}},{"type":"Feature","properties":{"title":"Polygon 2"},"geometry":{"type":"Polygon","coordinates":[[[-179.296875,-1.4061088354351594],[-168.75,-1.4061088354351594],[-168.75,10.487811882056695],[-179.296875,10.487811882056695],[-179.296875,-1.4061088354351594]]]}},{"type":"Feature","properties":{"title":"Polygon 3"},"geometry":{"type":"Polygon","coordinates":[[[-158.203125,5.61598581915534],[-146.25,5.61598581915534],[-146.25,22.59372606392931],[-158.203125,22.59372606392931],[-158.203125,5.61598581915534]]]}},{"type":"Feature","properties":{"title":"Polygon 4"},"geometry":{"type":"Polygon","coordinates":[[[-162.0703125,-13.2399454992863],[-150.82031249999997,-13.2399454992863],[-150.82031249999997,-1.0546279422758742],[-162.0703125,-1.0546279422758742],[-162.0703125,-13.2399454992863]]]}},{"type":"Feature","properties":{"title":"Polygon 5"},"geometry":{"type":"Polygon","coordinates":[[[-142.3828125,-20.632784250388013],[-131.1328125,-20.632784250388013],[-131.1328125,-2.108898659243126],[-142.3828125,-2.108898659243126],[-142.3828125,-20.632784250388013]]]}},{"type":"Feature","properties":{"title":"Polygon 6"},"geometry":{"type":"Polygon","coordinates":[[[-106.171875,44.08758502824516],[-100.8984375,39.90973623453719],[-95.625,42.8115217450979],[-101.25,46.800059446787316],[-106.171875,44.08758502824516]]]}}]}')}}]);