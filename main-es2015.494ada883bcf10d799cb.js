(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,r){e.exports=r("GPX4")},"94f5":function(e){e.exports=JSON.parse('{"type":"FeatureCollection","poperties":{"description":"This are a few test cities and locations collected with geojson.io"},"features":[{"type":"Feature","properties":{"name":"Munich"},"geometry":{"type":"Point","coordinates":[11.575899124145508,48.137740422322295]}},{"type":"Feature","properties":{"name":"Landshut"},"geometry":{"type":"Point","coordinates":[12.152938842773436,48.5370678355958]}},{"type":"Feature","properties":{"name":"Ulm"},"geometry":{"type":"Point","coordinates":[9.986572265624998,48.40003249610685]}},{"type":"Feature","properties":{"name":"Ingolstadt"},"geometry":{"type":"Point","coordinates":[11.42578125,48.75618876280552]}},{"type":"Feature","properties":{"name":"Paris"},"geometry":{"type":"Point","coordinates":[2.3291015625,48.83579746243093]}},{"type":"Feature","properties":{"name":"Dreux"},"geometry":{"type":"Point","coordinates":[1.3677978515625,48.73445537176822]}},{"type":"Feature","properties":{"name":"Meaux"},"geometry":{"type":"Point","coordinates":[2.8729248046875,48.95497369808868]}},{"type":"Feature","properties":{"name":"Rome"},"geometry":{"type":"Point","coordinates":[12.480468749999998,41.86956082699455]}},{"type":"Feature","properties":{"name":"Anzio"},"geometry":{"type":"Point","coordinates":[12.6287841796875,41.4509614012039]}},{"type":"Feature","properties":{"name":"Berlin"},"geometry":{"type":"Point","coordinates":[13.403320312499998,52.50953477032727]}},{"type":"Feature","properties":{"name":"Potsdam"},"geometry":{"type":"Point","coordinates":[13.058624267578125,52.40074312027673]}}]}')},GPX4:function(e,t,r){"use strict";r.r(t);var o=r("cUpR"),s=r("8Y7J"),i=r("iInd");const a="wms",n="wmts",c="xyz",l="geojson",p="wfs",u="custom";function h(e){return[l,p,u].includes(e)}function d(e){return[a,n,c,u].includes(e)}class m{constructor(e){this.name="",this.id="",this.opacity=1,this.visible=!0,this.removable=!1,this.filtertype="Layers",this.continuousWorld=!1,this.expanded=!1,Object.assign(this,e)}get time(){return this.protTime}set time(e){this.protTime=e}}class b extends m{constructor(e){if(super(e),this.styles&&this.styles.length>0){let e=this.styles.find(e=>e.default);e||(e=this.styles[0]),this.legendImg=e.legendURL,this.params?(this.type===a?this.params.STYLES=e.name:this.type===n&&(this.params.style=e.name),this.params.STYLES=e.name):this.type===n&&(this.params||(this.params={}),this.params.style=e.name)}}set time(e){this.params&&(this.params.TIME=e),this.protTime=e}get time(){return this.protTime}}class y extends m{constructor(e){super(e)}}class g extends m{constructor(e){super(e),this.type="custom",this.custom_layer={},Object.assign(this,e)}}class f{constructor(e){this.filtertype="Layers",this.removable=!0,this.layerRemovable=!0,this.expanded=!1,e&&void 0!==e.visible&&e.layers&&e.layers.length&&(e.layers=e.layers.map(t=>(t.visible=e.visible,t))),Object.assign(this,e)}get visible(){return this.layers&&this.layers.length&&(this.protVisible=this.layers.filter(e=>e.visible).length>0),this.protVisible}set visible(e){this.protVisible=e,this.layers&&this.layers.length&&(this.layers=this.layers.map(t=>(t.visible=e,t)))}}class v extends b{constructor(e){super(e)}}class w extends b{constructor(e){super(e)}}var S=r("2Vo4");let x=(()=>{class e{constructor(){this.store=new S.a(Array()),this.baseLayers=new S.a(Array()),this.overlays=new S.a(Array()),this.layers=new S.a(Array())}addLayer(e,t,r){if(this.isInLayergroups(e))console.error(`layer or Group with id: ${e.id} already exists!`);else{t?e.filtertype=t:t=e.filtertype;const o=this.store.getValue();r||(o.push(e),this.store.next(o)),this.filterFiltertype(t)}}removeLayer(e,t,r){this.isInLayergroups(e)?r?(console.log(`layer: ${e.id} is removed with force!`),this._removeLayer(e,t)):e.removable?this._removeLayer(e,t):e.removable||console.log(`layer: ${e.id} is not removable!`):console.error(`layer with id: ${e.id} not in storeItems!`)}_removeLayer(e,t){t?t!==e.filtertype&&console.error(`the layer with id: ${e.id} you want to remove from ${t} is from filtertype: ${e.filtertype}`):t=e.filtertype;const r=this.store.getValue().filter(t=>t instanceof m?t.id!==e.id:t);this.store.next(r),this.filterFiltertype(t)}updateLayer(e,t){this.isInLayergroups(e)?(t?t!==e.filtertype&&console.error(`the layer with id: ${e.id} you want to update is from filtertype: ${e.filtertype} and not from ${t} `):t=e.filtertype,"Overlays"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype)),"Layers"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype)),"Baselayers"===e.filtertype&&(this.updateLayerOrGroupInStore(e),this.filterFiltertype(e.filtertype))):console.error(`layer with id: ${e.id} you want to update not in storeItems!`)}updateLayerOrGroupInStore(e){this.store.getValue().filter((t,r,o)=>{t instanceof m&&e instanceof m?t.id===e.id&&(o[r]=e,this.store.next(o)):t instanceof f&&e instanceof f&&t.id===e.id&&(o[r]=e,this.store.next(o))})}removeLayerOrGroupById(e,t,r){this.store.getValue().filter(o=>{o instanceof m?o.id===e&&this.removeLayer(o,o.filtertype||"Layers",r):o instanceof f&&(o.id===e?this.removeLayerGroup(o,r):o.layers.forEach(s=>{s.id===e&&this.removeLayerFromGroup(s,o,t,r)}))})}addLayerToGroup(e,t){this.isInLayergroups(e)?console.error(`layer with id: ${e.id} already exists!`):(e.filtertype!==t.filtertype&&(e.filtertype=t.filtertype),this.isInLayergroups(e,[t])?console.error(`layer with id: ${e.id} already exists in ${t.id}!`,t):(t.layers.push(e),this.updateLayerGroup(t)))}addLayerToGroupById(e,t){this.store.getValue().forEach(r=>{r instanceof f&&r.id===t&&this.addLayerToGroup(e,r)})}removeLayerFromGroup(e,t,r=!0,o){t.layers=t.layers.filter(t=>t.id!==e.id),this.updateLayerGroup(t),this.filterFiltertype(e.filtertype),0===t.layers.length&&r&&this.removeLayerGroup(t,o)}setLayerIndexInGroup(e,t,r){const o=r.layers.indexOf(e);switch(t){case"up":if(0===o)break;this.arrayMove(r.layers,o,o-1);break;case"down":if(o===r.layers.length-1)break;this.arrayMove(r.layers,o,o+1)}this.updateLayer(e,r.filtertype||"Layers")}addLayerGroup(e,t){if(!this.isInLayergroups(e)){t?e.filtertype=t:t=e.filtertype;const r=this.store.getValue();this.isInLayergroups(e,e.layers)&&(e.layers=e.layers.filter(t=>t.id!==e.id)),e.layers=e.layers.map(t=>(t.filtertype=e.filtertype,t)),r.push(e),this.store.next(r),this.updateLayerGroup(e)}}removeLayerGroup(e,t){this.isInLayergroups(e)?t?(console.log(`layerGroup: ${e.id} is removed with force!`),this._removeLayerGroup(e)):e.removable?this._removeLayerGroup(e):e.removable||console.log(`layerGroup: ${e.id} is not removable!`):console.error(`layer or Group with id: ${e.id} not in storeItems!`)}_removeLayerGroup(e){for(const r of e.layers)this.removeLayerFromGroup(r,e);const t=this.store.getValue().filter(function(t,r){return t.id!==e.id});this.store.next(t)}updateLayerGroup(e,t=!1){t&&(e=this.sortLayerGroup(e)),this.updateLayerOrGroupInStore(e);for(const r of e.layers)this.updateLayer(r,e.filtertype||"Layers")}arrayMove(e,t,r){e.splice(r<0?e.length+r:r,0,e.splice(t,1)[0])}setGroupLayerIndex(e,t){let r;if((e instanceof m&&e.filtertype||e instanceof f)&&(r=this.getNumOfGroups(e.filtertype)),r>1){const r=this.store.getValue(),o=r.indexOf(e);this.isGroupFirst(e)&&this.isGroupLast(e)||("number"==typeof t?this.arrayMove(r,o,t):"up"===t?this.arrayMove(r,o,o-1):"down"===t&&this.arrayMove(r,o,o+1)),this.store.next(r),this.baseLayers.next(this.filterBaseLayers()),this.layers.next(this.filterLayers()),this.overlays.next(this.filterOverlays())}}getNumOfGroups(e){let t=0;const r=this.store.getValue();for(const o of r)o.filtertype===e&&t++;return t}isGroupFirst(e,t,r){let o=!1,s=this.store.getValue();return t&&(s=t),r&&(s=s.filter(e=>e.filtertype===r)),0===s.indexOf(e)&&(o=!0),o}isGroupLast(e,t,r){let o=!1,s=this.store.getValue();return t&&(s=t),r&&(s=s.filter(e=>e.filtertype===r)),s.indexOf(e)===s.length-1&&(o=!0),o}isInLayergroups(e,t){let r,o=!1;r=e instanceof m||e instanceof f?e.id:e;const s=this.getLayerOrGroupById(r,t);return(s&&s instanceof m||s instanceof f)&&(o=!0),o}getLayerOrGroupById(e,t){const r=[];let o=this.store.getValue();return t&&(o=t),o.map(t=>{t instanceof f?t.id===e?r.push(t):t.layers.map(t=>{t.id===e&&r.push(t)}):t instanceof m&&t.id===e&&r.push(t)}),r.length?1===r.length?r[0]:void(r.length>1&&console.log("there is a duplicate ID in the Layer Groups!")):null}getLayerById(e,t){let r,o=this.flattenDeepArray(this.store.getValue());return t&&(o=t),o.map(t=>{t.id===e&&(r=t)}),r}getBaseLayers(){return this.baseLayers.asObservable()}removeBaseLayers(e){let t=this.filterBaseLayers();return e&&(t=t.filter(e)),t.forEach(e=>{this.removeLayerOrGroupById(e.id)}),this.baseLayers.asObservable()}getBaseLayersCount(){return this.baseLayers.getValue().length}getOverlays(){return this.overlays.asObservable()}removeOverlays(e){let t=this.filterOverlays();return e&&(t=t.filter(e)),t.forEach(e=>{this.removeLayerOrGroupById(e.id)}),this.overlays.asObservable()}getOverlaysCount(){return this.overlays.getValue().length}getLayers(){return this.layers.asObservable()}removeLayers(e){let t=this.filterLayers();return e&&(t=t.filter(e)),t.forEach(e=>{this.removeLayerOrGroupById(e.id)}),this.layers.asObservable()}getLayersCount(){return this.layers.getValue().length}getLayerGroups(){return this.store.asObservable()}setLayerGroups(e,t){return e.length>0&&e.map(e=>{e instanceof f&&e.layers.length>0&&(e.layers=e.layers.map(t=>(t.filtertype=e.filtertype,t)))}),t?("Baselayers"===t?this.removeBaseLayers():"Layers"===t?this.removeLayers():"Overlays"===t&&this.removeOverlays(),e.map(e=>{e instanceof m?this.addLayer(e,t):e instanceof f&&this.addLayerGroup(e,t)})):(this.store.next(e),this.baseLayers.next(this.filterBaseLayers()),this.layers.next(this.filterLayers()),this.overlays.next(this.filterOverlays())),this.store.asObservable()}getLayerGroupsCount(){return this.store.getValue().length}flattenDeepArray(e){return e.reduce((e,t)=>t instanceof f&&Array.isArray(t.layers)?e.concat(this.flattenDeepArray(t.layers)):e.concat(t),[])}filterOverlays(){const e=this.store.getValue();return this.flattenDeepArray(e.filter(e=>"Overlays"===e.filtertype))}filterBaseLayers(){const e=this.store.getValue();return this.flattenDeepArray(e.filter(e=>"Baselayers"===e.filtertype))}filterLayers(){const e=this.store.getValue();return this.flattenDeepArray(e.filter(e=>"Layers"===e.filtertype))}filterFiltertype(e){"Baselayers"===e?this.baseLayers.next(this.filterBaseLayers()):"Overlays"===e?this.overlays.next(this.filterOverlays()):"Layers"===e&&this.layers.next(this.filterLayers())}sortLayerGroup(e){return e.layers.sort((e,t)=>{let r=0;return e instanceof b?r=1:t instanceof b&&(r=-1),r}),e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class P{constructor(e,t,r,o=[-180,-90,180,90],s=(new Date).toISOString()){this.zoom=e,this.center=t,this.extent=o,this.time=s,this.options=Object.assign({maxzoom:0,minzoom:0,notifier:"map"},r)}sameCenter(e){return this.center.lat===e.lat&&this.center.lon===e.lon}sameZoom(e){return this.zoom===e}sameExtent(e){let t=!1;return this.extent.length===e.length&&(t=this.extent.every((t,r)=>e[r]===t)),t}sameNotifier(e){return this.options.notifier===e}}var _=r("lJxs");const L=new P(0,{lat:0,lon:0});let E=(()=>{class e{constructor(){this.mapState=new S.a(L),this.lastAction=new S.a(null)}getMapState(){return this.mapState}setMapState(e){if(e)if(this.lastAction.next("setState"),e instanceof P){const t=new P(e.zoom,e.center,e.options,e.extent);this.mapState.next(t)}else{const t=Object.assign({notifier:"user"},e.options),r=new P(e.zoom,e.center,t,e.extent);this.mapState.next(r)}}getExtent(){return this.mapState.pipe(Object(_.a)(e=>e.extent))}setExtent(e,t="user"){if(!e)return;this.lastAction.next("setExtent");const r=this.getMapState().getValue();r.options.notifier=t;const o=new P(r.zoom,r.center,r.options,e);this.mapState.next(o)}getLastAction(){return this.lastAction}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class O extends b{constructor(e){const t={name:"OpenStreetMap",displayName:"OpenStreetMap",id:"osm",visible:!1,type:"xyz",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",subdomains:["a","b","c"],attribution:'&copy, <a href="https://www.openstreetmap.org">OpenStreetMap</a> contributors',continuousWorld:!1,legendImg:"https://a.tile.openstreetmap.org/3/4/3.png",description:"OpenStreetMap z-x-y Tiles",opacity:1};e&&Object.assign(t,e),super(t)}}class T extends b{constructor(e){const t={name:"OpenSeaMap",displayName:"OpenSeaMap",id:"OpenSeaMap",visible:!1,type:"xyz",removable:!1,url:"https://{s}.openseamap.org/seamark/{z}/{x}/{y}.png",subdomains:["t1"],attribution:'&copy, <a href="https://map.openseamap.org/legend.php?lang=de&page=license">OpenSeaMap</a>',continuousWorld:!1,legendImg:"https://t1.openseamap.org/seamark/10/554/321.png",description:"http://map.openseamap.org/",opacity:1};e&&Object.assign(t,e),super(t)}}class C extends w{constructor(e){const t={name:"EOC Litemap",displayName:"EOC Litemap",id:"eoc_litemap",visible:!1,type:"wms",removable:!1,params:{LAYERS:"litemap",FORMAT:"image/png",TRANSPARENT:!0},url:"https://geoservice.dlr.de/eoc/basemap/wms",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://geoservice.dlr.de/eoc/basemap/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&FORMAT=image%2Fpng&TRANSPARENT=true&LAYERS=litemap&ATTRIBUTION=&WIDTH=256&HEIGHT=256&CRS=EPSG%3A3857&STYLES=&BBOX=0%2C0%2C10018754.171394622%2C10018754.171394622",description:"http://www.naturalearthdata.com/about/",opacity:1};e&&Object.assign(t,e),super(t)}}class I extends v{constructor(e){const t={name:"EOC Litemap Tile",displayName:"EOC Litemap Tile",id:"eoc_litemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:litemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Alitemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"EOC Litemap as web map tile service",opacity:1};e&&Object.assign(t,e),super(t)}}class R extends v{constructor(e){const t={name:"EOC Liteoverlay Tile",displayName:"EOC LiteoverlayTile",id:"eoc_Liteoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:liteoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aliteoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the liteoverlay provided for EOC Service Portals",opacity:1};e&&Object.assign(t,e),super(t)}}class k extends v{constructor(e){const t={name:"EOC Basemap Tile",displayName:"EOC Basemap Tile",id:"eoc_basemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:basemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abasemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};e&&Object.assign(t,e),super(t)}}class F extends v{constructor(e){const t={name:"EOC Baseoverlay Tile",displayName:"EOC Baseoverlay Tile",id:"eoc_Baseoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:baseoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abaseoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};e&&Object.assign(t,e),super(t)}}class M extends v{constructor(e){const t={name:"BlueMarble Tile",displayName:"BlueMarble Tile",id:"blueMarble_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"bmng_topo_bathy",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=bmng_topo_bathy&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Blue Marble NG dataset with topography and bathymetry",opacity:1};e&&Object.assign(t,e),super(t)}}class G extends v{constructor(e){const t={name:"World Relief B/W Tile",displayName:"World Relief B/W Tile",id:"eoc:world_relief_bw",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:world_relief_bw",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aworld_relief_bw&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"World Relief Black / White",opacity:1};e&&Object.assign(t,e),super(t)}}class A extends v{constructor(e){const t={name:"Hillshade Tile",displayName:"Hillshade Tile",id:"eoc_hillshade",visible:!1,type:"wmts",removable:!1,params:{layer:"hillshade",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=hillshade&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Global Hillshade based on GMTED2010",opacity:1};e&&Object.assign(t,e),super(t)}}var j=r("m1H0"),D=r("ci6y"),z=r("U1NS"),Q=r("DsyP"),V=r("2tVv"),N=r("DwgT"),B=r("zmPu"),U=r("y5Nx"),W=r("ZII/"),Z=r("JlTo"),$=r("qsxt"),H=r("wuBr"),X=r("llT+"),q=r("PxdU"),Y=r("M/FA"),K=r("XEES"),J=r("XheB"),ee=r("Fnjr"),te=r("Dm0N"),re=r("8yCo"),oe=r("IAcf"),se=r("rCez"),ie=r("LXzw"),ae=r("Msoz"),ne=r("Znq9"),ce=r("c7WQ"),le=r("p5/s"),pe=r("hKKC"),ue=r("1rej"),he=r("orbG"),de=r("sOX2"),me=r("OT4/"),be=r("fyJ9"),ye=r("0T8a"),ge=r("kEUA"),fe=r("dPhe"),ve=r("2I+J"),we=r("XNiG"),Se=r("0o2U");function xe(e){let t=[];for(const r of e)if(r instanceof Q.a){const e=xe(r.getLayers().getArray());t=Array.prototype.concat(t,e)}else t.push(r);return t}var Pe=r("PhKu"),_e=r("QQLW");const Le=e=>{let t=[];for(const r of e){let e;e=Array.isArray(r[0])?Le(r):r,t=Array.prototype.concat(t,e)}return t},Ee=(e,t)=>Math.log(e)/Math.log(t),Oe=(e,t)=>Ee(e,t)%1==0,Te=(e,t,r)=>{const o=e.createShader(t);if(!o)throw new Error("No shader was created");if(e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw e.deleteShader(o),new Error(`An error occurred compiling the shader: ${e.getShaderInfoLog(o)}.    \n\n Shader code: ${r}`);return o},Ce=(e,t)=>{e.useProgram(t)},Ie=(e,t,r)=>{e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.vectorSize,r.type,r.normalize,r.stride,r.offset)},Re=(e,t,r,o)=>{if(r>e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS))throw new Error(`There are only ${e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)} texture bind points, but you tried to bind to point nr. ${r}.`);7===r&&console.error(`You are about to bind to the dedicated texture-construction bind point (nr. ${r}).\n        If after this call another texture is built, your shader will now use that new texture instead of this one!\n        Consider using another bind point.`),e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(o,r)},ke=(e,t,r)=>{const o=e.getUniformLocation(t,r);if(null===o)throw new Error(`Couldn't find uniform ${r} in program.`);return o},Fe=(e,t,r,o)=>{switch(r){case"bool":e.uniform1i(t,o[0]);break;case"bvec2":e.uniform2i(t,o[0],o[1]);break;case"bvec3":e.uniform3i(t,o[0],o[1],o[2]);break;case"bvec4":e.uniform4i(t,o[0],o[1],o[2],o[3]);break;case"bool[]":e.uniform1iv(t,o);break;case"bvec2[]":e.uniform2iv(t,o);break;case"bvec3[]":e.uniform3iv(t,o);break;case"bvec4[]":e.uniform4iv(t,o);break;case"int":e.uniform1i(t,o[0]);break;case"ivec2":e.uniform2i(t,o[0],o[1]);break;case"ivec3":e.uniform3i(t,o[0],o[1],o[2]);break;case"ivec4":e.uniform4i(t,o[0],o[1],o[2],o[3]);break;case"int[]":e.uniform1iv(t,o);break;case"ivec2[]":e.uniform2iv(t,o);break;case"ivec3[]":e.uniform3iv(t,o);break;case"ivec4[]":e.uniform4iv(t,o);break;case"float":e.uniform1f(t,o[0]);break;case"vec2":e.uniform2f(t,o[0],o[1]);break;case"vec3":e.uniform3f(t,o[0],o[1],o[2]);break;case"vec4":e.uniform4f(t,o[0],o[1],o[2],o[3]);break;case"float[]":e.uniform1fv(t,o);break;case"vec2[]":e.uniform2fv(t,o);break;case"vec3[]":e.uniform3fv(t,o);break;case"vec4[]":e.uniform4fv(t,o);break;case"mat2":e.uniformMatrix2fv(t,!1,o);break;case"mat3":e.uniformMatrix3fv(t,!1,o);break;case"mat4":e.uniformMatrix4fv(t,!1,o);break;default:throw Error(`Type ${r} not implemented.`)}};class Me{constructor(e,t,r){this.vertexShaderSource=t,this.fragmentShaderSource=r,this.program=((e,t,r)=>{const o=e.createProgram();if(!o)throw new Error("No program was created");const s=Te(e,e.VERTEX_SHADER,t),i=Te(e,e.FRAGMENT_SHADER,r);if(e.attachShader(o,s),e.attachShader(o,i),e.linkProgram(o),e.detachShader(o,s),e.detachShader(o,i),e.deleteShader(s),e.deleteShader(i),!e.getProgramParameter(o,e.LINK_STATUS))throw e.deleteProgram(o),new Error("Unable to initialize the shader program: "+e.getProgramInfoLog(o));return o})(e,t,r),this.id=function(e){let t=0;for(const r of e)t+=r.charCodeAt(0);return`${t}`}(t+r)}}class Ge{constructor(e,t,r,o,s){this.location=ke(e,t.program,r),this.type=o,this.value=s,this.variableName=r}}class Ae{constructor(e,t,r,o,s){this.location=ke(e,t.program,r),this.texture=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement?((e,t)=>{const r=e.createTexture();if(!r)throw new Error("No texture was created");e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,r);const o=e.RGBA,s=e.RGBA,i=e.UNSIGNED_BYTE;let a,n;return e.texImage2D(e.TEXTURE_2D,0,o,s,i,t),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),t instanceof HTMLImageElement?(a=t.naturalWidth,n=t.naturalHeight):(a=t.width,n=t.height),{texture:r,level:0,internalformat:o,format:s,type:i,width:a,height:n,border:0}})(e,o):o,this.bindPoint=s,this.variableName=r}}class je{constructor(e,t,r,o,s){this.location=ke(e,t.program,r),this.texture=((e,t)=>{const r=t.length,o=t[0].length,s=t[0][0].length;if(!Oe(o,2)||!Oe(r,2))throw new Error(`Texture-data-dimensions must be a power of two, but are ${o} x ${r}`);if(4!==s)throw new Error(`Expecting 4 channels, but ${s} provided`);const i=e.createTexture();if(!i)throw new Error("No texture was created");e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,i);const a=e.RGBA,n=e.RGBA,c=e.UNSIGNED_BYTE,l=new Uint8Array(Le(t));return 4!==s&&e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,a,o,r,0,n,c,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),{texture:i,level:0,internalformat:a,format:n,type:c,width:o,height:r,border:0}})(e,o),this.bindPoint=s,this.variableName=r}}class De{constructor(e,t,r,o,s="triangles"){let i;switch(s){case"triangles":i=e.TRIANGLES;break;case"lines":i=e.LINES;break;case"points":i=e.POINTS;break;default:throw new Error(`Invalid drawing mode ${s}`)}this.location=((e,t,r)=>{const o=e.getAttribLocation(t,r);if(-1===o)throw new Error(`Couldn't find attribute ${r} in program.`);return o})(e,t.program,r),this.value=((e,t,r=e.TRIANGLES)=>{const o=new Float32Array(Le(t)),s=e.createBuffer();if(!s)throw new Error("No buffer was created");return e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),{buffer:s,vectorSize:t[0].length,vectorCount:t.length,type:e.FLOAT,normalize:!1,stride:0,offset:0,drawingMode:r}})(e,o,i),this.variableName=r,this.drawingMode=i}}class ze{constructor(e,t,r="triangles"){let o;switch(r){case"triangles":o=e.TRIANGLES;break;case"lines":o=e.LINES;break;case"points":o=e.POINTS;break;default:throw new Error(`Invalid drawing mode ${r}`)}this.index=((e,t,r=e.TRIANGLES)=>{const o=new Uint16Array(Le(t)),s=e.createBuffer();if(!s)throw new Error("No buffer was created");return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),{buffer:s,count:o.length,type:e.UNSIGNED_SHORT,offset:0,drawingMode:r}})(e,t,o)}}function Qe(e,t){for(const r of e)if(t(r))return r;return null}class Ve{constructor(e,t,r,o,s){this.program=e,this.attributes=t,this.uniforms=r,this.textures=o,this.index=s;const[i,a,n,c]=function(e){const t=/^\s*attribute (int|float|vec2|vec3|vec4|mat2|mat3|mat4) (\w*);/gm,r=/^\s*uniform (int|float|vec2|vec3|vec4|mat2|mat3|mat4) (\w*)(\[\d\])*;/gm,o=/^\s*uniform sampler2D (\w*);/gm,s=/^\s*precision (\w*) float;/gm,i=e.fragmentShaderSource+"\n\n\n"+e.vertexShaderSource,a=[];let n;for(;null!==(n=t.exec(i));)a.push(n[2]);const c=[];let l;for(;null!==(l=r.exec(i));)c.push(l[2]);const p=[];let u;for(;null!==(u=o.exec(i));)p.push(u[1]);const h=[];let d;for(;null!==(d=s.exec(i));)h.push(d[1]);return[a,c,p,h]}(e);for(const p of i){const e=t.filter(e=>e.variableName===p);if(1!==e.length)throw new Error(`Provided ${e.length} values for shader's attribute ${p}.`)}for(const p of a){const e=r.filter(e=>e.variableName===p);if(1!==e.length)throw new Error(`Provided ${e.length} values for shader's uniform ${p}.`)}for(const p of n){const e=o.filter(e=>e.variableName===p);if(1!==e.length)throw new Error(`Provided ${e.length} values for shader's texture ${p}.`)}1===c.length&&console.warn("You have only provided one precision qualifier.\n            This can cause issues when you want to use a uniform in both the vertex- and the fragment-shader.");const l=this.attributes.map(e=>e.value.vectorCount);if(Math.min(...l)!==Math.max(...l))throw new Error("Your attributes are not of the same length!")}bind(e){Ce(e,this.program.program);for(const t of this.attributes)Ie(e,t.location,t.value);for(const t of this.uniforms)Fe(e,t.location,t.type,t.value);for(const t of this.textures)Re(e,t.texture.texture,t.bindPoint,t.location);this.index&&((e,t)=>{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.index.index.buffer)})(e)}render(e,t,r,o){r?((e,t,r)=>{e.bindFramebuffer(e.FRAMEBUFFER,t.framebuffer),r?(t.width/t.height!=r[2]/r[3]&&console.warn("Your viewport-aspect is different from the framebuffer-aspect."),e.viewport(...r)):e.viewport(0,0,t.width,t.height)})(e,r,o):((e,t)=>{e.bindFramebuffer(e.FRAMEBUFFER,null),t?(e.canvas.width/e.canvas.height!=t[2]/t[3]&&console.warn("Your viewport-aspect is different from the canvas-aspect."),e.viewport(...t)):e.viewport(0,0,e.canvas.width,e.canvas.height)})(e,o),t&&((e,t)=>{e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)})(e,t),this.index?((e,t)=>{e.drawElements(t.drawingMode,t.count,t.type,t.offset)})(e,this.index.index):((e,t)=>{e.drawArrays(t.drawingMode,t.offset,t.vectorCount)})(e,this.attributes[0].value)}updateAttributeData(e,t,r){const o=Qe(this.attributes,e=>e.variableName===t);if(!o)throw new Error(`No such attribute ${t} to be updated.`);((e,t,r)=>{const o=new Float32Array(Le(r));e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)})(e,o.value,r)}updateUniformData(e,t,r){const o=Qe(this.uniforms,e=>e.variableName===t);if(!o)throw new Error(`No such uniform ${t} to be updated.`);o.value=r}updateTextureData(e,t,r){const o=Qe(this.textures,e=>e.variableName===t);if(!o)throw new Error(`No such texture ${t} to be updated.`);const s=((e,t,r)=>{if(e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,t.texture),r instanceof HTMLImageElement||r instanceof HTMLCanvasElement)e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);else{const o=r[0].length,s=r.length;if(!Oe(o,2)||!Oe(s,2))throw new Error(`Texture-data-dimensions must be a power of two, but are ${s} x ${o}`);const i=new Uint8Array(Le(r));e.texImage2D(e.TEXTURE_2D,t.level,t.internalformat,t.width,t.height,t.border,t.format,t.type,i)}return e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),r instanceof HTMLImageElement?(t.width=r.naturalWidth,t.height=r.naturalHeight):r instanceof HTMLCanvasElement?(t.width=r.width,t.height=r.height):(t.width=r[0].length,t.height=r.length),t})(e,o.texture,r);o.texture=s}}class Ne{constructor(e,t,r){const o=(e=>{const t=e.createFramebuffer();if(!t)throw new Error("Error creating framebuffer");return t})(e),s=((e,t,r)=>{if(t<=0||r<=0)throw new Error("Width and height must be positive.");const o=e.createTexture();if(!o)throw new Error("No texture was created");return e.activeTexture(e.TEXTURE0+7),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),{texture:o,level:0,internalformat:e.RGBA,format:e.RGBA,type:e.UNSIGNED_BYTE,width:t,height:r,border:0}})(e,t,r),i=((e,t,r)=>{if(e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.texture,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)throw new Error(`Error creating framebuffer: framebuffer-status: ${e.checkFramebufferStatus(e.FRAMEBUFFER)} ; error-code: ${e.getError()}`);return e.bindFramebuffer(e.FRAMEBUFFER,null),{framebuffer:r,texture:t,width:t.width,height:t.height}})(e,s,o);this.fbo=i}}const Be=(e,t)=>({vertices:[[-e/2,t/2,0],[-e/2,-t/2,0],[e/2,-t/2,0],[-e/2,t/2,0],[e/2,-t/2,0],[e/2,t/2,0]],texturePositions:[[0,1],[0,0],[1,0],[0,1],[1,0],[1,1]]});class Ue extends _e.a{constructor(e){super(e)}createRenderer(){return this.renderer=new We(this),this.renderer}updateSunAngle(e){this.renderer.updateSunAngle(e)}}class We extends Pe.a{constructor(e){super(e),this.state="loading";const t=document.createElement("canvas");t.width=1200,t.height=800,t.style.position="absolute";const r=t.getContext("webgl"),o=e.getSource(),s=o.getProjection(),i=o.getImageExtent(),a=this.bboxOntoRectangle(2,2,i),n=((e,t=256,r=256,o="red")=>{const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("no context");return s.canvas.width=t,s.canvas.height=r,s.font=`bold ${5*r/6|0}px sans-serif`,s.textAlign="center",s.textBaseline="middle",s.fillStyle=o,s.fillText(e,t/2,r/2),s.canvas})("test",2048,2048,"red"),c=new Me(r,"\n            attribute vec3 a_position;\n            attribute vec2 a_texturePosition;\n            uniform mat3 u_world2pix;\n            uniform mat3 u_pix2canv;\n            varying vec2 v_texturePosition;\n            void main() {\n                vec3 pixelPosition = u_world2pix * vec3(a_position.x, a_position.y, 1.);\n                vec3 canvasPosition = u_pix2canv * pixelPosition;\n                gl_Position = vec4(canvasPosition.x, canvasPosition.y, 0., 1.);\n                v_texturePosition = a_texturePosition;\n            }\n        ","\n            precision mediump float;\n            uniform sampler2D u_srtm;\n            uniform float u_imageSize;\n            uniform vec3 u_sun;\n            varying vec2 v_texturePosition;\n            void main() {\n                float delta = 4. / u_imageSize;\n                float top = texture2D(u_srtm, vec2(v_texturePosition.x,         1. - v_texturePosition.y + delta)).r;\n                float bot = texture2D(u_srtm, vec2(v_texturePosition.x,         1. - v_texturePosition.y - delta)).r;\n                float lft = texture2D(u_srtm, vec2(v_texturePosition.x + delta, 1. - v_texturePosition.y        )).r;\n                float rgt = texture2D(u_srtm, vec2(v_texturePosition.x - delta, 1. - v_texturePosition.y        )).r;\n\n                vec3 surfaceNormal = vec3(\n                    lft - rgt,\n                    bot - top,\n                    2. * delta\n                );\n                surfaceNormal = normalize(surfaceNormal);\n                vec3 sunNormal = normalize(u_sun);\n                float alignment = abs(dot(sunNormal, surfaceNormal));\n\n                gl_FragColor = vec4(0., 0., 0., 0.5 * alignment);\n            }\n        ");Ce(r,c.program);const l=new Ve(c,[new De(r,c,"a_position",a.vertices),new De(r,c,"a_texturePosition",a.texturePositions)],[new Ge(r,c,"u_imageSize","float",[2048]),new Ge(r,c,"u_sun","vec3",[0,0,1]),new Ge(r,c,"u_world2pix","mat3",Le([[1,0,0],[0,1,0],[0,0,1]])),new Ge(r,c,"u_pix2canv","mat3",Le([[1/(t.width/2),0,0],[0,-1/(t.height/2),0],[-1,1,1]]))],[new Ae(r,c,"u_srtm",n,0)]);l.bind(r),this.shader=l,this.canvas=t,this.gl=r,this.projection=s;const p=o.getImage(i,.02197265625,2.440000295639038,s);p.addEventListener("change",e=>{const t=p.getImage();this.shader.updateTextureData(this.gl,"u_srtm",t),this.shader.bind(this.gl),this.state="ready",super.getLayer().changed()}),p.load()}prepareFrame(e){if("ready"===this.state){const t=e.coordinateToPixelTransform;this.shader.updateUniformData(this.gl,"u_world2pix",Le([[t[0],t[1],0],[t[2],t[3],0],[t[4],t[5],1]])),this.shader.bind(this.gl),e.viewState.projection!==this.projection&&this.reprojectImage(e.viewState.projection)}return!0}renderFrame(e,t){return"ready"===this.state&&(this.shader.render(this.gl),this.transformCanvas(e)),this.canvas}renderDeclutter(e){}updateSunAngle(e){this.shader.updateUniformData(this.gl,"u_sun",[e[0],e[1],1]),this.shader.bind(this.gl),this.shader.render(this.gl)}bboxOntoRectangle(e,t,r){const o=Be(e,t);for(const s of o.vertices){const o=s[1];s[0]=s[0]===e/2?r[2]:r[0],s[1]=o===t/2?r[3]:r[1]}return o}reprojectImage(e){const t=super.getLayer().getSource(),r=t.getProjection(),o=t.getImageExtent(),s=Object(ne.r)(o,r,e),i=this.bboxOntoRectangle(2,2,s);this.shader.updateAttributeData(this.gl,"a_position",i.vertices),this.shader.bind(this.gl)}transformCanvas(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,o=e.size,s=Math.round(o[0]*r),i=Math.round(o[1]*r),a=t.opacity;this.canvas.width=s,this.canvas.height=i,this.canvas.style.opacity=`${a}`,this.shader.updateUniformData(this.gl,"u_pix2canv",Le([[1/(this.canvas.width/2),0,0],[0,-1/(this.canvas.height/2),0],[-1,1,1]]))}}var Ze=r("gB+7"),$e=r("Cw4B");class He extends Z.a{constructor(e){super(e),this.options=e}createRenderer(){return new Xe(this,this.options.renderSettings)}updateParas(e,t,r){const o={colorRamp:this.options.renderSettings.colorRamp,maxEdgeLength:this.options.renderSettings.maxEdgeLength,storeInterpolatedPixelData:this.options.renderSettings.storeInterpolatedPixelData,valueProperty:this.options.renderSettings.valueProperty,power:e,showLabels:r,smooth:t};super.getRenderer().updateSettings(o),this.options.renderSettings=o}}class Xe extends Pe.a{constructor(e,t){super(e),this.settings=t,this.container=document.createElement("div"),this.container.classList.add("ol-layer"),this.container.style.setProperty("position","absolute"),this.container.style.setProperty("width","100%"),this.container.style.setProperty("height","100%"),this.webGlCanvas=document.createElement("canvas"),this.webGlCanvas.style.setProperty("position","absolute"),this.webGlCanvas.style.setProperty("left","0px"),this.webGlCanvas.style.setProperty("top","0px"),this.webGlCanvas.style.setProperty("width","100%"),this.webGlCanvas.style.setProperty("height","100%"),this.webGlCanvas.width=1e3,this.webGlCanvas.height=1e3,this.gl=this.webGlCanvas.getContext("webgl"),this.container.appendChild(this.webGlCanvas),this.pointRenderer=new Ze.a(e);const r=e.getSource();this.projection=r.getProjection();const{coords:o,values:s,bboxDelta:i,maxVal:a}=this.parseData(r,this.settings.valueProperty,this.settings.maxEdgeLength),{observationsBbox:n,maxEdgeLengthBbox:c}=this.parseDataBbox(i,o,s,a,this.settings.maxEdgeLength);this.bbox=i;const l=[[1,0,0],[0,1,0],[0,0,1]];this.interpolationShader=Ye(this.gl,n,a,this.settings.power,c),this.valueFb=new Ne(this.gl,this.webGlCanvas.width,this.webGlCanvas.height),this.colorizationShader=Ke(this.gl,this.settings.colorRamp,a,this.settings.smooth,this.valueFb),this.colorFb=new Ne(this.gl,this.webGlCanvas.width,this.webGlCanvas.height),this.arrangementShader=Je(this.gl,l,l,i,this.colorFb),this.runInterpolationShader(this.valueFb.fbo),this.runColorizationShader(this.colorFb.fbo)}prepareFrame(e){if(this.webGlCanvas.style.opacity=`${e.layerStatesArray[e.layerIndex].opacity}`,e.viewState.projection!==this.projection){this.projection=e.viewState.projection;const t=super.getLayer().getSource(),{coords:r,values:o,bboxDelta:s,maxVal:i}=this.parseData(t,this.settings.valueProperty,this.settings.maxEdgeLength),{observationsBbox:a,maxEdgeLengthBbox:n}=this.parseDataBbox(s,r,o,i,this.settings.maxEdgeLength);this.updateInterpolationShader(this.settings.power,a,n),this.runInterpolationShader(this.valueFb.fbo),this.runColorizationShader(this.colorFb.fbo),this.bbox=s}return this.updateArrangementShader(e.coordinateToPixelTransform,e.size[0],e.size[1],this.bbox),this.pointRenderer.prepareFrame(e),!0}renderFrame(e,t){if(this.runArrangementShader(),this.settings.showLabels){const t=this.pointRenderer.renderFrame(e,this.container);Object($e.f)(this.container,[this.webGlCanvas,t])}else Object($e.f)(this.container,[this.webGlCanvas]);return this.container}renderDeclutter(e){}updateSettings(e){const t=this.settings;this.settings=e,e.power!==t.power?(this.updateInterpolationShader(e.power),this.runInterpolationShader(this.valueFb.fbo),this.updateColorizationShader(e.smooth),this.runColorizationShader(this.colorFb.fbo)):e.smooth!==t.smooth&&(this.updateColorizationShader(e.smooth),this.runColorizationShader(this.colorFb.fbo)),super.getLayer().changed()}updateArrangementShader(e,t,r,o){const s=[[1/(t/2),0,0],[0,-1/(r/2),0],[-1,1,1]];this.arrangementShader.updateUniformData(this.gl,"u_world2pix",Le([[e[0],e[1],0],[e[2],e[3],0],[e[4],e[5],1]])),this.arrangementShader.updateUniformData(this.gl,"u_pix2clip",Le(s)),this.arrangementShader.updateUniformData(this.gl,"u_bbox",o)}runArrangementShader(e){this.arrangementShader.bind(this.gl),this.arrangementShader.render(this.gl,[0,0,0,0],e)}updateInterpolationShader(e,t,r){this.interpolationShader.updateUniformData(this.gl,"u_power",[e]),t&&this.interpolationShader.updateTextureData(this.gl,"u_dataTexture",[t]),r&&this.interpolationShader.updateUniformData(this.gl,"u_maxDistance",[r])}runInterpolationShader(e){this.interpolationShader.bind(this.gl),this.interpolationShader.render(this.gl,[0,0,0,0],e),this.settings.storeInterpolatedPixelData&&(this.interpolatedValues=(e=>{const t=e.getContext("webgl");if(!t)throw new Error("no context");const r=t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT),o=t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE);let s;if(o===t.UNSIGNED_BYTE)s=new Uint8Array(t.drawingBufferWidth*t.drawingBufferHeight*4);else if(o===t.UNSIGNED_SHORT_5_6_5||o===t.UNSIGNED_SHORT_4_4_4_4||o===t.UNSIGNED_SHORT_5_5_5_1)s=new Uint16Array(t.drawingBufferWidth*t.drawingBufferHeight*4);else{if(o!==t.FLOAT)throw new Error(`Did not understand pixel data type ${o} for format ${r}`);s=new Float32Array(t.drawingBufferWidth*t.drawingBufferHeight*4)}return t.readPixels(0,0,e.width,e.height,r,o,s),s})(this.webGlCanvas))}updateColorizationShader(e){this.colorizationShader.updateUniformData(this.gl,"u_smooth",[e?1:0])}runColorizationShader(e){this.colorizationShader.bind(this.gl),this.colorizationShader.render(this.gl,[0,0,0,0],e)}parseData(e,t,r){let o=e.getFeatures();o=e instanceof oe.a?e.getSource().getFeatures():e.getFeatures();const s=o.map(e=>e.getGeometry().getCoordinates()),i=o.map(e=>parseFloat(e.getProperties()[t])),a=et(s),n=a[2]-a[0],c=a[3]-a[1];let l,p;n>c?(p=n-c,l=0):(p=0,l=c-n);const u=[a[0]-r,a[1]-r,a[2]+l+r,a[3]+p+r],h=i.reduce((e,t)=>t>e?t:e,0);return{coords:s,values:i,bboxDelta:u,maxVal:h}}parseDataBbox(e,t,r,o,s){const i=tt(t,r).map(t=>{const r=qe([t[0],t[1]],e);return[255*(r[0]+1)/2,255*(r[1]+1)/2,255*t[2]/o,255]}),a=i.length,n=((e,t)=>{const r=Math.ceil(Ee(e,2));return Math.pow(2,r)})(a);for(let c=0;c<n-a;c++)i.push([0,0,0,0]);return{observationsBbox:i,maxEdgeLengthBbox:s/Math.max(e[2]-e[0],e[3]-e[1])}}}const qe=(e,t)=>[(e[0]-t[0])/(t[2]-t[0])*2-1,(e[1]-t[1])/(t[3]-t[1])*2-1],Ye=(e,t,r,o,s)=>{const i=new Me(e,"\n            precision mediump float;\n            attribute vec3 a_position;\n            attribute vec2 a_texturePosition;\n            varying vec2 v_position;\n            varying vec2 v_texturePosition;\n\n            void main() {\n                v_position = a_position.xy;\n                v_texturePosition = a_texturePosition;\n                gl_Position = vec4(a_position.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform float u_power;\n            uniform sampler2D u_dataTexture;\n            uniform int u_nrDataPoints;\n            uniform float u_maxValue;\n            uniform float u_maxDistance;\n            varying vec2 v_position;\n            varying vec2 v_texturePosition;\n\n            void main() {\n\n                float valSum = 0.0;\n                float wSum = 0.0;\n                float minD = 10000.0;\n                for (int i = 0; i < 10000; i++) {\n                    if (i > u_nrDataPoints) {\n                        break;\n                    }\n                    vec4 dataPoint = texture2D(u_dataTexture, vec2(float(i) / float(u_nrDataPoints), 0.5));\n                    if (dataPoint.w > 0.0) {  // texture is padded to next power of two with transparent 0-values.\n                        vec2 coords = dataPoint.xy * 2.0 - 1.0;  // transforming coords from [0, 1] to [-1, 1]\n                        float value = dataPoint.z * u_maxValue;  // transforming value from [0, 1] to [0, maxValue]\n\n                        float d = distance(v_position, coords);\n                        float w = 1.0 / pow(d, u_power);\n                        valSum += value * w;\n                        wSum += w;\n                        if (d < minD) {\n                            minD = d;\n                        }\n                    }\n                }\n                float interpolatedValue = valSum / wSum;\n                float alpha = 1.0;\n                if (minD > u_maxDistance) {\n                    alpha = 0.0;\n                }\n                vec4 color = vec4(interpolatedValue / u_maxValue, 0.0, 0.0, alpha);\n\n                gl_FragColor = color;\n            }\n        "),a=[[0,1],[0,0],[1,0],[1,1]],n=[[0,1,2],[0,2,3]];return new Ve(i,[new De(e,i,"a_position",[[-1,1,0],[-1,-1,0],[1,-1,0],[1,1,0]]),new De(e,i,"a_texturePosition",a)],[new Ge(e,i,"u_power","float",[o]),new Ge(e,i,"u_nrDataPoints","int",[t.length]),new Ge(e,i,"u_maxValue","float",[r]),new Ge(e,i,"u_maxDistance","float",[s])],[new je(e,i,"u_dataTexture",[t],0)],new ze(e,n))},Ke=(e,t,r,o,s)=>{const i=new Me(e,"\n            precision mediump float;\n            attribute vec2 a_position;\n            attribute vec2 a_textureCoord;\n            varying vec2 v_textureCoord;\n\n            void main() {\n                v_textureCoord = a_textureCoord;\n                gl_Position = vec4(a_position.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform float u_colorRampValues[15];\n            uniform vec3 u_colorRampColors[15];\n            uniform int u_nrColorRampValues;\n            uniform float u_maxValue;\n            uniform bool u_smooth;\n            uniform sampler2D u_valueTexture;\n            varying vec2 v_textureCoord;\n\n            vec3 valueToSmoothColor(in float value) {\n                if (value < u_colorRampValues[0]) {\n                    return u_colorRampColors[0];\n                }\n                for (int i = 1; i < 15; i++) {\n                    if (i > u_nrColorRampValues) {\n                        break;\n                    }\n                    if (value < u_colorRampValues[i]) {\n                        float alpha = (value - u_colorRampValues[i-1]) / (u_colorRampValues[i] - u_colorRampValues[i-1]);\n                        vec3 color = alpha * (u_colorRampColors[i] - u_colorRampColors[i-1]) + u_colorRampColors[i-1];\n                        return color;\n                    }\n                    if (i == u_nrColorRampValues) {\n                        return u_colorRampColors[i];\n                    }\n                }\n            }\n\n            vec3 valueToStepColor(in float value) {\n                for (int i = 0; i < 15; i++) {\n                    if (i > u_nrColorRampValues) {\n                        break;\n                    }\n                    if (value < u_colorRampValues[i]) {\n                        return u_colorRampColors[i];\n                    }\n                    if (i == u_nrColorRampValues) {\n                        return u_colorRampColors[i];\n                    }\n                }\n            }\n\n            void main() {\n                vec4 pixelData = texture2D(u_valueTexture, v_textureCoord);\n                float val = pixelData.r * u_maxValue;\n                float alpha = pixelData.w;\n                vec3 rgb = vec3(0.0, 0.0, 0.0);\n                if (alpha > 0.01) {\n                    if (u_smooth) {\n                        rgb = valueToSmoothColor(val);\n                    } else {\n                        rgb = valueToStepColor(val);\n                    }\n                }\n                gl_FragColor = vec4(rgb.x / 255.0, rgb.y / 255.0, rgb.z / 255.0, alpha);\n            }\n        ");return new Ve(i,[new De(e,i,"a_position",Be(2,2).vertices),new De(e,i,"a_textureCoord",Be(2,2).texturePositions)],[new Ge(e,i,"u_colorRampValues","float[]",t.map(e=>e.val)),new Ge(e,i,"u_colorRampColors","vec3[]",Le(t.map(e=>e.rgb))),new Ge(e,i,"u_nrColorRampValues","int",[t.length]),new Ge(e,i,"u_maxValue","float",[r]),new Ge(e,i,"u_smooth","bool",[o?1:0])],[new Ae(e,i,"u_valueTexture",s.fbo.texture,0)])},Je=(e,t,r,o,s)=>{const i=new Me(e,"\n            precision mediump float;\n            attribute vec3 a_pos;\n            attribute vec2 a_posTexture;\n            uniform mat3 u_world2pix;\n            uniform mat3 u_pix2clip;\n            uniform vec4 u_bbox;\n            varying vec2 v_posTexture;\n\n            vec2 clipBbx2worldCoords(vec2 clipCoords, vec4 bbox) {\n                float xPerct = ( clipCoords.x + 1.0 ) / 2.0;\n                float yPerct = ( clipCoords.y + 1.0 ) / 2.0;\n                float xWorld = xPerct * (bbox.z - bbox.x) + bbox.x;\n                float yWorld = yPerct * (bbox.w - bbox.y) + bbox.y;\n                return vec2(xWorld, yWorld);\n            }\n\n            void main() {\n                v_posTexture = a_posTexture;\n                vec2 worldPos = clipBbx2worldCoords(a_pos.xy, u_bbox);\n                vec3 clipPos = u_pix2clip * u_world2pix * vec3(worldPos.xy, 1.0);\n                gl_Position = vec4(clipPos.xy, 0.0, 1.0);\n            }\n        ","\n            precision mediump float;\n            uniform sampler2D u_texture;\n            varying vec2 v_posTexture;\n\n            void main() {\n                gl_FragColor = texture2D(u_texture, v_posTexture);\n            }\n        ");return new Ve(i,[new De(e,i,"a_pos",Be(2,2).vertices),new De(e,i,"a_posTexture",Be(2,2).texturePositions)],[new Ge(e,i,"u_world2pix","mat3",Le(t)),new Ge(e,i,"u_pix2clip","mat3",Le(r)),new Ge(e,i,"u_bbox","vec4",o)],[new Ae(e,i,"u_texture",s.fbo.texture,0)])},et=e=>{const t=e.map(e=>e[0]),r=e.map(e=>e[1]),o=Math.min(...t),s=Math.max(...t);return[o,Math.min(...r),s,Math.max(...r)]},tt=(e,t)=>{const r=[];for(let o=0;o<e.length;o++)r.push(e[o].concat(t[o]));return r};r("jqAh");var rt=r("xXok");const ot="EPSG:4326";let st=(()=>{class e{constructor(e,t,r){this.crf=e,this.app=t,this.injector=r,this.hitTolerance=0,this.projectionChange=new we.a,this.dynamicPopupComponents=new Map,this.map=new j.a({controls:[]}),this.view=new D.a,this.EPSG="EPSG:3857"}createMap(e){const t=new Q.a({layers:[]});t.set("filtertype","baselayers"),t.set("title","Base maps"),t.set("id","ID_filtertype_baselayers");const r=new Q.a({layers:[]});r.set("filtertype","layers"),r.set("title","Layers"),r.set("id","ID_filtertype_layers");const o=new Q.a({layers:[]});o.set("filtertype","overlays"),o.set("title","Overlays"),o.set("id","ID_filtertype_overlays"),this.viewOptions={center:Object(ne.q)([0,0],ot,this.EPSG),zoom:0,projection:Object(ne.i)(this.EPSG)},this.view.constrainRotation&&(this.viewOptions.constrainRotation=this.view.constrainRotation),this.view.enableRotation&&(this.viewOptions.enableRotation=this.view.enableRotation),this.view.extent&&(this.viewOptions.extent=this.view.extent),this.view.constrainOnlyCenter&&(this.viewOptions.constrainOnlyCenter=this.view.constrainOnlyCenter),this.view.smoothExtentConstraint&&(this.viewOptions.smoothExtentConstraint=this.view.smoothExtentConstraint),this.view.getMaxResolution()&&(this.viewOptions.maxResolution=this.view.getMaxResolution()),this.view.getMinResolution()&&(this.viewOptions.minResolution=this.view.getMinResolution()),this.view.getMaxZoom()&&(this.viewOptions.maxZoom=this.view.getMaxZoom()),this.view.getMinZoom()&&(this.viewOptions.minZoom=this.view.getMinZoom()),this.view.multiWorld&&(this.viewOptions.multiWorld=this.view.multiWorld),this.view.constrainResolution&&(this.viewOptions.constrainResolution=this.view.constrainResolution),this.view.smoothResolutionConstraint&&(this.viewOptions.smoothResolutionConstraint=this.view.smoothResolutionConstraint),this.view.getResolution()&&(this.viewOptions.resolution=this.view.getResolution()),this.view.getResolutions()&&(this.viewOptions.resolutions=this.view.getResolutions()),this.view.rotation&&(this.viewOptions.rotation=this.view.rotation),this.view.zoomFactor&&(this.viewOptions.zoomFactor=this.view.zoomFactor);const s=new D.a(this.viewOptions);return[t,r,o].map(e=>this.map.addLayer(e)),this.map.setView(s),this.view=this.map.getView(),this.setProjection(this.EPSG),e&&this.map.setTarget(e),{map:this.map,view:this.view}}setHitTolerance(e){this.hitTolerance=e}getHitTolerance(){return this.hitTolerance}addBboxSelection(e,t,r,o){Object.assign({className:"ol-drag-select",condition:e},o);const s=new fe.a(o);return t&&s.on("boxstart",e=>{t(e)}),r&&s.on("boxend",e=>{const t=s.getGeometry().getExtent();r(t,e)}),this.map.addInteraction(s),s}getLayers(e){const t=e.toLowerCase();let r;return this.map.getLayers().getArray().forEach(e=>{e.get("filtertype")===t&&(r=e.getLayers().getArray())}),r}getLayersFromGroup(e,t,r=!1){const o=e.getLayers().getArray();let s=o;if(r){let e=[].concat(o);o.forEach(r=>{r instanceof Q.a&&(e=e.concat(this.getLayersFromGroup(r,t,!0)))}),s=e}return t?s.filter(e=>e.get("filtertype")&&e.get("filtertype").toLowerCase()===t.toLowerCase()):s}getLayerByKey(e,t){const r=xe(this.getLayersFromGroup(this.map.getLayerGroup(),t)),o=[];if(r.forEach(t=>{t.get(e.key)&&t.get(e.key)===e.value&&-1===o.indexOf(t)&&o.push(t)}),!o.length){const r=this.getLayersFromGroup(this.map.getLayerGroup(),t,!0);r.length&&r.forEach(t=>{t.get(e.key)&&t.get(e.key)===e.value&&-1===o.indexOf(t)&&o.push(t)})}return 1===o.length?o[0]:null}setRecursiveKey(e,t,r="filtertype"){e.set(r,t),e instanceof Q.a&&e.getLayers().forEach(e=>{this.setRecursiveKey(e,t,r)})}addLayer(e,t){const r=t.toLowerCase();let o;return this.map.getLayers().getArray().forEach(t=>{t.get("filtertype")===r&&(this.isLayerInGroup(e,t)||(o=t.getLayers().getArray(),this.setRecursiveKey(e,r,"filtertype"),o.push(e),t.setLayers(new se.a(o))))}),o}isLayerInGroup(e,t){return!!t.getLayers().getArray().filter(t=>t.get("id")===e.get("id")).length}getLayerGroups(e){const t=[];return this.map.getLayers().forEach(r=>{r instanceof Q.a&&(e?r.get("filtertype")&&r.get("filtertype").toLowerCase()===e.toLowerCase()&&t.push(r):t.push(r))}),t}addLayers(e,t){const r=t.toLocaleLowerCase();let o;return this.getLayerGroups(r).forEach(t=>{t.getLayers().getLength()>0?(o=t.getLayers().getArray(),e.map(e=>{this.isLayerInGroup(e,t)||o.push(e)})):o=e,o.forEach(e=>{e instanceof Q.a&&this.setRecursiveKey(e,r,"filtertype")}),t.setLayers(new se.a(o))}),o}setLayers(e,t){const r=t.toLocaleLowerCase(),o=this.getLayerGroups(r);return e.forEach(e=>{e instanceof Q.a&&this.setRecursiveKey(e,t.toLocaleLowerCase(),"filtertype")}),o.forEach(t=>{t.setLayers(new se.a(e))}),e}getLayerGroupForLayer(e){const t=this.getLayersFromGroup(this.map.getLayerGroup(),null,!0);t.push(this.map.getLayerGroup());let r=null;return t.forEach(t=>{if(t instanceof Q.a){const o=this.getLayersFromGroup(t).find(t=>t===e);o&&(r={group:t,layer:o})}}),r}removeLayerByKey(e,t){const r=t.toLocaleLowerCase(),o=this.getLayerByKey(e,r);if(o){const e=this.getLayerGroupForLayer(o);if(e.group){const t=this.getLayersFromGroup(e.group).filter(e=>e!==o);e.group.setLayers(new se.a(t))}}}updateLayerByKey(e,t,r){const o=r.toLocaleLowerCase();this.map.getLayers().forEach(r=>{if(r.get("filtertype")===o){const o=r.getLayers();o.forEach((r,s)=>{if(r.get(e.key)&&r.get(e.key)===e.value){const e=t.getProperties(),i=t.getExtent(),a=t.getMaxZoom(),n=t.getMinZoom(),c=t.getOpacity(),l=t.getVisible(),p=t.getZIndex();if(r instanceof z.a&&t instanceof z.a){const e=t.getSource();r.setSource(e)}e&&r.setProperties(e),i&&r.setExtent(i),a&&r.setMaxZoom(a),n&&r.setMinZoom(n),c&&r.setOpacity(c),l&&r.setVisible(l),p&&r.setZIndex(p),r.changed(),o.setAt(s,r)}}),r.setLayers(o)}})}removeAllLayers(e){const t=e.toLowerCase();let r;this.map.getLayers().getArray().forEach(e=>{e.get("filtertype")===t&&(r=e.getLayers(),r.clear())})}setUkisLayers(e,t){const r=t.toLowerCase(),o=[];if(e.length<1&&"baselayers"!==r?this.removeAllLayers(r):e.forEach(e=>{const t=this.create_layers(e);t&&o.push(t)}),o.length>0)return this.setLayers(o,r),{type:r,layers:o}}setUkisLayer(e,t){t||(t=e.filtertype);const r=t.toLowerCase(),o=this.getLayers(r).find(t=>t.get("id")===e.id),s=this.create_layers(e);o?(this.removeLayerByKey({key:"id",value:o.get("id")},t),this.addLayer(s,t)):this.addLayer(s,t)}updateUkisLayer(e,t){t||(t=e.filtertype);const r=t.toLowerCase(),o=this.getLayers(r).find(t=>t.get("id")===e.id),s=this.create_layers(e);s&&this.updateLayerByKey({key:"id",value:o.get("id")},s,t)}create_layers(e){let t;switch(e.type){case"xyz":t=this.create_xyz_layer(e);break;case"wms":t=this.create_wms_layer(e);break;case"wmts":t=this.create_wmts_layer(e);break;case"geojson":t=this.create_geojson_layer(e);break;case"wfs":t=this.create_wfs_layer(e);break;case"custom":t=this.create_custom_layer(e)}return t}create_xyz_layer(e){const t={wrapX:!1};e.crossOrigin&&(t.crossOrigin=e.crossOrigin);const r=new H.a(t);if(e.attribution&&r.setAttributions([e.attribution]),e.continuousWorld&&r.set("wrapX",e.continuousWorld),e.subdomains){const t=e.subdomains.map(t=>e.url.replace("{s}",`${t}`));r.setUrls(t)}else r.setUrl(e.url);const o={type:"xyz",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:r};return e.popup&&(o.popup=e.popup),e.bbox&&(o.extent=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode())),e.maxResolution&&(o.maxResolution=e.maxResolution),e.minResolution&&(o.minResolution=e.minResolution),e.maxZoom&&(o.maxZoom=e.maxZoom),e.minZoom&&(o.minZoom=e.minZoom),new W.a(o)}create_wms_layer(e){const t={params:Object.assign({},e.params),wrapX:!1};e.tileSize&&(t.tileGrid=this.getTileGrid("default",null,e.tileSize),delete t.params.tileSize),e.crossOrigin&&(t.crossOrigin=e.crossOrigin),t.params=this.keysToUppercase(t.params);const r=new Y.a(t);if(e.attribution&&r.setAttributions([e.attribution]),e.continuousWorld&&r.set("wrapX",e.continuousWorld),e.subdomains){const t=e.subdomains.map(t=>e.url.replace("{s}",`${t}`));r.setUrls(t)}else r.setUrl(e.url);const o={type:"wms",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:r};return e.popup&&(o.popup=e.popup,o.className=e.id),e.maxResolution&&(o.maxResolution=e.maxResolution),e.minResolution&&(o.minResolution=e.minResolution),e.maxZoom&&(o.maxZoom=e.maxZoom),e.minZoom&&(o.minZoom=e.minZoom),e.bbox&&(o.extent=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode())),new W.a(o)}create_wmts_layer(e){if(e instanceof v){let t=this.getTileGrid("wmts"),r=this.EPSG;e.params.matrixSetOptions&&(r=e.params.matrixSetOptions.matrixSet,"resolutions"in e.params.matrixSetOptions?t=this.getTileGrid("wmts",null,e.tileSize,null,e.params.matrixSetOptions.resolutions):("resolutionLevels"in e.params.matrixSetOptions||"tileMatrixPrefix"in e.params.matrixSetOptions)&&(t=this.getTileGrid("wmts",e.params.matrixSetOptions.resolutionLevels,e.tileSize,e.params.matrixSetOptions.tileMatrixPrefix,null)),"matrixIds"in e.params.matrixSetOptions&&(t=this.getTileGrid("wmts",null,e.tileSize,null,null,e.params.matrixSetOptions.matrixIds)));let o={url:e.url,tileGrid:t,matrixSet:r,wrapX:!1,layer:e.params.layer,style:e.params.style};o=Object.assign(o,e.params),e.crossOrigin&&(o.crossOrigin=e.crossOrigin);const s=new K.a(o);if(e.attribution&&s.setAttributions([e.attribution]),e.continuousWorld&&s.set("wrapX",e.continuousWorld),e.subdomains){const t=e.subdomains.map(t=>e.url.replace("{s}",`${t}`));s.setUrls(t)}else s.setUrl(e.url);const i={type:"wmts",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:s};return e.popup&&(i.popup=e.popup,i.className=e.id),e.maxResolution&&(i.maxResolution=e.maxResolution),e.minResolution&&(i.minResolution=e.minResolution),e.maxZoom&&(i.maxZoom=e.maxZoom),e.minZoom&&(i.minZoom=e.minZoom),e.bbox&&(i.extent=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode())),new W.a(i)}console.error(`layer with id: ${e.id} and type ${e.type} is no instanceof WmtsLayer!`)}create_wfs_layer(e){var t;const r=new URL(e.url);r.searchParams.set("srsname",this.EPSG);const o=new te.a({format:new ie.a,url:r.toString()}),s=(null===(t=e.options)||void 0===t?void 0:t.style)||void 0,i={type:"wfs",filtertype:e.filtertype,name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:o,style:s};return e.popup&&(i.popup=e.popup,i.className=e.id),e.maxResolution&&(i.maxResolution=e.maxResolution),e.minResolution&&(i.minResolution=e.minResolution),e.maxZoom&&(i.maxZoom=e.maxZoom),e.minZoom&&(i.minZoom=e.minZoom),e.bbox&&(i.extent=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode())),e.options&&Object.assign(i,e.options),new Z.a(i)}create_geojson_layer(e){let t;e.data?t=new te.a({features:this.geoJsonToFeatures(e.data),format:new ie.a,wrapX:!1}):e.url&&(t=new re.a({url:e.url,crossOrigin:"anonymous",wrapX:!1})),e.continuousWorld&&t.set("wrapX",e.continuousWorld);const r={type:"geojson",name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1,source:t};if(e.popup&&(r.popup=e.popup,r.className=e.id),e.maxResolution&&(r.maxResolution=e.maxResolution),e.minResolution&&(r.minResolution=e.minResolution),e.maxZoom&&(r.maxZoom=e.maxZoom),e.minZoom&&(r.minZoom=e.minZoom),e.bbox&&(r.extent=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode())),e.cluster){const o={};"object"==typeof e.cluster&&Object.assign(o,e.cluster),o.source=t;const s=new oe.a(o);r.source=s;const i={};r.style=e=>{const t=e.get("features").length;let r=i[t];return r||(r=new de.b({image:new ye.a({radius:10,stroke:new ge.a({color:"#fff"}),fill:new be.a({color:"#3399CC"})}),text:new me.a({text:t.toString(),fill:new be.a({color:"#fff"})})}),i[t]=r),r}}return e.options&&Object.assign(r,e.options),new Z.a(r)}setCrossOrigin(e){if(e instanceof z.a){const t=e.getSource();(t instanceof X.a||t instanceof q.a)&&(t.crossOrigin_="anonymous")}}create_custom_layer(e){if(e.custom_layer){const t=e.custom_layer;if(t instanceof z.a){const r=t.getSource();r.set("wrapX",!1),e.attribution&&r.setAttributions([e.attribution]),e.continuousWorld&&r.set("wrapX",e.continuousWorld),this.setCrossOrigin(t)}else t instanceof Q.a?t.getLayers().forEach(e=>this.setCrossOrigin(e)):console.error(`The custom_layer of ${e.id} in not a openlayers Layer`);const r={type:"custom",name:e.name,id:e.id,visible:e.visible,legendImg:e.legendImg,opacity:e.opacity||1,zIndex:1};if(e.maxResolution&&t.setMaxResolution(e.maxResolution),e.minResolution&&t.setMinResolution(e.minResolution),e.maxZoom&&t.setMaxZoom(e.maxZoom),e.minZoom&&t.setMinZoom(e.minZoom),e.popup&&(r.popup=e.popup,t.className_=e.id),e.bbox){const r=Object(ne.r)(e.bbox.slice(0,4),ot,this.getProjection().getCode());t.setExtent(r)}return t.setProperties(r),t}console.log("attribute custom_layer not set on layer type custom!")}resolutionsFromExtent(e,t,r){const o=t,s=Object(pe.B)(e),i=Object(pe.F)(e),a=Math.max(i/r,s/r),n=o+1,c=new Array(n);for(let l=0;l<n;++l)c[l]=a/Math.pow(2,l);return c}matrixIdsFromResolutions(e,t){return Array.from(Array(e).keys()).map(e=>t?`${t}:${e}`:e)}getTileGrid(e="default",t,r,o,s,i){const a=t||ue.a,n=r||ue.b,c=o||"",l=this.getProjection().getExtent(),p=this.resolutionsFromExtent(l,a,n),u=this.matrixIdsFromResolutions(p.length,c),h={extent:l,origin:Object(pe.D)(l),resolutions:s||p,tileSize:[n,n]};return"wmts"===e?(h.matrixIds=i||u,new J.b(h)):"default"===e?new ee.a(h):void 0}isMovePopup(e){return e&&"object"==typeof e&&"event"in e&&"move"===e.event}layers_on_click(e){this.layers_on_click_move(e,e=>{const t=e.get("popup");return!0===t||!this.isMovePopup(t)})}layers_on_pointermove(e){this.layers_on_click_move(e,e=>{const t=e.get("popup");return this.isMovePopup(t)})}layers_on_click_move(e,t){const r=[];let o=!1;this.map.forEachLayerAtPixel(e.pixel,(e,t)=>{o=!0,r.push({layer:e,color:t})},{layerFilter:t}),r.forEach((t,r)=>{0===r&&this.layer_on_click(e,t.layer,t.color)}),o?this.map.getTargetElement().style.cursor="pointer":(this.removeAllPopups(e=>"pointermove"===e.get("addEvent")),this.map.getTargetElement().style.cursor="")}layer_on_click(e,t,r){t instanceof U.a||t instanceof N.a?this.raster_on_click(e,t,r):t instanceof B.a&&this.vector_on_click(e)}vector_on_click(e){const t=[];this.map.forEachFeatureAtPixel(e.pixel,(e,r)=>{t.push({feature:e,layer:r})},{layerFilter:e=>{if(e instanceof B.a){const t=e.getSource();return t instanceof oe.a?t.getSource()instanceof te.a:t instanceof te.a||t instanceof $.a}},hitTolerance:this.hitTolerance}),t.forEach((t,r)=>{if(0===r){const r=t.layer,o=t.feature,s=r.get("popup");let i={};if(r instanceof B.a&&s){const t=o.getProperties().features;if(t&&1===t.length)i=t[0].getProperties();else{if(t&&t.length>1){if("click"===e.type){const e=this.getFeaturesExtent(o.getProperties().features);return this.setExtent(e),!1}return!0}i=o.getProperties()}("boolean"==typeof s||Array.isArray(s)||"click"===s.event&&"click"===e.type||!s.event&&"click"===e.type||"move"===s.event&&"pointermove"===e.type)&&this.prepareAddPopup(i,r,o,e,s)}}})}raster_on_click(e,t,r){const o=t.get("popup");let s={};o&&(s=t.getProperties(),s.evt=e,r&&(s.color=r),this.prepareAddPopup(s,t,null,e,o))}prepareAddPopup(e,t,r,o,s){const i={modelName:e.id,properties:e,layer:t,feature:r,event:o};let a=Object.assign({},e);if(a.geometry&&delete a.geometry,Array.isArray(s)&&(a=Object.keys(a).filter(e=>s.includes(e)).reduce((e,t)=>(e[t]=a[t],e),{})),"object"==typeof s&&!Array.isArray(s)&&s.filterkeys&&(a=Object.keys(a).filter(e=>s.filterkeys.includes(e)).reduce((e,t)=>(e[t]=a[t],e),{})),"object"==typeof s&&!Array.isArray(s))if(s.properties){const e=Object.keys(s.properties);Array.isArray(e)&&(a=Object.keys(a).reduce((e,t)=>{const r=s.properties[t];return r?e[r]=a[t]:e[t]=a[t],e},{}))}else s.pupupFunktion?i.popupFn=s.pupupFunktion:s.dynamicPopup&&(i.dynamicPopup=s.dynamicPopup);"boolean"==typeof s||Array.isArray(s)?this.addPopup(i,a,null):s&&("asyncPupup"in s?s.asyncPupup(a,e=>{this.addPopup(i,null,e,s.event,s.single)}):this.addPopup(i,a,null,s.event,s.single))}addPopup(e,t,r,o,s){const i=e.layer.get("popup"),a="popup_move_ID",n=this.getPopups().find(e=>e.getId()===a);if("move"===o&&n){let s;s=e.properties&&e.properties.geometry&&"Point"===e.properties.geometry.getType()?e.properties.geometry.getCoordinates():e.event.coordinate;const i=this.createPopupContainer(n,e,t,r,o);n.setElement(i),n.setPosition(s)}else if("pointermove"!==e.event.type||o){let n=null;n="move"===o?a:e.feature?Object(ve.c)(e.feature):e.layer?Object(ve.c)(e.layer):`popup_${(new Date).getTime()}`;const c={autoPan:!0,id:n,autoPanAnimation:{duration:250},positioning:rt.a.BOTTOM_CENTER,stopEvent:!0,insertFirst:!1};let l=c;i&&"object"==typeof i&&!Array.isArray(i)&&i.options&&(l=Object.assign(c,i.options));const p=new V.a(l);s&&this.removeAllPopups();const u=this.getPopups().find(e=>e.getId()===p.getId()&&p.getId()!==a);u&&(this.map.removeOverlay(u),this.destroyDynamicPopupComponent(u.getId().toString()));const h=this.createPopupContainer(p,e,t,r,o);let d;p.set("addEvent",e.event.type),p.set("type","popup"),p.setElement(h),d=e.properties&&e.properties.geometry&&"Point"===e.properties.geometry.getType()?e.properties.geometry.getCoordinates():e.event.coordinate,p.setPosition(d),this.map.addOverlay(p)}else n&&this.removeAllPopups(e=>"pointermove"===e.get("addEvent"))}createPopupContainer(e,t,r,o,s){const i=document.createElement("div");i.className="ol-popup-content";let a="";if(a=t.popupFn?t.popupFn(r):!o||r&&0!==Object.keys(r).length?this.createPopupHtml(r):o,i.innerHTML=a,t.dynamicPopup){const o=e.getId().toString();this.destroyDynamicPopupComponent(o),this.createDynamicPopupComponent(o,i,{event:t.event,layer:t.layer,feature:t.feature||null,dynamicPopup:t.dynamicPopup,properties:r})}const n=document.createElement("div");if(n.className="ol-popup",n.id=e.getId().toString(),n.style.display="block",!s||"move"!==s){const t=document.createElement("a");t.className="ol-popup-closer",n.appendChild(t);const r=()=>{t.removeEventListener("click",r,!1),this.map.removeOverlay(e),this.destroyDynamicPopupComponent(e.getId().toString())};t.addEventListener("click",r,!1)}return n.appendChild(i),n}removeAllPopups(e){let t=this.getPopups();e&&(t=this.getPopups().filter(e)),t.forEach(e=>{"popup"===e.get("type")&&(this.map.removeOverlay(e),this.destroyDynamicPopupComponent(e.getId().toString()))})}createPopupHtml(e){let t="<table>";for(const r in e)e.hasOwnProperty(r)&&(t+='<tr><td style="vertical-align: top; padding-right: 7px;"><b>'+r+": </b></td><td>"+e[r]+"</td></tr>");return t+="</table>",t}getPopups(){const e=[];return this.map.getOverlays().getArray().slice(0).forEach(t=>{"popup"===t.get("type")&&e.push(t)}),e}destroyDynamicPopupComponent(e){this.dynamicPopupComponents.has(e)&&(this.dynamicPopupComponents.get(e).destroy(),this.dynamicPopupComponents.delete(e))}createDynamicPopupComponent(e,t,r){const o=this.crf.resolveComponentFactory(r.dynamicPopup.component).create(this.injector,[],t);if(r.dynamicPopup.getAttributes){const e=r.dynamicPopup.getAttributes(r);for(const t in e)"undefined"!==e[t]&&(o.instance[t]=e[t])}this.app.attachView(o.hostView),this.dynamicPopupComponents.set(e,o)}setExtent(e,t,r){const o=t?Object(ne.i)(ot):Object(ne.i)(this.EPSG),s=Object(ne.r)(e.slice(0,4),o,this.getProjection().getCode()),i={size:this.map.getSize()};return r&&Object.assign(i,r),this.map.getView().fit(s,r),s}setCenter(e,t){const r=t?Object(ne.i)(ot):Object(ne.i)(this.EPSG),o=Object(ne.q)(e,r,this.getProjection().getCode());return this.map.getView().setCenter(o),o}getCenter(e){const t=e?Object(ne.i)(ot):Object(ne.i)(this.EPSG),r=Object(ne.i)(this.getProjection().getCode());return Object(ne.q)(this.map.getView().getCenter(),r,t)}getFeaturesExtent(e,t){const r=e[0].getGeometry().getExtent().slice(0);if(e.forEach(e=>{Object(pe.r)(r,e.getGeometry().getExtent())}),t){const e=Object(ne.i)(ot);return Object(ne.r)(r,this.getProjection().getCode(),e)}return r}getCurrentExtent(e){const t=e?Object(ne.i)(ot):Object(ne.i)(this.EPSG),r=this.map.getView().calculateExtent();return Object(ne.r)(r,this.getProjection().getCode(),t)}setZoom(e,t){this.map.getView().setZoom(e)}getZoom(){return this.map.getView().getZoom()}zoomInOut(e){const t=this.map.getView();if(!t)return;const r=t.getZoom();if(void 0!==r){const e=t.getConstrainedZoom(r+1);t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:e,duration:250,easing:he.b})}}geoJsonToFeature(e){return new ie.a({dataProjection:ot,featureProjection:this.EPSG}).readFeature(e)}geoJsonToFeatures(e){return new ie.a({dataProjection:ot,featureProjection:this.EPSG}).readFeatures(e)}getProjection(){return this.map.getView().getProjection()}reprojectFeatures(e,t,r){e.getFeatures().forEach(e=>{e.getGeometry().transform(t,r)})}setProjection(e){if(e){let t={};if(this.viewOptions&&(t=this.viewOptions,t.minResolution=void 0,t.maxResolution=void 0,t.resolution=void 0,t.resolutions=void 0),e instanceof ae.a){t.projection=e;const r=Object(ne.q)(this.map.getView().getCenter(),this.map.getView().getProjection(),e);t.center=r,t.zoom=this.map.getView().getZoom()}else"string"==typeof e&&(t.projection=e,t.center=this.map.getView().getCenter(),t.zoom=this.map.getView().getZoom());const r=new D.a(t),o=this.EPSG;this.EPSG=r.getProjection().getCode(),this.map.setView(r),this.view=this.map.getView(),this.map.getLayers().getArray().forEach(e=>{e.getLayers().getArray().forEach(e=>{if(e instanceof z.a){let t=e.getSource();for(;t.source;)t=t.source;t instanceof te.a&&this.reprojectFeatures(t,o,this.EPSG)}})}),this.projectionChange.next(this.getProjection())}}registerProjection(e){le.a.defs(e.code,e.proj4js),Object(ce.a)(le.a)}getOlProjection(e){return new ae.a({code:e.code,extent:e.extent?e.extent:void 0,worldExtent:e.worldExtent?e.worldExtent:void 0,global:!!e.global&&e.global,units:e.units?e.units:void 0})}keysToUppercase(e){return Object.keys(e).forEach(t=>{const r=t.toUpperCase();r!==t&&(e[r]=e[t],delete e[t])}),e}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(s.j),s.Ub(s.g),s.Ub(s.s))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var it=r("zP0r"),at=r("6kTr"),nt=r("XdCU"),ct=r("Yjhu"),lt=r("Gufx"),pt=r("rA9B"),ut=r("1N7p"),ht=r("kMZc"),dt=r("+L8p"),mt=r("WpFC"),bt=r("SVse");const yt=["mapDiv"];function gt(e,t){1&e&&(s.Qb(0,"div",3),s.yc(1,"+"),s.Pb())}let ft=(()=>{class e{constructor(e,t){this.mapSvc=e,this.ngZone=t,this.subs=[],this.privMapwidth=0,this.removePopupsOnMouseLeave=e=>{this.mapSvc.removeAllPopups(e=>"pointermove"===e.get("addEvent"))}}get mapwidth(){return this.privMapwidth}set mapwidth(e){this.privMapwidth=e,this.map.updateSize()}ngOnInit(){this.subscribeToMapState(),this.initMap(),this.subscribeToLayers()}ngAfterViewInit(){this.map.setTarget(this.mapDivView.nativeElement);const e=this.mapStateSvc.getMapState().getValue();this.setMapState(e),this.subscribeToMapEvents(),this.map.getTargetElement().addEventListener("mouseleave",this.removePopupsOnMouseLeave)}ngAfterViewChecked(){if(this.mapDivView){const e=this.mapDivView.nativeElement.offsetWidth;e!==this.mapwidth&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.mapwidth=e},100)})}}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe()),this.map&&(this.map.un("moveend",this.mapOnMoveend),this.map.un("click",this.mapOnClick),this.map.un("dblclick",this.mapOnDclick),this.map.un("pointermove",this.mapOnPointermove),this.map.getTargetElement().removeEventListener("mouseleave",this.removePopupsOnMouseLeave),this.map.getInteractions().forEach(e=>{this.map.removeInteraction(e)}))}addUpdateLayers(e,t,r){let o=0;if(r.forEach(e=>{o+=this.mapSvc.getLayers(e).length}),e.length!==this.mapSvc.getLayers(t).length){if(this.mapSvc.setUkisLayers(e,t),o>0)for(const r of e){const s=this.mapSvc.getLayerByKey({key:"id",value:r.id},t);s&&s.getZIndex()!==e.indexOf(r)+o&&(s.setZIndex(e.indexOf(r)+o),s instanceof Q.a&&s.getLayers().forEach(t=>{t.setZIndex(e.indexOf(r)+o)}))}}else for(const s of e){const r=this.mapSvc.getLayerByKey({key:"id",value:s.id},t);if(r){if(r.getVisible()!==s.visible&&r.setVisible(s.visible),r.getOpacity()!==s.opacity&&r.setOpacity(s.opacity),s instanceof g&&r instanceof z.a){const e=s.custom_layer.getSource(),t=r.getSource();e&&Object(ve.c)(t)!==Object(ve.c)(e)&&r.setSource(e)}else if(s instanceof g&&s.custom_layer instanceof Q.a&&r instanceof Q.a){const e=s.custom_layer.getLayers().getArray();r.getLayers().getArray().forEach((t,r)=>{const o=e[r];if(t instanceof z.a&&o instanceof z.a){const e=t.getSource(),r=o.getSource();r&&Object(ve.c)(e)!==Object(ve.c)(r)&&t.setSource(r)}})}o>0?r.getZIndex()!==e.indexOf(s)+o&&r.setZIndex(e.indexOf(s)+o):r.getZIndex()!==e.indexOf(s)&&r.setZIndex(e.indexOf(s)),this.updateLayerParamsWith(r,s)}}}updateLayerParamsWith(e,t){switch(t.type){case a:this.updateWmsLayerParamsWith(e,t);break;case n:this.updateWmtsLayerParamsWith(e,t);break;case l:this.updateGeojsonLayerParamsWith(e,t);break;case p:this.updateWfsLayerParamsWith(e,t)}}updateWfsLayerParamsWith(e,t){t.options&&t.options.style!==e.getStyle()&&e.setStyle(t.options.style),e.getSource().getUrl()!==t.url&&e.getSource().setUrl(t.url)}updateGeojsonLayerParamsWith(e,t){var r;const o=e.getSource();if(o){if(t.data){const e=this.mapSvc.geoJsonToFeatures(t.data);if(o instanceof oe.a){const t=o.getSource();t.clear(),t.addFeatures(e)}else o.clear(),o.addFeatures(e)}else t.url&&(o instanceof oe.a?o.getSource().setUrl(t.url):o.setUrl(t.url));"object"==typeof(null==t?void 0:t.cluster)&&"distance"in t.cluster&&o instanceof oe.a&&o.setDistance(t.cluster.distance)}(null===(r=null==t?void 0:t.options)||void 0===r?void 0:r.style)&&e.setStyle(t.options.style)}updateWmsLayerParamsWith(e,t){if(e instanceof z.a){const r=e.getSource().getParams(),o=t.params;this.shallowEqual(r,o)||e.getSource().updateParams(o)}}updateWmtsLayerParamsWith(e,t){if(e instanceof z.a){const r=e.getSource(),o=r.getStyle(),s=r.getFormat(),i=r.getVersion(),a=r.getMatrixSet(),n=t.params.style,c=t.params.format,l=t.params.version,p=t.params.matrixSetOptions.matrixSet;if(void 0!==n&&o!==n||void 0!==c&&s!==c||void 0!==l&&i!==l||void 0!==p&&a!==p){const e=t.filtertype.toLowerCase();this.mapSvc.updateUkisLayer(t,e)}}}shallowEqual(e,t){const r=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(r.length!==o.length)return!1;for(const s of r)if(e[s]!==t[s])return!1;return!0}addUpdateBaseLayers(e){if(e.length!==this.mapSvc.getLayers("baselayers").length){const t=e.filter(e=>!0===e.visible);0===t.length?e[0].visible=!0:t.length>1&&(e.forEach(e=>e.visible=!1),e[0].visible=!0),this.mapSvc.setUkisLayers(e,"baselayers")}else for(const t of e){const r=this.mapSvc.getLayerByKey({key:"id",value:t.id},"baselayers");r&&(r.getVisible()!==t.visible&&r.setVisible(t.visible),r.getZIndex()!==e.indexOf(t)&&r.setZIndex(e.indexOf(t)),r.getOpacity()!==t.opacity&&r.setOpacity(t.opacity))}}subscribeToLayers(){if(this.layersSvc){const e=this.layersSvc.getBaseLayers().subscribe(e=>this.addUpdateBaseLayers(e));this.subs.push(e);const t=this.layersSvc.getLayers().subscribe(e=>this.addUpdateLayers(e,"layers",["baselayers"]));this.subs.push(t);const r=this.layersSvc.getOverlays().subscribe(e=>this.addUpdateLayers(e,"overlays",["baselayers","layers"]));this.subs.push(r)}}setMapState(e){const t=this.mapStateSvc.getLastAction().getValue();"user"===e.options.notifier&&("setExtent"===t?this.mapSvc.setExtent(e.extent,!0):"setState"===t&&(this.mapSvc.setZoom(e.zoom,e.options.notifier),this.mapSvc.setCenter([e.center.lon,e.center.lat],!0)))}subscribeToMapState(){if(this.mapStateSvc){const e=this.mapStateSvc.getMapState().pipe(Object(it.a)(1)).subscribe(e=>this.setMapState(e));this.subs.push(e)}}subscribeToMapEvents(){this.mapOnMoveend=e=>{const t=this.mapSvc.getZoom(),r=this.mapSvc.getCenter(!0),o=this.mapSvc.getCurrentExtent(!0),s={lat:parseFloat(r[1]),lon:parseFloat(r[0])},i=new P(t,s,{notifier:"map"},o);this.mapStateSvc.setMapState(i)},this.map.on("moveend",this.mapOnMoveend),this.mapOnClick=e=>{this.mapSvc.layers_on_click(e)},this.map.on("click",this.mapOnClick),this.mapOnDclick=e=>{this.mapSvc.removeAllPopups()},this.map.on("dblclick",this.mapOnDclick),this.mapOnPointermove=e=>{this.mapSvc.layers_on_pointermove(e)},this.map.on("pointermove",this.mapOnPointermove)}initMap(){const e=this.mapSvc.createMap();this.map=e.map,this.setControls(),this.layersSvc||console.log("there is no layersSvc as defined!"),this.mapStateSvc||console.log("there is no mapStateSvc as defined!")}setControls(){const e=[],t=[];if(this.map&&(this.map.getControls().getArray().forEach(e=>t.push(e)),this.map.getControls().clear()),this.controls&&this.map){if(!1!==this.controls.attribution){let t={collapsible:!0,collapsed:!1};"object"==typeof this.controls.attribution&&(t=Object.assign(t,this.controls.attribution));const r=new at.a(t);e.push(r)}if(this.controls.scaleLine){let t={};"object"==typeof this.controls.scaleLine&&(t=Object.assign(t,this.controls.scaleLine));const r=new nt.a(t);e.push(r)}if(!1!==this.controls.zoom){let t={};"object"==typeof this.controls.zoom&&(t=Object.assign(t,this.controls.zoom));const r=new ct.a(t);e.push(r)}if(this.controls.mousePosition){let t={coordinateFormat:e=>Object(pt.g)(e,2),projection:"EPSG:4326"};"object"==typeof this.controls.mousePosition&&(t=Object.assign(t,this.controls.mousePosition));const r=new lt.a(t);e.push(r)}if(this.controls.fullScreen){let t={};"object"==typeof this.controls.fullScreen&&(t=Object.assign(t,this.controls.fullScreen));const r=new ut.a(t);e.push(r)}if(this.controls.overviewMap){const t=document.createElement("spawn");t.innerHTML='<clr-icon shape="world"></clr-icon>';let r={layers:[new W.a({source:new dt.a})],label:t};"object"==typeof this.controls.overviewMap&&(r=Object.assign(r,this.controls.overviewMap));const o=new ht.a(r);e.push(o)}if(this.controls.rotate){let t={};"object"==typeof this.controls.rotate&&(t=Object.assign(t,this.controls.rotate));const r=new mt.a(t);e.push(r)}e.length&&(t.filter(t=>!e.includes(t)).forEach(t=>e.push(t)),this.map.getControls().extend(e))}}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(st),s.Kb(s.A))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-map-ol"]],viewQuery:function(e,t){if(1&e&&s.Dc(yt,1),2&e){let e;s.kc(e=s.Yb())&&(t.mapDivView=e.first)}},inputs:{layersSvc:"layersSvc",mapStateSvc:["mapState","mapStateSvc"],controls:"controls"},decls:3,vars:1,consts:[["id","map","ref","map",1,"map"],["mapDiv",""],["id","crosshair","class","crosshair",4,"ngIf"],["id","crosshair",1,"crosshair"]],template:function(e,t){1&e&&(s.Qb(0,"div",0,1),s.wc(2,gt,2,0,"div",2),s.Pb()),2&e&&(s.zb(2),s.fc("ngIf",t.controls&&t.controls.crosshair))},directives:[bt.n],styles:['@charset "UTF-8";.ol-box{box-sizing:border-box;border-radius:2px;border:2px solid #00f}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:rgba(0,60,136,.3);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid #eee;border-top:none;color:#eee;font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-step-marker{width:1px;height:15px;background-color:#000;float:right;z-Index:10}.ol-scale-step-text{bottom:-5px;font-size:12px;z-Index:11}.ol-scale-step-text,.ol-scale-text{position:absolute;color:#000;text-shadow:-2px 0 #fff,0 2px #fff,2px 0 #fff,0 -2px #fff}.ol-scale-text{font-size:14px;text-align:center;bottom:25px}.ol-scale-singlebar{position:relative;height:10px;z-Index:9;box-sizing:border-box;border:1px solid #000}.ol-unsupported{display:none}.ol-unselectable,.ol-viewport{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:grab}.ol-control{position:absolute;background-color:hsla(0,0%,100%,.4);border-radius:4px;padding:2px}.ol-control:hover{background-color:hsla(0,0%,100%,.6)}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:#fff;font-size:1.14em;font-weight:700;text-decoration:none;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:rgba(0,60,136,.5);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;font-size:1.2em;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:focus,.ol-control button:hover{text-decoration:none;background-color:rgba(0,60,136,.7)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em)}.ol-attribution ul{margin:0;padding:0 .5em;color:#000;text-shadow:0 0 2px #fff}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button,.ol-attribution ul{display:inline-block}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:inline-block}.ol-overviewmap .ol-overviewmap-map{border:1px solid #7b98bc;height:150px;margin:2px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:1px;left:2px;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-overviewmap-box{border:2px dotted rgba(0,60,136,.7)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}:root{--ukis-crosshair-color:#ff0004;--ukis-popup-bg-color:#eee;--ukis-drop-shadow:drop-shadow(0 1px 4px rgba(0,0,0,0.2));--ukis-ol-bbox-bg-color:hsla(0,0%,100%,0.4);--ukis-ol-bbox-border-color:rgba(87,87,87,0.4);--ukis-ol-overviewmap-left:0.5em;--ukis-ol-overviewmap-bottom:3.0em;--ukis-ol-control-bg-color:rgba(87,87,87,0.6);--ukis-ol-control-border-color:rgba(87,87,87,0.4)}.map{width:100%;height:100%;position:relative}.ol-popup{position:absolute;background-color:var(--ukis-popup-bg-color);filter:var(--ukis-drop-shadow);padding:15px;border-radius:2px;bottom:12px;left:-50px;min-width:280px;display:none;z-index:1000000}.ol-popup .ol-popup-closer{text-decoration:none;position:absolute;top:0;right:8px;cursor:pointer}.ol-popup .ol-popup-closer:after{content:"\u2716"}.ol-popup:after,.ol-popup:before{top:100%;border:solid transparent;content:" ";height:0;width:0;position:absolute;pointer-events:none}.ol-popup:after{border-top-color:var(--ukis-popup-bg-color);border-width:10px;left:48px;margin-left:-10px}.ol-popup:before{border-width:11px;left:48px;margin-left:-11px}.crosshair{top:50%;left:50%;font-size:large;color:var(--ukis-crosshair-color);z-index:1;position:absolute;cursor:default}.ol-control button{cursor:pointer}.ol-control button,.ol-control button:focus{background-color:var(--ukis-ol-control-bg-color)}.ol-control button:hover{background-color:var(--ukis-ol-control-border-color)}.ol-scale-line{background:hsla(0,0%,100%,.4);line-height:1.375em}.ol-scale-line .ol-scale-line-inner{background:var(--ukis-ol-control-bg-color);border-color:var(--ukis-ol-control-bg-color)}.ol-attribution ul{font-size:.5rem}.ol-box{background-color:var(--ukis-ol-bbox-bg-color);border-color:var(--ukis-ol-bbox-border-color)!important}.ol-box.ol-drag-select{border-color:var(--clr-color-action-600,var(--fallback-color-no-clr))!important}.ol-overviewmap{left:var(--ukis-ol-overviewmap-left)!important;bottom:var(--ukis-ol-overviewmap-bottom)!important}'],encapsulation:2}),e})(),vt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({providers:[st],imports:[[bt.c]]}),e})();var wt=r("jnTo"),St=r("FHfp");class xt extends wt.a{constructor(e={}){const t=e;super({element:document.createElement("div"),target:t.target}),this.toggle="zoom";const r=void 0!==t.className?t.className:"zoom-number ol-unselectable ol-control",o=document.createElement("button");o.className=r+"-reset",o.setAttribute("type","button"),o.innerHTML="Z",o.addEventListener("click",this.toggleZoomResolution.bind(this),!1);const s=this.element;s.className=r+" ",s.appendChild(o)}setMap(e){super.setMap(e),e&&this.listenerKeys.push(Object(St.a)(e,"moveend",this.handleMapMoveend_,this))}getMapZoom(){return this.getMap().getView().getZoom()}getMapResolution(){return this.getMap().getView().getResolution()}toggleZoomResolution(){this.toggle="zoom"===this.toggle?"resolution":"zoom",this.handleMapMoveend_()}handleMapMoveend_(){if(this.element instanceof HTMLElement&&this.element.firstElementChild instanceof HTMLElement)if("zoom"===this.toggle){const e=this.getMapZoom();this.element.firstElementChild.innerHTML=""+Math.round(1*e)/1,this.element.firstElementChild.title=`z: ${e}`}else{const e=this.getMapResolution();this.element.firstElementChild.innerHTML=""+Math.round(1*e)/1,this.element.firstElementChild.title=`r: ${e}`}}}var Pt=r("X69f");function _t(e,t){if(1&e&&(s.Qb(0,"clr-dg-column"),s.yc(1),s.Pb()),2&e){const e=t.$implicit;s.zb(1),s.zc(e.key)}}function Lt(e,t){if(1&e&&(s.Qb(0,"clr-dg-cell"),s.yc(1),s.Pb()),2&e){const e=t.$implicit;s.zb(1),s.zc(e.value)}}let Et=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-table-popup"]],inputs:{data:"data"},decls:6,vars:6,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Qb(0,"clr-datagrid"),s.wc(1,_t,2,1,"clr-dg-column",0),s.ac(2,"keyvalue"),s.Qb(3,"clr-dg-row"),s.wc(4,Lt,2,1,"clr-dg-cell",0),s.ac(5,"keyvalue"),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("ngForOf",s.bc(2,2,t.data)),s.zb(3),s.fc("ngForOf",s.bc(5,4,t.data)))},directives:[Pt.g,Pt.L,Pt.N,Pt.I,Pt.O,bt.m,Pt.k,Pt.M,Pt.i,Pt.K,Pt.h,Pt.J],pipes:[bt.h],styles:[""]}),e})();var Ot=r("94f5"),Tt=r("IheW"),Ct=r("dmaU"),It=r("39Zw"),Rt=r("YakL"),kt=r("Tu8L"),Ft=r("eW8D"),Mt=r("RZOP"),Gt=r("51Rc");const At=It.XLink_1_0,jt=Rt.OWS_1_1_0,Dt=kt.SMIL_2_0,zt=Ft.SMIL_2_0_Language,Qt=Mt.GML_3_1_1,Vt=Gt.WMTS_1_0;let Nt=(()=>{class e{constructor(e){this.http=e;const t=new Ct.Jsonix.Context([Dt,zt,Qt,At,jt,Vt]);this.xmlunmarshaller=t.createUnmarshaller(),this.xmlmarshaller=t.createMarshaller()}getCapabilities(e,t="1.1.0"){const r=`${e}?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=${t}`,o=new Tt.c({"Content-Type":"text/xml",Accept:"text/xml, application/xml"});return this.http.get(r,{headers:o,responseType:"text"}).pipe(Object(_.a)(e=>this.xmlunmarshaller.unmarshalString(e)))}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(Tt.a))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Bt=r("mxoJ"),Ut=r("M4FE"),Wt=r("LRne"),Zt=r("5+tZ"),$t=r("vkgz"),Ht=r("eIep"),Xt=r("w1tV"),qt=r("wgT7"),Yt=r("LuQ5"),Kt=r("GS9G"),Jt=r("cp0P"),er=r("PqYM"),tr=r("MtjB"),rr=r("3E0/");function or(e,t=3){let r=1;return o=>o.pipe(Object(tr.a)(o=>o.pipe(Object(rr.a)(e),Object(Zt.a)(e=>{if(e.status&&400===e.status)throw e;if(r<=t)return console.log("http-error. Retrying ..."),r+=1,Object(Wt.a)(e);throw console.log(`Persistent http-errors after ${r} attempts. Giving up.`),e}))))}class sr{set(e,t){return Object(Wt.a)(!0)}get(e){return Object(Wt.a)(null)}}const ir=It.XLink_1_0,ar=Rt.OWS_1_1_0,nr=qt.OWS_2_0,cr=Yt.WPS_1_0_0,lr=Kt.WPS_2_0,pr=Ct.Jsonix;var ur=r("o1q9");let hr=(()=>{class e extends class{constructor(e){this.http=e,this.parser=new ur.a}getCapabilities(e,t="1.1.0"){return this.http.get(`${e}?SERVICE=WMS&REQUEST=GetCapabilities&VERSION=${t}`,{headers:{"Content-Type":"text/xml",Accept:"text/xml, application/xml"},responseType:"text"}).pipe(Object(_.a)(e=>this.parser.read(e)))}getLayerFromCapabilities(e,t){return this.getLayerFromCapabilitiesLayer(e,t.Capability.Layer)}getLayerFromCapabilitiesLayer(e,t){const r=t;return r?r.Name&&r.Name===e?r:r.Layer&&Array.isArray(r.Layer)?r.Layer.find(t=>this.getLayerFromCapabilitiesLayer(e,t)):r.Layer&&r.Layer.Name&&r.Layer.Name===e?r.Layer:void 0:null}getTimeDimensionFromLayer(e){var t;return null===(t=e.Dimension)||void 0===t?void 0:t.find(e=>"time"===e.name)}}{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(Tt.a))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac}),e})(),dr=(()=>{class e extends class{constructor(e="1.0.0",t,r){let o;if(this.webclient=t,this.cache=new sr,this.version=e,r&&(this.cache=r),"1.0.0"===this.version)this.wpsmarshaller=new Bt.a,o=new pr.Context([ir,ar,cr]);else{if("2.0.0"!==this.version)throw new Error("You entered a WPS version other than 1.0.0 or 2.0.0.");this.wpsmarshaller=new Ut.a,o=new pr.Context([ir,nr,lr])}this.xmlunmarshaller=o.createUnmarshaller(),this.xmlmarshaller=o.createMarshaller()}getCapabilities(e){const t=this.wpsmarshaller.getCapabilitiesUrl(e);return this.getRaw(t).pipe(Object(_.a)(e=>{const t=this.xmlunmarshaller.unmarshalString(e);return this.wpsmarshaller.unmarshalCapabilities(t.value)}))}describeProcess(e,t){const r=this.wpsmarshaller.getDescribeProcessUrl(e,t);return this.getRaw(r).pipe(Object(_.a)(e=>{const t=this.xmlunmarshaller.unmarshalString(e);return this.wpsmarshaller.unmarshalProcessDescription(t.value)}))}executeAsync(e,t,r,o,s=1e3,i,a){const n=this.executeAsyncBasic(e,t,r,o).pipe(Object(Zt.a)(a=>function(e,t,r,o=1e3){r&&r(null);const s=e.pipe(Object($t.a)(e=>{r&&r(e)})),i=Object(Jt.a)(s,Object(er.a)(o)).pipe(Object(_.a)(e=>e[0])).pipe(Object(Zt.a)(e=>t(e)?Object(Wt.a)(e):i));return i}(this.getNextState(a,e,t,r,o),e=>{if("Failed"===e.status)throw new Error(`Error during execution of process ${t}: `+e.statusLocation);return"Succeeded"===e.status},i,s)),Object(Zt.a)(s=>this.fetchResults(s,e,t,r,o,a)),Object($t.a)(e=>{for(const t of e)if("error"===t.description.type)throw console.log("server responded with 200, but body contained an error-result: ",t),new Error(t.value)}));return this.cachedQuery(e,t,r,o,n)}cachedQuery(e,t,r,o,s){return this.cache.get({url:e,processId:t,inputs:r,outputs:o}).pipe(Object(Ht.a)(i=>i?Object(Wt.a)(i):s.pipe(Object($t.a)(s=>{this.cache.set({url:e,processId:t,inputs:r,outputs:o},s).subscribe(e=>{console.log("set data in cache",e)})}))))}getNextState(e,t,r,o,s){let i;if("1.0.0"===this.version){if(!e.statusLocation)throw Error("No status location");i=this.getRaw(e.statusLocation)}else{if("2.0.0"!==this.version)throw new Error(`'GetStatus' has not yet been implemented for this WPS-Version (${this.version}).`);{if(!e.jobID)throw Error("No job-Id");const o=this.wpsmarshaller.marshallGetStatusBody(t,r,e.jobID),s=this.xmlmarshaller.marshalString(o);i=this.postRaw(t,s)}}return i.pipe(or(2e3,2),Object(_.a)(e=>{const i=this.xmlunmarshaller.unmarshalString(e);return this.wpsmarshaller.unmarshalGetStateResponse(i,t,r,o,s)}))}fetchResults(e,t,r,o,s,i){if(e.results){let a;return a=i?i(e.results):this.wpsmarshaller.unmarshalSyncExecuteResponse(e.results,t,r,o,s),Object(Wt.a)(a)}{if(!e.jobID)throw new Error("You want me to get a result, but I can't find a jobId. I don't know what to do now!");const a=this.wpsmarshaller.marshallGetResultBody(t,r,e.jobID),n=this.xmlmarshaller.marshalString(a);return this.postRaw(t,n).pipe(Object(_.a)(e=>{const a=this.xmlunmarshaller.unmarshalString(e);let n;return n=i?i(a):this.wpsmarshaller.unmarshalSyncExecuteResponse(a,t,r,o,s),n}))}}executeAsyncBasic(e,t,r,o){const s=this.wpsmarshaller.executeUrl(e,t),i=this.wpsmarshaller.marshalExecBody(t,r,o,!0),a=this.xmlmarshaller.marshalString(i);return this.postRaw(s,a).pipe(Object(_.a)(s=>{const i=this.xmlunmarshaller.unmarshalString(s);return this.wpsmarshaller.unmarshalAsyncExecuteResponse(i,e,t,r,o)}))}execute(e,t,r,o,s){const i=this.wpsmarshaller.executeUrl(e,t),a=this.wpsmarshaller.marshalExecBody(t,r,o,!1),n=this.xmlmarshaller.marshalString(a);return this.postRaw(i,n).pipe(Object(_.a)(i=>{const a=this.xmlunmarshaller.unmarshalString(i);return s?s(a):this.wpsmarshaller.unmarshalSyncExecuteResponse(a,e,t,r,o)}))}dismiss(e,t,r){const o=this.wpsmarshaller.dismissUrl(e,t,r),s=this.wpsmarshaller.marshalDismissBody(r),i=this.xmlmarshaller.marshalString(s);return this.postRaw(o,i).pipe(Object(_.a)(r=>{const o=this.xmlunmarshaller.unmarshalString(r);return this.wpsmarshaller.unmarshalDismissResponse(o,e,t)}))}postRaw(e,t){return this.webclient.post(e,t,{headers:{"Content-Type":"text/xml",Accept:"text/xml, application/xml"},responseType:"text"}).pipe(or(2e3,2),Object($t.a)(t=>{this.parseResponseForErrors(e,t)}),Object(Xt.a)())}getRaw(e){return this.webclient.get(e,{headers:{Accept:"text/xml, application/xml"},responseType:"text"}).pipe(or(2e3,2),Object($t.a)(t=>{this.parseResponseForErrors(e,t)}))}parseResponseForErrors(e,t){if(t.match("<title>404 Not Found</title>")||t.match("ows:ExceptionReport"))throw new Error(`From ${e}:  `+t)}setCache(e){this.cache=e}}{constructor(e="1.0.0",t,r){super(e,t,r),this.webClient=t}}return e.\u0275fac=function(t){return new(t||e)(s.Ub("WPS_VERSION"),s.Ub(Tt.a),s.Ub("WPS_CACHE"))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac}),e})();function mr(e,t){for(const r of e)if(!t(r))return!1;return!0}function br(e){return"id"in e&&"properties"in e&&function(e){return"title"in e&&"updated"in e&&(!e.authors||mr(e.authors,gr))&&(!e.offerings||mr(e.offerings,yr))&&(!e.categories||mr(e.categories,fr))}(e.properties)}function yr(e){return"code"in e&&(!e.operations||mr(e.operations,wr))&&(!e.contents||mr(e.contents,Sr))&&(!e.styles||mr(e.styles,xr))}function gr(e){return"name"in e||"email"in e||"uri"in e}function fr(e){return"scheme"in e||"term"in e||"label"in e}function vr(e){return"pixelWidth"in e||"pixelHeight"in e||"mmPerPixel"in e}function wr(e){return"code"in e&&"method"in e&&(!e.request||Sr(e.request))&&(!e.result||Sr(e.result))}function Sr(e){return"type"in e}function xr(e){return"name"in e&&"title"in e}function Pr(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wms"===e||"http://schemas.opengis.net/wms/1.1.1"===e||"http://schemas.opengis.net/wms/1.1.0"===e}function _r(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wfs"===e}function Lr(e){return"http://www.opengis.net/spec/owc-geojson/1.0/req/wmts"===e||"http://schemas.opengis.net/wmts/1.0.0"===e||"http://schemas.opengis.net/wmts/1.1.0"===e}function Er(e){if(!e)return;const t=[],r=e.split(",");for(const o in r)if(r[o]){const e=r[o].split("-");if(1===e.length)t.push(r[o]);else if(2===e.length){const r=e[0].charCodeAt(0),o=e[1].charCodeAt(0);if(r<=o)for(let e=r;e<=o;e++)t.push(String.fromCharCode(e).toLowerCase());else for(let e=r;e>=o;e--)t.push(String.fromCharCode(e).toLowerCase())}}return t}let Or=(()=>{class e{constructor(e){this.wmtsClient=e}checkContext(e){return"id"in(t=e)&&"properties"in t&&"links"in t.properties&&"lang"in t.properties&&"title"in t.properties&&"updated"in t.properties&&(!t.properties.authors||mr(t.properties.authors,gr))&&(!t.properties.creator||function(e){return"title"in e||"uri"in e||"version"in e}(t.properties.creator))&&(!t.properties.display||mr(t.properties.display,vr))&&(!t.properties.categories||mr(t.properties.categories,fr))&&"features"in t&&mr(t.features,br);var t}getContextTitle(e){return e.properties.title}getContextPublisher(e){return e.properties.publisher?e.properties.publisher:null}getContextExtent(e){return e.bbox?e.bbox:null}getResources(e){return e.features}getResourceTitle(e){return e.properties.title}getResourceUpdated(e){return e.properties.updated}getResourceDate(e){return e.properties.date?e.properties.date:null}getResourceOfferings(e){return e.properties.offerings?e.properties.offerings:null}isActive(e){let t=!0;return e.properties.hasOwnProperty("active")&&(t=e.properties.active),t}getResourceOpacity(e){let t=1;return e.properties.hasOwnProperty("opacity")&&(t=e.properties.opacity),t}getResourceAttribution(e){let t="";return e.properties.hasOwnProperty("attribution")&&(t=e.properties.attribution),t}getResourceShards(e){if(e.properties.hasOwnProperty("shards"))return e.properties.shards}convertOwcTimeToIsoTimeAndPeriodicity(e){const t=e.split("/"),r=3===t.length?t[0]+"/"+t[1]:e,o=3===t.length?t[2]:null;return o?{interval:r,periodicity:o}:r}getTimeValueFromDimensions(e){const t=RegExp(",","g").test(e);return t?e?e.split(",").map(e=>this.convertOwcTimeToIsoTimeAndPeriodicity(e)):null:!t&&e?this.convertOwcTimeToIsoTimeAndPeriodicity(e):void 0}getResourceDimensions(e){if(!e.properties.hasOwnProperty("dimensions"))return;const t={};let r={};if(Array.isArray(e.properties.dimensions))for(const o of e.properties.dimensions)r[o.name]=o;else r=e.properties.dimensions;for(const o in r)if(r[o]){let e={};e="time"===o||"ISO8601"===r[o].units?this.getTimeDimensions(r):r[o],t[o]=e}return t}getTimeDimensions(e){let t={values:null,units:null};const r=e.time.value;r||console.log("check to get dimensions value from OGC Service later!!",e);const o=this.getTimeValueFromDimensions(r);return t={values:null,units:e.time.units,display:{format:"YYYMMDD",period:e.time.display,default:"end"}},(Array.isArray(o)||o&&"string"!=typeof o&&o.interval&&o.periodicity)&&(t.values=o),t}getLayertypeFromOfferingCode(e){return Pr(e.code)?a:Lr(e.code)?n:_r(e.code)?p:"http://www.opengis.net/spec/owc-geojson/1.0/req/geojson"===e.code?l:"http://www.opengis.net/spec/owc-geojson/1.0/req/xyz"===e.code?c:e.code}checkIfServiceOffering(e){return!(e.contents||!e.operations)}checkIfDataOffering(e){return!(!e.contents||e.operations)}getOfferingContents(e){return this.checkIfServiceOffering(e)?e.operations:this.checkIfDataOffering(e)?e.contents:void 0}getLegendUrl(e){let t="";if(e.hasOwnProperty("styles")){const t=e.styles.filter(e=>e.default);if(t.length>0)return t[0].legendURL}else e.hasOwnProperty("legendUrl")&&(t=e.legendUrl);return t}getIconUrl(e){let t="";return e.hasOwnProperty("iconUrl")&&(t=e.iconUrl),t}getLayers(e,t){const r=e.features,o=[];for(const s of r){const r=s.properties.offerings;if(r.length>0){const i=r.find(e=>Pr(e.code))||r.find(e=>Lr(e.code))||r.find(e=>_r(e.code))||r[0];o.push(this.createLayerFromOffering(i,s,e,t))}}return Object(Jt.a)(o)}createLayerFromOffering(e,t,r,o){const s=this.getLayertypeFromOfferingCode(e);return d(s)?this.createRasterLayerFromOffering(e,t,r,o):h(s)?this.createVectorLayerFromOffering(e,t,r):void console.error(`This type of service (${s}) has not been implemented yet.`)}createVectorLayerFromOffering(e,t,r){const o=this.getLayertypeFromOfferingCode(e);if(!h(o))return console.error(`This type of layer '${o}' / offering '${e.code}' cannot be converted into a Vectorlayer`),null;let s,i;if(this.getIconUrl(e),e.operations)for(const l of e.operations)"GetFeature"===l.code&&(s=l.href);e.contents&&(i=e.contents[0].content);const a=this.getLegendUrl(e),n={id:t.id,name:this.getResourceTitle(t),displayName:this.getDisplayName(e,t),visible:this.isActive(t),type:o,removable:!0,attribution:this.getResourceAttribution(t),continuousWorld:!1,opacity:this.getResourceOpacity(t),url:s||null,legendImg:a||null,data:i},c=new y(n);return t.bbox?c.bbox=t.bbox:r&&r.bbox&&(c.bbox=r.bbox),Object(Wt.a)(c)}createRasterLayerFromOffering(e,t,r,o){const s=this.getLayertypeFromOfferingCode(e);if(!d(s))return console.error(`This type of offering '${e.code}' cannot be converted into a rasterlayer.`),null;let i;switch(s){case a:i=this.createWmsLayerFromOffering(e,t,r);break;case n:i=this.createWmtsLayerFromOffering(e,t,r,o)}return i}createWmtsLayerFromOffering(e,t,r,o){return this.getWmtsOptions(e,t,r,o).pipe(Object(_.a)(e=>new v(e)))}createWmsLayerFromOffering(e,t,r){const o=this.getWmsOptions(e,t,r),s=new w(o);return Object(Wt.a)(s)}getWmtsOptions(e,t,r,o){const s=this.getRasterLayerOptions(e,t,r),i=this.getLayerForWMTS(e,t);let a;if(e.styles){const t=e.styles.find(e=>e.default);t&&(a=t.name)}return this.getMatrixSetForWMTS(e,t,o).pipe(Object(_.a)(e=>{const t={matrixSet:e.matrixSet,matrixIds:e.matrixIds,resolutions:e.resolutions};return Object.assign(Object.assign({},s),{type:"wmts",params:{layer:i,matrixSetOptions:t,projection:o,style:a,format:"image/png"}})}))}getLayerForWMTS(e,t){const[r,o]=this.parseOperationUrl(e,"GetTile");if(o.LAYER)return o.LAYER;console.error(`There is no layer-parameter in the offering ${e.code} for resource ${t.id}.\n      Cannot infer layer.`,e)}parseOperationUrl(e,t){if(e.operations){const r=e.operations.find(e=>e.code===t);if(r)return[this.getUrlFromUri(r.href),this.getJsonFromUri(r.href)];console.error(`There is no ${t}-operation in the offering ${e.code}.`,e)}else console.error(`The offering ${e.code} has no operations.`,e)}getMatrixSetForWMTS(e,t,r){if(e.matrixSets){const t=e.matrixSets.find(e=>e.srs===r);return Object(Wt.a)(t)}{const[t,o]=this.parseOperationUrl(e,"GetCapabilities");return this.wmtsClient.getCapabilities(t).pipe(Object(_.a)(e=>{const t=e.value.contents.tileMatrixSet.find(e=>e.identifier.value===r);return{srs:r,matrixSet:t.identifier.value,matrixIds:t.tileMatrix.map(e=>e.identifier.value),resolutions:t.tileMatrix.map(e=>e.scaleDenominator),origin:{x:t.tileMatrix[0].topLeftCorner[1],y:t.tileMatrix[0].topLeftCorner[0]},tilesize:t.tileMatrix[0].tileHeight}}))}}getWmsOptions(e,t,r){const o=this.getRasterLayerOptions(e,t,r);if(o.type===a){const t=this.getJsonFromUri(e.operations[0].href);let r;e.styles&&(r=e.styles.find(e=>e.default).name);const s={LAYERS:t.LAYERS,FORMAT:t.FORMAT,TIME:t.TIME,VERSION:t.VERSION,TILED:t.TILED,TRANSPARENT:!0,STYLES:r};return Object.assign(Object.assign({},o),{type:"wms",params:s})}console.error(`resource ${t.id} cannot be converted into a WMS-Layer`,e)}getRasterLayerOptions(e,t,r){const o=this.getLayerOptions(e,t,r);if(d(o.type))return Object.assign(Object.assign({},o),{type:o.type,url:this.getUrlFromUri(e.operations[0].href),subdomains:Er(this.getResourceShards(t))});console.error(`The layer ${o.id} is not a rasterlayer`,o)}getLayerOptions(e,t,r){const o={id:t.id,type:this.getLayertypeFromOfferingCode(e),name:this.getResourceTitle(t),removable:!0,continuousWorld:!1,opacity:this.getResourceOpacity(t),displayName:this.getDisplayName(e,t),visible:this.isActive(t),attribution:this.getResourceAttribution(t),dimensions:this.getResourceDimensions(t),legendImg:this.getLegendUrl(e),styles:e.styles};return t.bbox?o.bbox=t.bbox:r&&r.bbox&&(o.bbox=r.bbox),o}getUrlFromUri(e){return e.substring(0,e.indexOf("?"))}getJsonFromUri(e){const t=e.substr(e.lastIndexOf("?")+1),r={};return t.split("&").forEach(e=>{const t=e.split("=");r[t[0].toUpperCase()]=decodeURIComponent(t[1])}),r}getDisplayName(e,t){let r="";return e.hasOwnProperty("title")&&(r=e.title?e.title:this.getResourceTitle(t)),r}generateOwsContextFrom(e,t,r,o){o||(o={lang:"",links:[],title:"",updated:""});const s={id:e,type:"FeatureCollection",properties:o,features:[]};r&&(s.bbox=r);for(const i of t){const e=this.generateResourceFromLayer(i);s.features.push(e)}return s}generateResourceFromLayer(e){return{id:e.id,properties:{title:e.name,updated:null,offerings:[this.generateOfferingFromLayer(e)],opacity:e.opacity,attribution:e.attribution},type:"Feature",geometry:null}}generateOfferingFromLayer(e,t,r){const o={code:this.getOfferingCodeFromLayer(e),title:e.name};return e.type===l?o.contents=this.getContentsFromLayer(e):o.operations=this.getOperationsFromLayer(e),t&&(o.legendUrl=t),r&&(o.iconUrl=r),o}getOfferingCodeFromLayer(e){switch(e.type){case a:return"http://www.opengis.net/spec/owc-geojson/1.0/req/wms";case n:return"http://www.opengis.net/spec/owc-geojson/1.0/req/wmts";case l:return"http://www.opengis.net/spec/owc-geojson/1.0/req/geojson";case c:return"http://www.opengis.net/spec/owc-geojson/1.0/req/xyz";default:return console.error(`This type of layer (${e.type}) has not been implemented yet.`),null}}getContentsFromLayer(e){const t=[];switch(e.type){case l:const r={type:"FeatureCollection",content:JSON.stringify(e.data)};t.push(r);break;default:console.error(`Cannot get contents for this type of vectorlayer: (${e.type})`)}return t}getOperationsFromLayer(e){if(e instanceof b)switch(e.type){case a:return this.getWmsOperationsFromLayer(e);case n:return this.getWmtsOperationsFromLayer(e);case c:return this.getXyzOperationsFromLayer(e);default:return console.error(`Cannot get operations for this type of layer: (${e.type})`),[]}else if(e instanceof y)return console.error(`This type of service (${e.type}) has not been implemented yet.`),[]}getXyzOperationsFromLayer(e){return[{code:"REST",method:"GET",type:"text/html",href:`${e.url}`}]}getTmsOperationsFromLayer(e){return[]}getWfsOperationsFromLayer(e){return[{code:"GetFeature",method:"GET",type:"application/json",href:`${e.url}?service=WFS&version=${e.options.version?e.options.version:"1.1.0"}&request=GetFeature`}]}getWmsOperationsFromLayer(e){const t=e.url,r=e.params.VERSION,o=e.id;let s="image/vnd.jpeg-png";return e.params&&e.params.FORMAT&&(s=e.params.FORMAT),[{code:"GetMap",method:"GET",type:s,href:`${t}?service=WMS&version=${r}&request=GetMap&TRANSPARENT=TRUE&LAYERS=${o}&FORMAT=${s}&TILED=true`},{code:"GetCapabilities",method:"GET",type:"application/xml",href:`${t}?service=WMS&version=${r}&request=GetCapabilities`},{code:"GetFeatureInfo",method:"GET",type:"text/html",href:`${t}?service=WMS&version=${r}&request=GetFeatureInfo&TRANSPARENT=TRUE&LAYERS=${o}&FORMAT=${s}`}]}getWmtsOperationsFromLayer(e){const t=e.url,r=e.params.version;let o="image/vnd.jpeg-png";return e.params&&e.params.FORMAT&&(o=e.params.FORMAT),[{code:"GetTile",href:`${t}?SERVICE=WMTS&REQUEST=GetTile&FORMAT=${o}&LAYER=${e.id}&VERSION=${r}`,method:"GET",type:o},{code:"GetCapabilities",href:`${t}?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=${r}`,method:"GET",type:"application/xml"},{code:"GetFeatureInfo",href:`${t}?SERVICE=WMS&REQUEST=GetFeatureInfo&VERSION=${r}`,method:"GET",type:"text/html"}]}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(Nt))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Tr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({providers:[Nt,hr,Or,dr],imports:[[]]}),e})();var Cr=r("ltgo");function Ir(e,t){}let Rr=(()=>{class e{constructor(e){this.viewContainerRef=e}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(s.P))},e.\u0275dir=s.Fb({type:e,selectors:[["","ukisAddHost",""]]}),e})(),kr=(()=>{class e{constructor(e){this.componentFactoryResolver=e,this.dynamicComponentChange=new s.n}loadComponent(){if(this.dynamicComponent){this.subs=[];const e=this.componentFactoryResolver.resolveComponentFactory(this.dynamicComponent.component),t=this.ukisAddHost.viewContainerRef;t.clear(),this.componentRef=t.createComponent(e),this.setInputOutputs()}}setInputOutputs(){this.componentRef&&this.dynamicComponent.inputs&&Object.keys(this.dynamicComponent.inputs).map(e=>{const t=e;if(this.dynamicComponent.inputs){this.componentRef.instance[t]=this.dynamicComponent.inputs[t];const e=`${t}Change`;if(this.componentRef.instance[e]&&this.componentRef.instance[e]instanceof s.n){const r=this.componentRef.instance[e].subscribe(r=>{this.dynamicComponent.inputs&&(this.dynamicComponent.inputs[t]=r),this.dynamicComponent.outputs&&this.dynamicComponent.outputs[e]&&this.dynamicComponent.outputs[e](r),this.dynamicComponentChange.emit(this.dynamicComponent)});this.subs.push(r)}}})}ngOnChanges(e){e.dynamicComponent&&(Array.isArray(this.subs)&&this.subs.map(e=>e.unsubscribe()),this.setInputOutputs())}ngOnInit(){this.loadComponent()}ngOnDestroy(){this.componentRef&&(this.subs.map(e=>e.unsubscribe()),this.componentRef.destroy(),this.componentRef=null)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(s.j))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-dynamic-component"]],viewQuery:function(e,t){if(1&e&&s.Dc(Rr,3),2&e){let e;s.kc(e=s.Yb())&&(t.ukisAddHost=e.first)}},inputs:{dynamicComponent:"dynamicComponent"},outputs:{dynamicComponentChange:"dynamicComponentChange"},features:[s.xb],decls:1,vars:0,consts:[["ukisAddHost",""]],template:function(e,t){1&e&&s.wc(0,Ir,0,0,"ng-template",0)},directives:[Rr],encapsulation:2}),e})();var Fr=r("s7LF");function Mr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"span",12),s.Xb("click",function(){return s.pc(e),s.Zb().showProperties()}),s.yc(1),s.Pb()}if(2&e){const e=s.Zb();s.fc("title",e.getLayerName(e.layer)),s.zb(1),s.Ac(" ",e.getLayerName(e.layer)," ")}}const Gr=function(e){return{disabled:e}};function Ar(e,t){if(1&e){const e=s.Rb();s.Qb(0,"span"),s.Qb(1,"clr-icon",13),s.Xb("click",function(){s.pc(e);const t=s.Zb();return t.setLayerIndex(t.layer,"down",t.group)}),s.Pb(),s.Qb(2,"clr-icon",14),s.Xb("click",function(){s.pc(e);const t=s.Zb();return t.setLayerIndex(t.layer,"up",t.group)}),s.Pb(),s.Pb()}if(2&e){const e=s.Zb();s.zb(1),s.fc("hidden",e.layerGroups&&1==e.layerGroups.length)("ngClass",s.jc(4,Gr,e.isLast(e.layer))),s.zb(1),s.fc("hidden",e.layerGroups&&1==e.layerGroups.length)("ngClass",s.jc(6,Gr,e.isFirst(e.layer)))}}const jr=function(e){return{"is-solid":e}};function Dr(e,t){if(1&e&&s.Lb(0,"clr-icon",15),2&e){const e=s.Zb();s.gc("title",e.layer.visible?"Choose another layer":"Show layer"),s.fc("ngClass",s.jc(3,jr,e.layer.visible)),s.Ab("shape",e.layer.visible?"dot-circle":"circle")}}function zr(e,t){if(1&e&&s.Lb(0,"clr-icon",15),2&e){const e=s.Zb();s.gc("title",e.layer.visible?"Hide layer":"Show layer"),s.fc("ngClass",s.jc(3,jr,e.layer.visible)),s.Ab("shape",e.layer.visible?"eye":"eye-hide")}}const Qr=function(e){return{active:e}};function Vr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",27),s.Xb("click",function(){return s.pc(e),s.Zb(2).switchTab("settings")}),s.Pb()}if(2&e){const e=s.Zb(2);s.fc("ngClass",s.jc(1,Qr,e.activeTabs.settings))}}function Nr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",28),s.Xb("click",function(){return s.pc(e),s.Zb(2).switchTab("legend")}),s.Pb()}if(2&e){const e=s.Zb(2);s.fc("ngClass",s.jc(1,Qr,e.activeTabs.legend))}}function Br(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",29),s.Xb("click",function(){return s.pc(e),s.Zb(2).switchTab("description")}),s.Pb()}if(2&e){const e=s.Zb(2);s.fc("ngClass",s.jc(1,Qr,e.activeTabs.description))}}function Ur(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",30),s.Xb("click",function(){return s.pc(e),s.Zb(2).switchTab("changeStyle")}),s.Pb()}if(2&e){const e=s.Zb(2);s.fc("ngClass",s.jc(1,Qr,e.activeTabs.changeStyle))}}function Wr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",31),s.Xb("click",function(){s.pc(e);const r=t.$implicit,o=s.Zb(2);return r.action(o.layer)}),s.Pb()}if(2&e){const e=t.$implicit;s.fc("title",e.title),s.Ab("shape",e.icon)}}function Zr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",32),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.zoomTo(t.layer)}),s.Pb()}}function $r(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",33),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.removeLayer(t.group,t.layer)}),s.Pb()}}function Hr(e,t){if(1&e){const e=s.Rb();s.Ob(0),s.Qb(1,"ukis-dynamic-component",37),s.Xb("dynamicComponentChange",function(t){return s.pc(e),s.Zb(3).layer.action=t}),s.Pb(),s.Nb()}if(2&e){const e=s.Zb(3);s.zb(1),s.fc("dynamicComponent",e.layer.action)}}function Xr(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",34),s.Qb(1,"div",35),s.Qb(2,"label",8),s.yc(3,"Opacity:"),s.Pb(),s.Qb(4,"input",36),s.Xb("change",function(){s.pc(e);const t=s.Zb(2);return t.setLayerOpacity(t.layer)})("ngModelChange",function(t){return s.pc(e),s.Zb(2).layer.opacity=t}),s.Pb(),s.Qb(5,"span"),s.yc(6),s.Pb(),s.Pb(),s.wc(7,Hr,2,1,"ng-container",6),s.Pb()}if(2&e){const e=s.Zb(2);s.zb(2),s.fc("for","layer_transparency_slider_"+e.layer.id),s.zb(2),s.fc("id","layer_transparency_slider_"+e.layer.id)("value",e.layer.opacity)("min",0)("max",1)("step",.1)("ngModel",e.layer.opacity),s.zb(2),s.zc(" "+e.layer.opacity),s.zb(1),s.fc("ngIf",e.checkIsComponentItem(e.layer,"action"))}}function qr(e,t){if(1&e){const e=s.Rb();s.Ob(0),s.Qb(1,"ukis-dynamic-component",37),s.Xb("dynamicComponentChange",function(t){return s.pc(e),s.Zb(3).layer.legendImg=t}),s.Pb(),s.Nb()}if(2&e){const e=s.Zb(3);s.zb(1),s.fc("dynamicComponent",e.layer.legendImg)}}function Yr(e,t){if(1&e&&s.Lb(0,"img",40),2&e){const e=s.Zb(3);s.fc("src",e.layer.legendImg,s.rc)}}function Kr(e,t){if(1&e&&(s.Qb(0,"div"),s.wc(1,qr,2,1,"ng-container",38),s.wc(2,Yr,1,1,"ng-template",null,39,s.xc),s.Pb()),2&e){const e=s.lc(3),t=s.Zb(2);s.zb(1),s.fc("ngIf",t.checkIsComponentItem(t.layer,"legendImg"))("ngIfElse",e)}}function Jr(e,t){if(1&e&&(s.Qb(0,"div"),s.Lb(1,"span",41),s.Pb()),2&e){const e=s.Zb(2);s.zb(1),s.fc("innerHTML",e.layer.description,s.qc)}}function eo(e,t){if(1&e&&(s.Qb(0,"option",44),s.yc(1),s.Pb()),2&e){const e=t.$implicit,r=s.Zb(3);s.fc("value",e.name),s.Ab("selected",!!r.isSelectedStyle(e.name)||null),s.zb(1),s.zc(e.title)}}function to(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div"),s.Qb(1,"select",42),s.Xb("change",function(t){return s.pc(e),s.Zb(2).executeChangeStyle(t.target.value)}),s.wc(2,eo,2,3,"option",43),s.Pb(),s.Pb()}if(2&e){const e=s.Zb(2);s.zb(2),s.fc("ngForOf",e.layer.styles)}}function ro(e,t){if(1&e&&(s.Qb(0,"div",16),s.Qb(1,"div",17),s.wc(2,Vr,1,3,"clr-icon",18),s.wc(3,Nr,1,3,"clr-icon",19),s.wc(4,Br,1,3,"clr-icon",20),s.wc(5,Ur,1,3,"clr-icon",21),s.wc(6,Wr,1,2,"clr-icon",22),s.Lb(7,"span"),s.wc(8,Zr,1,0,"clr-icon",23),s.wc(9,$r,1,0,"clr-icon",24),s.Pb(),s.Qb(10,"div",25),s.wc(11,Xr,8,9,"div",26),s.wc(12,Kr,4,2,"div",6),s.wc(13,Jr,2,1,"div",6),s.wc(14,to,3,1,"div",6),s.Pb(),s.Pb()),2&e){const e=s.Zb();s.zb(2),s.fc("ngIf",!e.checkBaselayer(e.layer,e.group)),s.zb(1),s.fc("ngIf",e.layer.legendImg),s.zb(1),s.fc("ngIf",e.layer.description),s.zb(1),s.fc("ngIf",(null==e.layer.styles?null:e.layer.styles.length)>1),s.zb(1),s.fc("ngForOf",e.layer.actions),s.zb(2),s.fc("ngIf",e.canZoomToLayer),s.zb(1),s.fc("ngIf",e.layer.removable),s.zb(2),s.fc("ngIf",e.activeTabs.settings),s.zb(1),s.fc("ngIf",e.activeTabs.legend&&e.layer.legendImg),s.zb(1),s.fc("ngIf",e.activeTabs.description&&e.layer.description),s.zb(1),s.fc("ngIf",e.activeTabs.changeStyle&&e.layer.styles&&(null==e.layer.styles?null:e.layer.styles.length)>1)}}const oo=["*"];let so=(()=>{class e{constructor(){this.expandable=!0,this.update=new s.n,this.canZoomToLayer=!1,this.activeTabs={settings:!1,legend:!0,description:!1,changeStyle:!1}}get visible(){return this.layer.visible}get cssClass(){return this.layer.cssClass}set expanded(e){this.layer&&(this.layer.expanded=e)}get expanded(){return!!this.layer&&this.layer.expanded}checkIsComponentItem(e,t){const r=e[t];let o=!1;if(r&&"object"==typeof r&&"component"in r){if(r.inputs){if(r.inputs&&!r.inputs.layer){const o=Object.assign({__proto__:this.layer.__proto__},e);console.log(o),o&&o[t]&&delete o[t],r.inputs=Object.assign({layer:o},r.inputs)}}else{const o=Object.assign({__proto__:this.layer.__proto__},e);console.log(o),o&&o[t]&&delete o[t],r.inputs={layer:o}}o=!0}return o}getLayerName(e){return e.displayName?e.displayName:e.name}ngOnInit(){this.layersSvc||console.error("you need to provide a layersService!"),this.layer.legendImg||(this.activeTabs.description=!0,this.activeTabs.legend=!1,this.activeTabs.settings=!1,this.activeTabs.changeStyle=!1),this.layer.legendImg||this.layer.description||(this.activeTabs.description=!1,this.activeTabs.legend=!1,this.activeTabs.settings=!0),this.layer.bbox&&this.layer.bbox.length>=4&&(this.canZoomToLayer=!0)}setLayerVisibility(e,t){if(t){if(t.layers.length>0)if("Baselayers"===t.filtertype){for(const r of t.layers)r.visible=r===e;this.update.emit({layer:this.layer})}else{const r=t.visible;e.visible=!e.visible,r!==t.visible?this.update.emit({layer:this.layer}):this.layersSvc.updateLayer(e,e.filtertype||"Layers")}}else if("Baselayers"===e.filtertype){e.visible=!e.visible;const t=this.layerGroups.filter(e=>"Baselayers"===e.filtertype);for(const r of t)r instanceof m&&r.id!==e.id&&(r.visible=!e.visible,this.layersSvc.updateLayer(r,r.filtertype||"Baselayers"))}else e.visible=!e.visible,this.layersSvc.updateLayer(e,e.filtertype||"Layers")}setLayerIndex(e,t,r){r?this.layersSvc.setLayerIndexInGroup(e,t,r):this.layersSvc.setGroupLayerIndex(e,t)}removeLayer(e,t){e?this.layersSvc.removeLayerFromGroup(t,e):this.layersSvc.removeLayer(t,t.filtertype)}zoomTo(e){this.mapState&&e.bbox&&e.bbox.length>=4&&this.mapState.setExtent(e.bbox)}setLayerOpacity(e){this.group?this.update.emit({layer:e}):this.layersSvc.updateLayer(e,e.filtertype||"Layers")}checkBaselayer(e,t){return!!("Baselayers"===e.filtertype||t&&"Baselayers"===t.filtertype)}is_expandable(){return!!this.group&&!this.layer.legendImg&&"Baselayers"===this.group.filtertype}showProperties(){this.is_expandable()||(this.expanded=!this.expanded)}switchTab(e){for(const t of Object.keys(this.activeTabs))this.activeTabs[t]=e===t}isSelectedStyle(e){if(d(this.layer.type)){if(this.layer.type===a)return this.layer.params.STYLES===e;if(this.layer.type===n)return this.layer.params.style===e}else if((e=>h(this.layer.type))())return!1;return!1}executeChangeStyle(e){if(d(this.layer.type)&&this.layer.styles){const t=this.layer.styles.find(t=>t.name===e);t&&(this.layer.legendImg=t.legendURL,this.layer.type===a?this.layer.params.STYLES=t.name:this.layer.type===n&&(this.layer.params.style=t.name),this.layersSvc.updateLayer(this.layer,this.layer.filtertype))}}isFirst(e){return this.group?this.layersSvc.isGroupFirst(e,this.group.layers):this.layersSvc.isGroupFirst(e,null,e.filtertype)}isLast(e){return this.group?this.layersSvc.isGroupLast(e,this.group.layers):this.layersSvc.isGroupLast(e,null,e.filtertype)}getExpandShape(){return this.expanded?{transform:"rotate(180deg)"}:{transform:"rotate(90deg)"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-layerentry"]],hostVars:4,hostBindings:function(e,t){2&e&&(s.Bb(t.cssClass),s.Cb("layer-visible",t.visible))},inputs:{layersSvc:"layersSvc",mapState:"mapState",layer:"layer",group:"group",layerGroups:"layerGroups",expanded:"expanded",expandable:"expandable"},outputs:{update:"update"},ngContentSelectors:oo,decls:14,vars:15,consts:[[1,"layer"],[1,"head"],["shape","angle","title","Details",1,"iconButton",3,"ngStyle","ngClass","click"],[1,"item-title-replacement","title",3,"title","click"],["ref",""],["class","title",3,"title","click",4,"ngIf"],[4,"ngIf"],[1,"hide",3,"type","name","id","checked","change"],[3,"for"],["class","iconButton",3,"ngClass","title",4,"ngIf","ngIfElse"],["notBaselayer",""],["class","body",4,"ngIf"],[1,"title",3,"title","click"],["shape","arrow","title","up",1,"iconButton",3,"hidden","ngClass","click"],["shape","arrow","title","down","dir","down",1,"iconButton",3,"hidden","ngClass","click"],[1,"iconButton",3,"ngClass","title"],[1,"body"],[1,"tools"],["title","Layer settings","shape","cog","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Layer Legend","shape","image","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Layer info","shape","info-standard","class","iconButton",3,"ngClass","click",4,"ngIf"],["title","Change style","shape","cloud-chart","class","iconButton",3,"ngClass","click",4,"ngIf"],["class","iconButton",3,"title","click",4,"ngFor","ngForOf"],["shape","zoom-in","class","iconButton","title","Zoom to layer",3,"click",4,"ngIf"],["shape","trash","class","iconButton","title","Remove layer",3,"click",4,"ngIf"],[1,"tabsbody"],["class","layersettings",4,"ngIf"],["title","Layer settings","shape","cog",1,"iconButton",3,"ngClass","click"],["title","Layer Legend","shape","image",1,"iconButton",3,"ngClass","click"],["title","Layer info","shape","info-standard",1,"iconButton",3,"ngClass","click"],["title","Change style","shape","cloud-chart",1,"iconButton",3,"ngClass","click"],[1,"iconButton",3,"title","click"],["shape","zoom-in","title","Zoom to layer",1,"iconButton",3,"click"],["shape","trash","title","Remove layer",1,"iconButton",3,"click"],[1,"layersettings"],[1,"form-group"],["type","range","name","points",1,"ukis-range-input","opacity-input",3,"id","value","min","max","step","ngModel","change","ngModelChange"],[3,"dynamicComponent","dynamicComponentChange"],[4,"ngIf","ngIfElse"],["imageUrl",""],[3,"src"],[3,"innerHTML"],["clrSelect","",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(s.ec(),s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"clr-icon",2),s.Xb("click",function(){return t.showProperties()}),s.Pb(),s.Qb(3,"div",3,4),s.Xb("click",function(){return t.showProperties()}),s.dc(5),s.Pb(),s.wc(6,Mr,2,2,"span",5),s.wc(7,Ar,3,8,"span",6),s.Qb(8,"input",7),s.Xb("change",function(){return t.setLayerVisibility(t.layer,t.group)}),s.Pb(),s.Qb(9,"label",8),s.wc(10,Dr,1,5,"clr-icon",9),s.wc(11,zr,1,5,"ng-template",null,10,s.xc),s.Pb(),s.Pb(),s.wc(13,ro,15,11,"div",11),s.Pb()),2&e){const e=s.lc(4),r=s.lc(12);s.zb(2),s.fc("ngStyle",t.getExpandShape())("ngClass",s.jc(13,Gr,t.is_expandable())),s.zb(1),s.fc("title",t.getLayerName(t.layer)),s.zb(3),s.fc("ngIf",0==e.children.length),s.zb(1),s.fc("ngIf",!t.checkBaselayer(t.layer,t.group)),s.zb(1),s.fc("type",t.checkBaselayer(t.layer,t.group)?"radio":"checkbox")("name","layer")("id",t.layer.id)("checked",t.layer.visible),s.zb(1),s.fc("for",t.layer.id),s.zb(1),s.fc("ngIf",t.checkBaselayer(t.layer,t.group))("ngIfElse",r),s.zb(3),s.fc("ngIf",t.expandable&&t.expanded)}},directives:[Pt.n,bt.o,bt.l,bt.n,Pt.r,bt.m,Fr.r,Fr.b,Fr.j,Fr.m,kr,Pt.x,Fr.o,Fr.x],styles:[".title[_ngcontent-%COMP%]{cursor:pointer}.item-title-replacement[_ngcontent-%COMP%]:empty{display:none}.tabsbody[_ngcontent-%COMP%]{overflow:hidden;word-break:break-all}"]}),e})(),io=(()=>{class e{transform(e){return"string"==typeof e?e.split("").reverse().join(""):Array.isArray(e)?e.slice().reverse():e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Jb({name:"reverse",type:e,pure:!1}),e})(),ao=(()=>{class e{transform(e,t){return e.filter(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Jb({name:"itemsfilter",type:e,pure:!1}),e})();function no(e,t){if(1&e){const e=s.Rb();s.Qb(0,"span",8),s.Xb("click",function(){return s.pc(e),s.Zb().showProperties()}),s.yc(1),s.Pb()}if(2&e){const e=s.Zb();s.fc("title",e.getLayerName(e.group)),s.zb(1),s.Ac(" ",e.getLayerName(e.group)," ")}}const co=function(e){return{disabled:e}};function lo(e,t){if(1&e){const e=s.Rb();s.Qb(0,"span"),s.Qb(1,"clr-icon",9),s.Xb("click",function(){s.pc(e);const t=s.Zb();return t.setLayerGroupIndex(t.group,"down")}),s.Pb(),s.Qb(2,"clr-icon",10),s.Xb("click",function(){s.pc(e);const t=s.Zb();return t.setLayerGroupIndex(t.group,"up")}),s.Pb(),s.Pb()}if(2&e){const e=s.Zb();s.zb(1),s.fc("ngClass",s.jc(2,co,e.isLast(e.group))),s.zb(1),s.fc("ngClass",s.jc(4,co,e.isFirst(e.group)))}}const po=function(e){return{"is-solid":e}};function uo(e,t){if(1&e){const e=s.Rb();s.Qb(0,"span"),s.Qb(1,"input",11),s.Xb("change",function(){return s.pc(e),s.Zb().setGroupLayersVisibility()}),s.Pb(),s.Qb(2,"label",12),s.Lb(3,"clr-icon",13),s.Pb(),s.Pb()}if(2&e){const e=s.Zb();s.zb(1),s.fc("type","checkbox")("checked",e.group.visible)("name","group")("id",e.group.id),s.zb(1),s.fc("for",e.group.id),s.zb(1),s.gc("title",e.group.visible?"Hide Group":"Show Group"),s.fc("ngClass",s.jc(8,po,e.group.visible)),s.Ab("shape",e.group.visible?"eye":"eye-hide")}}function ho(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",2),s.Xb("click",function(){s.pc(e);const r=t.$implicit,o=s.Zb(2);return r.action(o.group)}),s.Pb()}if(2&e){const e=t.$implicit;s.fc("title",e.title),s.Ab("shape",e.icon)}}function mo(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",26),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.showAction=!t.showAction}),s.Pb()}if(2&e){const e=s.Zb(2);s.gc("title",e.showAction?"Hide settings":"Show settings"),s.fc("ngClass",s.jc(2,po,e.showAction))}}function bo(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",27),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.showInfo=!t.showInfo}),s.Pb()}if(2&e){const e=s.Zb(2);s.gc("title",e.showInfo?"Hide Info":"Show Info"),s.fc("ngClass",s.jc(2,po,e.showInfo))}}function yo(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",28),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.zoomTo(t.group)}),s.Pb()}}function go(e,t){if(1&e){const e=s.Rb();s.Qb(0,"clr-icon",29),s.Xb("click",function(){s.pc(e);const t=s.Zb(2);return t.removeLayerGroup(t.group)}),s.Pb()}}function fo(e,t){if(1&e&&(s.Qb(0,"div",30),s.Lb(1,"span",31),s.Pb()),2&e){const e=s.Zb(2);s.zb(1),s.fc("innerHTML",e.group.description,s.qc)}}function vo(e,t){if(1&e){const e=s.Rb();s.Ob(0),s.Qb(1,"ukis-dynamic-component",33),s.Xb("dynamicComponentChange",function(t){return s.pc(e),s.Zb(3).group.action=t}),s.Pb(),s.Nb()}if(2&e){const e=s.Zb(3);s.zb(1),s.fc("dynamicComponent",e.group.action)}}function wo(e,t){if(1&e&&(s.Qb(0,"div",32),s.wc(1,vo,2,1,"ng-container",6),s.Pb()),2&e){const e=s.Zb(2);s.zb(1),s.fc("ngIf",e.checkIsComponentItem(e.group,"action"))}}const So=function(e){return{id:e}};function xo(e,t){if(1&e){const e=s.Rb();s.Ob(0),s.Qb(1,"div",34),s.Qb(2,"ukis-layerentry",35),s.Xb("update",function(t){s.pc(e);const r=s.Zb(2);return r.layerUpdate(t,r.group)}),s.Qb(3,"span",36),s.yc(4),s.Pb(),s.Pb(),s.Pb(),s.Nb()}if(2&e){const e=t.$implicit,r=s.Zb(2);s.zb(1),s.fc("cdkDragData",s.jc(7,So,e.id)),s.zb(1),s.fc("expanded",r.openAllLayersProperties)("layersSvc",r.layersSvc)("mapState",r.mapState)("layer",e)("group",r.group),s.zb(2),s.Ac(" ",e.displayName||e.name," ")}}function Po(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",14),s.Qb(1,"div",15),s.wc(2,ho,1,2,"clr-icon",16),s.wc(3,mo,1,4,"clr-icon",17),s.wc(4,bo,1,4,"clr-icon",18),s.Qb(5,"clr-icon",19),s.Xb("click",function(){return s.pc(e),s.Zb().showHideAllDetails()}),s.Pb(),s.Lb(6,"span"),s.wc(7,yo,1,0,"clr-icon",20),s.wc(8,go,1,0,"clr-icon",21),s.Pb(),s.wc(9,fo,2,1,"div",22),s.wc(10,wo,2,1,"div",23),s.Qb(11,"div",24),s.Xb("cdkDropListDropped",function(t){return s.pc(e),s.Zb().drop(t)}),s.ac(12,"reverse"),s.ac(13,"itemsfilter"),s.wc(14,xo,5,9,"ng-container",25),s.ac(15,"reverse"),s.ac(16,"itemsfilter"),s.Pb(),s.Pb()}if(2&e){const e=s.Zb();s.zb(2),s.fc("ngForOf",e.group.actions),s.zb(1),s.fc("ngIf",e.group.action),s.zb(1),s.fc("ngIf",e.group.description),s.zb(1),s.gc("title",e.openAllLayersProperties?"Hide all layers details":"Show all layers details"),s.fc("ngClass",s.jc(21,po,e.openAllLayersProperties)),s.zb(2),s.fc("ngIf",e.canZoomToGroup),s.zb(1),s.fc("ngIf",e.group.removable),s.zb(1),s.fc("ngIf",e.showInfo),s.zb(1),s.fc("ngIf",e.group.action&&e.showAction),s.zb(1),s.fc("cdkDropListData",s.bc(12,11,s.cc(13,13,e.group.layers,e.checkClassHide))),s.zb(3),s.fc("ngForOf",s.bc(15,16,s.cc(16,18,e.group.layers,e.checkClassHide)))}}const _o=["*"];let Lo=(()=>{class e{constructor(){this.canZoomToGroup=!1,this.showInfo=!1,this.showAction=!0}get visible(){return this.group.visible}get cssClass(){return this.group.cssClass}set openAllLayersProperties(e){this.group&&this.group.layers.length&&this.group.layers.forEach(t=>t.expanded=e)}get openAllLayersProperties(){return!(!this.group||!this.group.layers.length)&&this.group.layers.filter(e=>!0===e.expanded).length===this.group.layers.length}ngOnInit(){var e;this.group.bbox&&this.group.bbox.length>=4&&(this.canZoomToGroup=!0),(null===(e=this.group)||void 0===e?void 0:e.action)||(this.showAction=!1)}checkIsComponentItem(e,t){const r=e[t];let o=!1;if(r&&"object"==typeof r&&"component"in r){if(r.inputs){if(r.inputs&&!r.inputs.group){const o=Object.assign({__proto__:this.group.__proto__},e);o&&o[t]&&delete o[t],r.inputs=Object.assign({group:o},r.inputs)}}else{const o=Object.assign({__proto__:this.group.__proto__},e);o&&o[t]&&delete o[t],r.inputs={group:o}}o=!0}return o}checkBaselayer(e){return!(!e||"Baselayers"!==e.filtertype)}checkClassHide(e){var t;return!(null===(t=null==e?void 0:e.cssClass)||void 0===t?void 0:t.includes("hide"))}getLayerName(e){return e.displayName?e.displayName:e.name}setLayerGroupIndex(e,t){this.layersSvc.setGroupLayerIndex(e,t)}setGroupLayersVisibility(){this.group.visible=!this.group.visible,this.layersSvc.updateLayerGroup(this.group)}removeLayerGroup(e){this.layersSvc.removeLayerGroup(e)}zoomTo(e){this.mapState&&e.bbox&&e.bbox.length>=4&&this.mapState.setExtent(e.bbox)}layerUpdate(e,t){this.layersSvc.updateLayerGroup(t)}showProperties(){this.group.expanded=!this.group.expanded}showHideAllDetails(){this.openAllLayersProperties=!this.openAllLayersProperties,this.showAction=this.openAllLayersProperties,this.showInfo=this.openAllLayersProperties}isFirst(e){return this.layersSvc.isGroupFirst(e,this.layerGroups,e.filtertype)}isLast(e){return this.layersSvc.isGroupLast(e,this.layerGroups,e.filtertype)}drop(e){const t=this.group.layers,r=t.length,o=e.container.data;let s,i;if(r===o.length)s=r-e.previousIndex-1,i=r-e.currentIndex-1;else{const r=o[e.currentIndex],a=t.findIndex(t=>t.id===e.item.data.id);let n=t.findIndex(e=>e.id===r.id);e.previousIndex===e.currentIndex&&(n=a),s=a,i=n}Object(Cr.e)(this.group.layers,s,i),this.layersSvc.updateLayerGroup(this.group)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-layerentry-group"]],hostVars:4,hostBindings:function(e,t){2&e&&(s.Bb(t.cssClass),s.Cb("group-visible",t.visible))},inputs:{layersSvc:"layersSvc",mapState:"mapState",group:"group",layerGroups:"layerGroups"},ngContentSelectors:_o,decls:10,vars:7,consts:[[1,"layergroup"],[1,"head"],[1,"iconButton",3,"title","click"],[1,"item-title-replacement","title",3,"title","click"],["ref",""],["class","title",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","body",4,"ngIf"],[1,"title",3,"title","click"],["shape","arrow","title","up",1,"iconButton","move-item",3,"ngClass","click"],["shape","arrow","title","down","dir","down",1,"iconButton","move-item",3,"ngClass","click"],[1,"hide",3,"type","checked","name","id","change"],[3,"for"],[1,"iconButton",3,"ngClass","title"],[1,"body"],[1,"tools"],["class","iconButton",3,"title","click",4,"ngFor","ngForOf"],["shape","cog","class","iconButton",3,"ngClass","title","click",4,"ngIf"],["shape","info-standard","class","iconButton",3,"ngClass","title","click",4,"ngIf"],["shape","details",1,"iconButton",3,"ngClass","title","click"],["shape","zoom-in","class","iconButton","title","Zoom to group",3,"click",4,"ngIf"],["shape","trash","class","iconButton","title","Remove group",3,"click",4,"ngIf"],["class","info",4,"ngIf"],["class","tabsbody",4,"ngIf"],["cdkDropList","",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf"],["shape","cog",1,"iconButton",3,"ngClass","title","click"],["shape","info-standard",1,"iconButton",3,"ngClass","title","click"],["shape","zoom-in","title","Zoom to group",1,"iconButton",3,"click"],["shape","trash","title","Remove group",1,"iconButton",3,"click"],[1,"info"],[3,"innerHTML"],[1,"tabsbody"],[3,"dynamicComponent","dynamicComponentChange"],["cdkDragLockAxis","y","cdkDrag","",1,"sublayers",3,"cdkDragData"],[3,"expanded","layersSvc","mapState","layer","group","update"],["cdkDragHandle","",1,"move-item"]],template:function(e,t){if(1&e&&(s.ec(),s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"clr-icon",2),s.Xb("click",function(){return t.showProperties()}),s.Pb(),s.Qb(3,"div",3,4),s.Xb("click",function(){return t.showProperties()}),s.dc(5),s.Pb(),s.wc(6,no,2,2,"span",5),s.wc(7,lo,3,6,"span",6),s.wc(8,uo,4,10,"span",6),s.Pb(),s.wc(9,Po,17,23,"div",7),s.Pb()),2&e){const e=s.lc(4);s.zb(2),s.gc("title",t.group.expanded?"Close":"Open"),s.Ab("shape",t.group.expanded?"folder-open":"folder"),s.zb(1),s.fc("title",t.getLayerName(t.group)),s.zb(3),s.fc("ngIf",0==e.children.length),s.zb(1),s.fc("ngIf",t.layerGroups.length>1),s.zb(1),s.fc("ngIf",!t.checkBaselayer(t.group)),s.zb(1),s.fc("ngIf",t.group.expanded)}},directives:[Pt.n,bt.n,bt.l,Pt.r,bt.m,Cr.c,kr,Cr.a,so,Cr.b],pipes:[io,ao],styles:[".title[_ngcontent-%COMP%]{cursor:pointer}.item-title-replacement[_ngcontent-%COMP%]:empty{display:none}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px;box-sizing:border-box;border-radius:2px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .sublayers[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.info[_ngcontent-%COMP%]{padding-left:.2rem}"]}),e})();function Eo(e,t){if(1&e&&(s.Qb(0,"ukis-layerentry-group",5),s.Qb(1,"span",6),s.yc(2),s.Pb(),s.Pb()),2&e){const e=s.Zb().$implicit,t=s.Zb();s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("group",e)("layerGroups",t.layergroups),s.zb(2),s.Ac(" ",e.displayName||e.name," ")}}function Oo(e,t){if(1&e&&(s.Qb(0,"ukis-layerentry",7),s.Qb(1,"span",6),s.yc(2),s.Pb(),s.Pb()),2&e){const e=s.Zb().$implicit,t=s.Zb();s.fc("layerGroups",t.layergroups)("expanded",!1)("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("layer",e)("group",null),s.zb(2),s.Ac(" ",e.displayName||e.name," ")}}const To=function(e){return{id:e}};function Co(e,t){if(1&e&&(s.Ob(0),s.Qb(1,"div",2),s.wc(2,Eo,3,5,"ukis-layerentry-group",3),s.wc(3,Oo,3,7,"ukis-layerentry",4),s.Pb(),s.Nb()),2&e){const e=t.$implicit,r=s.Zb();s.zb(1),s.fc("cdkDragData",s.jc(3,To,e.id)),s.zb(1),s.fc("ngIf",r.isLayerGroup(e)&&e.filtertype===r.layerfilter),s.zb(1),s.fc("ngIf",!r.isLayerGroup(e)&&e.filtertype===r.layerfilter)}}let Io=(()=>{class e{constructor(){this.layerfilter="Layers",this.layergroups=[]}ngOnInit(){this.layerGroupsSubscription=this.layersSvc.getLayerGroups().subscribe(e=>{this.layergroups=e})}isLayerGroup(e){return e instanceof f}ngOnDestroy(){this.layerGroupsSubscription.unsubscribe()}drop(e){const t=this.layergroups,r=t.length,o=e.container.data;let s,i;if(r===o.length)s=r-e.previousIndex-1,i=r-e.currentIndex-1;else{const r=o[e.currentIndex],a=t.findIndex(t=>t.id===e.item.data.id);let n=t.findIndex(e=>e.id===r.id);e.previousIndex===e.currentIndex&&(n=a),s=a,i=n}this.layersSvc.arrayMove(this.layergroups,s,i),this.layersSvc.setLayerGroups(this.layergroups)}checkBaselayer(e,t){return!!("Baselayers"===e.filtertype||t&&"Baselayers"===t.filtertype)}checkClassHide(e){var t;return!(null===(t=null==e?void 0:e.cssClass)||void 0===t?void 0:t.includes("hide"))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-layer-control"]],inputs:{layersSvc:"layersSvc",mapStateSvc:"mapStateSvc",layerfilter:"layerfilter"},decls:6,vars:12,consts:[["cdkDropList","",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf"],["cdkDragLockAxis","y","cdkDrag","",1,"list-item",3,"cdkDragData"],[3,"layersSvc","mapState","group","layerGroups",4,"ngIf"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group",4,"ngIf"],[3,"layersSvc","mapState","group","layerGroups"],["cdkDragHandle","",1,"move-item"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Xb("cdkDropListDropped",function(e){return t.drop(e)}),s.ac(1,"reverse"),s.ac(2,"itemsfilter"),s.wc(3,Co,4,5,"ng-container",1),s.ac(4,"reverse"),s.ac(5,"itemsfilter"),s.Pb()),2&e&&(s.fc("cdkDropListData",s.bc(1,2,s.cc(2,4,t.layergroups,t.checkClassHide))),s.zb(3),s.fc("ngForOf",s.bc(4,7,s.cc(5,9,t.layergroups,t.checkClassHide))))},directives:[Cr.c,bt.m,Cr.a,bt.n,Lo,Cr.b,so],pipes:[io,ao],styles:[".list-item[_ngcontent-%COMP%]{cursor:pointer}.move-item[_ngcontent-%COMP%]{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px 10px;box-sizing:border-box;border-radius:2px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);overflow:hidden}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.2}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();function Ro(e,t){if(1&e&&s.Lb(0,"ukis-layerentry-group",4),2&e){const e=s.Zb().$implicit,t=s.Zb();s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("group",e)("layerGroups",t.layergroups)}}function ko(e,t){if(1&e&&s.Lb(0,"ukis-layerentry",5),2&e){const e=s.Zb().$implicit,t=s.Zb();s.fc("layerGroups",t.layergroups)("expanded",!1)("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("layer",e)("group",null)}}function Fo(e,t){if(1&e&&(s.Qb(0,"div",1),s.wc(1,Ro,1,4,"ukis-layerentry-group",2),s.wc(2,ko,1,6,"ukis-layerentry",3),s.Pb()),2&e){const e=t.$implicit,r=s.Zb();s.zb(1),s.fc("ngIf",r.isLayerGroup(e)),s.zb(1),s.fc("ngIf",!r.isLayerGroup(e))}}let Mo=(()=>{class e{constructor(){this.layergroups=[]}ngOnInit(){this.layerGroupsSubscription=this.layersSvc.getLayerGroups().subscribe(e=>{this.layergroups=e.filter(e=>"Baselayers"===e.filtertype)})}isLayerGroup(e){return e instanceof f}ngOnDestroy(){this.layerGroupsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-base-layer-control"]],inputs:{layersSvc:"layersSvc",mapStateSvc:"mapStateSvc"},decls:2,vars:3,consts:[["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],[3,"layersSvc","mapState","group","layerGroups",4,"ngIf"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group",4,"ngIf"],[3,"layersSvc","mapState","group","layerGroups"],[3,"layerGroups","expanded","layersSvc","mapState","layer","group"]],template:function(e,t){1&e&&(s.wc(0,Fo,3,2,"div",0),s.ac(1,"reverse")),2&e&&s.fc("ngForOf",s.bc(1,1,t.layergroups))},directives:[bt.m,bt.n,Lo,so],pipes:[io],styles:[""]}),e})(),Go=(()=>{class e{constructor(e){this.owcSvc=e,this.baselayers=[],this.overlays=[],this.layers=[],this.sub=[]}ngOnInit(){this.sub.push(this.layerSvc.getBaseLayers().subscribe(e=>{this.baselayers=e})),this.sub.push(this.layerSvc.getOverlays().subscribe(e=>{this.overlays=e})),this.layerSvc.getLayers().subscribe(e=>{this.layers=e}),this.sub.push(this.mapStateSvc.getExtent().subscribe(e=>{this.extent=e})),this.sub.push(this.mapStateSvc.getMapState().subscribe(e=>{this.state=e}))}ngOnDestroy(){this.sub.map(e=>e.unsubscribe())}onClickExport(){const e="myContext",t=this.owcSvc.generateOwsContextFrom(e,[...this.baselayers,...this.overlays,...this.layers],this.extent);this.downloadFile(t,`${e}.json`)}downloadFile(e,t){const r=JSON.stringify(e),o=new Blob([r],{type:"text/json;charset=utf-8;"}),s=window.URL.createObjectURL(o),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=s,i.download=t,i.click(),window.URL.revokeObjectURL(s),document.body.removeChild(i)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(Or))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-owc-control"]],inputs:{layerSvc:"layerSvc",mapStateSvc:"mapStateSvc"},decls:2,vars:0,consts:[[1,"btn",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"button",0),s.Xb("click",function(){return t.onClickExport()}),s.yc(1,"Export map as OWC"),s.Pb())},encapsulation:2}),e})(),Ao=(()=>{class e{constructor(e,t,r,o){this.layersSvc=e,this.mapStateSvc=t,this.mapSvc=r,this.wmsSvc=o,this.class="content-container",this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.mapSvc.map.addControl(new xt),this.addBaseLayers(),this.addLayers(),this.addOverlays(),this.setExtent()}setExtent(){this.mapStateSvc.setExtent([-14,33,40,57])}parseCapabilities(){this.wmsSvc.getCapabilities("https://geoservice.dlr.de/eoc/land/wms").subscribe(e=>{const t=this.wmsSvc.getLayerFromCapabilities("AGRODE_S2_EVI_P1M",e);console.log(t)})}addBaseLayers(){[new y({name:"Transparenter Hintergrund",id:"blank",type:"geojson",visible:!0}),new I({visible:!1}),new v({type:"wmts",url:"https://tiles.geoservice.dlr.de/service/wmts",name:"Relief",id:"world_relief_bw",params:{layer:"eoc:world_relief_bw",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},visible:!1,description:"eoc:world_relief_bw as web map tile service",attribution:'Relief: <a src="https://www.dlr.de/eoc">DLR/EOC</>',legendImg:""}),new O({id:"OSM_Base"})].map(e=>this.layersSvc.addLayer(e,"Baselayers"))}addLayers(){const e=new b({type:"wms",url:"https://geoservice.dlr.de/eoc/land/wms",name:"GUF Mosaic",id:"GUF28_DLR_v1_Mosaic",params:{LAYERS:"GUF28_DLR_v1_Mosaic",STYLES:"guf_8bit"},tileSize:512,visible:!1,description:"GUF28_DLR_v1_Mosaic",attribution:' | GUF\xae: <a href="https://www.dlr.de/eoc/en/desktopdefault.aspx/tabid-9628/16557_read-40454/">DLR License</a>',legendImg:"",popup:{asyncPupup:(e,t)=>{!function(e,t,r){const o=e.source,s=e.evt,i=t.map.getView().getResolution(),a=o.getFeatureInfoUrl(s.coordinate,i,t.EPSG,{INFO_FORMAT:"application/json"});fetch(a).then(e=>e.json()).catch(e=>{console.log(e)}).then(e=>{if(e.features.length){const o=t.createPopupHtml(e.features[0].properties);r(o)}else r("<p>No Data!</p>")})}(e,this.mapSvc,t)}}}),t=new v({type:"wmts",url:"https://tiles.geoservice.dlr.de/service/wmts",name:"TDM90 DEM",id:"TDM90_DEM",params:{layer:"TDM90_DEM",style:"default",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"},format:"image/png"},visible:!1,maxZoom:8,description:"TDM90_DEM maxZoom: 8",attribution:' | TDM90 Data \xa9: <a href="http://www.dlr.de" target="_blank">DLR</a>  licensed for <a rel="license" target="_blank" href="https://geoservice.dlr.de/resources/licenses/tdm90/License_for_the_Utilization_of_90m_DEM_for_Scientific_Use.pdf">scientific use</a>',legendImg:"",expanded:!0,cssClass:"custom-layer"}),r=new y({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Polygon"},geometry:{type:"Polygon",coordinates:[[[11.53564453125,48.80686346108517],[11.42578125,48.61838518688487],[11.97509765625,48.516604348867475],[12.2607421875,48.69096039092549],[12.0849609375,48.99463598353405],[11.53564453125,48.80686346108517]]]}},{type:"Feature",properties:{title:"Rectangle"},geometry:{type:"Polygon",coordinates:[[[10.986328125,43.89789239125797],[11.755371093749998,43.89789239125797],[11.755371093749998,44.41808794374846],[10.986328125,44.41808794374846],[10.986328125,43.89789239125797]]]}},{type:"Feature",properties:{title:"Line"},geometry:{type:"LineString",coordinates:[[13.29345703125,48.268569112964336],[15.073242187499998,47.56170075451973],[14.1064453125,46.40756396630067],[15.886230468750002,44.94924926661153]]}},{type:"Feature",properties:{title:"Point"},geometry:{type:"Point",coordinates:[11.513671874999998,46.42271253466717]}}]},visible:!1,popup:{event:"move",dynamicPopup:{component:Et,getAttributes:e=>({data:e.properties})}}}),o=new y({id:"geojson_test_3",name:"GeoJSON Point Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Munich",type:"City",image:"https://en.wikipedia.org/wiki/Munich#/media/File:Stadtbild_M%C3%BCnchen.jpg",wiki:"https://en.wikipedia.org/wiki/Munich"},geometry:{type:"Point",coordinates:[11.557617187499998,48.151428143221224]}}]},visible:!1,popup:{properties:{title:"Title",type:"Type"}}}),s=new y({id:"geojson_test_2",name:"Vector Layer in Group",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{type:"Polygon",name:"Vector Layer in Group",data:"geojson"},geometry:{type:"Polygon",coordinates:[[[-4.9658203125,41.09591205639546],[-6.459960937499999,39.52099229357195],[-5.009765625,38.42777351132902],[-1.8896484375,38.77121637244273],[-.68115234375,40.84706035607122],[-2.900390625,41.65649719441145],[-4.9658203125,41.09591205639546]]]}}]},visible:!1,cssClass:"hide",popup:["type","name"],actions:[{title:"download",icon:"download-cloud",action:e=>{console.log(e)}}]}),i=new y({id:"geojson_test_cluster",name:"Cluster - GeoJSON Vector Layer",type:"geojson",cluster:{distance:20},data:Ot,visible:!0,actions:[{title:"update Layer",icon:"sync",action:e=>{e.cluster.distance=25,e.options||(e.options={}),e.options.style=e=>{const t=e.get("features").length;return new de.b({image:new ye.a({radius:t<=1?6:10,stroke:new ge.a({color:"#fff"}),fill:new be.a({color:t<=1?"green":"red"})})})},this.layersSvc.updateLayer(e)}}],popup:{pupupFunktion:e=>`<div>${JSON.stringify(e)} </div>`}}),a=new y({id:"WfsLayer",name:"WFS Pennsylvania",type:"wfs",url:"https://ahocevar.com/geoserver/wfs?service=WFS&request=GetFeature&outputFormat=application/json&version=1.1.0&srsname=EPSG:3857&typenames=usa:states&cql_filter=STATE_NAME='Pennsylvania'",bbox:[-83.1005859375,38.37611542403604,-72.50976562499999,43.03677585761058],popup:{dynamicPopup:{component:Et,getAttributes:e=>({data:e})}}}),n=new k;n.cssClass="hide";const c=new F,l=new R,p=new O,u=new f({id:"group_1",name:"Test Group",layers:[p,n,c],description:"this is a group with OsmLayer, eocBasemap, eocBaseoverlay",actions:[{title:"download",icon:"download-cloud",action:e=>{console.log(e)}}]}),h=new f({id:"group_2",name:"Test Group 2",expanded:!0,cssClass:"custom-layer-group",layers:[t,s,l]}),d=new f({id:"group_3",name:"Test Group Vector-Data",expanded:!1,layers:[r,o,a]});[e,new A({popup:{pupupFunktion:e=>`\n            <table>\n              <tbody>\n                <tr>\n                  <td style="vertical-align: top; padding-right: 7px;"><b>Name: ${e.name}</b></td>\n                  <td></td>\n                </tr>\n                <tr>\n                  <td style="vertical-align: top; padding-right: 7px;"><b>type: ${e.type}</b></td>\n                  <td></td>\n                </tr>\n              </tbody>\n            </table>\n            <img src="${e.legendImg}">\n            `}}),d,h,u,i].map(e=>{e instanceof m?this.layersSvc.addLayer(e,"Layers"):e instanceof f&&this.layersSvc.addLayerGroup(e)})}addOverlays(){const e=new M({crossOrigin:"anonymous"}),t=new T({crossOrigin:"anonymous"});this.layersSvc.addLayer(e,"Overlays"),this.layersSvc.addLayer(t,"Overlays")}updateLayerGroup(){const e=this.layersSvc.getLayerOrGroupById("group_1");e.expanded=!0,e.layers[1].cssClass=null,this.layersSvc.updateLayerGroup(e);const t=this.layersSvc.getLayerOrGroupById("group_2");t.layers[1].visible=!0,this.layersSvc.updateLayerGroup(t)}addLayerToGroup(){const e=this.layersSvc.getLayerOrGroupById("group_2"),t=new G;this.layersSvc.addLayerToGroup(t,e)}removeAllLayers(){this.layersSvc.removeLayers()}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E),s.Kb(st),s.Kb(hr))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:37,vars:18,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","world","title","Overlays","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc","layerfilter"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""],["shape","cog","title","Actions","clrVerticalNavIcon",""],[1,"btn","btn-primary",3,"click"],["shape","export","title","Export","clrVerticalNavIcon",""],[3,"layerSvc","mapStateSvc"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Overlays "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",3),s.Lb(9,"clr-icon",7),s.yc(10," Layers "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-layer-control",8),s.Pb(),s.Pb(),s.Qb(13,"clr-vertical-nav-group",3),s.Lb(14,"clr-icon",9),s.yc(15," Baselayers "),s.Qb(16,"clr-vertical-nav-group-children",5),s.Lb(17,"ukis-base-layer-control",8),s.Pb(),s.Pb(),s.Qb(18,"clr-vertical-nav-group",3),s.Lb(19,"clr-icon",10),s.yc(20," Actions "),s.Qb(21,"clr-vertical-nav-group-children",5),s.Qb(22,"button",11),s.Xb("click",function(){return t.updateLayerGroup()}),s.yc(23,"update LayerGroup"),s.Pb(),s.Qb(24,"button",11),s.Xb("click",function(){return t.addLayerToGroup()}),s.yc(25,"add Layer to LayerGroup"),s.Pb(),s.Qb(26,"button",11),s.Xb("click",function(){return t.removeAllLayers()}),s.yc(27,"remove All Layers"),s.Pb(),s.Qb(28,"button",11),s.Xb("click",function(){return t.setExtent()}),s.yc(29,"set Extent"),s.Pb(),s.Qb(30,"button",11),s.Xb("click",function(){return t.parseCapabilities()}),s.yc(31,"Parse WMS capabilities"),s.Pb(),s.Pb(),s.Pb(),s.Qb(32,"clr-vertical-nav-group"),s.Lb(33,"clr-icon",12),s.yc(34," OWC Control "),s.Qb(35,"clr-vertical-nav-group-children",5),s.Lb(36,"ukis-owc-control",13),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc)("layerfilter","Overlays"),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(18),s.fc("layerSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io,Mo,Go],styles:["[_nghost-%COMP%]     .custom-layer-group .head>.title{color:#660f00}[_nghost-%COMP%]     .custom-layer .head>.title{color:#b87d00}[_nghost-%COMP%]     .zoom-number{bottom:2.5em;left:8px}"]}),e})();const jo=function(e){return{"is-solid":e}};function Do(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",2),s.Xb("click",function(){s.pc(e);const r=t.$implicit;return s.Zb(2).setNewProjection(r)}),s.Qb(1,"div",3),s.Qb(2,"div",4),s.Qb(3,"span",5),s.Xb("click",function(){s.pc(e);const r=t.$implicit;return s.Zb(2).setNewProjection(r)}),s.yc(4),s.Pb(),s.Lb(5,"clr-icon",6),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=t.$implicit,r=s.Zb(2);s.zb(3),s.fc("title",e.title),s.zb(1),s.Ac(" ",e.title||e.code," "),s.zb(1),s.gc("title",e.code),s.fc("ngClass",s.jc(5,jo,e===r.selectedProj)),s.Ab("shape",e===r.selectedProj?"eye":"eye-hide")}}function zo(e,t){if(1&e&&(s.Qb(0,"div"),s.wc(1,Do,6,7,"div",1),s.Pb()),2&e){const e=s.Zb();s.zb(1),s.fc("ngForOf",e.projList)}}let Qo=(()=>{class e{constructor(){}ngOnInit(){this.projList[0]&&this.setNewProjection(this.projList[0])}setNewProjection(e){this.mapSvc.registerProjection(e);const t=this.mapSvc.getOlProjection(e);this.mapSvc.setProjection(t),this.selectedProj=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-projection-switch"]],inputs:{mapSvc:"mapSvc",projList:["projectionList","projList"]},decls:1,vars:1,consts:[[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"layergroup"],[1,"head"],[1,"title",3,"title","click"],[1,"iconButton",3,"ngClass","title"]],template:function(e,t){1&e&&s.wc(0,zo,2,1,"div",0),2&e&&s.fc("ngIf",t.projList)},directives:[bt.n,bt.m,Pt.n,bt.l],encapsulation:2}),e})();function Vo(e,t){if(1&e&&(s.Qb(0,"option",9),s.yc(1),s.Pb()),2&e){const e=t.$implicit;s.fc("value",e.value),s.zb(1),s.zc(e.title)}}let No=(()=>{class e{constructor(e){this.mapSvc=e,this.mapCoordinates=[0,0],this.zoom=0,this.precision=2,this.x="Lon",this.y="Lat",this.mapMoveSubscription=e=>{e.coordinate&&(this.mapCoordinates=Object(ne.q)(e.coordinate,this.mapProjection,Object(ne.i)(this.selectedProjection)))},this.mapOnMoveend=e=>{const t=e.map.getView().getZoom();this.zoom!==t&&(this.zoom=t)},this.mapSub=this.mapSvc.projectionChange.subscribe(e=>{this.mapProjection=e,this.setProjection(e)})}ngOnInit(){this.mapSvc.map.on("pointermove",this.mapMoveSubscription),this.mapSvc.map.on("moveend",this.mapOnMoveend)}setProjection(e){const t=e.getCode();this.projections="EPSG:4326"===t?[{title:t,value:t}]:[{title:"EPSG:4326",value:"EPSG:4326"},{title:t,value:t}],this.selectedProjection=this.projections[0].value}ngOnDestroy(){this.mapSvc.map.un("pointermove",this.mapMoveSubscription),this.mapSvc.map.un("moveend",this.mapOnMoveend),this.mapSub.unsubscribe()}onChangeProj(e){"EPSG:4326"===e?(this.x="Lon",this.y="Lat"):(this.x="X",this.y="Y");const t=this.selectedProjection;this.selectedProjection=e,this.mapCoordinates=Object(ne.q)(this.mapCoordinates,Object(ne.i)(t),Object(ne.i)(this.selectedProjection))}toPrecision(e,t){return e.toFixed(t)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(st))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-mouse-position"]],decls:27,vars:7,consts:[[1,"mouse-position-control"],[1,"clr-row"],[1,"clr-col-7"],[1,"output-container"],[1,"clr-col-5"],[1,"input-container"],["clrSelect","",3,"change"],[3,"value",4,"ngFor","ngForOf"],["type","number","min","0","max","12","name","precision","clrInput","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div"),s.Qb(5,"b"),s.yc(6),s.Pb(),s.yc(7),s.Pb(),s.Qb(8,"div"),s.Qb(9,"b"),s.yc(10),s.Pb(),s.yc(11),s.Pb(),s.Qb(12,"div"),s.Qb(13,"b"),s.yc(14,"Zoom"),s.Pb(),s.yc(15),s.Pb(),s.Pb(),s.Pb(),s.Qb(16,"div",4),s.Qb(17,"div",5),s.Qb(18,"clr-select-container"),s.Qb(19,"label"),s.yc(20,"Projection "),s.Pb(),s.Qb(21,"select",6),s.Xb("change",function(e){return t.onChangeProj(e.target.value)}),s.wc(22,Vo,2,2,"option",7),s.Pb(),s.Pb(),s.Qb(23,"clr-input-container"),s.Qb(24,"label"),s.yc(25,"Precision "),s.Pb(),s.Qb(26,"input",8),s.Xb("ngModelChange",function(e){return t.precision=e}),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(6),s.zc(t.x),s.zb(1),s.Ac(" ",t.toPrecision(t.mapCoordinates[0],t.precision),""),s.zb(3),s.zc(t.y),s.zb(1),s.Ac(" ",t.toPrecision(t.mapCoordinates[1],t.precision),""),s.zb(4),s.Ac(" ",t.toPrecision(t.zoom,t.precision),""),s.zb(7),s.fc("ngForOf",t.projections),s.zb(4),s.fc("ngModel",t.precision))},directives:[Pt.y,Pt.r,Pt.x,bt.m,Pt.q,Fr.p,Fr.b,Pt.p,Fr.j,Fr.m,Fr.o,Fr.x],styles:[".mouse-position-control[_ngcontent-%COMP%]{margin-left:.2rem;padding-bottom:.4rem}.mouse-position-control[_ngcontent-%COMP%]   .output-container[_ngcontent-%COMP%]{line-height:1.6rem}.mouse-position-control[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]:first-child{margin-top:0}"]}),e})(),Bo=(()=>{class e{constructor(){this.inputStep=.01,this.precision=2}ngOnInit(){this.subscription=this.mapState.getMapState().subscribe(e=>{this.mapstate=e})}ngOnDestroy(){this.subscription.unsubscribe()}zoomIn(){this.mapstate.zoom++,this.setNewState(this.mapstate)}zoomOut(){this.mapstate.zoom--,this.setNewState(this.mapstate)}setNewState(e){e.options.notifier="user",this.mapState.setMapState(e)}stateChange(e){this.setNewState(this.mapstate)}setInputStep(e){const t=Array.from(Array(e),(e,t)=>"0").join("");this.inputStep=1/Number(`1${t}`)}toPrecision(e,t){return e.toFixed(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-map-navigator"]],inputs:{mapState:"mapState"},decls:22,vars:7,consts:[[1,"clr-row"],[1,"clr-col-9"],[1,"output-container"],["clrForm",""],["clrInput","","type","number","name","lon",3,"ngModel","step","ngModelChange"],["clrInput","","type","number","name","lat",3,"ngModel","step","ngModelChange"],["clrInput","","type","number","name","zoom",3,"ngModel","step","ngModelChange"],[1,"clr-col-3"],[1,"input-container"],["type","number","min","0","max","8","step","1","name","precision","clrInput","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"form",3),s.Qb(4,"clr-input-container"),s.Qb(5,"label"),s.yc(6,"Lon"),s.Pb(),s.Qb(7,"input",4),s.Xb("ngModelChange",function(e){return t.mapstate.center.lon=e})("ngModelChange",function(e){return t.stateChange(e)}),s.Pb(),s.Pb(),s.Qb(8,"clr-input-container"),s.Qb(9,"label"),s.yc(10,"Lat"),s.Pb(),s.Qb(11,"input",5),s.Xb("ngModelChange",function(e){return t.mapstate.center.lat=e})("ngModelChange",function(e){return t.stateChange(e)}),s.Pb(),s.Pb(),s.Qb(12,"clr-input-container"),s.Qb(13,"label"),s.yc(14,"Zoom"),s.Pb(),s.Qb(15,"input",6),s.Xb("ngModelChange",function(e){return t.mapstate.zoom=e})("ngModelChange",function(e){return t.stateChange(e)}),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(16,"div",7),s.Qb(17,"div",8),s.Qb(18,"clr-input-container"),s.Qb(19,"label"),s.yc(20,"Precision "),s.Pb(),s.Qb(21,"input",9),s.Xb("ngModelChange",function(e){return t.precision=e})("ngModelChange",function(e){return t.setInputStep(e)}),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(7),s.fc("ngModel",t.mapstate.center.lon)("step",t.inputStep),s.zb(4),s.fc("ngModel",t.mapstate.center.lat)("step",t.inputStep),s.zb(4),s.fc("ngModel",t.mapstate.zoom)("step",t.inputStep),s.zb(6),s.fc("ngModel",t.precision))},directives:[Fr.w,Fr.k,Fr.l,Pt.l,Pt.q,Pt.r,Fr.p,Fr.b,Pt.p,Fr.j,Fr.m],styles:[".output-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]:first-child{margin-top:0}.output-container[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:90%}"]}),e})(),Uo=(()=>{class e{constructor(e,t,r){this.layersSvc=e,this.mapStateSvc=t,this.mapSvc=r,this.class="content-container",this.controls={attribution:!0,scaleLine:!0},this.projections=[{code:"EPSG:3857",proj4js:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",title:"Spherical Mercator",extent:[-20026376.39,-20048966.1,20026376.39,20048966.1],worldExtent:[-180,-85.06,180,85.06],global:!0,units:"m"},{code:"EPSG:3995",proj4js:"+proj=stere +lat_0=90 +lat_ts=71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs",title:"Arctic Polar Stereographic",extent:[-20048966.1,-20048966.1,20048966.1,20048966.1],worldExtent:[-180,60,180,90],global:!1,units:"m"},{code:"EPSG:3031",proj4js:"+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs",title:"Antarctic Polar Stereographic",extent:[-20048966.1,-20048966.1,20048966.1,20048966.1],worldExtent:[-180,-90,180,-60],global:!1,units:"m"}],this.addOverlays(),this.mapStateSvc.setExtent([-14,33,40,57])}ngOnInit(){}addOverlays(){[new O({removable:!0,legendImg:null,visible:!0,id:"osm"}),new b({type:"wms",url:"https://geoservice.dlr.de/eoc/land/wms",name:"GUF Mosaic",id:"GUF28_DLR_v1_Mosaic",params:{layers:"GUF28_DLR_v1_Mosaic",styles:"guf_8bit"},visible:!1,description:"GUF28_DLR_v1_Mosaic",attribution:' | GUF\xae: <a href="https://www.dlr.de/eoc/en/desktopdefault.aspx/tabid-9628/16557_read-40454/">DLR License</a>',legendImg:""}),new y({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[12.65625,49.61070993807422],[20.698242187499996,46.830133640447386],[22.5,49.781264058178344],[15.161132812500002,51.508742458803326],[12.65625,49.61070993807422]]]}}]},visible:!0})].map(e=>this.layersSvc.addLayer(e,"Layers"))}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E),s.Kb(st))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map2"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:23,vars:14,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","Projection",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","map","clrVerticalNavIcon",""],[3,"mapSvc","projectionList"],["title","Coordinates",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","compass","clrVerticalNavIcon",""],["title","Navigator",1,"layers",3,"clrVerticalNavGroupExpanded"],[3,"mapState"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Layers "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",7),s.Lb(9,"clr-icon",8),s.yc(10," Projection "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-projection-switch",9),s.Pb(),s.Pb(),s.Qb(13,"clr-vertical-nav-group",10),s.Lb(14,"clr-icon",11),s.yc(15," Coordinates "),s.Qb(16,"clr-vertical-nav-group-children",5),s.Lb(17,"ukis-mouse-position"),s.Pb(),s.Pb(),s.Qb(18,"clr-vertical-nav-group",12),s.Lb(19,"clr-icon",11),s.yc(20," Navigator "),s.Qb(21,"clr-vertical-nav-group-children",5),s.Lb(22,"ukis-map-navigator",13),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("mapSvc",t.mapSvc)("projectionList",t.projections),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(5),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("mapState",t.mapStateSvc))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io,Qo,No,Bo],styles:[""]}),e})();var Wo=r("k9Tt"),Zo=r("CxY0"),$o=r("Nr0W"),Ho=r("gOFd"),Xo=r("SxV6"),qo=r("JF1W");let Yo=(()=>{class e{constructor(){this.progressSource=new we.a,this.progress$=this.progressSource.asObservable()}progress(e){this.progressSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ko=(()=>{class e{constructor(e,t,r,o,s){this.layersSvc=e,this.mapStateSvc=t,this.mapSvc=r,this.progressService=o,this.route=s,this.class="content-container",this.subs=[],this.startBbox=null,this.updateLayerOnZoom=e=>{const t=this.mapStateSvc.getMapState().getValue(),r=((e,t,r,o,s)=>{const i=[];let a=80;r>1&&(a=40),r>2&&(a=20),r>3&&(a=10),r>4&&(a=6),r>5&&(a=4),r>6&&(a=3),r>7&&(a=2),r>8&&(a=1);const n=.5*a;let c=10;c>10&&(c=10),s=Object(pe.d)(s,n);const l=e[0]+c,p=e[1]+c,u=e[3]-c-p,h=Math.floor((e[2]-c-l)/n),d=Math.floor(u/n);let m=l;for(let b=h;b>0;b--){let e=p;for(let t=d;t>0;t--){const r=m+n,a=e+n,c=[m,e],l=[[c,[m,a],[r,a],[r,e],c]];if(console.log(),Object(pe.i)(s,m,e)&&Object(pe.i)(s,r,a)){const e=new Ho.a(l).transform("EPSG:4326",o),r=new $o.a({geometry:e,column:b,row:t,id:i.length+1});i.push(r)}e+=n}m+=n}return i})([-180,-90,180,90],0,t.zoom,this.mapSvc.EPSG,t.extent),o=new te.a({features:r,wrapX:!1}),s=new Wo.a({id:"gridLayer",source:o}),i=this.layersSvc.getLayerById("gridLayer");if(i)i.custom_layer=s,this.layersSvc.updateLayer(i,i.filtertype);else{const e=new g({id:"gridLayer",name:"gridLayer",type:"custom",opacity:.3,custom_layer:s});this.layersSvc.addLayer(e,"Layers")}},this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.addLayers(),this.subscribeToMapState(),this.subscribeToRoute(),this.startBbox&&this.mapStateSvc.setExtent(this.startBbox)}ngAfterViewInit(){this.mapSvc.map.on("moveend",this.updateLayerOnZoom)}ngOnDestroy(){this.subs.map(e=>e.unsubscribe()),this.mapSvc.map.un("moveend",this.updateLayerOnZoom)}addLayers(){const e=new O({visible:!0}),t=new X.a({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"});t.on("imageloadstart",()=>{this.progressService.progress({indeterminate:!0})}),t.on("imageloadend",()=>{this.progressService.progress(null)}),t.on("imageloaderror",()=>{this.progressService.progress(null)});const r=new g({id:"event_layer",name:"Image load Layer",type:"custom",custom_layer:new _e.a({source:t}),visible:!1,bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),o=new y({id:"updatable_feature_layer",name:"Updatable feature layer",type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-192.48046875,-24.686952411999144],[-88.06640625,-24.686952411999144],[-88.06640625,50.28933925329178],[-192.48046875,50.28933925329178],[-192.48046875,-24.686952411999144]]]}}]},actions:[{action:e=>{o.data=qo,this.layersSvc.updateLayer(o)},icon:"download",title:"Load data"}]});[e,r,o].forEach(e=>this.layersSvc.addLayer(e,"Layers"))}updateSearchParamsHashRouting(e){const t=Object(Zo.parse)(window.location.href.replace("#/","")),r=Object(Zo.parse)(window.location.href),o=r.hash.split("?")[1];let s=new URLSearchParams;o&&(s=new URLSearchParams(o)),Object.keys(e).map(t=>{s.set(t,e[t])});const i=decodeURIComponent(`${s}`);return`${r.protocol}//${r.host}${r.pathname||""}#${t.pathname}?${i}`}subscribeToMapState(){const e=this.mapStateSvc.getMapState().subscribe(e=>{if(history.pushState){const t=e.extent.map(e=>e.toFixed(3)),r=this.updateSearchParamsHashRouting({bbox:t.join(","),zoom:e.zoom.toString()});window.history.pushState({path:r},"",r)}});this.subs.push(e)}subscribeToRoute(){const e=this.route.queryParams.pipe(Object(Xo.a)()).subscribe(e=>{if(Object.keys(e).length>0&&e.bbox){const t=e.bbox.split(",").map(e=>parseFloat(e));4===t.length&&(this.startBbox=t)}});this.subs.push(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E),s.Kb(st),s.Kb(Yo),s.Kb(i.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map3"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:13,vars:9,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","Coordinates",1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","compass","clrVerticalNavIcon",""]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Layers "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",7),s.Lb(9,"clr-icon",8),s.yc(10," Coordinates "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-mouse-position"),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!1))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io,No],styles:[""]}),e})();var Jo=r("b6O2"),es=r("dmYx"),ts=r("gayD"),rs=r("itZQ"),os=r("NxsL"),ss=r("eGOI");let is=(()=>{class e{constructor(){this.privValue=1,this.valueChange=new s.n}set value(e){this.privValue=e,this.layer.custom_layer&&this.layer.custom_layer.setRadius(e)}get value(){return this.privValue}changeValue(e){const t=parseInt(e.target.value,10);this.value=t,this.valueChange.emit(t),this.layer.custom_layer&&this.layer.custom_layer.setRadius(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-example-layer-action"]],inputs:{layer:"layer",value:"value"},outputs:{valueChange:"valueChange"},decls:6,vars:2,consts:[[1,"heatmap-range"],["type","range","clrRange","","name","two","min","1","max","50","step","1",1,"ukis-range-input",3,"value","change"]],template:function(e,t){1&e&&(s.Qb(0,"clr-range-container",0),s.Qb(1,"label"),s.yc(2,"Heatmap radius:"),s.Pb(),s.Qb(3,"input",1),s.Xb("change",function(e){return t.changeValue(e)}),s.Pb(),s.Qb(4,"clr-control-helper"),s.yc(5),s.Pb(),s.Pb()),2&e&&(s.zb(3),s.fc("value",t.value),s.zb(2),s.zc(" "+t.value))},directives:[Pt.w,Pt.r,Pt.v,Pt.f],styles:[".heatmap-range[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}"]}),e})();const as={type:"FeatureCollection",features:[{type:"Feature",properties:{height:2},geometry:{type:"Polygon",coordinates:[[[11.539764404296875,48.17707562779612,2],[11.53289794921875,48.13126755117026],[11.51641845703125,48.12301775410865],[11.517791748046875,48.10926514749487],[11.56036376953125,48.11384975871469],[11.564483642578125,48.12301775410865],[11.58233642578125,48.130350972491556],[11.592292785644531,48.14043243818811],[11.594696044921875,48.14730502988628],[11.602935791015625,48.15715413998257],[11.595039367675781,48.1640244926387],[11.59950256347656,48.17226770127996],[11.587142944335938,48.177533502046636],[11.572036743164062,48.177533502046636],[11.539764404296875,48.17707562779612]]]}},{type:"Feature",properties:{height:1},geometry:{type:"Polygon",coordinates:[[[11.605682373046875,48.156238023440835],[11.596412658691406,48.147534100428686],[11.59332275390625,48.13699579726703],[11.583709716796875,48.12851776605501],[11.564826965332031,48.121413473016034],[11.561737060546875,48.11247441829591],[11.575126647949217,48.11155750423242],[11.581993103027344,48.10490938797694],[11.614608764648438,48.11178673428214],[11.620101928710938,48.12462198509838],[11.614952087402344,48.12920522613733],[11.614265441894531,48.13905780942574],[11.61529541015625,48.15165719536032],[11.605682373046875,48.156238023440835]]]}},{type:"Feature",properties:{height:3},geometry:{type:"Polygon",coordinates:[[[11.516075134277344,48.12347611093252],[11.532554626464844,48.131496693283744],[11.538734436035156,48.176388808753124],[11.52191162109375,48.175701980509444],[11.511268615722656,48.17249666038475],[11.507148742675781,48.16379549570767],[11.492729187011719,48.165398452755674],[11.486892700195312,48.16379549570767],[11.458740234375,48.164482483433744],[11.457366943359375,48.15188624647704],[11.455307006835938,48.148221305921446],[11.436767578124998,48.133329793382636],[11.430244445800781,48.12874692043826],[11.443977355957031,48.12828861064926],[11.45050048828125,48.12553866602599],[11.4862060546875,48.124392812310205],[11.503028869628904,48.12553866602599],[11.516075134277344,48.12347611093252]]]}},{type:"Feature",properties:{height:0},geometry:{type:"Polygon",coordinates:[[[11.517448425292969,48.10972362702285],[11.487579345703125,48.095738161288885],[11.488265991210938,48.08381312049231],[11.485176086425781,48.075785093732456],[11.487922668457031,48.07486752519069],[11.493759155273438,48.07693203139914],[11.506805419921875,48.0762438718672],[11.517448425292969,48.06890293081563],[11.536331176757812,48.068214663899795],[11.538734436035156,48.07349114169717],[11.540107727050781,48.08427182703979],[11.548004150390625,48.09367440979962],[11.549720764160154,48.10559716402152],[11.559333801269531,48.11407897853892],[11.517448425292969,48.10972362702285]]]}}]},ns={type:"FeatureCollection",features:[{type:"Feature",properties:{pid:1},geometry:{type:"Point",coordinates:[10.9423828125,49.001843917978526]}},{type:"Feature",properties:{pid:2},geometry:{type:"Point",coordinates:[11.18408203125,49.088257784724675]}},{type:"Feature",properties:{pid:3},geometry:{type:"Point",coordinates:[11.030273437499998,49.35375571830993]}},{type:"Feature",properties:{pid:4},geometry:{type:"Point",coordinates:[10.72265625,49.24629332459796]}},{type:"Feature",properties:{pid:5},geometry:{type:"Point",coordinates:[12.76611328125,48.011975126709956]}},{type:"Feature",properties:{pid:6},geometry:{type:"Point",coordinates:[13.55712890625,49.15296965617042]}},{type:"Feature",properties:{pid:7},geometry:{type:"Point",coordinates:[13.3154296875,48.545705491847464]}},{type:"Feature",properties:{pid:8},geometry:{type:"Point",coordinates:[4.482421875,49.224772722794825]}}]},cs={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Feature 1 - Polygon"},geometry:{type:"Polygon",coordinates:[[[7.91015625,50.233151832472245],[9.140625,47.81315451752768],[13.33740234375,48.28319289548349],[13.7109375,50.17689812200107],[7.91015625,50.233151832472245]]]}}]},ls={type:"FeatureCollection",features:[{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.3",geometry:{type:"Point",coordinates:[14.354708,54.004536]},geometry_name:"geom",properties:{lat:"54.004536",lon:"14.354708",id:"3",timestamp:"2020-09-13T16:52:57Z",SWH:"1.13",plength:"209.7",windSpeed:"4.25",pdirection:"125.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.4",geometry:{type:"Point",coordinates:[14.445045,54.013187]},geometry_name:"geom",properties:{lat:"54.013187",lon:"14.445045",id:"4",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"251.0",windSpeed:"3.75",pdirection:"11.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.5",geometry:{type:"Point",coordinates:[14.535383,54.021835]},geometry_name:"geom",properties:{lat:"54.021835",lon:"14.535383",id:"5",timestamp:"2020-09-13T16:52:57Z",SWH:"1.08",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.6",geometry:{type:"Point",coordinates:[14.625798,54.030346]},geometry_name:"geom",properties:{lat:"54.030346",lon:"14.625798",id:"6",timestamp:"2020-09-13T16:52:57Z",SWH:"0.99",plength:"194.6",windSpeed:"4.00",pdirection:"171.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.7",geometry:{type:"Point",coordinates:[14.716214,54.038853]},geometry_name:"geom",properties:{lat:"54.038853",lon:"14.716214",id:"7",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"475.4",windSpeed:"4.05",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.8",geometry:{type:"Point",coordinates:[13.978081,54.022915]},geometry_name:"geom",properties:{lat:"54.022915",lon:"13.978081",id:"8",timestamp:"2020-09-13T16:52:57Z",SWH:"0.66",plength:"475.4",windSpeed:"3.50",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.9",geometry:{type:"Point",coordinates:[14.068372,54.031853]},geometry_name:"geom",properties:{lat:"54.031853",lon:"14.068372",id:"9",timestamp:"2020-09-13T16:52:57Z",SWH:"1.03",plength:"452.5",windSpeed:"4.20",pdirection:"135.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.10",geometry:{type:"Point",coordinates:[14.158684,54.040756]},geometry_name:"geom",properties:{lat:"54.040756",lon:"14.158684",id:"10",timestamp:"2020-09-13T16:52:57Z",SWH:"0.47",plength:"199.9",windSpeed:"4.40",pdirection:"51.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.11",geometry:{type:"Point",coordinates:[14.249058,54.049553]},geometry_name:"geom",properties:{lat:"54.049553",lon:"14.249058",id:"11",timestamp:"2020-09-13T16:52:57Z",SWH:"1.36",plength:"420.9",windSpeed:"4.40",pdirection:"80.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.12",geometry:{type:"Point",coordinates:[14.339441,54.058331]},geometry_name:"geom",properties:{lat:"54.058331",lon:"14.339441",id:"12",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"134.6",windSpeed:"3.95",pdirection:"3.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.13",geometry:{type:"Point",coordinates:[14.429894,54.066982]},geometry_name:"geom",properties:{lat:"54.066982",lon:"14.429894",id:"13",timestamp:"2020-09-13T16:52:57Z",SWH:"1.01",plength:"351.6",windSpeed:"4.15",pdirection:"164.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.14",geometry:{type:"Point",coordinates:[14.52035,54.075634]},geometry_name:"geom",properties:{lat:"54.075634",lon:"14.520350",id:"14",timestamp:"2020-09-13T16:52:57Z",SWH:"1.16",plength:"310.4",windSpeed:"4.45",pdirection:"166.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.15",geometry:{type:"Point",coordinates:[14.610882,54.084145]},geometry_name:"geom",properties:{lat:"54.084145",lon:"14.610882",id:"15",timestamp:"2020-09-13T16:52:57Z",SWH:"1.00",plength:"210.4",windSpeed:"4.05",pdirection:"170.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.16",geometry:{type:"Point",coordinates:[14.701414,54.092651]},geometry_name:"geom",properties:{lat:"54.092651",lon:"14.701414",id:"16",timestamp:"2020-09-13T16:52:57Z",SWH:"0.98",plength:"254.7",windSpeed:"4.40",pdirection:"174.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.17",geometry:{type:"Point",coordinates:[14.792017,54.101032]},geometry_name:"geom",properties:{lat:"54.101032",lon:"14.792017",id:"17",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"475.4",windSpeed:"4.45",pdirection:"158.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.18",geometry:{type:"Point",coordinates:[14.882627,54.109398]},geometry_name:"geom",properties:{lat:"54.109398",lon:"14.882627",id:"18",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"188.2",windSpeed:"4.25",pdirection:"107.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.19",geometry:{type:"Point",coordinates:[14.973297,54.117649]},geometry_name:"geom",properties:{lat:"54.117649",lon:"14.973297",id:"19",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"404.8",windSpeed:"4.00",pdirection:"161.6"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.20",geometry:{type:"Point",coordinates:[15.063984,54.12587]},geometry_name:"geom",properties:{lat:"54.125870",lon:"15.063984",id:"20",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"170.3",windSpeed:"4.10",pdirection:"176.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.21",geometry:{type:"Point",coordinates:[15.154721,54.133991]},geometry_name:"geom",properties:{lat:"54.133991",lon:"15.154721",id:"21",timestamp:"2020-09-13T16:52:57Z",SWH:"0.69",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.22",geometry:{type:"Point",coordinates:[14.052757,54.085644]},geometry_name:"geom",properties:{lat:"54.085644",lon:"14.052757",id:"22",timestamp:"2020-09-13T16:52:57Z",SWH:"0.28",plength:"475.4",windSpeed:"4.25",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.26",geometry:{type:"Point",coordinates:[14.414745,54.120781]},geometry_name:"geom",properties:{lat:"54.120781",lon:"14.414745",id:"26",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"129.3",windSpeed:"4.20",pdirection:"45.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.27",geometry:{type:"Point",coordinates:[14.505316,54.129433]},geometry_name:"geom",properties:{lat:"54.129433",lon:"14.505316",id:"27",timestamp:"2020-09-13T16:52:57Z",SWH:"0.50",plength:"310.4",windSpeed:"4.60",pdirection:"14.0"}}]};let ps=(()=>{class e{constructor(){this.sunlightForm=new Fr.e({x:new Fr.c(0,Fr.v.required),y:new Fr.c(0,Fr.v.required)})}ngOnInit(){this.sunlightForm.valueChanges.subscribe(e=>{this.changeHandler(parseInt(e.x,10)/100,parseInt(e.y,10)/100)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-sunlight"]],inputs:{changeHandler:"changeHandler"},decls:15,vars:1,consts:[["clrForm","","clrLayout","horizontal",3,"formGroup"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","x",1,"ukis-range-input"],["type","range","min","-100","max","100","value","0","clrInput","","formControlName","y",1,"ukis-range-input"]],template:function(e,t){1&e&&(s.Qb(0,"form",0),s.Qb(1,"label"),s.yc(2,"Sun position"),s.Pb(),s.Qb(3,"clr-input-container"),s.Qb(4,"label"),s.yc(5,"x"),s.Pb(),s.Lb(6,"input",1),s.Qb(7,"clr-control-helper"),s.yc(8,"east -> west"),s.Pb(),s.Pb(),s.Qb(9,"clr-input-container"),s.Qb(10,"label"),s.yc(11,"y"),s.Pb(),s.Lb(12,"input",2),s.Qb(13,"clr-control-helper"),s.yc(14,"south -> north"),s.Pb(),s.Pb(),s.Pb()),2&e&&s.fc("formGroup",t.sunlightForm)},directives:[Fr.w,Fr.k,Pt.l,Pt.s,Fr.f,Pt.r,Pt.q,Fr.r,Fr.b,Pt.p,Fr.j,Fr.d,Pt.f],styles:[""]}),e})(),us=(()=>{class e{constructor(){this.interpolationForm=new Fr.e({power:new Fr.c(2,Fr.v.required),smooth:new Fr.c(!0,Fr.v.required),labels:new Fr.c(!1,Fr.v.required)})}ngOnInit(){this.interpolationForm.valueChanges.subscribe(e=>{this.changeHandler(e.power,e.smooth,e.labels)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-interpolation-settings"]],inputs:{changeHandler:"changeHandler"},decls:21,vars:1,consts:[["clrForm","","clrLayout","vertical",3,"formGroup"],["type","range","min","1","max","7","value","1","clrInput","","formControlName","power",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","true","formControlName","smooth",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","false","formControlName","labels",1,"ukis-range-input"]],template:function(e,t){1&e&&(s.Qb(0,"form",0),s.Qb(1,"clr-input-container"),s.Qb(2,"label"),s.yc(3,"Power"),s.Pb(),s.Lb(4,"input",1),s.Qb(5,"clr-control-helper"),s.yc(6,"inverse distance weighting power"),s.Pb(),s.Pb(),s.Qb(7,"clr-checkbox-container"),s.Qb(8,"label"),s.yc(9,"Smoothing"),s.Pb(),s.Qb(10,"clr-checkbox-wrapper"),s.Lb(11,"input",2),s.Qb(12,"label"),s.yc(13,"Smoothing"),s.Pb(),s.Pb(),s.Pb(),s.Qb(14,"clr-checkbox-container"),s.Qb(15,"label"),s.yc(16,"Labels"),s.Pb(),s.Qb(17,"clr-checkbox-wrapper"),s.Lb(18,"input",3),s.Qb(19,"label"),s.yc(20,"Show labels"),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&s.fc("formGroup",t.interpolationForm)},directives:[Fr.w,Fr.k,Pt.l,Pt.s,Fr.f,Pt.q,Pt.r,Fr.r,Fr.b,Pt.p,Fr.j,Fr.d,Pt.f,Pt.d,Pt.e,Fr.a,Pt.c],styles:[""]}),e})();var hs=r("Womt"),ds=r("RyHr");function ms(e){const t=e.map(e=>Math.pow(e,2)).reduce((e,t)=>e+t,0);return Math.sqrt(t)}function bs(e){return e%360*(2*Math.PI)/360}function ys(e,t){return e/2/Math.tan(bs(t/2))}class gs{constructor(e=360/(2*Math.PI),t=10,r){this.mapRadiusMU=e,this.mapWidthMU=2*Math.PI*e,this.mapUnitsPerSphereUnits=e/t,this.sphereRadiusSU=t,this.sphereCircumferenceSU=2*Math.PI*t,this.sphereUnitsPerMapUnits=t/e,this.fovDeg=r}mapWidth2SphereHeight(e){const t=ys(e,this.fovDeg);return this.sphereRadiusSU+t*this.sphereUnitsPerMapUnits}sphereHeight2mapWidth(e){return(e-this.sphereRadiusSU)*this.mapUnitsPerSphereUnits*2*Math.tan(bs(this.fovDeg/2))}sphereHeight2zoom(e){const t=this.sphereHeight2mapWidth(e);return this.widthMU2Zoom(t)}zoom2sphereHeight(e){const t=this.zoom2WidthMU(e);return this.mapWidth2SphereHeight(t)}spherePos2zoom(e,t,r){const o=ms([e,t,r]);return this.sphereHeight2zoom(o)}zoom2WidthMU(e){return function(e,t){return t*Math.pow(.5,e)}(e,this.mapWidthMU)}widthMU2Zoom(e){return Math.log2(this.mapWidthMU/e)}lonLatZoom2XYZ(e,t,r){const o=this.mu2rad(e),s=this.mu2rad(t),i=this.zoom2WidthMU(r),a=this.mapWidth2SphereHeight(i);return[a*Math.cos(s)*Math.sin(o),a*Math.sin(s),a*Math.cos(s)*Math.cos(o)]}xyz2LonLatZoom(e,t,r){const o=Math.asin(t/ms([e,t,r])),s=Math.asin(e/ms([e,r])),i=180*o/Math.PI;let a=180*s/Math.PI;return r<=0&&(a=180-a),[a,i,this.spherePos2zoom(e,t,r)]}mu2rad(e){return bs(e)}rad2mu(e){return e%(2*Math.PI)*360/(2*Math.PI)}}class fs extends hs.J{constructor(e,t){const r=new hs.f(e);super(t,new hs.fb({vertexShader:"\n        varying vec2 vUv;\n        uniform vec4 bbox;\n        uniform vec2 textureSize;\n\n        vec2 positionToLonLat(vec3 position) {\n          float pi = 3.141592653589793;\n\n          float latRad = asin(position.y / length(position));\n          float latDeg = 180.0 * latRad / pi;\n\n          float lonRad = asin(position.x / length(position.xz));\n          float lonDeg = 180.0 * lonRad / pi;\n          if (position.z <= 0.0) {\n            lonDeg = 180.0 - lonDeg;\n          }\n          return vec2(lonDeg, latDeg);\n        }\n\n        void main() {\n          vec2 lonLat = positionToLonLat(position);\n          float u = (lonLat.x - bbox.x) / (bbox.z - bbox.x);\n          float v = (lonLat.y - bbox.y) / (bbox.w - bbox.y);\n          if  (u < 0.0) {\n            u = ((360.0 + lonLat.x) - bbox.x) / (bbox.z - bbox.x);\n          }\n          if (u > 1.0) {\n            u = ((lonLat.x - 360.0) - bbox.x) / (bbox.z - bbox.x);\n          }\n          vUv = vec2(u, v);\n          gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\n        }\n        ",fragmentShader:"\n        uniform sampler2D texture1;\n        varying vec2 vUv;\n\n        void main() {\n          gl_FragColor = texture2D(texture1, vUv);\n          if (vUv.x > 1.0 || vUv.x < 0.0 || vUv.y > 1.0 || vUv.y < 0.0) {\n            gl_FragColor = vec4(0.3, 0.3, 0.3, 1.0); // <-- better: retrieve texture2D from *previous* texture.\n          }\n        }\n        ",uniforms:{texture1:{value:r},bbox:{value:[-180,-90,180,90]}}}))}perspectiveChanged(e){this.material.uniforms.bbox.value=e,this.material.uniforms.texture1.value.needsUpdate=!0}}let vs=(()=>{class e{constructor(e,t){this.mapStateSvc=e,this.zone=t,this.subs=[],this.needsResize=!1}initScene(e,t,r){const o=new hs.ub({alpha:!0,antialias:!0,canvas:e});o.setSize(e.clientWidth,e.clientHeight,!1);const s=new hs.eb,i=new hs.V(50,e.clientWidth/e.clientHeight,.01,1e5);i.lookAt(0,0,0),i.position.set(-40,40,40);const a=new ds.a(i,o.domElement),n=(new hs.i).load(new Array(6).fill("assets/images/zpos.png"));s.background=n;const c=document.createElement("canvas");!function(e,t,r,o=!1){const s=t.getContext("2d");if(!s)throw new Error("The target-canvas needs to use a 2d-context.");if(!t.width||!t.height)throw new Error("TargetCanvas: width or height have not been set.");s.clearRect(0,0,t.width,t.height);const i=e.getSize();e.getView().getResolution(),t.width=i[0],t.height=i[1];const a=xe(e.getLayers().getArray()),n=[];for(const c of a)if(c.getVisible()&&c.getOpacity()>0){const e=c.on("postrender",e=>{const r=e.context.canvas;s.drawImage(r,0,0,r.clientWidth,r.clientHeight,0,0,t.width,t.height)});Array.isArray(e)?e.map(e=>n.push(e)):n.push(e)}o?e.on("rendercomplete",e=>{r(t)}):e.once("rendercomplete",e=>{for(const t of n)Object(Se.b)(t);r(t)}),e.renderSync()}(r,c,()=>{},!0);const l=new fs(c,t.geometry);s.add(l);const p=new gs(360/(2*Math.PI),15,50);r.on("postrender",e=>{const t=r.getView().calculateExtent(r.getSize()),[o,s]=r.getView().getCenter(),a=r.getView().getZoom();l.perspectiveChanged(t);const[n,c,u]=p.lonLatZoom2XYZ(o,s,a);i.position.set(n,c,u),i.lookAt(0,0,0)}),a.addEventListener("change",e=>{const t=i.position,[r,o,s]=p.xyz2LonLatZoom(t.x,t.y,t.z);this.mapStateSvc.setMapState({center:{lon:r,lat:o},zoom:s})}),this.zone.runOutsideAngular(()=>{!function(e,t){let r,o,s,i=33.333333333333336;const a=()=>{r=window.performance.now(),t(),o=window.performance.now(),i=o-r,s=Math.max(33.333333333333336-i,0),setTimeout(()=>{requestAnimationFrame(a)},s)};a()}(0,t=>{this.needsResize&&(e.clientHeight===e.height&&e.clientWidth===e.width||(o.setSize(e.clientWidth,e.clientHeight,!1),i.aspect=e.clientWidth/e.clientHeight,i.updateProjectionMatrix()),this.needsResize=!1),o.render(s,i)})})}onResize(e){this.needsResize=!0}ngOnDestroy(){this.subs.map(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(E),s.Ub(s.A))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ws=r("NK00");const Ss=["threeCanvas"];let xs=(()=>{class e{constructor(e){this.mapThreeSvc=e,this.modelFilePath="https://solarsystem.nasa.gov/system/resources/gltf_files/2358_Phobos_1_1000.glb",this.modelName="phobos"}ngOnInit(){}ngAfterViewInit(){new Promise(e=>{(new ws.a).load(this.modelFilePath,t=>{const r=t.scene.getObjectByName(this.modelName);if(!r)throw new Error(`No object named ${this.modelName} in glb!`);e(r)})}).then(e=>{this.mapThreeSvc.initScene(this.threeCanvas.nativeElement,e,this.mapOlSvc.map)})}onResize(e){this.mapThreeSvc.onResize(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(vs))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-map-three"]],viewQuery:function(e,t){if(1&e&&s.Dc(Ss,1),2&e){let e;s.kc(e=s.Yb())&&(t.threeCanvas=e.first)}},hostBindings:function(e,t){1&e&&s.Xb("resize",function(e){return t.onResize(e)},!1,s.oc)},inputs:{mapOlSvc:"mapOlSvc",modelFilePath:"modelFilePath",modelName:"modelName"},decls:2,vars:0,consts:[["id","threeCanvas",1,"threeCanvas"],["threeCanvas",""]],template:function(e,t){1&e&&s.Lb(0,"canvas",0,1)},styles:[".threeCanvas[_ngcontent-%COMP%]{width:100%;height:100%;margin:0;display:block}"]}),e})(),Ps=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({imports:[[]]}),e})();class _s extends Z.a{constructor(e){super(e)}createRenderer(){return new Ls(this)}}class Ls extends Pe.a{constructor(e){super(e);const t=document.createElement("canvas");t.width=800,t.height=600,t.style.position="absolute";const r=e.getSource().getFeatures(),o=this.featuresToMeshes(r),s=new hs.ub({canvas:t,alpha:!0}),i=new hs.V(45,t.width/t.height,.01,3e7);i.position.set(0,0,10),i.lookAt(new hs.sb(0,0,0));const a=new hs.eb;for(const c of o)a.add(c);const n=new hs.j(16777215,1);n.position.set(-1,2,4),a.add(n),this.canvas=t,this.scene=a,this.meshes=o,this.renderer=s,this.camera=i}prepareFrame(e){const t=e.pixelRatio,r=e.size,o=Math.round(r[0]*t),s=Math.round(r[1]*t),i=e.viewState.center,a=this.extent2Height(e.extent,45);return this.camera.aspect=o/s,this.camera.fov=45,this.camera.near=.01,this.camera.far=3e8,this.camera.position.set(i[0],i[1],a),this.camera.lookAt(new hs.sb(i[0],i[1],0)),this.camera.updateProjectionMatrix(),r[0]===this.canvas.width&&r[1]===this.canvas.height||(this.canvas.width=r[0],this.canvas.height=r[1],this.renderer.setSize(this.canvas.width,this.canvas.height)),this.canvas.style.opacity=""+e.layerStatesArray[e.layerIndex].opacity,!0}renderFrame(e,t){return this.renderer.render(this.scene,this.camera),this.canvas}renderDeclutter(e){}featuresToMeshes(e){const t=[];for(const r of e){const e=r.getGeometry(),o=r.get("height"),s=this.fGeom2tGeom(e,.1*o),i=new hs.h(16777215);i.setHex(16777215*Math.random());const a=new hs.L({color:i}),n=new hs.J(s,a);t.push(n)}return t}fGeom2tGeom(e,t){const r=e.getCoordinates()[0],o=new hs.gb;o.moveTo(r[0][0],r[0][1]);for(let s=1;s<r.length;s++){const e=r[s];o.lineTo(e[0],e[1])}return new hs.m(o,{depth:t,bevelEnabled:!1})}extent2Height(e,t){return ys(e[3]-e[1],t)}}function Es(e,t){if(1&e&&(s.Qb(0,"li"),s.yc(1),s.Pb()),2&e){const e=t.$implicit,r=s.Zb();s.zb(1),s.Bc(" ",e,": ",r.group[e]||"undefined"," ")}}let Os=(()=>{class e{constructor(e){this.layersSvc=e}ngOnInit(){this.groupkeys=["bbox","cssClass","displayName","filtertype","id","name","removable"]}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-example-group-action"]],inputs:{group:"group"},decls:5,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Qb(0,"div"),s.Qb(1,"span"),s.yc(2,"some properties of the group:"),s.Pb(),s.Qb(3,"ul"),s.wc(4,Es,2,2,"li",0),s.Pb(),s.Pb()),2&e&&(s.zb(4),s.fc("ngForOf",t.groupkeys))},directives:[bt.m],styles:[""]}),e})(),Ts=(()=>{class e{constructor(e,t,r){this.layersSvc=e,this.mapStateSvc=t,this.mapSvc=r,this.class="content-container",this.test=[],this.inputValue={value:15},this.controls={attribution:!0,scaleLine:!0,overviewMap:!0}}ngOnInit(){this.addLayers()}setInput(){const e=this.layersSvc.getLayerById("heatmap_layer");this.inputValue.value=40,e.action.inputs=this.inputValue,e.action=Object.assign({},e.action)}addLayers(){const e=new O({id:"OSM1",visible:!1}),t=new g({id:"heatmap_layer",name:"Heatmap Layer",actions:[{title:"test",icon:"",action:e=>{}}],action:{component:is,inputs:this.inputValue,outputs:{valueChange:e=>{this.inputValue.value=e}}},custom_layer:new Jo.a({source:new te.a({features:this.mapSvc.geoJsonToFeatures(ns),format:new ie.a}),radius:this.inputValue.value}),visible:!1}),r=new y({id:"Vector Layer1",name:"Vector Layer",type:"geojson",data:ns,visible:!0,popup:{single:!0}}),o=new g({id:"Layer_KML",name:"KML - VectorLayer",popup:!0,custom_layer:new Z.a({source:new te.a({url:"assets/data/kml/TimeZones.kml",format:new rs.a({extractStyles:!0})})}),visible:!1,bbox:[-180,-90,180,90]}),s=new g({id:"topo_json_layer",name:"Topo Json - VectorImageLayer",popup:{event:"move"},custom_layer:new Wo.a({source:new te.a({url:"https://openlayers.org/en/latest/examples/data/topojson/world-110m.json",format:new os.a({layers:["countries"]}),overlaps:!1}),style:(e,t)=>(Object(ve.c)(e),[new de.b({stroke:new ge.a({color:"gray",width:1}),fill:new be.a({color:"rgba(0, 153, 255, 0.2)"})})])}),visible:!1}),i=new g({id:"geo_json_layer_ocean",name:"GeoJson - VectorImageLayer ocean",popup:{event:"move"},custom_layer:new Wo.a({source:new te.a({features:this.mapSvc.geoJsonToFeatures(qo)}),style:(e,t)=>new de.b({stroke:new ge.a({color:"gray",width:1}),fill:new be.a({color:"rgba(20,20,20,0.9)"})})}),visible:!1,bbox:[-180.35156249999997,-22.268764039073968,-129.375,29.84064389983441]}),a=new g({id:"static_image_layer",name:"Static Image",visible:!1,popup:{filterkeys:["id","color","name"]},custom_layer:new _e.a({source:new q.a({url:"assets/images/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326",crossOrigin:"anonymous"})})}),n=new g({id:"osm_clip_layer",name:"OSM Clip",visible:!1,popup:{filterkeys:["id","color","name"]},custom_layer:new W.a({source:new dt.a}),bbox:[-105.41888884797893,6.480590573390401,-15.540298246016693,42.53496284727569]}),c=new g({id:"customLayerOlGroup",name:"Custom Layer OlGroup",visible:!1,popup:!0,custom_layer:new Q.a({layers:[new W.a({source:new Y.a({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"litemap",TILED:!0},serverType:"geoserver",transition:0})}),new W.a({source:new Y.a({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"liteoverlay",TILED:!0},serverType:"geoserver",transition:0})})]})}),l=new g({id:"clusterLayer",name:"cluster Layer - VectorLayer",visible:!1,popup:!0,custom_layer:new Z.a({source:new oe.a({distance:10,source:new te.a({features:this.mapSvc.geoJsonToFeatures(ns)})})})}),p=new g({id:"vectorTile",name:"VectorTileLayer",visible:!0,popup:{event:"move",filterkeys:["name","region_un","region_wb"],properties:{name:"Name"},options:{autoPan:!1}},custom_layer:new es.a({source:new $.a({format:new ss.a,url:"https://tiles.geoservice.dlr.de/service/tms/1.0.0/eoc:litemap@EPSG%3A3857@pbf/{z}/{x}/{-y}.pbf"}),style:(e,t)=>{const r=e.get("layer");if(this.test.includes(r)||this.test.push(r),r&&("ne_50m_land"===r||"ne_50m_admin_0_countries"===r||"ne_10m_admin_0_countries"===r))return new de.b({stroke:new ge.a({color:"gray",width:1}),fill:new be.a({color:"rgba(20,20,20,0.9)"})})}})}),u=new f({name:"Heatmap Group",filtertype:"Layers",id:"group1",layers:[t,r],description:"This is a custom layer group with some custom angular components in the UI",action:{component:Os}}),h=new g({id:"image_wms",name:"Image WMS",custom_layer:new _e.a({source:new X.a({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"})}),visible:!1,popup:{filterkeys:["id","color","name"]},bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),d=new g({id:"dtmLayer",name:"SRTM DTM",filtertype:"Layers",custom_layer:new Ue({source:new q.a({url:"assets/images/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326"})}),action:{component:ps,inputs:{changeHandler:(e,t)=>{d.custom_layer.updateSunAngle([e,t])}}},opacity:.6,visible:!1,description:"<p>This layer uses SRTM data to calculate surface-normals and uses them to dynamically create shades on hilltops. Things like these might be a nice illustration for time-enabled maps.</p>\n      <p>Use the controls to dynamically change the sun's angle.</p>"}),b=this.mapSvc.getProjection().getMetersPerUnit(),v=new ae.a({code:"EPSG:4326",units:"degrees"}).getMetersPerUnit();as.features.map(e=>e.properties.height=e.properties.height*v/b);const w=new g({id:"three",name:"Bars layer",custom_layer:new _s({source:new te.a({features:this.mapSvc.geoJsonToFeatures(as)})}),filtertype:"Layers",opacity:.7,visible:!1,description:"<p>This layer demonstrates how a common 3d-library, three.js, can be integrated in a 2d-map. Using three.js often yields less verbose code than calling WebGL directly.</p>"}),S=new te.a({features:this.mapSvc.geoJsonToFeatures(ls)}),x=new oe.a({source:S,distance:25}),P=new g({id:"interpolation",name:"Interpolation",custom_layer:new He({source:x,style:(e,t)=>{const r=e.getProperties().features;let o;return o=r.length>1?`${e.getProperties().features.length}`:`${Number.parseFloat(r[0].getProperties().SWH).toPrecision(3)}`,new de.b({image:new ye.a({radius:13,fill:new be.a({color:"rgba(0, 153, 255, 0.2)"}),stroke:new ge.a({color:"rgba(255, 255, 255, 0.2)",width:1})}),text:new me.a({text:o,overflow:!0,offsetX:-5*o.length/2,offsetY:1,textAlign:"left",fill:new be.a({color:"#ffffff"})})})},renderSettings:{maxEdgeLength:15e3/b,power:2,colorRamp:[{val:0,rgb:[166,97,26]},{val:.4,rgb:[223,194,125]},{val:.8,rgb:[247,247,247]},{val:2,rgb:[128,205,193]},{val:22.5,rgb:[1,133,113]}],smooth:!0,showLabels:!1,valueProperty:"SWH",storeInterpolatedPixelData:!1}}),action:{component:us,inputs:{changeHandler:(e,t,r)=>{P.custom_layer.updateParas(e,t,r)}}},filtertype:"Layers",opacity:.7,visible:!1,description:"This layer is an example of how WebGL can be used to outsource computationally expensive operations. For inverse-distance interpolation we need to account for every datapoint at every pixel."}),_=new f({name:"Webgl Group",filtertype:"Layers",id:"group2",layers:[d,w,P]});[new g({name:"Transparenter Hintergrund",id:"blank",type:"custom",visible:!1,custom_layer:new _e.a({source:new ts.a({canvasFunction:()=>document.createElement("canvas")})})}),e,p,u,_,l,h,o,a,n,s,i,c].forEach(e=>{e instanceof m?this.layersSvc.addLayer(e,"Layers"):e instanceof f&&this.layersSvc.addLayerGroup(e)})}ngAfterViewInit(){const e=new y({id:"Vector Layer2",name:"async add Layer",type:"geojson",data:cs,visible:!1,popup:!0});setTimeout(()=>{this.layersSvc.addLayer(e,"Layers")},2e3)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E),s.Kb(st))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map4"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:15,vars:10,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","set input of dynamic component from parent when it is created or the input changed",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Layers "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",3),s.Lb(9,"clr-icon",4),s.yc(10," Test to set dynamic component "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Qb(12,"button",7),s.Xb("click",function(){return t.setInput()}),s.yc(13,"Set Heatmap Layer radius"),s.Pb(),s.yc(14),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(6),s.Ac(" ",t.inputValue.value," "))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io],styles:[""]}),e})();function Cs(e,t){if(1&e&&(s.Qb(0,"tr"),s.Qb(1,"td",16),s.yc(2),s.Pb(),s.Qb(3,"td"),s.yc(4),s.Pb(),s.Qb(5,"td"),s.yc(6),s.Pb(),s.Qb(7,"td"),s.yc(8),s.Pb(),s.Pb()),2&e){const e=t.$implicit;s.zb(2),s.zc(e.properties.title),s.zb(2),s.zc(e.properties.foo),s.zb(2),s.zc(e.properties.bar),s.zb(2),s.zc(e.properties.baz)}}function Is(e,t){if(1&e&&(s.Qb(0,"table",15),s.Qb(1,"thead"),s.Qb(2,"tr"),s.Qb(3,"th",16),s.yc(4,"Title"),s.Pb(),s.Qb(5,"th"),s.yc(6,"Foo"),s.Pb(),s.Qb(7,"th"),s.yc(8,"Bar"),s.Pb(),s.Qb(9,"th"),s.yc(10,"Baz"),s.Pb(),s.Pb(),s.Pb(),s.Qb(11,"tbody"),s.wc(12,Cs,9,4,"tr",17),s.Pb(),s.Pb()),2&e){const e=s.Zb();s.zb(12),s.fc("ngForOf",e.geojsonData.features)}}const Rs=function(){return{height:"95%"}},ks=function(){return{height:"5%"}};let Fs=(()=>{class e{constructor(e,t){this.layersSvc=e,this.mapStateSvc=t,this.class="content-container",this.showTable=!1,this.subs=[],this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.addBaseLayers(),this.addLayers(),this.addOverlays(),this.mapStateSvc.setExtent([-14,33,40,57]),this.checkVisibleLayers()}addBaseLayers(){[new C({visible:!0}),new G].map(e=>this.layersSvc.addLayer(e,"Baselayers"))}addLayers(){this.geojsonData={type:"FeatureCollection",features:[{type:"Feature",properties:{title:"Polygon",foo:"1",bar:"test",baz:"555"},geometry:{type:"Polygon",coordinates:[[[11.53564453125,48.80686346108517],[11.42578125,48.61838518688487],[11.97509765625,48.516604348867475],[12.2607421875,48.69096039092549],[12.0849609375,48.99463598353405],[11.53564453125,48.80686346108517]]]}},{type:"Feature",properties:{title:"Rectangle",foo:"2",bar:"test2",baz:"66667"},geometry:{type:"Polygon",coordinates:[[[10.986328125,43.89789239125797],[11.755371093749998,43.89789239125797],[11.755371093749998,44.41808794374846],[10.986328125,44.41808794374846],[10.986328125,43.89789239125797]]]}},{type:"Feature",properties:{title:"Line",foo:"3",bar:"test3",baz:"111"},geometry:{type:"LineString",coordinates:[[13.29345703125,48.268569112964336],[15.073242187499998,47.56170075451973],[14.1064453125,46.40756396630067],[15.886230468750002,44.94924926661153]]}},{type:"Feature",properties:{title:"Point",foo:"4",bar:"test4",baz:"444"},geometry:{type:"Point",coordinates:[11.513671874999998,46.42271253466717]}}]};const e=new y({id:"geojson_test",name:"GeoJSON Vector Layer",type:"geojson",data:this.geojsonData,visible:!1,popup:!0});this.layersSvc.addLayer(e,"Layers")}checkVisibleLayers(){const e=this.layersSvc.getLayers().subscribe(e=>{e.map(e=>{e&&("geojson_test"===e.id&&!0===e.visible?this.showTable=!0:"geojson_test"===e.id&&!1===e.visible&&(this.showTable=!1))})});this.subs.push(e)}addOverlays(){const e=new R;this.layersSvc.addLayer(e,"Overlays")}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map5"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:27,vars:22,consts:[[1,"content-area",3,"ngStyle"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","world","title","Overlays","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc","layerfilter"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""],[3,"clrVerticalNavCollapsible"],[3,"clrVerticalNavGroupExpanded"],["shape","table","title","Overlays","clrVerticalNavIcon",""],["class","table",4,"ngIf"],[1,"footer","ukis-footer",3,"ngStyle"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Overlays "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",3),s.Lb(9,"clr-icon",7),s.yc(10," Layers "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-layer-control",8),s.Pb(),s.Pb(),s.Qb(13,"clr-vertical-nav-group",3),s.Lb(14,"clr-icon",9),s.yc(15," Baselayers "),s.Qb(16,"clr-vertical-nav-group-children",5),s.Lb(17,"ukis-base-layer-control",8),s.Pb(),s.Pb(),s.Pb(),s.Qb(18,"clr-vertical-nav",10),s.Qb(19,"clr-vertical-nav-group",11),s.Lb(20,"clr-icon",12),s.yc(21," Table "),s.Qb(22,"clr-vertical-nav-group-children",5),s.wc(23,Is,13,1,"table",13),s.Pb(),s.Pb(),s.Pb(),s.Qb(24,"div",14),s.Qb(25,"p"),s.yc(26,"this is the footer"),s.Pb(),s.Pb()),2&e&&(s.fc("ngStyle",s.ic(20,Rs)),s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc)("layerfilter","Overlays"),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavCollapsible",!0),s.zb(1),s.fc("clrVerticalNavGroupExpanded",t.showTable),s.zb(4),s.fc("ngIf",t.showTable),s.zb(1),s.fc("ngStyle",s.ic(21,ks)))},directives:[bt.o,ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io,Mo,bt.n,bt.m],styles:[".content-container[_nghost-%COMP%]   .ukis-footer[_ngcontent-%COMP%], .content-container   [_nghost-%COMP%]   .ukis-footer[_ngcontent-%COMP%]{padding:0 1rem}"]}),e})();function Ms(e,t){if(1&e&&(s.Qb(0,"tr"),s.Qb(1,"th"),s.yc(2),s.Pb(),s.Qb(3,"td"),s.yc(4),s.Pb(),s.Pb()),2&e){const e=t.$implicit;s.zb(2),s.zc(e.key),s.zb(2),s.zc(e.value)}}function Gs(e,t){if(1&e&&(s.Qb(0,"tbody"),s.wc(1,Ms,5,2,"tr",3),s.ac(2,"keyvalue"),s.Pb()),2&e){const e=t.ngIf;s.zb(1),s.fc("ngForOf",s.bc(2,1,e))}}function As(e,t){1&e&&(s.Qb(0,"clr-spinner",4),s.yc(1,"Loading ..."),s.Pb()),2&e&&s.fc("clrInline",!0)}let js=(()=>{class e{constructor(e){this.http=e}ngOnInit(){this.data$=this.getFeatureInfo().pipe(Object(_.a)(e=>e.features[0].properties))}getFeatureInfo(){const e=this.layer.getSource().getFeatureInfoUrl(this.event.coordinate,this.event.frameState.viewState.resolution,this.event.frameState.viewState.projection.getCode(),{INFO_FORMAT:"application/json"});return console.log("getting",e),this.http.get(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(Tt.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-raster-feature-info"]],inputs:{layer:"layer",event:"event"},decls:7,vars:4,consts:[[1,"table","table-vertical"],[4,"ngIf","ngIfElse"],["loading",""],[4,"ngFor","ngForOf"],[3,"clrInline"]],template:function(e,t){if(1&e&&(s.Qb(0,"table",0),s.Qb(1,"caption"),s.yc(2," Feature properties "),s.Pb(),s.wc(3,Gs,3,3,"tbody",1),s.ac(4,"async"),s.Pb(),s.wc(5,As,2,1,"ng-template",null,2,s.xc)),2&e){const e=s.lc(6);s.zb(3),s.fc("ngIf",s.bc(4,2,t.data$))("ngIfElse",e)}},directives:[bt.n,bt.m,Pt.B],pipes:[bt.b,bt.h],styles:[""]}),e})(),Ds=(()=>{class e{constructor(e,t){this.layersSvc=e,this.mapStateSvc=t,this.class="content-container",this.subs=[],this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.addBaseLayers(),this.addLayers(),this.mapStateSvc.setExtent([9.681317514755053,47.425291526740125,12.765729135848805,49.213103602937025]),this.layersSvc.getLayers().subscribe(e=>console.log("layers are now ",e))}addBaseLayers(){const e=new C({visible:!0,tileSize:512});this.layersSvc.addLayer(e,"Baselayers")}addLayers(){const e=new v({type:"wmts",id:"TDM90_AMP",visible:!1,url:"https://tiles.geoservice.dlr.de/service/wmts?",name:"TDM90_AMP",filtertype:"Layers",attribution:'| TDM90 Data &copy; <a href="http://www.dlr.de" target="_blank">DLR</a> licensed for <a rel="license" target="_blank" href="https://geoservice.dlr.de/resources/licenses/tdm90/License_for_the_Utilization_of_90m_DEM_for_Scientific_Use.pdf">scientific use</a>',params:{layer:"TDM90_AMP",version:"1.1.0",format:"image/png",style:"default",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},styles:[{default:!0,name:"default",title:"default"},{default:!1,name:"none",title:"none"}]});this.layersSvc.addLayer(e,e.filtertype);const t=new w({type:"wms",id:"S2_L3A_WASP_FRC_P1M",url:"https://{s}.geoservice.dlr.de/eoc/imagery/wms?",name:"S2_L3A_WASP_FRC_P1M",subdomains:["a","b","c","d"],filtertype:"Layers",attribution:'| &copy; <a href="http://www.dlr.de" target="_blank">DLR</a> Contains modified Copernicus Sentinel Data [2020]',params:{LAYERS:"S2_L3A_WASP_FRC_P1M",VERSION:"1.1.0",FORMAT:"image/png"},styles:[{default:!0,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-ndvi",title:"NDVI"},{default:!1,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-infrared",title:"Infrared (8,4,3)"},{default:!1,legendURL:"https://geoservice.dlr.de/eoc/imagery/wms?service=WMS&request=GetLegendGraphic&format=image/png&width=20&height=20&layer=land:S2_L3A_WASP_FRC_P1M",name:"s2-l3a-wasp-frc",title:"Style for L3A MAJA/WASP Ground Reflectances"}],popup:{dynamicPopup:{component:js,getAttributes:e=>({layer:e.layer,event:e.event})}}});this.layersSvc.addLayer(t,t.filtertype)}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map6"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:13,vars:11,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["shape","world","title","Baselayers","clrVerticalNavIcon",""]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Layers "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-layer-control",6),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",3),s.Lb(9,"clr-icon",7),s.yc(10," Baselayers "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-base-layer-control",6),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Io,Mo],styles:[""]}),e})();function zs(e,t){1&e&&(s.Qb(0,"clr-signpost-content"),s.Qb(1,"h3"),s.yc(2,"Licenses setup"),s.Pb(),s.Qb(3,"p"),s.yc(4,"This component expects a "),s.Qb(5,"code"),s.yc(6,"assets/licenses.json"),s.Pb(),s.yc(7," file to be present in the project bundle."),s.Pb(),s.Qb(8,"p"),s.yc(9,"That file was created with the following command:"),s.Pb(),s.Qb(10,"code"),s.yc(11," cd ./frontend-libraries npm install -g license-checker npx license-checker --json --out ./dist/demo-maps/assets "),s.Pb(),s.yc(12," You might want to add this command to the build-process by adding a "),s.Qb(13,"code"),s.yc(14,'"postbuild"'),s.Pb(),s.yc(15," task to your package.json. "),s.Pb())}function Qs(e,t){if(1&e&&(s.Qb(0,"clr-dg-row"),s.Qb(1,"clr-dg-cell"),s.yc(2),s.Pb(),s.Qb(3,"clr-dg-cell"),s.yc(4),s.Pb(),s.Qb(5,"clr-dg-cell"),s.yc(6),s.Pb(),s.Qb(7,"clr-dg-cell"),s.Qb(8,"a",4),s.yc(9),s.Pb(),s.Pb(),s.Pb()),2&e){const e=t.$implicit;s.zb(2),s.zc(e.name),s.zb(2),s.zc(e.publisher),s.zb(2),s.zc(e.license),s.zb(2),s.gc("href",e.repository,s.rc),s.zb(1),s.zc(e.repository)}}function Vs(e,t){if(1&e&&(s.Ob(0),s.wc(1,Qs,10,5,"clr-dg-row",3),s.Qb(2,"clr-dg-footer"),s.yc(3),s.Pb(),s.Nb()),2&e){const e=t.ngIf;s.zb(1),s.fc("ngForOf",e),s.zb(2),s.Ac("",e.length," third party dependencies")}}let Ns=(()=>{class e{constructor(e){this.http=e,this.class="content-container"}ngOnInit(){this.licenses$=this.http.get("assets/licenses.json").pipe(Object(_.a)(e=>{const t=[];for(const r in e)if(e[r]){const o=e[r];t.push({name:r,license:o.licenses,repository:o.repository,publisher:o.publisher})}return t}))}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(Tt.a))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-licenses"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},decls:18,vars:3,consts:[[1,"content-area","licenses"],[4,"clrIfOpen"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Qb(1,"p"),s.yc(2,"A lot of third party libraries were used to create this project. Their licenses are listed here."),s.Pb(),s.Qb(3,"p"),s.yc(4,"For more information, click here: "),s.Qb(5,"clr-signpost"),s.wc(6,zs,16,0,"clr-signpost-content",1),s.Pb(),s.Pb(),s.Qb(7,"clr-datagrid"),s.Qb(8,"clr-dg-column"),s.yc(9,"Library name"),s.Pb(),s.Qb(10,"clr-dg-column"),s.yc(11,"Publisher"),s.Pb(),s.Qb(12,"clr-dg-column"),s.yc(13,"License"),s.Pb(),s.Qb(14,"clr-dg-column"),s.yc(15,"Repository"),s.Pb(),s.wc(16,Vs,4,2,"ng-container",2),s.ac(17,"async"),s.Pb(),s.Pb()),2&e&&(s.zb(16),s.fc("ngIf",s.bc(17,1,t.licenses$)))},directives:[Pt.z,Pt.o,Pt.g,Pt.L,Pt.N,Pt.I,Pt.O,Pt.i,Pt.K,bt.n,Pt.A,bt.m,Pt.j,Pt.k,Pt.M,Pt.h,Pt.J],pipes:[bt.b],styles:[".content-area.licenses[_ngcontent-%COMP%]{padding:1em}"]}),e})();var Bs=r("1X1q");let Us=(()=>{class e{constructor(e,t){this.http=e,this.olSvc=t,le.a.defs("EPSG:2966","+proj=tmerc +lat_0=37.5 +lon_0=-87.08333333333333 +k=0.999966667 +x_0=900000 +y_0=249999.9998983998 +datum=NAD83 +units=us-ft +no_defs"),Object(ce.a)(le.a);const r=Object(ne.i)("EPSG:2966");Object(ne.k)(r,"EPSG:4326"),this.geojson2966To4326=new ie.a({dataProjection:"EPSG:2966",featureProjection:"EPSG:4326"}),this.geojson4326=new ie.a({featureProjection:"EPSG:4326"})}getWfsSource(e){switch(e){case"all":return new te.a({format:new ie.a,url:this.getRequestUrl(this.olSvc.EPSG),strategy:Bs.a});case"bbox":return new te.a({format:new ie.a,url:(e,t,r)=>{const o=r.getCode();return this.getRequestUrl(o,e)},strategy:Bs.b});case"simplifyGeometry":const e=new te.a({loader:(t,r,o)=>{const s=o.getCode();this.http.get(this.getRequestUrl(s,t)).subscribe(t=>{const r=(new ie.a).readFeatures(t);for(const e of r)e.geometry=e.getGeometry().simplify(1e3);e.addFeatures(r)})},strategy:Bs.b});return e;case"noProps":const t=new te.a({loader:(e,r,o)=>{const s=o.getCode();this.http.get(this.getRequestUrl(s,e)).subscribe(e=>{const r=(new ie.a).readFeatures(e);for(const t of r)t.setProperties({});t.addFeatures(r)})},strategy:Bs.b});return t;case"tile":throw new Error("Tile-Strategy source not yet implemented.")}}getRequestUrl(e,t){e||(e="EPSG:4326");let r="https://ahocevar.com/geoserver/wfs?service=WFS&version=1.1.0&request=GetFeature";return r+=`&outputFormat=application/json&srsname=${e}`,r+="&typename=osm:water_areas",t&&(r+=`&bbox=${t.join(",")},${e}`),r}createWfsLayer(e,t,r,o){const s=this.getWfsSource(r),i=new Z.a({source:s,style:o});return new g({id:e,name:t,custom_layer:i,popup:!0,visible:!1})}createVectorTileLayer(e,t){const r=new $.a({format:new ss.a,url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:4326@pbf/{z}/{x}/{-y}.pbf"}),o=new es.a({source:r});return new g({id:e,name:t,custom_layer:o,popup:!0,visible:!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(Tt.a),s.Ub(st))},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ws(e,t){1&e&&(s.Qb(0,"clr-signpost-content",4),s.Qb(1,"h3"),s.yc(2,"Change detection"),s.Pb(),s.Qb(3,"p"),s.yc(4,"This badge changes its color any time angular's change-detection was executed."),s.Pb(),s.Pb()),2&e&&s.fc("clrPosition","left-middle")}let Zs=(()=>{class e{constructor(){this.color="white"}ngAfterContentChecked(){this.color=this.getRandomColor()}getRandomColor(){let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-blinker"]],decls:6,vars:2,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,t){1&e&&(s.Qb(0,"p",0),s.Qb(1,"clr-signpost"),s.wc(2,Ws,5,1,"clr-signpost-content",1),s.Pb(),s.Qb(3,"span",2),s.yc(4," Change detected "),s.Lb(5,"span",3),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.tc("background-color",t.color))},directives:[Pt.z,Pt.o,Pt.A],styles:[".blinker[_ngcontent-%COMP%]{width:10px;height:10px}"]}),e})();var $s=r("mrSG");function Hs(e){return Object($s.a)(this,void 0,void 0,function*(){return Xs(function(){return Object($s.a)(this,void 0,void 0,function*(){return new Promise((e,t)=>{const r=window.performance.now();setTimeout(()=>{const t=window.performance.now();e(1e3/(t-r))},0)})})}(),e,[]).then(e=>{return function(e){let t=0;for(const r of e)t+=r;return t}(t=e)/t.length;var t})})}function Xs(e,t,r){return Object($s.a)(this,void 0,void 0,function*(){return e.then(o=>(r.push(o),t>1?Xs(e,t-1,r):r))})}function qs(e,t){1&e&&(s.Qb(0,"clr-signpost-content",4),s.Qb(1,"h3"),s.yc(2,"Frames per second"),s.Pb(),s.Qb(3,"p"),s.yc(4,"Estimates the number of frames that are rendered per second."),s.Pb(),s.Qb(5,"p"),s.yc(6,"This is done by periodically measuring the time a call to "),s.Qb(7,"code"),s.yc(8,"setTimeout(() => ..., 0)"),s.Pb(),s.yc(9," takes."),s.Pb(),s.Qb(10,"p"),s.yc(11,"That call is made outside the angular-zone, so as not to trigger change-detection."),s.Pb(),s.Qb(12,"p"),s.yc(13,"Please not that in Chrome you can also monitor FPS from the developer-tools: Hit "),s.Qb(14,"code"),s.yc(15,"ctrl-shift-p"),s.Pb(),s.yc(16," and enter "),s.Qb(17,"code"),s.yc(18,"fps"),s.Pb(),s.yc(19," to find the FPS-meter."),s.Pb(),s.Pb()),2&e&&s.fc("clrPosition","left-middle")}let Ys=(()=>{class e{constructor(e,t){this.ngZone=e,this.cdRef=t,this.pollingRate=1e3,this.precission=2,this.nrSamples=10,t.detach(),this.ngZone.runOutsideAngular(()=>{this.updateFps(this.pollingRate)})}updateFps(e){setTimeout(()=>{Hs(this.nrSamples).then(t=>{this.fps=function(e,t){const r=Math.pow(10,t);return Math.floor(e*r)/r}(t,this.precission),this.cdRef.detectChanges(),this.updateFps(e)})},e)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(s.A),s.Kb(s.h))},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-fpser"]],decls:7,vars:1,consts:[[2,"margin","0px"],[3,"clrPosition",4,"clrIfOpen"],[1,"label"],[1,"badge"],[3,"clrPosition"]],template:function(e,t){1&e&&(s.Qb(0,"p",0),s.Qb(1,"clr-signpost"),s.wc(2,qs,20,1,"clr-signpost-content",1),s.Pb(),s.Qb(3,"span",2),s.yc(4," FPS: "),s.Qb(5,"span",3),s.yc(6),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(6),s.zc(t.fps))},directives:[Pt.z,Pt.o,Pt.A],styles:[""]}),e})(),Ks=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-performance"]],decls:8,vars:0,consts:[[1,"clr-row"],[1,"clr-col-12"]],template:function(e,t){1&e&&(s.Qb(0,"p"),s.yc(1,"Load data and pan the map for a while to see a drop in performance."),s.Pb(),s.Qb(2,"div",0),s.Qb(3,"div",1),s.Lb(4,"ukis-blinker"),s.Pb(),s.Pb(),s.Qb(5,"div",0),s.Qb(6,"div",1),s.Lb(7,"ukis-fpser"),s.Pb(),s.Pb())},directives:[Zs,Ys],styles:[""]}),e})(),Js=(()=>{class e{constructor(e,t,r,o){this.layersSvc=e,this.dataSvc=t,this.mapStateSvc=r,this.mapSvc=o,this.class="content-container",this.controls={attribution:!0,scaleLine:!0}}ngOnInit(){this.mapSvc.setProjection("EPSG:4326");const e=(e,t)=>{const r=e.getId().match(/(\d+)/)[0],o=r%255,s=(r+20)%255,i=(r+40)%255;return new de.b({stroke:new ge.a({color:"gray",width:1}),fill:new be.a({color:`rgba(${o}, ${s}, ${i},0.7)`})})},t=new O({visible:!0}),r=this.dataSvc.createWfsLayer("full","Fully loaded","all",e);r.description="Full dataset loaded at once.";const o=this.dataSvc.createWfsLayer("bbx","Current extent only","bbox",e);o.description="Bbox strategy: Only current bbox loaded at a time.";const s=this.dataSvc.createWfsLayer("simple","Simplified geometry","simplifyGeometry",e);s.description="Bbox strategy. Also: geometry simplified.";const i=this.dataSvc.createWfsLayer("noProps","No properties","noProps",e);i.description="Bbox strategy. Also: features have no properties.";const a=this.dataSvc.createWfsLayer("noStyle","No Styling","bbox");a.description="Bbox strategy. Also: no styling applied to features.",[t,r,o,s,i,a].map(e=>this.layersSvc.addLayer(e,"Layers"))}ngAfterViewInit(){this.mapSvc.map.getView().fit([-107.14,51.85,-106.14,52.33],{size:this.mapSvc.map.getSize()})}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(Us),s.Kb(E),s.Kb(st))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-map7"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,E,st])],decls:13,vars:9,consts:[[1,"content-area"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","clock","title","Performance","clrVerticalNavIcon",""],[1,"padding","title-ellipsis"],["shape","layers","clrVerticalNavIcon","","title","layers"],[3,"layersSvc","mapStateSvc"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Lb(1,"ukis-map-ol",1),s.Pb(),s.Qb(2,"clr-vertical-nav",2),s.Qb(3,"clr-vertical-nav-group",3),s.Lb(4,"clr-icon",4),s.yc(5," Performance "),s.Qb(6,"clr-vertical-nav-group-children",5),s.Lb(7,"ukis-performance"),s.Pb(),s.Pb(),s.Qb(8,"clr-vertical-nav-group",3),s.Lb(9,"clr-icon",6),s.yc(10," Layers "),s.Qb(11,"clr-vertical-nav-group-children",5),s.Lb(12,"ukis-layer-control",7),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(5),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(4),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[ft,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Ks,Io],styles:[""]}),e})();var ei=r("cR4a");const ti=[{path:"",redirectTo:"example-layers",pathMatch:"full"},{path:"example-layers",component:Ao,data:{title:"Layers"}},{path:"example-projection",component:Uo,data:{title:"Projection"}},{path:"example-events",component:Ko,data:{title:"Events"}},{path:"example-custom-layers",component:Ts,data:{title:"Custom Layers"}},{path:"example-layout",component:Fs,data:{title:"Two Vertical-Nav Layout"}},{path:"example-layer-style",component:Ds,data:{title:"Switching Layer-Style"}},{path:"ol-performance",component:Js,data:{title:"Ol-Performance"}},{path:"threejs",component:(()=>{class e{constructor(e,t,r,o){this.layersSvc=e,this.mapStateSvc=t,this.mapOlSvc=r,this.mapThreeSvc=o,this.class="content-container",this.controls={attribution:!0,mousePosition:!0,scaleLine:!0,zoom:!0}}ngOnInit(){const e=new W.a({source:new Y.a({url:"https://planetarymaps.usgs.gov/cgi-bin/mapserv?map=/maps/mars/phobos_simp_cyl.map",params:{LAYERS:"VIKING"},crossOrigin:"anonymous"})}),t=new ei.a({showLabels:!0,wrapX:!0,latLabelPosition:.5}),r=new g({id:"phobos",name:"Phobos",custom_layer:e,description:"There are a few objects that are very big, but still irregularly shaped.\n      Because they are big, it makes sense to serve their image-material per WMTS instead of a single, humongous file.\n      Because they are irregularly shaped, it makes sense to display them in 3d.\n\n      This demo shows how we can project openlayers-layers onto a three-js mesh to reap the benefits of both libraries."}),o=new g({id:"graticule",name:"Graticule",custom_layer:t,description:"Note how adding and removing this layer is reflected in both the map and the 3d-object."});this.layersSvc.addLayer(r),this.layersSvc.addLayer(o)}ngAfterViewInit(){const e=Object(ne.i)("EPSG:4326");this.mapOlSvc.setProjection(e),this.mapOlSvc.map.getView().setMaxZoom(4)}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(x),s.Kb(E),s.Kb(st),s.Kb(vs))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-route-example-threejs"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Bb(t.class)},features:[s.yb([x,st])],decls:25,vars:10,consts:[[1,"content-area"],[2,"height","49.5%","width","100%"],["id","olMap",3,"layersSvc","mapState","controls"],[2,"height","50%","width","100%"],["id","threeMap",3,"mapOlSvc"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","info","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[1,"card",2,"margin","0px","margin-bottom","10px"],[1,"card-block"],[1,"card-text"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"alert-item","static"],[1,"alert-text"],[3,"layersSvc","mapStateSvc"]],template:function(e,t){1&e&&(s.Qb(0,"main",0),s.Qb(1,"div",1),s.Lb(2,"ukis-map-ol",2),s.Pb(),s.Qb(3,"div",3),s.Lb(4,"ukis-map-three",4),s.Pb(),s.Pb(),s.Qb(5,"clr-vertical-nav",5),s.Qb(6,"clr-vertical-nav-group",6),s.Lb(7,"clr-icon",7),s.yc(8," Phobos "),s.Qb(9,"clr-vertical-nav-group-children",8),s.Qb(10,"div",9),s.Qb(11,"div",10),s.Qb(12,"div",11),s.Qb(13,"p"),s.yc(14," This is a threejs/openlayers demo application. Here, we project an openlayers map as a canvas-texture onto a glTF model of the Mars-moon Phobos. "),s.Pb(),s.Qb(15,"p"),s.yc(16," There are some objects that are so irregular that they are better displayed with a three dimensional model, yet so large that their imagedata is best served per WMTS. Phobos is a good example of such an object. Note how the texture gets sharper when you zoom in: this is a new WMTS tile being loaded, projected and displayed on the fly. "),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(17,"clr-vertical-nav-group",6),s.Lb(18,"clr-icon",12),s.yc(19," Layers "),s.Qb(20,"clr-vertical-nav-group-children",8),s.Qb(21,"div",13),s.Qb(22,"span",14),s.yc(23," The controls of map and 3d-object are synced. Use the mouse to pan around in either and watch both displays change. "),s.Pb(),s.Pb(),s.Lb(24,"ukis-layer-control",15),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(2),s.fc("layersSvc",t.layersSvc)("mapState",t.mapStateSvc)("controls",t.controls),s.zb(2),s.fc("mapOlSvc",t.mapOlSvc),s.zb(1),s.fc("clrVerticalNavCollapsible",!0)("clr-nav-level",2),s.zb(1),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(11),s.fc("clrVerticalNavGroupExpanded",!0),s.zb(7),s.fc("layersSvc",t.layersSvc)("mapStateSvc",t.mapStateSvc))},directives:[ft,xs,Pt.C,Pt.u,Pt.D,Pt.n,Pt.F,Pt.E,Pt.b,Io],styles:[""]}),e})(),data:{title:"Threejs"}},{path:"licenses",component:Ns,data:{title:"Licenses"}}];let ri=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({imports:[[i.f.forRoot(ti,{useHash:!0,preloadingStrategy:i.b,relativeLinkResolution:"legacy"})],i.f]}),e})();"undefined"!=typeof window&&window.hasOwnProperty("ClarityIcons")&&window.ClarityIcons.add({ukis:'\n                <svg version="1.1" viewBox="0 0 36 36" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>ukis</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M18,31.5c4.7,0,8.9-2.4,11.3-6.1H6.7C9.1,29.1,13.3,31.5,18,31.5z"/>\n                    <path class="clr-i-solid clr-i-solid-path-2" d="M4.5,17.1c0,0.3,0,0.6,0,0.9c0,1.7,0.3,3.4,0.9,4.9h21.2L4.5,17.1z"/>\n                    <path class="clr-i-solid clr-i-solid-path-3" d="M31,21.5c0.3-1.1,0.5-2.3,0.5-3.5c0-3-1-5.7-2.6-7.9L8.7,15.6L31,21.5z"/>\n                    <path class="clr-i-solid clr-i-solid-path-4" d="M18,4.5c-6,0-11.2,4-12.9,9.5l22-6C24.7,5.8,21.5,4.5,18,4.5z"/>\n                </svg>\n            ',dlr:'\n                <svg version="1.1" viewBox="0 0 36 36" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>dlr</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M25.8,13.2V3.8l-9.4,9.4h-8l-7.7,7.7l9.4,0v9.4l9.4-9.4h8l7.7-7.7H25.8L25.8,13.2z M23.9,8.5v4.7h-4.7L23.9,8.5\n                    L23.9,8.5z M5.4,18.9l3.8-3.8h5.3l-3.8,3.8H5.4L5.4,18.9z M12.1,25.6v-4.8h4.8L12.1,25.6L12.1,25.6z M18.8,18.9h-5.4l3.8-3.8h5.4\n                    L18.8,18.9L18.8,18.9z M26.8,18.9h-5.2l3.8-3.8h5.2L26.8,18.9L26.8,18.9z M19.6,26.5h1.6c1.8,0,3.3,0.6,3.3,2.9\n                    c0,2.3-1.6,2.9-3.3,2.9h-1.6V26.5L19.6,26.5z M20.8,31.3h0.6c1,0,1.9-0.7,1.9-2c0-1.2-0.9-2-1.9-2h-0.6V31.3L20.8,31.3z M25.7,26.5\n                    h1.1v4.8h2.2v0.9h-3.4V26.5L25.7,26.5z M30.1,26.5h1.2c1.2,0,2.7,0,2.7,1.6c0,0.7-0.5,1.2-1.2,1.3v0c0.3,0,0.5,0.3,0.6,0.6l0.9,2.2\n                    h-1.3l-0.7-1.8c-0.2-0.4-0.3-0.6-0.8-0.6h-0.4v2.4h-1.1V26.5L30.1,26.5z M31.3,28.9h0.4c0.6,0,1.2-0.1,1.2-0.8\n                    c0-0.7-0.6-0.7-1.2-0.7h-0.4V28.9L31.3,28.9z"/>\n                </svg>\n            ',eoc:'\n                <svg version="1.1" viewBox="0 0 580 220" preserveAspectRatio="xMidYMid meet" class="has-solid"\n                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" role="img">\n                    <title>eoc</title>\n                    <path class="clr-i-solid clr-i-solid-path-1" d="M284,210c-55.1,0-100-44.9-100-100S228.9,10,284,10s100,44.9,100,100S339.1,210,284,210z M284,28.2\n                    c-45.1,0-81.8,36.7-81.8,81.8s36.7,81.8,81.8,81.8s81.8-36.7,81.8-81.8S329.1,28.2,284,28.2z M566,180.7l-12.9-12.9\n                    c-31.9,31.9-83.8,31.9-115.7,0c-31.9-31.9-31.9-83.8,0-115.7c31.9-31.9,83.8-31.9,115.7,0L566,39.3c-39-39-102.5-39-141.5,0\n                    s-39,102.5,0,141.5c19.5,19.5,45.1,29.3,70.7,29.3S546.5,200.2,566,180.7z M184.7,180.7l-12.9-12.9c-31.9,31.9-83.8,31.9-115.7,0\n                    c-15.5-15.5-24-36-24-57.8c0-21.9,8.5-42.4,24-57.8c28.6-28.6,73.4-31.8,105.5-8.7l-67.8,75.2l13.5,12.2l80.3-89.1l-6.7-6.1\n                    C141.4,0.1,80.9,1.7,43.3,39.3C24.4,58.2,14,83.3,14,110c0,26.7,10.4,51.8,29.3,70.7C62.8,200.2,88.4,210,114,210\n                    C139.6,210,165.2,200.2,184.7,180.7z"/>\n                </svg>\n            '});let oi=(()=>{class e{constructor(){this.alertSource=new we.a,this.alert$=this.alertSource.asObservable()}alert(e){this.alertSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const si=[[["",8,"header-nav-el"]],"*",[["",8,"header-action-el"]]],ii=[".header-nav-el","*",".header-action-el"];let ai=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-header"]],inputs:{title:["ukis-title","title"]},ngContentSelectors:ii,decls:14,vars:3,consts:[[1,"header-1"],[1,"branding"],["href","https://www.dlr.de","target","_blank","alt","link to dlr"],["shape","dlr","size","48","alt","dlr icon",1,"is-solid"],["href","https://www.dlr.de/eoc/desktopdefault.aspx/tabid-5413/10560_read-21914","target","_blank","alt","link to dlr ukis"],["shape","ukis","size","33","alt","ukis icon",1,"is-solid"],["routerLink","/","routerLinkActive","active",1,"nav-link","title"],[1,"title",3,"title"],[1,"header-nav",3,"clr-nav-level"],[1,"header-actions"]],template:function(e,t){1&e&&(s.ec(si),s.Qb(0,"clr-header",0),s.Qb(1,"div",1),s.Qb(2,"a",2),s.Lb(3,"clr-icon",3),s.Pb(),s.Qb(4,"a",4),s.Lb(5,"clr-icon",5),s.Pb(),s.Qb(6,"a",6),s.Qb(7,"span",7),s.yc(8),s.Pb(),s.Pb(),s.Pb(),s.Qb(9,"div",8),s.dc(10),s.Pb(),s.dc(11,1),s.Qb(12,"div",9),s.dc(13,2),s.Pb(),s.Pb()),2&e&&(s.zb(7),s.fc("title",t.title),s.zb(1),s.zc(t.title),s.zb(1),s.fc("clr-nav-level",1))},directives:[Pt.m,Pt.H,Pt.n,i.e,i.d,Pt.u],styles:[""]}),e})();function ni(e,t){if(1&e&&(s.Qb(0,"button",11),s.Xb("click",function(){const e=t.$implicit;return e.callback&&e.callback()}),s.yc(1),s.Pb()),2&e){const e=t.$implicit;s.zb(1),s.zc(e.title)}}function ci(e,t){if(1&e&&(s.Qb(0,"div",9),s.wc(1,ni,2,1,"button",10),s.Pb()),2&e){const e=s.Zb(2);s.zb(1),s.fc("ngForOf",e.alert.actions)}}function li(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",12),s.Xb("click",function(){return s.pc(e),s.Zb(2).close()}),s.Lb(1,"clr-icon",13),s.Pb()}}function pi(e,t){if(1&e&&(s.Qb(0,"div",1),s.Qb(1,"div",2),s.Qb(2,"div",3),s.Qb(3,"div",4),s.Lb(4,"clr-icon",5),s.Pb(),s.Lb(5,"div",6),s.wc(6,ci,2,1,"div",7),s.Pb(),s.Pb(),s.wc(7,li,2,0,"button",8),s.Pb()),2&e){const e=s.Zb();s.fc("ngClass","alert-"+e.alert.type),s.zb(5),s.fc("innerHTML",e.alert.text,s.qc),s.zb(1),s.fc("ngIf",e.alert.actions),s.zb(1),s.fc("ngIf",e.alert.closeable)}}let ui=(()=>{class e{constructor(){this.alertChange=new s.n}close(){this.alert=null,this.alertChange.emit(this.alert)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-global-alert"]],inputs:{alert:"alert"},outputs:{alertChange:"alertChange"},decls:1,vars:1,consts:[["class","alert alert-app-level","role","alert",3,"ngClass",4,"ngIf"],["role","alert",1,"alert","alert-app-level",3,"ngClass"],[1,"alert-items"],[1,"alert-item","static"],[1,"alert-icon-wrapper"],["shape","info-circle",1,"alert-icon"],[1,"alert-text",3,"innerHTML"],["class","alert-actions",4,"ngIf"],["type","button","class","close","aria-label","alert close",3,"click",4,"ngIf"],[1,"alert-actions"],["class","btn alert-action","aria-label","alert action",3,"click",4,"ngFor","ngForOf"],["aria-label","alert action",1,"btn","alert-action",3,"click"],["type","button","aria-label","alert close",1,"close",3,"click"],["aria-hidden","true","shape","close"]],template:function(e,t){1&e&&s.wc(0,pi,8,4,"div",0),2&e&&s.fc("ngIf",t.alert)},directives:[bt.n,bt.l,Pt.n,Pt.b,bt.m],styles:[""]}),e})();function hi(e,t){if(1&e&&(s.Qb(0,"span"),s.Qb(1,"div",1),s.Lb(2,"progress"),s.Pb(),s.Pb()),2&e){const e=s.Zb();s.zb(1),s.fc("ngClass",e.progress.class)}}function di(e,t){if(1&e&&(s.Qb(0,"span"),s.Qb(1,"div",2),s.Lb(2,"progress",3),s.Pb(),s.Pb()),2&e){const e=s.Zb();s.zb(1),s.fc("ngClass",e.progress.class),s.zb(1),s.gc("max",e.progress.max),s.gc("value",e.progress.value)}}let mi=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["ukis-global-progress"]],inputs:{progress:"progress"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"progress","loop",3,"ngClass"],[1,"progress",3,"ngClass"],[3,"max","value"]],template:function(e,t){1&e&&(s.wc(0,hi,3,1,"span",0),s.wc(1,di,3,3,"span",0)),2&e&&(s.fc("ngIf",t.progress&&t.progress.indeterminate),s.zb(1),s.fc("ngIf",t.progress&&!t.progress.indeterminate))},directives:[bt.n,bt.l],styles:[".progress[_ngcontent-%COMP%]{height:.5em}"]}),e})();function bi(e,t){if(1&e){const e=s.Rb();s.Qb(0,"ukis-global-alert",5),s.Xb("alertChange",function(t){return s.pc(e),s.Zb().ui.alert=t}),s.Pb()}if(2&e){const e=s.Zb();s.fc("alert",e.ui.alert)}}function yi(e,t){if(1&e){const e=s.Rb();s.Qb(0,"ukis-global-progress",6),s.Xb("progressChange",function(t){return s.pc(e),s.Zb().ui.progress=t}),s.Pb()}if(2&e){const e=s.Zb();s.fc("progress",e.ui.progress)}}function gi(e,t){if(1&e&&(s.Qb(0,"a",7),s.yc(1),s.Pb()),2&e){const e=t.$implicit;s.hc("routerLink","/",e.path,""),s.zb(1),s.zc(e.data.title)}}const fi=function(e){return{floating:e}};let vi=(()=>{class e{constructor(e,t,r){this.alertService=e,this.progressService=t,this.router=r,this.title="",this.shortTitle="",this.ui={floating:!1,flipped:!1,alert:null,progress:null},this.showProgress=e=>{this.ui.progress=e},this.setAlert=e=>{this.ui.alert=e},this.init(),this.routes=this.router.config.filter(e=>e.data)}init(){this.getHtmlMeta(["title","version","description","short-title"]),this.TITLE&&(this.title=this.TITLE),this["SHORT-TITLE"]&&(this.shortTitle=this["SHORT-TITLE"]),this.alertService.alert$.subscribe(e=>{this.setAlert(e)}),this.progressService.progress$.subscribe(e=>{this.showProgress(e)})}getHtmlMeta(e){const t=document.getElementsByTagName("meta");for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.getAttribute("name");e.includes(s)&&(this[s.toUpperCase()]=o.getAttribute("content")||o.getAttribute("value"))}}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(oi),s.Kb(Yo),s.Kb(i.c))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-root"]],decls:6,vars:7,consts:[[3,"ngClass"],[3,"alert","alertChange",4,"ngIf"],[3,"progress","progressChange",4,"ngIf"],[3,"ukis-title"],["routerLinkActive","active","class","nav-link nav-text header-nav-el",3,"routerLink",4,"ngFor","ngForOf"],[3,"alert","alertChange"],[3,"progress","progressChange"],["routerLinkActive","active",1,"nav-link","nav-text","header-nav-el",3,"routerLink"]],template:function(e,t){1&e&&(s.Qb(0,"clr-main-container",0),s.wc(1,bi,1,1,"ukis-global-alert",1),s.wc(2,yi,1,1,"ukis-global-progress",2),s.Qb(3,"ukis-header",3),s.wc(4,gi,2,2,"a",4),s.Pb(),s.Lb(5,"router-outlet"),s.Pb()),2&e&&(s.fc("ngClass",s.jc(5,fi,t.ui.floating)),s.zb(1),s.fc("ngIf",t.ui.alert),s.zb(1),s.fc("ngIf",t.ui.progress),s.zb(1),s.fc("ukis-title",t.title),s.zb(1),s.fc("ngForOf",t.routes))},directives:[Pt.t,Pt.G,bt.l,bt.n,ai,bt.m,i.g,ui,mi,i.e,i.d],styles:[""]}),e})();var wi=r("omvX");let Si=(()=>{class e{constructor(){this.progressSource=new we.a,this.progress$=this.progressSource.asObservable()}progress(e){this.progressSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xi=(()=>{class e{constructor(){this.alertSource=new we.a,this.alert$=this.alertSource.asObservable()}alert(e){this.alertSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Pi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({providers:[xi,Si],imports:[[bt.c,Pt.a]]}),e})(),_i=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({imports:[[bt.c,Pt.a,Fr.h,Cr.d,Pi]]}),e})(),Li=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({imports:[[bt.c,Fr.h,Pt.a]]}),e})(),Ei=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({imports:[[]]}),e})(),Oi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ib({type:e,bootstrap:[vi]}),e.\u0275inj=s.Hb({providers:[oi,Yo],imports:[[o.a,ri,Pt.a,Fr.h,Fr.s,wi.a,vt,Ps,_i,Li,Ei,Tt.b,Tr]]}),e})();Object(s.S)(),o.b().bootstrapModule(Oi).catch(e=>console.error(e))},IDPa:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return s});const o=e=>e.hasOwnProperty("jobID")&&e.hasOwnProperty("status"),s=e=>e.hasOwnProperty("output")},JF1W:function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"title":"Polygon 1"},"geometry":{"type":"Polygon","coordinates":[[[-178.59375,15.961329081596647],[-166.640625,15.961329081596647],[-166.640625,27.994401411046148],[-178.59375,27.994401411046148],[-178.59375,15.961329081596647]]]}},{"type":"Feature","properties":{"title":"Polygon 2"},"geometry":{"type":"Polygon","coordinates":[[[-179.296875,-1.4061088354351594],[-168.75,-1.4061088354351594],[-168.75,10.487811882056695],[-179.296875,10.487811882056695],[-179.296875,-1.4061088354351594]]]}},{"type":"Feature","properties":{"title":"Polygon 3"},"geometry":{"type":"Polygon","coordinates":[[[-158.203125,5.61598581915534],[-146.25,5.61598581915534],[-146.25,22.59372606392931],[-158.203125,22.59372606392931],[-158.203125,5.61598581915534]]]}},{"type":"Feature","properties":{"title":"Polygon 4"},"geometry":{"type":"Polygon","coordinates":[[[-162.0703125,-13.2399454992863],[-150.82031249999997,-13.2399454992863],[-150.82031249999997,-1.0546279422758742],[-162.0703125,-1.0546279422758742],[-162.0703125,-13.2399454992863]]]}},{"type":"Feature","properties":{"title":"Polygon 5"},"geometry":{"type":"Polygon","coordinates":[[[-142.3828125,-20.632784250388013],[-131.1328125,-20.632784250388013],[-131.1328125,-2.108898659243126],[-142.3828125,-2.108898659243126],[-142.3828125,-20.632784250388013]]]}},{"type":"Feature","properties":{"title":"Polygon 6"},"geometry":{"type":"Polygon","coordinates":[[[-106.171875,44.08758502824516],[-100.8984375,39.90973623453719],[-95.625,42.8115217450979],[-101.25,46.800059446787316],[-106.171875,44.08758502824516]]]}}]}')},M4FE:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return i});var o=r("IDPa"),s=r("l8mB");class i{constructor(){}getCapabilitiesUrl(e){return`${e}?service=WPS&request=GetCapabilities&version=2.0.0`}getDescribeProcessUrl(e,t){return`${e}?service=WPS&request=DescribeProcess&version=2.0.0&Identifier=${t}`}unmarshalProcessDescription(e){var t,r;const o=e.processOffering[0],s=[];for(const a of o.process.input)s.push({description:this.unmarshalInputDescription(a),value:null});const i=[];for(const a of o.process.output)i.push({description:this.unmarshalOutputDescription(a),value:null});return{id:o.process.identifier.value,processVersion:o.processVersion||"",description:null===(t=o.process._abstract)||void 0===t?void 0:t.value,title:(null===(r=o.process.title)||void 0===r?void 0:r.value)||"",inputs:s,outputs:i}}unmarshalInputDescription(e){var t,r,o,s,i,a;if("BoundingBoxData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e.abstract)||void 0===t?void 0:t.value};if("LiteralData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",defaultValue:null===(o=null===(r=e.dataDescription.value.literalDataDomain)||void 0===r?void 0:r.defaultValue)||void 0===o?void 0:o.value,options:null===(s=e.dataDescription.value.literalDataDomain)||void 0===s?void 0:s.allowedValues.valueOrRange.map(e=>e.value),description:null===(i=e.abstract)||void 0===i?void 0:i.value};if("ComplexData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.dataDescription.value.format[0].mimeType,description:null===(a=e.abstract)||void 0===a?void 0:a.value};throw new Error(`Cannot unmarshal input-description ${e.identifier.value}`)}unmarshalOutputDescription(e){var t,r,o;if("BoundingBoxData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e.abstract)||void 0===t?void 0:t.value};if("LiteralData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",description:null===(r=e.abstract)||void 0===r?void 0:r.value};if("ComplexData"===e.dataDescription.name.localPart)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.dataDescription.value.format[0].mimeType,description:null===(o=e.abstract)||void 0===o?void 0:o.value};throw new Error(`Cannot unmarshal input-description ${e.identifier.value}`)}executeUrl(e,t){return`${e}?service=WPS&request=Execute&version=2.0.0&identifier=${t}`}unmarshalCapabilities(e){const t=[];return e.contents.processSummary.forEach(e=>{t.push({id:e.identifier.value})}),t}unmarshalSyncExecuteResponse(e,t,r,s,i){const a=[];if(Object(o.a)(e.value))for(const o of e.value.output){const e=i.find(e=>e.id===o.id);if(!e)throw new Error(`Could not find an output-description for the parameter ${o.id}.`);const t=e.reference,r=e.type,s=e.format;let n;if(o.reference)n=o.reference.href||null;else{if(!o.data)throw new Error("Output has neither reference nor data field.");n=this.unmarshalOutputData(o.data,e)}a.push({description:{id:o.id,title:e.title,format:s,reference:t,type:r},value:n})}else Object(o.b)(e.value)&&a.push({description:{id:r,title:"",reference:!0,type:"status"},value:{status:e.value.status,jobID:e.value.jobID,percentCompleted:e.value.percentCompleted}});return a}unmarshalOutputData(t,r){if("complex"===r.type)switch("base64"===t.encoding&&t.content.map(e.exports?e=>new Buffer(e,"base64").toString("ascii"):e=>atob(e)),t.mimeType){case"application/vnd.geo+json":case"application/json":return t.content.map(e=>JSON.parse(e));case"application/WMS":return t.content;case"text/xml":case"application/xml":return s.serializeToString(t.content[0]);default:throw new Error(`Cannot unmarshal complex data of format ${t.mimeType}`)}else if("literal"===r.type)return t.content;throw new Error(`Not yet implemented: ${t}`)}unmarshalAsyncExecuteResponse(e,t,r,o,s){return this.unmarshalGetStateResponse(e,t,r,o,s)}unmarshalGetStateResponse(e,t,r,s,i){if(Object(o.b)(e.value))return{status:e.value.status,jobID:e.value.jobID,percentCompleted:e.value.percentCompleted};throw new Error(`Not a status-info: ${e}`)}marshalExecBody(e,t,r,o){return{name:{key:"{http://www.opengis.net/wps/2.0}Execute",localPart:"Execute",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:Execute"},value:{TYPE_NAME:"WPS_2_0.ExecuteRequestType",service:"WPS",version:"2.0.0",identifier:{value:e},input:this.marshalInputs(t),output:this.marshalOutputs(r),mode:o?"async":"sync",response:"document"}}}marshalInputs(e){return e.map(e=>e.description.reference?{id:e.description.id,reference:{href:e.value,mimeType:e.description.format}}:{id:e.description.id,data:{content:[JSON.stringify(e.value)],mimeType:e.description.format}})}marshalOutputs(e){return e.map(e=>({id:e.id,mimeType:e.format,transmission:e.reference?"reference":"value"}))}marshallGetStatusBody(e,t,r){return{name:{key:"{http://www.opengis.net/wps/2.0}GetStatus",localPart:"GetStatus",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:GetStatus"},value:{jobID:r,service:"WPS",version:"2.0.0"}}}marshallGetResultBody(e,t,r){return{name:{key:"{http://www.opengis.net/wps/2.0}GetResult",localPart:"GetResult",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:GetResult"},value:{service:"WPS",version:"2.0.0",jobID:r}}}dismissUrl(e,t,r){return e}marshalDismissBody(e){return{name:{key:"{http://www.opengis.net/wps/2.0}Dismiss",localPart:"Dismiss",namespaceURI:"http://www.opengis.net/wps/2.0",prefix:"wps",string:"{http://www.opengis.net/wps/2.0}wps:Dismiss"},value:{jobID:e,service:"WPS",version:"2.0.0"}}}unmarshalDismissResponse(e,t,r){return{status:e.value.status,jobID:e.value.jobID}}}}).call(this,r("3UD+")(e))},mxoJ:function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return s});var o=r("l8mB");class s{constructor(){}getCapabilitiesUrl(e){return`${e}?service=WPS&request=GetCapabilities&version=1.0.0`}getDescribeProcessUrl(e,t){return`${e}?service=WPS&request=DescribeProcess&version=1.0.0&Identifier=${t}`}executeUrl(e,t){return`${e}?service=WPS&request=Execute&version=1.0.0&identifier=${t}`}unmarshalCapabilities(e){const t=[];return e.processOfferings.process.forEach(e=>{t.push({id:e.identifier.value})}),t}unmarshalProcessDescription(e){var t;const r=e.processDescription[0],o=[];for(const i of r.dataInputs.input)o.push({description:this.unmarshalInputDescription(i),value:null});const s=[];for(const i of r.processOutputs.output)s.push({description:this.unmarshalOutputDescription(i),value:null});return{id:r.identifier.value,processVersion:r.processVersion,description:null===(t=r._abstract)||void 0===t?void 0:t.value,title:r.title.value,inputs:o,outputs:s}}unmarshalSyncExecuteResponse(e,t,r,o,s){const i=[];if(e.value.status.processFailed)i.push({description:{id:e.value.process.identifier.value,title:e.value.process.title.value,reference:!0,type:"error"},value:e.value.statusLocation});else if(e.value.processOutputs)for(const a of e.value.processOutputs.output){const e=!!a.reference;let t,r,o;a.reference?(t="complex",r=a.reference.href||null,o=a.reference.mimeType):(a.data&&a.data.literalData?(t="literal",o=a.data.literalData.dataType):a.data&&a.data.complexData?(t="complex",o=a.data.complexData.mimeType):(t="bbox",o=void 0),r=this.unmarshalOutputData(a.data)),i.push({description:{id:a.identifier.value,title:a.title.value,format:o,reference:e,type:t},value:r})}else e.value.statusLocation&&i.push({description:{id:e.value.process.identifier.value,title:e.value.process.title.value,reference:!0,type:"status"},value:this.unmarshalGetStateResponse(e,t,r,o,s)});return i}unmarshalOutputData(t){if(t.complexData)switch("base64"===t.complexData.encoding&&t.complexData.content.map(e.exports?e=>new Buffer(e,"base64").toString("ascii"):e=>atob(e)),t.complexData.mimeType){case"application/vnd.geo+json":case"application/json":return t.complexData.content.map(e=>JSON.parse(e));case"application/WMS":return t.complexData.content;case"text/xml":case"application/xml":return o.serializeToString(t.complexData.content[0]);default:throw new Error(`Cannot unmarshal data of format ${t.complexData.mimeType}`)}else if(t.literalData)switch(t.literalData.dataType){case"string":default:return t.literalData.value}throw new Error(`Not yet implemented: ${t}`)}unmarshalInputDescription(e){var t,r,o,s;if(e.boundingBoxData)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox",description:null===(t=e._abstract)||void 0===t?void 0:t.value,format:"text/plain"};if(e.complexData)return{id:e.identifier.value,title:e.title.value,reference:e.storeSupported,type:"complex",description:null===(r=e._abstract)||void 0===r?void 0:r.value,format:e.complexData._default.format.mimeType};if(e.literalData)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal",description:null===(o=e._abstract)||void 0===o?void 0:o.value,defaultValue:e.literalData.defaultValue,options:null===(s=e.literalData.allowedValues)||void 0===s?void 0:s.valueOrRange.map(e=>e.value),format:"text/plain"};throw new Error(`Cannot unmarshal the input-description for ${e.identifier.value}`)}unmarshalOutputDescription(e){if(e.complexOutput)return{id:e.identifier.value,title:e.title.value,reference:!0,type:"complex",format:e.complexOutput._default.format.mimeType};if(e.boundingBoxOutput)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"bbox"};if(e.literalOutput)return{id:e.identifier.value,title:e.title.value,reference:!1,type:"literal"};throw new Error(`Cannot unmarshal the input-description for ${e.identifier.value}`)}unmarshalAsyncExecuteResponse(e,t,r,o,s){return this.unmarshalGetStateResponse(e,t,r,o,s)}unmarshalGetStateResponse(e,t,r,o,s){const i=e.value,a={status:i.status.processSucceeded?"Succeeded":i.status.processAccepted?"Accepted":i.status.processStarted?"Running":"Failed",statusLocation:i.statusLocation};return i.processOutputs&&i.processOutputs.output&&(a.results=e),a}marshalExecBody(e,t,r,o){return{name:{key:"{http://www.opengis.net/wps/1.0.0}Execute",localPart:"Execute",namespaceURI:"http://www.opengis.net/wps/1.0.0",prefix:"wps",string:"{http://www.opengis.net/wps/1.0.0}wps:Execute"},value:{dataInputs:this.marshalInputs(t),identifier:e,responseForm:this.marshalResponseForm(r,o),service:"WPS",version:"1.0.0"}}}marshalResponseForm(e,t=!1){const r=[];for(const o of e){let e;switch(o.type){case"literal":case"complex":e={identifier:{value:o.id},asReference:o.reference,mimeType:o.format};break;default:throw new Error(`This Wps-outputtype has not been implemented yet! ${o} `)}r.push(e)}return{responseDocument:{output:r,status:!!t,storeExecuteResponse:!!t}}}marshalInputs(e){const t=[];for(const r of e){if(null==r.value)throw new Error(`Value for input ${r.description.id} is not set`);const e=this.marshalInput(r);t.push(e)}return{input:t}}marshalInput(e){const t={identifier:{value:e.description.id},title:{value:e.description.id},_abstract:{value:""}};return e.description.reference?t.reference=this.marshalReferenceInput(e):t.data=this.marshalDataInput(e),t}marshalDataInput(e){let t;switch(e.description.type){case"literal":t={literalData:{value:String(e.value)}};break;case"bbox":const r=e.value;t={boundingBoxData:{lowerCorner:[r.lllat,r.lllon],upperCorner:[r.urlat,r.urlon]}};break;case"complex":switch(e.description.format){case"text/xml":t={complexData:{content:[e.value],mimeType:e.description.format}};break;default:t={complexData:{content:[JSON.stringify(e.value)],mimeType:e.description.format}}}break;default:throw Error(`This input is of type ${e.description.type}. We can only marshal input of type literal, bbox or complex.`)}return t}marshalReferenceInput(e){return{href:e.value,method:"GET",mimeType:e.description.format}}marshallGetStatusBody(e,t,r){return{}}marshallGetResultBody(e,t,r){return{}}dismissUrl(e,t,r){throw new Error("Wps 1.0 does not support Dismiss-operations.")}marshalDismissBody(e){throw new Error("Wps 1.0 does not support Dismiss-operations.")}unmarshalDismissResponse(e,t,r){throw new Error("Wps 1.0 does not support Dismiss-operations.")}}}).call(this,r("3UD+")(e))},zn8P:function(e,t){function r(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id="zn8P"}},[[0,0,5]]]);