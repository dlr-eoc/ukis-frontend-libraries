"use strict";(self.webpackChunkdemo_maps=self.webpackChunkdemo_maps||[]).push([[325],{5262:st=>{function Te(s,u,l){l=l||2;var S,D,P,M,q,z,ie,g=u&&u.length,d=g?u[0]*l:s.length,v=_(s,0,d,l,!0),y=[];if(!v||v.next===v.prev)return y;if(g&&(v=function Ze(s,u,l,g){var v,y,P,d=[];for(v=0,y=u.length;v<y;v++)(P=_(s,u[v]*g,v<y-1?u[v+1]*g:s.length,g,!1))===P.next&&(P.steiner=!0),d.push(qe(P));for(d.sort(Se),v=0;v<d.length;v++)l=He(d[v],l);return l}(s,u,v,l)),s.length>80*l){S=P=s[0],D=M=s[1];for(var W=l;W<d;W+=l)(q=s[W])<S&&(S=q),(z=s[W+1])<D&&(D=z),q>P&&(P=q),z>M&&(M=z);ie=0!==(ie=Math.max(P-S,M-D))?32767/ie:0}return me(v,y,l,S,D,ie,0),y}function _(s,u,l,g,d){var v,y;if(d===rt(s,u,l,g)>0)for(v=u;v<l;v+=g)y=$e(v,s[v],s[v+1],y);else for(v=l-g;v>=u;v-=g)y=$e(v,s[v],s[v+1],y);return y&&Me(y,y.next)&&(xe(y),y=y.next),y}function ne(s,u){if(!s)return s;u||(u=s);var g,l=s;do{if(g=!1,l.steiner||!Me(l,l.next)&&0!==te(l.prev,l,l.next))l=l.next;else{if(xe(l),(l=u=l.prev)===l.next)break;g=!0}}while(g||l!==u);return u}function me(s,u,l,g,d,v,y){if(s){!y&&v&&function oe(s,u,l,g){var d=s;do{0===d.z&&(d.z=j(d.x,d.y,u,l,g)),d.prevZ=d.prev,d.nextZ=d.next,d=d.next}while(d!==s);d.prevZ.nextZ=null,d.prevZ=null,function $(s){var u,l,g,d,v,y,S,D,P=1;do{for(l=s,s=null,v=null,y=0;l;){for(y++,g=l,S=0,u=0;u<P&&(S++,g=g.nextZ);u++);for(D=P;S>0||D>0&&g;)0!==S&&(0===D||!g||l.z<=g.z)?(d=l,l=l.nextZ,S--):(d=g,g=g.nextZ,D--),v?v.nextZ=d:s=d,d.prevZ=v,v=d;l=g}v.nextZ=null,P*=2}while(y>1)}(d)}(s,g,d,v);for(var D,P,S=s;s.prev!==s.next;)if(D=s.prev,P=s.next,v?We(s,g,d,v):Q(s))u.push(D.i/l|0),u.push(s.i/l|0),u.push(P.i/l|0),xe(s),s=P.next,S=P.next;else if((s=P)===S){y?1===y?me(s=Ie(ne(s),u,l),u,l,g,d,v,2):2===y&&Ke(s,u,l,g,d,v):me(ne(s),u,l,g,d,v,1);break}}}function Q(s){var u=s.prev,l=s,g=s.next;if(te(u,l,g)>=0)return!1;for(var d=u.x,v=l.x,y=g.x,S=u.y,D=l.y,P=g.y,M=d<v?d<y?d:y:v<y?v:y,q=S<D?S<P?S:P:D<P?D:P,z=d>v?d>y?d:y:v>y?v:y,ie=S>D?S>P?S:P:D>P?D:P,W=g.next;W!==u;){if(W.x>=M&&W.x<=z&&W.y>=q&&W.y<=ie&&Pe(d,S,v,D,y,P,W.x,W.y)&&te(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function We(s,u,l,g){var d=s.prev,v=s,y=s.next;if(te(d,v,y)>=0)return!1;for(var S=d.x,D=v.x,P=y.x,M=d.y,q=v.y,z=y.y,ie=S<D?S<P?S:P:D<P?D:P,W=M<q?M<z?M:z:q<z?q:z,se=S>D?S>P?S:P:D>P?D:P,ve=M>q?M>z?M:z:q>z?q:z,nt=j(ie,W,u,l,g),it=j(se,ve,u,l,g),V=s.prevZ,X=s.nextZ;V&&V.z>=nt&&X&&X.z<=it;){if(V.x>=ie&&V.x<=se&&V.y>=W&&V.y<=ve&&V!==d&&V!==y&&Pe(S,M,D,q,P,z,V.x,V.y)&&te(V.prev,V,V.next)>=0||(V=V.prevZ,X.x>=ie&&X.x<=se&&X.y>=W&&X.y<=ve&&X!==d&&X!==y&&Pe(S,M,D,q,P,z,X.x,X.y)&&te(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;V&&V.z>=nt;){if(V.x>=ie&&V.x<=se&&V.y>=W&&V.y<=ve&&V!==d&&V!==y&&Pe(S,M,D,q,P,z,V.x,V.y)&&te(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;X&&X.z<=it;){if(X.x>=ie&&X.x<=se&&X.y>=W&&X.y<=ve&&X!==d&&X!==y&&Pe(S,M,D,q,P,z,X.x,X.y)&&te(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function Ie(s,u,l){var g=s;do{var d=g.prev,v=g.next.next;!Me(d,v)&&et(d,g,g.next,v)&&Fe(d,v)&&Fe(v,d)&&(u.push(d.i/l|0),u.push(g.i/l|0),u.push(v.i/l|0),xe(g),xe(g.next),g=s=v),g=g.next}while(g!==s);return ne(g)}function Ke(s,u,l,g,d,v){var y=s;do{for(var S=y.next.next;S!==y.prev;){if(y.i!==S.i&&mt(y,S)){var D=at(y,S);return y=ne(y,y.next),D=ne(D,D.next),me(y,u,l,g,d,v,0),void me(D,u,l,g,d,v,0)}S=S.next}y=y.next}while(y!==s)}function Se(s,u){return s.x-u.x}function He(s,u){var l=function Qe(s,u){var y,l=u,g=s.x,d=s.y,v=-1/0;do{if(d<=l.y&&d>=l.next.y&&l.next.y!==l.y){var S=l.x+(d-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(S<=g&&S>v&&(v=S,y=l.x<l.next.x?l:l.next,S===g))return y}l=l.next}while(l!==u);if(!y)return null;var z,D=y,P=y.x,M=y.y,q=1/0;l=y;do{g>=l.x&&l.x>=P&&g!==l.x&&Pe(d<M?g:v,d,P,M,d<M?v:g,d,l.x,l.y)&&(z=Math.abs(d-l.y)/(g-l.x),Fe(l,s)&&(z<q||z===q&&(l.x>y.x||l.x===y.x&&Ae(y,l)))&&(y=l,q=z)),l=l.next}while(l!==D);return y}(s,u);if(!l)return u;var g=at(l,s);return ne(g,g.next),ne(l,l.next)}function Ae(s,u){return te(s.prev,s,u.prev)<0&&te(u.next,s,s.next)<0}function j(s,u,l,g,d){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-l)*d|0)|s<<8))|s<<4))|s<<2))|s<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-g)*d|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function qe(s){var u=s,l=s;do{(u.x<l.x||u.x===l.x&&u.y<l.y)&&(l=u),u=u.next}while(u!==s);return l}function Pe(s,u,l,g,d,v,y,S){return(d-y)*(u-S)>=(s-y)*(v-S)&&(s-y)*(g-S)>=(l-y)*(u-S)&&(l-y)*(v-S)>=(d-y)*(g-S)}function mt(s,u){return s.next.i!==u.i&&s.prev.i!==u.i&&!function Nt(s,u){var l=s;do{if(l.i!==s.i&&l.next.i!==s.i&&l.i!==u.i&&l.next.i!==u.i&&et(l,l.next,s,u))return!0;l=l.next}while(l!==s);return!1}(s,u)&&(Fe(s,u)&&Fe(u,s)&&function xt(s,u){var l=s,g=!1,d=(s.x+u.x)/2,v=(s.y+u.y)/2;do{l.y>v!=l.next.y>v&&l.next.y!==l.y&&d<(l.next.x-l.x)*(v-l.y)/(l.next.y-l.y)+l.x&&(g=!g),l=l.next}while(l!==s);return g}(s,u)&&(te(s.prev,s,u.prev)||te(s,u.prev,u))||Me(s,u)&&te(s.prev,s,s.next)>0&&te(u.prev,u,u.next)>0)}function te(s,u,l){return(u.y-s.y)*(l.x-u.x)-(u.x-s.x)*(l.y-u.y)}function Me(s,u){return s.x===u.x&&s.y===u.y}function et(s,u,l,g){var d=be(te(s,u,l)),v=be(te(s,u,g)),y=be(te(l,g,s)),S=be(te(l,g,u));return!!(d!==v&&y!==S||0===d&&Ge(s,l,u)||0===v&&Ge(s,g,u)||0===y&&Ge(l,s,g)||0===S&&Ge(l,u,g))}function Ge(s,u,l){return u.x<=Math.max(s.x,l.x)&&u.x>=Math.min(s.x,l.x)&&u.y<=Math.max(s.y,l.y)&&u.y>=Math.min(s.y,l.y)}function be(s){return s>0?1:s<0?-1:0}function Fe(s,u){return te(s.prev,s,s.next)<0?te(s,u,s.next)>=0&&te(s,s.prev,u)>=0:te(s,u,s.prev)<0||te(s,s.next,u)<0}function at(s,u){var l=new tt(s.i,s.x,s.y),g=new tt(u.i,u.x,u.y),d=s.next,v=u.prev;return s.next=u,u.prev=s,l.next=d,d.prev=l,g.next=l,l.prev=g,v.next=g,g.prev=v,g}function $e(s,u,l,g){var d=new tt(s,u,l);return g?(d.next=g.next,d.prev=g,g.next.prev=d,g.next=d):(d.prev=d,d.next=d),d}function xe(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function tt(s,u,l){this.i=s,this.x=u,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rt(s,u,l,g){for(var d=0,v=u,y=l-g;v<l;v+=g)d+=(s[y]-s[v])*(s[v+1]+s[y+1]),y=v;return d}st.exports=Te,st.exports.default=Te,Te.deviation=function(s,u,l,g){var d=u&&u.length,y=Math.abs(rt(s,0,d?u[0]*l:s.length,l));if(d)for(var S=0,D=u.length;S<D;S++)y-=Math.abs(rt(s,u[S]*l,S<D-1?u[S+1]*l:s.length,l));var q=0;for(S=0;S<g.length;S+=3){var z=g[S]*l,ie=g[S+1]*l,W=g[S+2]*l;q+=Math.abs((s[z]-s[W])*(s[ie+1]-s[z+1])-(s[z]-s[ie])*(s[W+1]-s[z+1]))}return 0===y&&0===q?0:Math.abs((q-y)/y)},Te.flatten=function(s){for(var u=s[0][0].length,l={vertices:[],holes:[],dimensions:u},g=0,d=0;d<s.length;d++){for(var v=0;v<s[d].length;v++)for(var y=0;y<u;y++)l.vertices.push(s[d][v][y]);d>0&&l.holes.push(g+=s[d-1].length)}return l}},6924:(st,Te,_)=>{_.d(Te,{gD:()=>He,tH:()=>Ze,hQ:()=>Se,wl:()=>We,me:()=>Ie,WX:()=>Ke,nu:()=>Ae,si:()=>Q,dl:()=>me,zT:()=>Qe});var ne=_(1686);class me extends ne.Bk{constructor($){const j={name:"OpenStreetMap",displayName:"OpenStreetMap",id:"osm",visible:!1,type:"xyz",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",subdomains:["a","b","c"],attribution:'&copy, <a href="https://www.openstreetmap.org">OpenStreetMap</a> contributors',continuousWorld:!1,legendImg:"https://a.tile.openstreetmap.org/3/4/3.png",description:"OpenStreetMap z-x-y Tiles",opacity:1};$&&Object.assign(j,$),super(j)}}class Q extends ne.Bk{constructor($){const j={name:"OpenSeaMap",displayName:"OpenSeaMap",id:"OpenSeaMap",visible:!1,type:"xyz",removable:!1,url:"https://{s}.openseamap.org/seamark/{z}/{x}/{y}.png",subdomains:["t1"],attribution:'&copy, <a href="https://map.openseamap.org/legend.php?lang=de&page=license">OpenSeaMap</a>',continuousWorld:!1,legendImg:"https://t1.openseamap.org/seamark/10/554/321.png",description:"http://map.openseamap.org/",opacity:1};$&&Object.assign(j,$),super(j)}}class We extends ne.nw{constructor($){const j={name:"EOC Litemap",displayName:"EOC Litemap",id:"eoc_litemap",visible:!1,type:"wms",removable:!1,params:{LAYERS:"litemap",FORMAT:"image/png",TRANSPARENT:!0},url:"https://geoservice.dlr.de/eoc/basemap/wms",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://geoservice.dlr.de/eoc/basemap/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&FORMAT=image%2Fpng&TRANSPARENT=true&LAYERS=litemap&ATTRIBUTION=&WIDTH=256&HEIGHT=256&CRS=EPSG%3A3857&STYLES=&BBOX=0%2C0%2C10018754.171394622%2C10018754.171394622",description:"http://www.naturalearthdata.com/about/",opacity:1};$&&Object.assign(j,$),super(j)}}class Ie extends ne.fn{constructor($){const j={name:"EOC Litemap Tile",displayName:"EOC Litemap Tile",id:"eoc_litemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:litemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Alitemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"EOC Litemap as web map tile service",opacity:1};$&&Object.assign(j,$),super(j)}}class Ke extends ne.fn{constructor($){const j={name:"EOC Liteoverlay Tile",displayName:"EOC LiteoverlayTile",id:"eoc_Liteoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:liteoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aliteoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the liteoverlay provided for EOC Service Portals",opacity:1};$&&Object.assign(j,$),super(j)}}class Ze extends ne.fn{constructor($){const j={name:"EOC Basemap Tile",displayName:"EOC Basemap Tile",id:"eoc_basemap_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:basemap",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abasemap&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};$&&Object.assign(j,$),super(j)}}class Se extends ne.fn{constructor($){const j={name:"EOC Baseoverlay Tile",displayName:"EOC Baseoverlay Tile",id:"eoc_Baseoverlay_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:baseoverlay",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Abaseoverlay&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"This is the basemap for DLR Service Portals",opacity:1};$&&Object.assign(j,$),super(j)}}class He extends ne.fn{constructor($){const j={name:"BlueMarble Tile",displayName:"BlueMarble Tile",id:"blueMarble_tile",visible:!1,type:"wmts",removable:!1,params:{layer:"bmng_topo_bathy",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=bmng_topo_bathy&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Blue Marble NG dataset with topography and bathymetry",opacity:1};$&&Object.assign(j,$),super(j)}}class Qe extends ne.fn{constructor($){const j={name:"World Relief B/W Tile",displayName:"World Relief B/W Tile",id:"eoc:world_relief_bw",visible:!1,type:"wmts",removable:!1,params:{layer:"eoc:world_relief_bw",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=eoc%3Aworld_relief_bw&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"World Relief Black / White",opacity:1};$&&Object.assign(j,$),super(j)}}class Ae extends ne.fn{constructor($){const j={name:"Hillshade Tile",displayName:"Hillshade Tile",id:"eoc_hillshade",visible:!1,type:"wmts",removable:!1,params:{layer:"hillshade",format:"image/png",style:"_empty",matrixSetOptions:{matrixSet:"EPSG:3857",tileMatrixPrefix:"EPSG:3857"}},url:"https://tiles.geoservice.dlr.de/service/wmts",attribution:'&copy, <a href="//geoservice.dlr.de/eoc/basemap/">DLR</a>',continuousWorld:!1,legendImg:"https://tiles.geoservice.dlr.de/service/wmts?layer=hillshade&style=_empty&tilematrixset=EPSG%3A3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A3857%3A5&TileCol=18&TileRow=11",description:"Global Hillshade based on GMTED2010",opacity:1};$&&Object.assign(j,$),super(j)}}},3325:(st,Te,_)=>{_.r(Te),_.d(Te,{RouteMap4Module:()=>si,RouteMap4RoutingModule:()=>ar});var ne=_(6610),me=_(7925),Q=_(1686),We=_(6478),Ie=_(5857),Ke=_(6924),Ze=_(7477),Se=_(9392),He=_(6631),Qe=_(2531);const et=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function Ge(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!Qe.oF},e);const t=et.length;for(let r=0;r<t;++r)try{const i=n.getContext(et[r],e);if(i)return i}catch{}return null}var Fe=_(5940);function $e(n){switch(n){case 34962:default:return Float32Array;case 34963:return Uint32Array}}const xe=class at{constructor(e,t){this.array_=null,this.type_=e,(0,Fe.v)(34962===e||34963===e,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=void 0!==t?t:35044}ofSize(e){return this.array_=new($e(this.type_))(e),this}fromArray(e){return this.array_=$e(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new($e(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}};var tt=_(4860),rt=_(970),s=_(2800),u=_(1688);var g=_(9153),d=_(2383);const D=class S{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,o=t.RGBA,a=0,c=t.RGBA,f=t.UNSIGNED_BYTE,p=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,o,r[0],r[1],a,c,f,p),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const o=this.getGL(),a=e.size;if(o.bindFramebuffer(o.FRAMEBUFFER,t?t.getFrameBuffer():null),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.renderTargetTexture_),!t){const f=(0,d.v6)(o.canvas);if(!e.renderTargets[f]){const p=o.getContextAttributes();p&&p.preserveDrawingBuffer&&(o.clearColor(0,0,0,0),o.clearDepth(1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)),e.renderTargets[f]=!0}}o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.bindBuffer(o.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),o.useProgram(this.renderTargetProgram_),o.enableVertexAttribArray(this.renderTargetAttribLocation_),o.vertexAttribPointer(this.renderTargetAttribLocation_,2,o.FLOAT,!1,0,0),o.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),o.uniform1i(this.renderTargetTextureLocation_,0),o.uniform1f(this.renderTargetOpacityLocation_,e.layerStatesArray[e.layerIndex].opacity),this.applyUniforms(e),r&&r(o,e),o.drawArrays(o.TRIANGLES,0,6),i&&i(o,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(o){if(r="function"==typeof o.value?o.value(e):o.value,r instanceof HTMLCanvasElement||r instanceof ImageData)o.texture||(o.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,o.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(o.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void t.uniform2f(o.location,r[0],r[1]);case 3:return void t.uniform3f(o.location,r[0],r[1],r[2]);case 4:return void t.uniform4f(o.location,r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&t.uniform1f(o.location,r)})}};var P=_(9330),M=_(1983);const se_UNSIGNED_BYTE=5121,se_UNSIGNED_SHORT=5123,se_UNSIGNED_INT=5125,se_FLOAT=5126,ve={};function nt(n){return"shared/"+n}let it=0;function Ut(n){switch(n){case se_UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case se_UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case se_UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;default:return Float32Array.BYTES_PER_ELEMENT}}const hr=class cr extends g.A{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?nt(e.canvasCacheKey):function V(){const n="unique/"+it;return it+=1,n}(),this.gl_=function X(n){let e=ve[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:Ge(t)},ve[n]=e}return e.users+=1,e.context}(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener("webglcontextlost",this.boundHandleWebGLContextLost_),t.addEventListener("webglcontextrestored",this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,M.vt)(),this.offsetScaleMatrix_=(0,M.vt)(),this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new D({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new D({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===nt(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.gl_,r=(0,d.v6)(e);let i=this.bufferCache_[r];i||(i={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=i),t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=this.gl_,r=(0,d.v6)(e),i=this.bufferCache_[r];i&&!t.isContextLost()&&t.deleteBuffer(i.webGlBuffer),delete this.bufferCache_[r]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener("webglcontextlost",this.boundHandleWebGLContextLost_),e.removeEventListener("webglcontextrestored",this.boundHandleWebGLContextRestored_),function lr(n){const e=ve[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete ve[n]}(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,o=this.getCanvas(),a=e.size,c=e.pixelRatio;(o.width!==a[0]*c||o.height!==a[1]*c)&&(o.width=a[0]*c,o.height=a[1]*c,o.style.width=a[0]+"px",o.style.height=a[1]+"px");for(let f=this.postProcessPasses_.length-1;f>=0;f--)this.postProcessPasses_[f].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}prepareDrawToRenderTarget(e,t,r,i){const o=this.gl_,a=t.getSize();o.bindFramebuffer(o.FRAMEBUFFER,t.getFramebuffer()),o.bindRenderbuffer(o.RENDERBUFFER,t.getDepthbuffer()),o.viewport(0,0,a[0],a[1]),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.clearColor(0,0,0,0),o.depthRange(0,1),o.clearDepth(1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,r?o.ZERO:o.ONE_MINUS_SRC_ALPHA),i?(o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL)):o.disable(o.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint"),r.drawElements(r.TRIANGLES,t-e,r.UNSIGNED_INT,4*e)}finalizeDraw(e,t,r){for(let i=0,o=this.postProcessPasses_.length;i<o;i++)i===o-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue("u_time",.001*(Date.now()-this.startTime_)),this.setUniformFloatValue("u_zoom",e.viewState.zoom),this.setUniformFloatValue("u_resolution",e.viewState.resolution),this.setUniformFloatValue("u_pixelRatio",i),this.setUniformFloatVec2("u_viewportSizePx",[t[0],t[1]]),this.setUniformFloatValue("u_rotation",r)}applyHitDetectionUniform(e){const t=this.getUniformLocation("u_hitDetection");this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue("u_pixelRatio",.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(o=>{if(r="function"==typeof o.value?o.value(e):o.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!o.texture?(o.prevValue=void 0,o.texture=r):o.texture||(o.prevValue=void 0,o.texture=t.createTexture()),this.bindTexture(o.texture,i,o.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&o.prevValue!==r&&(o.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&6===r.length)this.setUniformMatrixValue(o.name,function z(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:return void t.uniform2f(this.getUniformLocation(o.name),r[0],r[1]);case 3:return void t.uniform3f(this.getUniformLocation(o.name),r[0],r[1],r[2]);case 4:return void t.uniform4f(this.getUniformLocation(o.name),r[0],r[1],r[2],r[3]);default:return}else"number"==typeof r&&t.uniform1f(this.getUniformLocation(o.name),r)})}useProgram(e,t){this.gl_.useProgram(e),this.currentProgram_=e,this.applyFrameState(t),this.applyUniforms(t)}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),o=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,o),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const c=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(c)}if(r.deleteShader(i),!r.getShaderParameter(o,r.COMPILE_STATUS)){const c=`Vertex shader compilation failed: ${r.getShaderInfoLog(o)}`;throw new Error(c)}if(r.deleteShader(o),!r.getProgramParameter(a,r.LINK_STATUS)){const c=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(c)}return a}getUniformLocation(e){const t=(0,d.v6)(this.currentProgram_);return void 0===this.uniformLocationsByProgram_[t]&&(this.uniformLocationsByProgram_[t]={}),void 0===this.uniformLocationsByProgram_[t][e]&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=(0,d.v6)(this.currentProgram_);return void 0===this.attribLocationsByProgram_[t]&&(this.attribLocationsByProgram_[t]={}),void 0===this.attribLocationsByProgram_[t][e]&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,o=e.viewState.resolution,a=e.viewState.center;return(0,M.Zz)(t,0,0,2/(o*r[0]),2/(o*r[1]),-e.viewState.rotation,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,r,i,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,t,r,!1,i,o))}enableAttributes(e){const t=function ur(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*Ut(r.type)}return e}(e);let r=0;for(let i=0;i<e.length;i++){const o=e[i];this.enableAttributeArray_(o.name,o.size,o.type||5126,t,r),r+=o.size*Ut(o.type)}}handleWebGLContextLost(e){(0,P.I)(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r){const i=this.gl_;r=r||i.createTexture();const a=i.RGBA,f=i.RGBA,p=i.UNSIGNED_BYTE;return i.bindTexture(i.TEXTURE_2D,r),t?i.texImage2D(i.TEXTURE_2D,0,a,f,p,t):i.texImage2D(i.TEXTURE_2D,0,a,e[0],e[1],0,f,p,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),r}};class vt extends rt.A{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=(0,M.vt)(),this.pixelContext_=null,this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,e.addChangeListener(tt.A.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(u.A.PRECOMPOSE)){const i=new s.A(u.A.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(u.A.POSTCOMPOSE)){const i=new s.A(u.A.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let i,t=!0,r=-1;for(let a=0,c=e.layerStatesArray.length;a<c;a++){const f=e.layerStatesArray[a].layer,p=f.getRenderer();if(!(p instanceof vt)){t=!0;continue}const m=f.getClassName();if((t||m!==i)&&(r+=1,t=!1),i=m,p===this)break}const o="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(o)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new hr({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:o}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){(0,M.Zz)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const o=new s.A(e,this.inversePixelTransform_,r,t);i.dispatchEvent(o)}}preRender(e,t){this.dispatchRenderEvent_(u.A.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(u.A.POSTRENDER,e,t)}}const Bt=vt;var jt=_(2058);const ye=new Uint8Array(4),fr=class pr{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){(0,jt.aI)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return ye[0]=0,ye[1]=0,ye[2]=0,ye[3]=0,ye;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return ye[0]=this.data_[4*r],ye[1]=this.data_[4*r+1],ye[2]=this.data_[4*r+2],ye[3]=this.data_[4*r+3],ye}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}};var ee=_(8507);function gr(n,e){const t=256,r=255;return(e=e||[])[0]=Math.floor(n/t/t/t)/r,e[1]=Math.floor(n/t/t)%t/r,e[2]=Math.floor(n/t)%t/r,e[3]=n%t/r,e}_(5262);var Oe=_(9325),we=_(2614);const _r=class yr extends Bt{constructor(e,t){const r=t.uniforms||{},i=(0,M.vt)();r.u_projectionMatrix=i,super(e,{uniforms:r,postProcesses:t.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new xe(34962,35048),this.indicesBuffer_=new xe(34963,35048),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.hitDetectionEnabled_=t.hitDetectionEnabled??!0;const o=t.attributes?t.attributes.map(function(c){return{name:"a_prop_"+c.name,size:1,type:se_FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:se_FLOAT},{name:"a_index",size:1,type:se_FLOAT}],this.hitDetectionEnabled_&&(this.attributes.push({name:"a_prop_hitColor",size:4,type:se_FLOAT}),this.attributes.push({name:"a_featureUid",size:1,type:se_FLOAT})),this.attributes.push(...o),this.customAttributes=t.attributes?t.attributes:[],this.previousExtent_=(0,ee.S5)(),this.currentTransform_=i,this.renderTransform_=(0,M.vt)(),this.invertRenderTransform_=(0,M.vt)(),this.renderInstructions_=new Float32Array(0),this.lastSentId=0,this.worker_=function xr(){const n='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS";function r(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function x(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new Error(t)}(0!==n,"Transformation matrix cannot be inverted");const x=t[0],i=t[1],u=t[2],o=t[3],f=t[4],s=t[5];return e[0]=o/n,e[1]=-i/n,e[2]=-u/n,e[3]=x/n,e[4]=(u*s-o*f)/n,e[5]=-(x*s-i*f)/n,e}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}new Array(6);var u={exports:{}};function o(e,t,n){n=n||2;var r,x,i,u,o,s,l,v=t&&t.length,h=v?t[0]*n:e.length,c=f(e,0,h,n,!0),g=[];if(!c||c.next===c.prev)return g;if(v&&(c=function(e,t,n,r){var x,i,u,o=[];for(x=0,i=t.length;x<i;x++)(u=f(e,t[x]*r,x<i-1?t[x+1]*r:e.length,r,!1))===u.next&&(u.steiner=!0),o.push(d(u));for(o.sort(p),x=0;x<o.length;x++)n=y(o[x],n);return n}(e,t,c,n)),e.length>80*n){r=i=e[0],x=u=e[1];for(var b=n;b<h;b+=n)(o=e[b])<r&&(r=o),(s=e[b+1])<x&&(x=s),o>i&&(i=o),s>u&&(u=s);l=0!==(l=Math.max(i-r,u-x))?32767/l:0}return a(c,g,n,r,x,l,0),g}function f(e,t,n,r,x){var i,u;if(x===O(e,t,n,r)>0)for(i=t;i<n;i+=r)u=P(i,e[i],e[i+1],u);else for(i=n-r;i>=t;i-=r)u=P(i,e[i],e[i+1],u);return u&&m(u,u.next)&&(B(u),u=u.next),u}function s(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(B(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,x,i,u){if(e){!u&&i&&function(e,t,n,r){var x=e;do{0===x.z&&(x.z=b(x.x,x.y,t,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,function(e){var t,n,r,x,i,u,o,f,s=1;do{for(n=e,e=null,i=null,u=0;n;){for(u++,r=n,o=0,t=0;t<s&&(o++,r=r.nextZ);t++);for(f=s;o>0||f>0&&r;)0!==o&&(0===f||!r||n.z<=r.z)?(x=n,n=n.nextZ,o--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;n=r}i.nextZ=null,s*=2}while(u>1)}(x)}(e,r,x,i);for(var o,f,p=e;e.prev!==e.next;)if(o=e.prev,f=e.next,i?v(e,r,x,i):l(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(f.i/n|0),B(e),e=f.next,p=f.next;else if((e=f)===p){u?1===u?a(e=h(s(e),t,n),t,n,r,x,i,2):2===u&&c(e,t,n,r,x,i):a(s(e),t,n,r,x,i,1);break}}}function l(e){var t=e.prev,n=e,r=e.next;if(w(t,n,r)>=0)return!1;for(var x=t.x,i=n.x,u=r.x,o=t.y,f=n.y,s=r.y,a=x<i?x<u?x:u:i<u?i:u,l=o<f?o<s?o:s:f<s?f:s,v=x>i?x>u?x:u:i>u?i:u,h=o>f?o>s?o:s:f>s?f:s,c=r.next;c!==t;){if(c.x>=a&&c.x<=v&&c.y>=l&&c.y<=h&&M(x,o,i,f,u,s,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function v(e,t,n,r){var x=e.prev,i=e,u=e.next;if(w(x,i,u)>=0)return!1;for(var o=x.x,f=i.x,s=u.x,a=x.y,l=i.y,v=u.y,h=o<f?o<s?o:s:f<s?f:s,c=a<l?a<v?a:v:l<v?l:v,p=o>f?o>s?o:s:f>s?f:s,y=a>l?a>v?a:v:l>v?l:v,g=b(h,c,t,n,r),d=b(p,y,t,n,r),Z=e.prevZ,m=e.nextZ;Z&&Z.z>=g&&m&&m.z<=d;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;Z&&Z.z>=g;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;m&&m.z<=d;){if(m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function h(e,t,n){var r=e;do{var x=r.prev,i=r.next.next;!m(x,i)&&A(x,r,r.next,i)&&z(x,i)&&z(i,x)&&(t.push(x.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),B(r),B(r.next),r=e=i),r=r.next}while(r!==e);return s(r)}function c(e,t,n,r,x,i){var u=e;do{for(var o=u.next.next;o!==u.prev;){if(u.i!==o.i&&Z(u,o)){var f=F(u,o);return u=s(u,u.next),f=s(f,f.next),a(u,t,n,r,x,i,0),void a(f,t,n,r,x,i,0)}o=o.next}u=u.next}while(u!==e)}function p(e,t){return e.x-t.x}function y(e,t){var n=function(e,t){var n,r=t,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=x&&o>u&&(u=o,n=r.x<r.next.x?r:r.next,o===x))return n}r=r.next}while(r!==t);if(!n)return null;var f,s=n,a=n.x,l=n.y,v=1/0;r=n;do{x>=r.x&&r.x>=a&&x!==r.x&&M(i<l?x:u,i,a,l,i<l?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),z(r,e)&&(f<v||f===v&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,v=f)),r=r.next}while(r!==s);return n}(e,t);if(!n)return t;var r=F(n,e);return s(r,r.next),s(n,n.next)}function g(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function b(e,t,n,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function M(e,t,n,r,x,i,u,o){return(x-u)*(t-o)>=(e-u)*(i-o)&&(e-u)*(r-o)>=(n-u)*(t-o)&&(n-u)*(i-o)>=(x-u)*(r-o)}function Z(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&A(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(z(e,t)&&z(t,e)&&function(e,t){var n=e,r=!1,x=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&x<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||m(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,n,r){var x=I(w(e,t,n)),i=I(w(e,t,r)),u=I(w(n,r,e)),o=I(w(n,r,t));return x!==i&&u!==o||(!(0!==x||!E(e,n,t))||(!(0!==i||!E(e,r,t))||(!(0!==u||!E(n,e,r))||!(0!==o||!E(n,t,r)))))}function E(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function z(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function F(e,t){var n=new _(e.i,e.x,e.y),r=new _(t.i,t.x,t.y),x=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=x,x.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function P(e,t,n,r){var x=new _(e,t,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,n,r){for(var x=0,i=t,u=n-r;i<n;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}u.exports=o,u.exports.default=o,o.deviation=function(e,t,n,r){var x=t&&t.length,i=x?t[0]*n:e.length,u=Math.abs(O(e,0,i,n));if(x)for(var o=0,f=t.length;o<f;o++){var s=t[o]*n,a=o<f-1?t[o+1]*n:e.length;u-=Math.abs(O(e,s,a,n))}var l=0;for(o=0;o<r.length;o+=3){var v=r[o]*n,h=r[o+1]*n,c=r[o+2]*n;l+=Math.abs((e[v]-e[c])*(e[h+1]-e[v+1])-(e[v]-e[h])*(e[c+1]-e[v+1]))}return 0===u&&0===l?0:Math.abs((l-u)/u)},o.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<t;u++)n.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,n.holes.push(r))}return n};var N=i(u.exports);const R=[],S={vertexPosition:0,indexPosition:0};function T(e,t,n,r,x){e[t+0]=n,e[t+1]=r,e[t+2]=x}function U(e,t,n,r,x,i){const u=3+x,o=e[t+0],f=e[t+1],s=R;s.length=x;for(let n=0;n<s.length;n++)s[n]=e[t+2+n];let a=i?i.vertexPosition:0,l=i?i.indexPosition:0;const v=a/u;return T(n,a,o,f,0),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,1),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,2),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,3),s.length&&n.set(s,a+3),a+=u,r[l++]=v,r[l++]=v+1,r[l++]=v+3,r[l++]=v+1,r[l++]=v+2,r[l++]=v+3,S.vertexPosition=a,S.indexPosition=l,S}function k(e,t,n,x,i,u,o,f,s,a,l){const v=8+f.length,h=u.length/v,c=[e[t+0],e[t+1]],p=[e[n],e[n+1]],y=r(s,[...c]),g=r(s,[...p]);function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),x=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-x[1],x[0]],u=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),o=[(n[0]-e[0])/u,(n[1]-e[1])/u],f=0===r||0===u?0:Math.acos((s=o[0]*x[0]+o[1]*x[1],a=-1,l=1,Math.min(Math.max(s,a),l)));var s,a,l;return o[0]*i[0]+o[1]*i[1]>0?f:2*Math.PI-f}let d=-1,M=-1,Z=l;const w=null!==i;if(null!==x){d=b(y,g,r(s,[...[e[x],e[x+1]]])),Math.cos(d)<=.985&&(Z+=Math.tan((d-Math.PI)/2))}if(w){M=b(g,y,r(s,[...[e[i],e[i+1]]])),Math.cos(M)<=.985&&(Z+=Math.tan((Math.PI-M)/2))}function m(e,t){return 0===t?1e4*e:Math.sign(t)*(1e4*e+Math.abs(t))}return u.push(c[0],c[1],p[0],p[1],d,M,a,m(0,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(1,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(2,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(3,l)),u.push(...f),o.push(h,h+1,h+2,h+1,h+3,h+2),{length:a+Math.sqrt((g[0]-y[0])*(g[0]-y[0])+(g[1]-y[1])*(g[1]-y[1])),angle:Z}}function G(e,t,n,r,x){const i=2+x;let u=t;const o=e.slice(u,u+x);u+=x;const f=e[u++];let s=0;const a=new Array(f-1);for(let t=0;t<f;t++)s+=e[u++],t<f-1&&(a[t]=s);const l=e.slice(u,u+2*s),v=N(l,a,2);for(let e=0;e<v.length;e++)r.push(v[e]+n.length/i);for(let e=0;e<l.length;e+=2)n.push(l[e],l[e+1],...o);return u+2*s}const j=self;j.onmessage=r=>{const i=r.data;switch(i.type){case t:{const e=3,t=2,n=i.customAttributesSize,r=t+n,x=new Float32Array(i.renderInstructions),u=x.length/r,o=4*u*(n+e),f=new Uint32Array(6*u),s=new Float32Array(o);let a;for(let e=0;e<x.length;e+=r)a=U(x,e,s,f,n,a);const l=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:x.buffer},i);j.postMessage(l,[s.buffer,f.buffer,x.buffer]);break}case n:{const e=[],t=[],n=i.customAttributesSize,r=2,u=new Float32Array(i.renderInstructions);let o=0;const f=[1,0,0,1,0,0];let s,a;for(x(f,i.renderInstructionsTransform);o<u.length;){a=Array.from(u.slice(o,o+n)),o+=n,s=u[o++];const x=o,i=o+(s-1)*r,l=u[x]===u[i]&&u[x+1]===u[i+1];let v=0,h=0;for(let n=0;n<s-1;n++){let c=null;n>0?c=o+(n-1)*r:l&&(c=i-r);let p=null;n<s-2?p=o+(n+2)*r:l&&(p=x+r);const y=k(u,o+n*r,o+(n+1)*r,c,p,e,t,a,f,v,h);v=y.length,h=y.angle}o+=s*r}const l=Uint32Array.from(t),v=Float32Array.from(e),h=Object.assign({vertexBuffer:v.buffer,indexBuffer:l.buffer,renderInstructions:u.buffer},i);j.postMessage(h,[v.buffer,l.buffer,u.buffer]);break}case e:{const e=[],t=[],n=i.customAttributesSize,r=new Float32Array(i.renderInstructions);let x=0;for(;x<r.length;)x=G(r,x,e,t,n);const u=Uint32Array.from(t),o=Float32Array.from(e),f=Object.assign({vertexBuffer:o.buffer,indexBuffer:u.buffer,renderInstructions:r.buffer},i);j.postMessage(f,[o.buffer,u.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}(),this.worker_.addEventListener("message",c=>{const f=c.data;if("GENERATE_POINT_BUFFERS"===f.type){const p=f.projectionTransform;this.verticesBuffer_.fromArrayBuffer(f.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.fromArrayBuffer(f.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=p,(0,M.T9)(this.invertRenderTransform_,this.renderTransform_),this.renderInstructions_=new Float32Array(c.data.renderInstructions),f.id===this.lastSentId&&(this.ready=!0),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const a=this.getLayer().getSource();this.sourceListenKeys_=[(0,we.KT)(a,Se.A.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,we.KT)(a,Se.A.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,we.KT)(a,Se.A.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,we.KT)(a,Se.A.CLEAR,this.handleSourceFeatureClear_,this)],a.forEachFeature(c=>{this.featureCache_[(0,d.v6)(c)]={feature:c,properties:c.getProperties(),geometry:c.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new fr(this.helper))}handleSourceFeatureAdded_(e){const t=e.feature;this.featureCache_[(0,d.v6)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(e){const t=e.feature;this.featureCache_[(0,d.v6)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}}handleSourceFeatureDelete_(e){delete this.featureCache_[(0,d.v6)(e.feature)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,o]=function vr(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),o=t.getExtent(),a=n.extent,c=i?(0,ee.RG)(o):null,f=i?Math.ceil((a[2]-o[2])/c)+1:1;return[i?Math.floor((a[0]-o[0])/c):0,f,c]}(e,this.getLayer());return this.renderWorlds(e,!1,r,i,o),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,o),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),this.helper.getCanvas()}prepareFrameInternal(e){const t=this.getLayer(),r=t.getSource(),i=e.viewState,o=!e.viewHints[He.A.ANIMATING]&&!e.viewHints[He.A.INTERACTING],a=!(0,ee.aI)(this.previousExtent_,e.extent),c=this.sourceRevision_<r.getRevision();if(c&&(this.sourceRevision_=r.getRevision()),o&&(a||c)){const f=i.projection,p=i.resolution,m=t instanceof Ze.A?t.getRenderBuffer():0,x=(0,ee.r)(e.extent,m*p);r.loadFeatures(x,p,f),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_,e),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(e){const t=(0,M.vt)();this.helper.makeProjectionTransform(e,t);const r=(0,Oe.Tf)(),o=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,a=o*this.featureCount_;let c,f;(!this.renderInstructions_||this.renderInstructions_.length!==a)&&(this.renderInstructions_=new Float32Array(a));const p=[],m=[];let x=-1;for(const T in this.featureCache_)if(c=this.featureCache_[T],f=c.geometry,f&&"Point"===f.getType()){if(r){const R=(0,Oe.Ad)(f.getFlatCoordinates(),e.viewState.projection);p[0]=R[0],p[1]=R[1]}else p[0]=f.getFlatCoordinates()[0],p[1]=f.getFlatCoordinates()[1];if((0,M.Bb)(t,p),this.renderInstructions_[++x]=p[0],this.renderInstructions_[++x]=p[1],this.hitDetectionEnabled_){const R=gr(x+5,m);this.renderInstructions_[++x]=R[0],this.renderInstructions_[++x]=R[1],this.renderInstructions_[++x]=R[2],this.renderInstructions_[++x]=R[3],this.renderInstructions_[++x]=Number(T)}for(let R=0;R<this.customAttributes.length;R++){const L=this.customAttributes[R].callback(c.feature,c.properties);this.renderInstructions_[++x]=L}}const E={id:++this.lastSentId,type:"GENERATE_POINT_BUFFERS",renderInstructions:this.renderInstructions_.buffer,customAttributesSize:o-2};E.projectionTransform=t,this.ready=!1,this.worker_.postMessage(E,[this.renderInstructions_.buffer]),this.renderInstructions_=null}forEachFeatureAtCoordinate(e,t,r,i,o){if((0,Fe.v)(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.renderInstructions_||!this.hitDetectionEnabled_)return;const a=(0,M.Bb)(t.coordinateToPixelTransform,e.slice()),c=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),p=function mr(n){let e=0;const t=256,r=255;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}([c[0]/255,c[1]/255,c[2]/255,c[3]/255]),x=Math.floor(this.renderInstructions_[p]).toString(),T=this.getLayer().getSource().getFeatureByUid(x);return T?i(T,this.getLayer(),null):void 0}renderWorlds(e,t,r,i,o){let a=r;this.helper.useProgram(this.program_,e),t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,M.Tl)(this.currentTransform_,a*o,0),(0,M.lw)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.applyHitDetectionUniform(t);const c=this.indicesBuffer_.getSize();this.helper.drawElements(0,c)}while(++a<i)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){(0,we.JH)(e)}),this.sourceListenKeys_=null,super.disposeInternal()}renderDeclutter(){}},Er=class Tr{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}};var b=_(9625),ze=(_(8437),_(7783),_(9806),_(5551)),Ne=_(6621),Tt=(_(7257),_(2321),_(9973));_(8836),_(1884),_(8118);var ht=_(9270);_(2529),_(6990),_(6690);const ae_TILE_TEXTURE_ARRAY="u_tileTextures",ae_TEXTURE_PIXEL_WIDTH="u_texturePixelWidth",ae_TEXTURE_PIXEL_HEIGHT="u_texturePixelHeight";var Jt=_(1962);function Ue(n){const e=n.toString();return e.includes(".")?e:e+".0"}function At(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(Ue).join(", ")})`}function pt(n){const e=(0,Jt._j)(n),t=e.length>3?e[3]:1;return At([e[0]/255*t,e[1]/255*t,e[2]/255*t,t])}const Pt={};let Xr=0;function Be(n){return Ue(function kr(n){return n in Pt||(Pt[n]=Xr++),Pt[n]}(n))}const bt="getBandValue";function k(n){return(e,t,r)=>{const i=t.args.length,o=new Array(i);for(let a=0;a<i;++a)o[a]=Ft(t.args[a],r,e);return n(o,e)}}const Kr={[b.ZD.Get]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),(n.inFragmentShader?"v_prop_":"a_prop_")+r},[b.ZD.GeometryType]:(n,e,t)=>{const r="geometryType";return r in n.properties||(n.properties[r]={name:r,type:b.cT,evaluator:a=>(0,b.Ye)(a.getGeometry())}),(n.inFragmentShader?"v_prop_":"a_prop_")+r},[b.ZD.Var]:(n,e)=>{const r=e.args[0].value;return r in n.variables||(n.variables[r]={name:r,type:e.type}),function Yr(n){return"u_var_"+n}(r)},[b.ZD.Resolution]:()=>"u_resolution",[b.ZD.Zoom]:()=>"u_zoom",[b.ZD.Time]:()=>"u_time",[b.ZD.Any]:k(n=>`(${n.join(" || ")})`),[b.ZD.All]:k(n=>`(${n.join(" && ")})`),[b.ZD.Not]:k(([n])=>`(!${n})`),[b.ZD.Equal]:k(([n,e])=>`(${n} == ${e})`),[b.ZD.NotEqual]:k(([n,e])=>`(${n} != ${e})`),[b.ZD.GreaterThan]:k(([n,e])=>`(${n} > ${e})`),[b.ZD.GreaterThanOrEqualTo]:k(([n,e])=>`(${n} >= ${e})`),[b.ZD.LessThan]:k(([n,e])=>`(${n} < ${e})`),[b.ZD.LessThanOrEqualTo]:k(([n,e])=>`(${n} <= ${e})`),[b.ZD.Multiply]:k(n=>`(${n.join(" * ")})`),[b.ZD.Divide]:k(([n,e])=>`(${n} / ${e})`),[b.ZD.Add]:k(n=>`(${n.join(" + ")})`),[b.ZD.Subtract]:k(([n,e])=>`(${n} - ${e})`),[b.ZD.Clamp]:k(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[b.ZD.Mod]:k(([n,e])=>`mod(${n}, ${e})`),[b.ZD.Pow]:k(([n,e])=>`pow(${n}, ${e})`),[b.ZD.Abs]:k(([n])=>`abs(${n})`),[b.ZD.Floor]:k(([n])=>`floor(${n})`),[b.ZD.Ceil]:k(([n])=>`ceil(${n})`),[b.ZD.Round]:k(([n])=>`floor(${n} + 0.5)`),[b.ZD.Sin]:k(([n])=>`sin(${n})`),[b.ZD.Cos]:k(([n])=>`cos(${n})`),[b.ZD.Atan]:k(([n,e])=>void 0!==e?`atan(${n}, ${e})`:`atan(${n})`),[b.ZD.Sqrt]:k(([n])=>`sqrt(${n})`),[b.ZD.Match]:k(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2)r=`(${e} == ${n[i]} ? ${n[i+1]} : ${r||t})`;return r}),[b.ZD.Between]:k(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[b.ZD.Interpolate]:k(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const o=t[i],a=r||t[i+1],c=t[i+2],f=t[i+3];let p;p=n===Ue(1)?`(${e} - ${o}) / (${c} - ${o})`:`(pow(${n}, (${e} - ${o})) - 1.0) / (pow(${n}, (${c} - ${o})) - 1.0)`,r=`mix(${a}, ${f}, clamp(${p}, 0.0, 1.0))`}return r}),[b.ZD.Case]:k(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2)t=`(${n[r]} ? ${n[r+1]} : ${t||e})`;return t}),[b.ZD.In]:k(([n,...e],t)=>{const r=function zr(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}("in",t),i=[];for(let o=0;o<e.length;o+=1)i.push(`  if (inputValue == ${e[o]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {\n${i.join("\n")}\n  return false;\n}`,`${r}(${n})`}),[b.ZD.Array]:k(n=>`vec${n.length}(${n.join(", ")})`),[b.ZD.Color]:k(n=>{if(1===n.length)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(2===n.length)return`(${n[1]} * vec4(vec3(${n[0]} / 255.0), 1.0))`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);return 3===n.length?`vec4(${e.join(", ")}, 1.0)`:`(${n[3]} * vec4(${e.join(", ")}, 1.0))`}),[b.ZD.Band]:k(([n,e,t],r)=>{if(!(bt in r.functions)){let i="";const o=r.bandCount||1;for(let a=0;a<o;a++){const c=Math.floor(a/4);let f=a%4;a===o-1&&1===f&&(f=3),i+=`  if (band == ${a+1}.0) {\n    return texture2D(${ae_TILE_TEXTURE_ARRAY}[${c}], v_textureCoord + vec2(dx, dy))[${f}];\n  }\n`}r.functions[bt]=`float getBandValue(float band, float xOffset, float yOffset) {\n  float dx = xOffset / ${ae_TEXTURE_PIXEL_WIDTH};\n  float dy = yOffset / ${ae_TEXTURE_PIXEL_HEIGHT};\n${i}\n}`}return`${bt}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[b.ZD.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,o=new Uint8Array(4*i);for(let p=0;p<r.length;p++){const x=(0,Jt._j)(r[p].value),E=4*p;o[E]=x[0],o[E+1]=x[1],o[E+2]=x[2],o[E+3]=255*x[3]}n.paletteTextures||(n.paletteTextures=[]);const a=`u_paletteTextures[${n.paletteTextures.length}]`,c=new Er(a,o);return n.paletteTextures.push(c),`texture2D(${a}, vec2((${Ft(t,b.wl,n)} + 0.5) / ${i}.0, 0.5))`}};function Ft(n,e,t){if(n instanceof b.DG){const r=Kr[n.operator];if(void 0===r)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&b.wl)>0)return Ue(n.value);if((n.type&b.T8)>0)return n.value.toString();if((n.type&b.cT)>0)return Be(n.value.toString());if((n.type&b.mE)>0)return pt(n.value);if((n.type&b.Fq)>0)return At(n.value);if((n.type&b.qA)>0)return function Vr(n){return At((0,ht.xq)(n))}(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${(0,b.go)(e)})`)}const ke="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_screenToWorldMatrix;\nuniform vec2 u_viewportSizePx;\nuniform float u_pixelRatio;\nuniform float u_globalAlpha;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\nuniform float u_rotation;\nuniform vec4 u_renderExtent;\nuniform vec2 u_patternOrigin;\nuniform float u_depth;\nuniform mediump int u_hitDetection;\n\nconst float PI = 3.141592653589793238;\nconst float TWO_PI = 2.0 * PI;\n\n// this used to produce an alpha-premultiplied color from a texture\nvec4 samplePremultiplied(sampler2D sampler, vec2 texCoord) {\n  vec4 color = texture2D(sampler, texCoord);\n  return vec4(color.rgb * color.a, color.a);\n}\n",Ye_fill_color="rgba(255,255,255,0.4)",Ye_stroke_color="#3399CC",Ye_stroke_width=1.25,Ye_circle_radius=5,Ye_circle_fill_color="rgba(255,255,255,0.4)",Ye_circle_stroke_width=1.25;class qr{constructor(){this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Ue(Ye_circle_radius)} + ${Ue(.5*Ye_circle_stroke_width)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=pt(Ye_circle_fill_color),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Ue(Ye_stroke_width),this.strokeColorExpression_=pt(Ye_stroke_color),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Be("round"),this.strokeJoinExpression_=Be("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=pt(Ye_fill_color),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e){return this.uniforms_.push(e),this}addAttribute(e){return this.attributes_.push(e),this}addVarying(e,t,r){return this.varyings_.push({name:e,type:t,expression:r}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){this.vertexShaderFunctions_.includes(e)||this.vertexShaderFunctions_.push(e)}addFragmentShaderFunction(e){this.fragmentShaderFunctions_.includes(e)||this.fragmentShaderFunctions_.push(e)}getSymbolVertexShader(){return this.hasSymbol_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nattribute vec2 a_position;\nattribute float a_index;\nattribute vec4 a_prop_hitColor;\n${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\nvarying vec4 v_prop_hitColor;\nvarying vec2 v_centerPx;\nvarying float v_angle;\nvarying vec2 v_quadSizePx;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.vertexShaderFunctions_.join("\n")}\nvec2 pxToScreen(vec2 coordPx) {\n  vec2 scaled = coordPx / u_viewportSizePx / 0.5;\n  return scaled;\n}\n\nvec2 screenToPx(vec2 coordScreen) {\n  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;\n}\n\nvoid main(void) {\n  v_quadSizePx = ${this.symbolSizeExpression_};\n  vec2 halfSizePx = v_quadSizePx * 0.5;\n  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};\n  vec2 offsetPx = centerOffsetPx;\n  if (a_index == 0.0) {\n    offsetPx -= halfSizePx;\n  } else if (a_index == 1.0) {\n    offsetPx += halfSizePx * vec2(1., -1.);\n  } else if (a_index == 2.0) {\n    offsetPx += halfSizePx;\n  } else {\n    offsetPx += halfSizePx * vec2(-1., 1.);\n  }\n  float angle = ${this.symbolRotationExpression_};\n  ${this.symbolRotateWithView_?"angle += u_rotation;":""}\n  float c = cos(-angle);\n  float s = sin(-angle);\n  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);\n  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);\n  vec4 texCoord = ${this.texCoordExpression_};\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\n  v_texCoord = vec2(u, v);\n  v_prop_hitColor = a_prop_hitColor;\n  v_angle = angle;\n  c = cos(-v_angle);\n  s = sin(-v_angle);\n  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y); \n  v_centerPx = screenToPx(center.xy) + centerOffsetPx;\n${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}\n}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nvarying vec2 v_texCoord;\nvarying vec4 v_prop_hitColor;\nvarying vec2 v_centerPx;\nvarying float v_angle;\nvarying vec2 v_quadSizePx;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.fragmentShaderFunctions_.join("\n")}\n\nvoid main(void) {\n  if (${this.discardExpression_}) { discard; }\n  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center\n  float c = cos(v_angle);\n  float s = sin(v_angle);\n  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);\n  gl_FragColor = ${this.symbolColorExpression_};\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.05) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}`:null}getStrokeVertexShader(){return this.hasStroke_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nattribute vec2 a_position;\nattribute float a_index;\nattribute vec2 a_segmentStart;\nattribute vec2 a_segmentEnd;\nattribute float a_parameters;\nattribute float a_distance;\nattribute vec2 a_joinAngles;\nattribute vec4 a_prop_hitColor;\n${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}\nvarying vec2 v_segmentStart;\nvarying vec2 v_segmentEnd;\nvarying float v_angleStart;\nvarying float v_angleEnd;\nvarying float v_width;\nvarying vec4 v_prop_hitColor;\nvarying float v_distanceOffsetPx;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.vertexShaderFunctions_.join("\n")}\nvec2 worldToPx(vec2 worldPos) {\n  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);\n  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;\n}\n\nvec4 pxToScreen(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return vec4(screenPos, u_depth, 1.0);\n}\n\nbool isCap(float joinAngle) {\n  return joinAngle < -0.1;\n}\n\nvec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {\n  float halfAngle = joinAngle / 2.0;\n  float c = cos(halfAngle);\n  float s = sin(halfAngle);\n  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);\n  float length = 1.0 / s;\n  return angleBisectorNormal * length;\n}\n\nvec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {\n  // if on a cap or the join angle is too high, offset the line along the segment normal\n  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {\n    return point - normal * offsetPx;\n  }\n  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)\n  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;\n}\n\nvoid main(void) {\n  v_angleStart = a_joinAngles.x;\n  v_angleEnd = a_joinAngles.y;\n  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);\n  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)\n  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);\n\n  float lineWidth = ${this.strokeWidthExpression_};\n  float lineOffsetPx = ${this.strokeOffsetExpression_};\n\n  // compute segment start/end in px with offset\n  vec2 segmentStartPx = worldToPx(a_segmentStart);\n  vec2 segmentEndPx = worldToPx(a_segmentEnd);\n  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);\n  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);\n  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),\n  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);\n  \n  // compute current vertex position\n  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;\n  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;\n  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;\n  vec2 joinDirection;\n  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;\n  // if angle is too high, do not make a proper join\n  if (cos(angle) > 0.985 || isCap(angle)) {\n    joinDirection = normalPx * normalDir - tangentPx * tangentDir;\n  } else {\n    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);\n  }\n  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing\n  gl_Position = pxToScreen(positionPx);\n\n  v_segmentStart = segmentStartPx;\n  v_segmentEnd = segmentEndPx;\n  v_width = lineWidth;\n  v_prop_hitColor = a_prop_hitColor;\n  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);\n${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}\n}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nvarying vec2 v_segmentStart;\nvarying vec2 v_segmentEnd;\nvarying float v_angleStart;\nvarying float v_angleEnd;\nvarying float v_width;\nvarying vec4 v_prop_hitColor;\nvarying float v_distanceOffsetPx;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.fragmentShaderFunctions_.join("\n")}\n\nvec2 pxToWorld(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;\n}\n\nbool isCap(float joinAngle) {\n  return joinAngle < -0.1;\n}\n\nfloat segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  vec2 tangent = normalize(end - start);\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 startToPoint = point - start;\n  return abs(dot(startToPoint, normal)) - width * 0.5;\n}\n\nfloat buttCapDistanceField(vec2 point, vec2 start, vec2 end) {\n  vec2 startToPoint = point - start;\n  vec2 tangent = normalize(end - start);\n  return dot(startToPoint, -tangent);\n}\n\nfloat squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  return buttCapDistanceField(point, start, end) - width * 0.5;\n}\n\nfloat roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment\n  return length(point - start) - width * 0.5 - onSegment;\n}\n\nfloat roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {\n  return roundCapDistanceField(point, start, end, width);\n}\n\nfloat bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {\n  vec2 startToPoint = point - start;\n  vec2 tangent = normalize(end - start);\n  float c = cos(joinAngle * 0.5);\n  float s = sin(joinAngle * 0.5);\n  float direction = -sign(sin(joinAngle));\n  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);\n  float radius = width * 0.5 * s;\n  return dot(startToPoint, bisector * direction) - radius;\n}\n\nfloat miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {\n  if (cos(joinAngle) > 0.985) { // avoid risking a division by zero\n    return bevelJoinField(point, start, end, width, joinAngle);\n  }\n  float miterLength = 1. / sin(joinAngle * 0.5);\n  float miterLimit = ${this.strokeMiterLimitExpression_};\n  if (miterLength > miterLimit) {\n    return bevelJoinField(point, start, end, width, joinAngle);\n  }\n  return -1000.;\n}\n\nfloat capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {\n   if (capType == ${Be("butt")}) {\n    return buttCapDistanceField(point, start, end);\n  } else if (capType == ${Be("square")}) {\n    return squareCapDistanceField(point, start, end, width);\n  }\n  return roundCapDistanceField(point, start, end, width);\n}\n\nfloat joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {\n  if (joinType == ${Be("bevel")}) {\n    return bevelJoinField(point, start, end, width, joinAngle);\n  } else if (joinType == ${Be("miter")}) {\n    return miterJoinDistanceField(point, start, end, width, joinAngle);\n  }\n  return roundJoinDistanceField(point, start, end, width);\n}\n\nfloat computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {\n  if (isCap(joinAngle)) {\n    return capDistanceField(point, start, end, width, capType);\n  }\n  return joinDistanceField(point, start, end, width, joinAngle, joinType);\n}\n\nvoid main(void) {\n  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n  vec2 worldPos = pxToWorld(currentPoint);\n  if (\n    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (\n      worldPos[0] < u_renderExtent[0] ||\n      worldPos[1] < u_renderExtent[1] ||\n      worldPos[0] > u_renderExtent[2] ||\n      worldPos[1] > u_renderExtent[3]\n    )\n  ) {\n    discard;\n  }\n  #endif\n  if (${this.discardExpression_}) { discard; }\n\n  float segmentLength = length(v_segmentEnd - v_segmentStart);\n  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;\n  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);\n  vec2 startToPoint = currentPoint - v_segmentStart;\n  float currentLengthPx = max(0., min(dot(segmentTangent, startToPoint), segmentLength)) + v_distanceOffsetPx; \n  float currentRadiusPx = abs(dot(segmentNormal, startToPoint));\n  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;\n  vec4 color = ${this.strokeColorExpression_} * u_globalAlpha;\n  float capType = ${this.strokeCapExpression_};\n  float joinType = ${this.strokeJoinExpression_};\n  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);\n  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);\n  float distance = max(\n    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),\n    max(segmentStartDistance, segmentEndDistance)\n  );\n  distance = max(distance, ${this.strokeDistanceFieldExpression_});\n  gl_FragColor = color * smoothstep(0.5, -0.5, distance);\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.1) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}`:null}getFillVertexShader(){return this.hasFill_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nattribute vec2 a_position;\nattribute vec4 a_prop_hitColor;\n${this.attributes_.map(function(e){return"attribute "+e+";"}).join("\n")}\nvarying vec4 v_prop_hitColor;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.vertexShaderFunctions_.join("\n")}\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);\n  v_prop_hitColor = a_prop_hitColor;\n${this.varyings_.map(function(e){return"  "+e.name+" = "+e.expression+";"}).join("\n")}\n}`:null}getFillFragmentShader(){return this.hasFill_?`${ke}\n${this.uniforms_.map(function(e){return"uniform "+e+";"}).join("\n")}\nvarying vec4 v_prop_hitColor;\n${this.varyings_.map(function(e){return"varying "+e.type+" "+e.name+";"}).join("\n")}\n${this.fragmentShaderFunctions_.join("\n")}\nvec2 pxToWorld(vec2 pxPos) {\n  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;\n  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;\n}\n\nvec2 worldToPx(vec2 worldPos) {\n  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);\n  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;\n}\n\nvoid main(void) {\n  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;\n  vec2 pxOrigin = worldToPx(u_patternOrigin);\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n  vec2 worldPos = pxToWorld(pxPos);\n  if (\n    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (\n      worldPos[0] < u_renderExtent[0] ||\n      worldPos[1] < u_renderExtent[1] ||\n      worldPos[0] > u_renderExtent[2] ||\n      worldPos[1] > u_renderExtent[3]\n    )\n  ) {\n    discard;\n  }\n  #endif\n  if (${this.discardExpression_}) { discard; }\n  gl_FragColor = ${this.fillColorExpression_} * u_globalAlpha;\n  if (u_hitDetection > 0) {\n    if (gl_FragColor.a < 0.1) { discard; };\n    gl_FragColor = v_prop_hitColor;\n  }\n}`:null}}const en=["#00f","#0ff","#0f0","#ff0","#f00"],nn=class tn extends Ze.A{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.gradient_=null,this.addChangeListener("gradient",this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:en),this.setBlur(void 0!==e.blur?e.blur:15),this.setRadius(void 0!==e.radius?e.radius:8);const r=e.weight?e.weight:"weight";this.weightFunction_="string"==typeof r?function(i){return i.get(r)}:r,this.setRenderOrder(null)}getBlur(){return this.get("blur")}getGradient(){return this.get("gradient")}getRadius(){return this.get("radius")}handleGradientChanged_(){this.gradient_=function rn(n){const r=(0,ze.Y)(1,256),i=r.createLinearGradient(0,0,1,256),o=1/(n.length-1);for(let a=0,c=n.length;a<c;++a)i.addColorStop(a*o,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}(this.getGradient())}setBlur(e){this.set("blur",e)}setGradient(e){this.set("gradient",e)}setRadius(e){this.set("radius",e)}createRenderer(){const e=(new qr).addAttribute("float a_prop_weight").addVarying("v_prop_weight","float","a_prop_weight").addUniform("float u_size").addUniform("float u_blurSlope").setSymbolSizeExpression("vec2(u_size)").setSymbolColorExpression("vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * u_blurSlope) * v_prop_weight)");return new _r(this,{className:this.getClassName(),attributes:[{name:"weight",callback:t=>{const r=this.weightFunction_(t);return void 0!==r?(0,Tt.qE)(r,0,1):1}}],uniforms:{u_size:()=>2*(this.get("radius")+this.get("blur")),u_blurSlope:()=>this.get("radius")/Math.max(1,this.get("blur"))},hitDetectionEnabled:!0,vertexShader:e.getSymbolVertexShader(),fragmentShader:e.getSymbolFragmentShader(),postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}};var wt=_(9346),ft=_(2080),dt=_(7908),Ct=_(8201),on=_(3942),sn=_(5927),Ee=_(6370),Dt=_(4579),Lt=_(6490);const Kt=class ln extends Dt.Ay{constructor(e){const t=void 0!==e.crossOrigin?e.crossOrigin:null,r=void 0!==e.imageLoadFunction?e.imageLoadFunction:Dt.VV;super({attributions:e.attributions,interpolate:e.interpolate,projection:(0,Oe.Jt)(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image=null,this.image=new Lt.Ay(this.imageExtent_,void 0,1,function an(n){const e=n.load||Lt.D4,t=n.imageExtent,r=new Image;return null!==n.crossOrigin&&(r.crossOrigin=n.crossOrigin),()=>e(r,n.url).then(i=>{const o=(0,ee.RG)(t)/i.width,a=(0,ee.Oq)(t)/i.height;return{image:i,extent:t,resolution:o!==a?[o,a]:a,pixelRatio:1}})}({url:e.url,imageExtent:e.imageExtent,crossOrigin:t,load:(i,o)=>(this.image.setImage(i),r(this.image,o),(0,Lt.D4)(i))})),this.image.addEventListener(Ne.A.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,t,r,i){return(0,ee.HY)(e,this.image.getExtent())?this.image:null}getUrl(){return this.url_}};var It=_(6160),Qt=_(1888),qt=_(1395),cn=_(6138),un=_(7659),hn=_(1950);const fn=class pn extends Dt.Ay{constructor(e){super({attributions:(e=e||{}).attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvasFunction_=e.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==e.ratio?e.ratio:1.5}getImageInternal(e,t,r,i){t=this.findNearestResolution(t);let o=this.canvas_;if(o&&this.renderedRevision_==this.getRevision()&&o.getResolution()==t&&o.getPixelRatio()==r&&(0,ee.ms)(o.getExtent(),e))return o;e=e.slice(),(0,ee.Af)(e,this.ratio_);const a=(0,ee.RG)(e)/t,c=(0,ee.Oq)(e)/t,p=this.canvasFunction_.call(this,e,t,r,[a*r,c*r],i);return p&&(o=new hn.A(e,t,r,p)),this.canvas_=o,this.renderedRevision_=this.getRevision(),o}};var er=_(7712),tr=_(3672),dn=_(1780),gn=_(9557),mn=_(7651),xn=_(4249),vn=_(5078),yn=_(2879),_n=_(4367),Tn=_(8654),En=_(4157),Rn=_(3777);const An={Point:function Pn(n,e,t){const r=n.coordinates;return e&&t&&Mt(r,e,t),new Tn.A(r)},LineString:function Fn(n,e){const t=gt(n.arcs,e);return new xn.A(t)},Polygon:function Cn(n,e){const t=[];for(let r=0,i=n.arcs.length;r<i;++r)t[r]=gt(n.arcs[r],e);return new En.Ay(t)},MultiPoint:function bn(n,e,t){const r=n.coordinates;if(e&&t)for(let i=0,o=r.length;i<o;++i)Mt(r[i],e,t);return new yn.A(r)},MultiLineString:function wn(n,e){const t=[];for(let r=0,i=n.arcs.length;r<i;++r)t[r]=gt(n.arcs[r],e);return new vn.A(t)},MultiPolygon:function Dn(n,e){const t=[];for(let r=0,i=n.arcs.length;r<i;++r){const o=n.arcs[r],a=[];for(let c=0,f=o.length;c<f;++c)a[c]=gt(o[c],e);t[r]=a}return new _n.A(t)}};function gt(n,e){const t=[];let r;for(let i=0,o=n.length;i<o;++i)if(r=n[i],i>0&&t.pop(),r>=0){const a=e[r];for(let c=0,f=a.length;c<f;++c)t.push(a[c].slice(0))}else{const a=e[~r];for(let c=a.length-1;c>=0;--c)t.push(a[c].slice(0))}return t}function Ln(n,e,t,r,i,o,a){const c=n.geometries,f=[];for(let p=0,m=c.length;p<m;++p)f[p]=rr(c[p],e,t,r,i,o,a);return f}function rr(n,e,t,r,i,o,a){let c=null;const f=n.type;if(f){const x=An[f];c="Point"===f||"MultiPoint"===f?x(n,t,r):x(n,e),c=(0,Rn.hX)(c,!1,a)}const p=new gn.A({geometry:c});void 0!==n.id&&p.setId(n.id);let m=n.properties;return i&&(m||(m={}),m[i]=o),m&&p.setProperties(m,!0),p}function Mn(n,e,t){let r=0,i=0;for(let o=0,a=n.length;o<a;++o){const c=n[o];r+=c[0],i+=c[1],c[0]=r,c[1]=i,Mt(c,e,t)}}function Mt(n,e,t){n[0]=n[0]*e[0]+t[0],n[1]=n[1]*e[1]+t[1]}const Gn=class Sn extends mn.A{constructor(e){super(),this.layerName_=(e=e||{}).layerName,this.layers_=e.layers?e.layers:null,this.dataProjection=(0,Oe.Jt)(e.dataProjection?e.dataProjection:"EPSG:4326")}readFeaturesFromObject(e,t){if("Topology"==e.type){const r=e;let i,o=null,a=null;r.transform&&(i=r.transform,o=i.scale,a=i.translate);const c=r.arcs;i&&function In(n,e,t){for(let r=0,i=n.length;r<i;++r)Mn(n[r],e,t)}(c,o,a);const f=[],p=r.objects,m=this.layerName_;let x;for(const E in p)this.layers_&&!this.layers_.includes(E)||("GeometryCollection"===p[E].type?(x=p[E],f.push.apply(f,Ln(x,c,o,a,m,E,t))):(x=p[E],f.push(rr(x,c,o,a,m,E,t))));return f}return[]}readProjectionFromObject(e){return this.dataProjection}};var On=_(9422),Re=_(9380),Je=_(5409),fe=_(1540),nr=_(221),Nn=_(730),h=_(3279),Z=_(213);let Un=(()=>{class n{set value(t){this.privValue!==t&&(this.privValue=t,this.layer?.custom_layer&&this.layer.custom_layer.setRadius(t))}get value(){return this.privValue}constructor(){this.privValue=1,this.valueChange=new h.bkB}ngOnInit(){this.layer.custom_layer.setRadius(this.value)}changeValue(t){const r=parseInt(t.target.value,10);this.value=r,this.valueChange.emit(r),this.layer.custom_layer&&this.layer.custom_layer.setRadius(r)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-example-layer-action"]],inputs:{layer:"layer",value:"value"},outputs:{valueChange:"valueChange"},standalone:!0,features:[h.aNF],decls:6,vars:2,consts:[[1,"heatmap-range"],["type","range","clrRange","","name","two","min","1","max","50","step","1",1,"ukis-range-input",3,"change","value"]],template:function(r,i){1&r&&(h.j41(0,"clr-range-container",0)(1,"label"),h.EFF(2,"Heatmap radius:"),h.k0s(),h.j41(3,"input",1),h.bIt("change",function(a){return i.changeValue(a)}),h.k0s(),h.j41(4,"clr-control-helper"),h.EFF(5),h.k0s()()),2&r&&(h.R7$(3),h.Y8G("value",i.value),h.R7$(2),h.JRh(" "+i.value))},dependencies:[Z.xCE,Z.aZZ,Z.bnk,Z.HzI,Z.SEO,Z.uQ$],styles:[".heatmap-range[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}"]})}}return n})();const Gt={type:"FeatureCollection",features:[{type:"Feature",properties:{height:2},geometry:{type:"Polygon",coordinates:[[[11.539764404296875,48.17707562779612,2],[11.53289794921875,48.13126755117026],[11.51641845703125,48.12301775410865],[11.517791748046875,48.10926514749487],[11.56036376953125,48.11384975871469],[11.564483642578125,48.12301775410865],[11.58233642578125,48.130350972491556],[11.592292785644531,48.14043243818811],[11.594696044921875,48.14730502988628],[11.602935791015625,48.15715413998257],[11.595039367675781,48.1640244926387],[11.59950256347656,48.17226770127996],[11.587142944335938,48.177533502046636],[11.572036743164062,48.177533502046636],[11.539764404296875,48.17707562779612]]]}},{type:"Feature",properties:{height:1},geometry:{type:"Polygon",coordinates:[[[11.605682373046875,48.156238023440835],[11.596412658691406,48.147534100428686],[11.59332275390625,48.13699579726703],[11.583709716796875,48.12851776605501],[11.564826965332031,48.121413473016034],[11.561737060546875,48.11247441829591],[11.575126647949217,48.11155750423242],[11.581993103027344,48.10490938797694],[11.614608764648438,48.11178673428214],[11.620101928710938,48.12462198509838],[11.614952087402344,48.12920522613733],[11.614265441894531,48.13905780942574],[11.61529541015625,48.15165719536032],[11.605682373046875,48.156238023440835]]]}},{type:"Feature",properties:{height:3},geometry:{type:"Polygon",coordinates:[[[11.516075134277344,48.12347611093252],[11.532554626464844,48.131496693283744],[11.538734436035156,48.176388808753124],[11.52191162109375,48.175701980509444],[11.511268615722656,48.17249666038475],[11.507148742675781,48.16379549570767],[11.492729187011719,48.165398452755674],[11.486892700195312,48.16379549570767],[11.458740234375,48.164482483433744],[11.457366943359375,48.15188624647704],[11.455307006835938,48.148221305921446],[11.436767578124998,48.133329793382636],[11.430244445800781,48.12874692043826],[11.443977355957031,48.12828861064926],[11.45050048828125,48.12553866602599],[11.4862060546875,48.124392812310205],[11.503028869628904,48.12553866602599],[11.516075134277344,48.12347611093252]]]}},{type:"Feature",properties:{height:0},geometry:{type:"Polygon",coordinates:[[[11.517448425292969,48.10972362702285],[11.487579345703125,48.095738161288885],[11.488265991210938,48.08381312049231],[11.485176086425781,48.075785093732456],[11.487922668457031,48.07486752519069],[11.493759155273438,48.07693203139914],[11.506805419921875,48.0762438718672],[11.517448425292969,48.06890293081563],[11.536331176757812,48.068214663899795],[11.538734436035156,48.07349114169717],[11.540107727050781,48.08427182703979],[11.548004150390625,48.09367440979962],[11.549720764160154,48.10559716402152],[11.559333801269531,48.11407897853892],[11.517448425292969,48.10972362702285]]]}}]},Ot={type:"FeatureCollection",features:[{type:"Feature",properties:{pid:1},geometry:{type:"Point",coordinates:[10.9423828125,49.001843917978526]}},{type:"Feature",properties:{pid:2},geometry:{type:"Point",coordinates:[11.18408203125,49.088257784724675]}},{type:"Feature",properties:{pid:3},geometry:{type:"Point",coordinates:[11.030273437499998,49.35375571830993]}},{type:"Feature",properties:{pid:4},geometry:{type:"Point",coordinates:[10.72265625,49.24629332459796]}},{type:"Feature",properties:{pid:5},geometry:{type:"Point",coordinates:[12.76611328125,48.011975126709956]}},{type:"Feature",properties:{pid:6},geometry:{type:"Point",coordinates:[13.55712890625,49.15296965617042]}},{type:"Feature",properties:{pid:7},geometry:{type:"Point",coordinates:[13.3154296875,48.545705491847464]}},{type:"Feature",properties:{pid:8},geometry:{type:"Point",coordinates:[4.482421875,49.224772722794825]}}]},Bn={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Feature 1 - Polygon"},geometry:{type:"Polygon",coordinates:[[[7.91015625,50.233151832472245],[9.140625,47.81315451752768],[13.33740234375,48.28319289548349],[13.7109375,50.17689812200107],[7.91015625,50.233151832472245]]]}}]},ir={type:"FeatureCollection",features:[{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.3",geometry:{type:"Point",coordinates:[14.354708,54.004536]},geometry_name:"geom",properties:{lat:"54.004536",lon:"14.354708",id:"3",timestamp:"2020-09-13T16:52:57Z",SWH:"1.13",plength:"209.7",windSpeed:"4.25",pdirection:"125.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.4",geometry:{type:"Point",coordinates:[14.445045,54.013187]},geometry_name:"geom",properties:{lat:"54.013187",lon:"14.445045",id:"4",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"251.0",windSpeed:"3.75",pdirection:"11.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.5",geometry:{type:"Point",coordinates:[14.535383,54.021835]},geometry_name:"geom",properties:{lat:"54.021835",lon:"14.535383",id:"5",timestamp:"2020-09-13T16:52:57Z",SWH:"1.08",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.6",geometry:{type:"Point",coordinates:[14.625798,54.030346]},geometry_name:"geom",properties:{lat:"54.030346",lon:"14.625798",id:"6",timestamp:"2020-09-13T16:52:57Z",SWH:"0.99",plength:"194.6",windSpeed:"4.00",pdirection:"171.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.7",geometry:{type:"Point",coordinates:[14.716214,54.038853]},geometry_name:"geom",properties:{lat:"54.038853",lon:"14.716214",id:"7",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"475.4",windSpeed:"4.05",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.8",geometry:{type:"Point",coordinates:[13.978081,54.022915]},geometry_name:"geom",properties:{lat:"54.022915",lon:"13.978081",id:"8",timestamp:"2020-09-13T16:52:57Z",SWH:"0.66",plength:"475.4",windSpeed:"3.50",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.9",geometry:{type:"Point",coordinates:[14.068372,54.031853]},geometry_name:"geom",properties:{lat:"54.031853",lon:"14.068372",id:"9",timestamp:"2020-09-13T16:52:57Z",SWH:"1.03",plength:"452.5",windSpeed:"4.20",pdirection:"135.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.10",geometry:{type:"Point",coordinates:[14.158684,54.040756]},geometry_name:"geom",properties:{lat:"54.040756",lon:"14.158684",id:"10",timestamp:"2020-09-13T16:52:57Z",SWH:"0.47",plength:"199.9",windSpeed:"4.40",pdirection:"51.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.11",geometry:{type:"Point",coordinates:[14.249058,54.049553]},geometry_name:"geom",properties:{lat:"54.049553",lon:"14.249058",id:"11",timestamp:"2020-09-13T16:52:57Z",SWH:"1.36",plength:"420.9",windSpeed:"4.40",pdirection:"80.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.12",geometry:{type:"Point",coordinates:[14.339441,54.058331]},geometry_name:"geom",properties:{lat:"54.058331",lon:"14.339441",id:"12",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"134.6",windSpeed:"3.95",pdirection:"3.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.13",geometry:{type:"Point",coordinates:[14.429894,54.066982]},geometry_name:"geom",properties:{lat:"54.066982",lon:"14.429894",id:"13",timestamp:"2020-09-13T16:52:57Z",SWH:"1.01",plength:"351.6",windSpeed:"4.15",pdirection:"164.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.14",geometry:{type:"Point",coordinates:[14.52035,54.075634]},geometry_name:"geom",properties:{lat:"54.075634",lon:"14.520350",id:"14",timestamp:"2020-09-13T16:52:57Z",SWH:"1.16",plength:"310.4",windSpeed:"4.45",pdirection:"166.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.15",geometry:{type:"Point",coordinates:[14.610882,54.084145]},geometry_name:"geom",properties:{lat:"54.084145",lon:"14.610882",id:"15",timestamp:"2020-09-13T16:52:57Z",SWH:"1.00",plength:"210.4",windSpeed:"4.05",pdirection:"170.5"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.16",geometry:{type:"Point",coordinates:[14.701414,54.092651]},geometry_name:"geom",properties:{lat:"54.092651",lon:"14.701414",id:"16",timestamp:"2020-09-13T16:52:57Z",SWH:"0.98",plength:"254.7",windSpeed:"4.40",pdirection:"174.3"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.17",geometry:{type:"Point",coordinates:[14.792017,54.101032]},geometry_name:"geom",properties:{lat:"54.101032",lon:"14.792017",id:"17",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"475.4",windSpeed:"4.45",pdirection:"158.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.18",geometry:{type:"Point",coordinates:[14.882627,54.109398]},geometry_name:"geom",properties:{lat:"54.109398",lon:"14.882627",id:"18",timestamp:"2020-09-13T16:52:57Z",SWH:"0.94",plength:"188.2",windSpeed:"4.25",pdirection:"107.1"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.19",geometry:{type:"Point",coordinates:[14.973297,54.117649]},geometry_name:"geom",properties:{lat:"54.117649",lon:"14.973297",id:"19",timestamp:"2020-09-13T16:52:57Z",SWH:"0.91",plength:"404.8",windSpeed:"4.00",pdirection:"161.6"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.20",geometry:{type:"Point",coordinates:[15.063984,54.12587]},geometry_name:"geom",properties:{lat:"54.125870",lon:"15.063984",id:"20",timestamp:"2020-09-13T16:52:57Z",SWH:"0.90",plength:"170.3",windSpeed:"4.10",pdirection:"176.2"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.21",geometry:{type:"Point",coordinates:[15.154721,54.133991]},geometry_name:"geom",properties:{lat:"54.133991",lon:"15.154721",id:"21",timestamp:"2020-09-13T16:52:57Z",SWH:"0.69",plength:"475.4",windSpeed:"4.00",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.22",geometry:{type:"Point",coordinates:[14.052757,54.085644]},geometry_name:"geom",properties:{lat:"54.085644",lon:"14.052757",id:"22",timestamp:"2020-09-13T16:52:57Z",SWH:"0.28",plength:"475.4",windSpeed:"4.25",pdirection:"21.8"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.26",geometry:{type:"Point",coordinates:[14.414745,54.120781]},geometry_name:"geom",properties:{lat:"54.120781",lon:"14.414745",id:"26",timestamp:"2020-09-13T16:52:57Z",SWH:"1.10",plength:"129.3",windSpeed:"4.20",pdirection:"45.0"}},{type:"Feature",id:"S1A_IW_GRDH_1SDV_20200913T165301_20200913T165326_034343_03FE2F_9368_WAVE.27",geometry:{type:"Point",coordinates:[14.505316,54.129433]},geometry_name:"geom",properties:{lat:"54.129433",lon:"14.505316",id:"27",timestamp:"2020-09-13T16:52:57Z",SWH:"0.50",plength:"310.4",windSpeed:"4.60",pdirection:"14.0"}}]};var K=_(7222);let jn=(()=>{class n{constructor(){this.sunlightForm=new K.gE({x:new K.MJ(0,K.k0.required),y:new K.MJ(0,K.k0.required)})}ngOnInit(){this.sunlightForm.valueChanges.subscribe(t=>{this.changeHandler(parseInt(t.x.toString(),10)/100,parseInt(t.y.toString(),10)/100)})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-sunlight"]],inputs:{changeHandler:"changeHandler"},standalone:!0,features:[h.aNF],decls:16,vars:1,consts:[["clrForm","","clrLayout","horizontal",3,"formGroup"],[1,"sun-range-label"],[1,"sun-range"],["type","range","min","-100","max","100","value","0","clrRange","","formControlName","x",1,"ukis-range-input"],["type","range","min","-100","max","100","value","0","clrRange","","formControlName","y",1,"ukis-range-input"]],template:function(r,i){1&r&&(h.j41(0,"form",0),h.nrm(1,"hr"),h.j41(2,"label",1),h.EFF(3,"Sun position"),h.k0s(),h.j41(4,"clr-range-container",2)(5,"label"),h.EFF(6,"x"),h.k0s(),h.nrm(7,"input",3),h.j41(8,"clr-control-helper"),h.EFF(9,"east -> west"),h.k0s()(),h.j41(10,"clr-range-container",2)(11,"label"),h.EFF(12,"y"),h.k0s(),h.nrm(13,"input",4),h.j41(14,"clr-control-helper"),h.EFF(15,"south -> north"),h.k0s()()()),2&r&&h.Y8G("formGroup",i.sunlightForm)},dependencies:[K.YN,K.qT,K.me,K.MR,K.BC,K.cb,Z.uQ$,Z.aZZ,Z.bnk,Z.mDd,Z.a3p,K.X1,K.j4,K.JD,Z.xCE,Z.HzI,Z.SEO],styles:[".sun-range[_ngcontent-%COMP%]{margin-top:0}.sun-range-label[_ngcontent-%COMP%]{padding-left:0;font-weight:600}"]})}}return n})(),Wn=(()=>{class n{constructor(){this.interpolationForm=new K.gE({power:new K.MJ(2,K.k0.required),smooth:new K.MJ(!0,K.k0.required),labels:new K.MJ(!1,K.k0.required)})}ngOnInit(){this.interpolationForm.valueChanges.subscribe(t=>{this.changeHandler(t.power,t.smooth,t.labels)})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-interpolation-settings"]],inputs:{changeHandler:"changeHandler"},standalone:!0,features:[h.aNF],decls:21,vars:1,consts:[["clrForm","","clrLayout","vertical",3,"formGroup"],["type","range","min","1","max","7","value","1","clrInput","","formControlName","power",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","true","formControlName","smooth",1,"ukis-range-input"],["type","checkbox","clrCheckbox","","name","options","value","false","formControlName","labels",1,"ukis-range-input"]],template:function(r,i){1&r&&(h.j41(0,"form",0)(1,"clr-input-container")(2,"label"),h.EFF(3,"Power"),h.k0s(),h.nrm(4,"input",1),h.j41(5,"clr-control-helper"),h.EFF(6,"inverse distance weighting power"),h.k0s()(),h.j41(7,"clr-checkbox-container")(8,"label"),h.EFF(9,"Smoothing"),h.k0s(),h.j41(10,"clr-checkbox-wrapper"),h.nrm(11,"input",2),h.j41(12,"label"),h.EFF(13,"Smoothing"),h.k0s()()(),h.j41(14,"clr-checkbox-container")(15,"label"),h.EFF(16,"Labels"),h.k0s(),h.j41(17,"clr-checkbox-wrapper"),h.nrm(18,"input",3),h.j41(19,"label"),h.EFF(20,"Show labels"),h.k0s()()()()),2&r&&h.Y8G("formGroup",i.interpolationForm)},dependencies:[K.YN,K.qT,K.me,K.MR,K.Zm,K.BC,K.cb,Z.uQ$,Z.aZZ,Z.bnk,Z.mDd,Z.a3p,K.X1,K.j4,K.JD,Z.AZk,Z.icl,Z.Xu5,Z.Nsh,Z.Jej,Z.EjB,Z.eAx]})}}return n})();var de=_(341),Zn=_(5812),Hn=_(3812);class $n extends wt.A{constructor(e){super(e)}createRenderer(){return new zn(this)}}class zn extends Hn.A{constructor(e){super(e);const t=document.createElement("canvas");t.width=800,t.height=600,t.style.position="absolute";const i=e.getSource().getFeatures(),o=this.featuresToMeshes(i),a=new de.JeP({canvas:t,alpha:!0}),c=new de.ubm(45,t.width/t.height,.01,3e7);c.position.set(0,0,10),c.lookAt(new de.Pq0(0,0,0));const f=new de.Z58;for(const m of o)f.add(m);const p=new de.ZyN(16777215,1);p.position.set(-1,2,4),f.add(p),this.canvas=t,this.scene=f,this.meshes=o,this.renderer=a,this.camera=c}prepareFrame(e){const t=e.pixelRatio,r=e.size,i=Math.round(r[0]*t),o=Math.round(r[1]*t),c=e.viewState.center,m=this.extent2Height(e.extent,45);return this.camera.aspect=i/o,this.camera.fov=45,this.camera.near=.01,this.camera.far=3e8,this.camera.position.set(c[0],c[1],m),this.camera.lookAt(new de.Pq0(c[0],c[1],0)),this.camera.updateProjectionMatrix(),(r[0]!==this.canvas.width||r[1]!==this.canvas.height)&&(this.canvas.width=r[0],this.canvas.height=r[1],this.renderer.setSize(this.canvas.width,this.canvas.height)),this.canvas.style.opacity=""+e.layerStatesArray[e.layerIndex].opacity,!0}renderFrame(e,t){return this.renderer.render(this.scene,this.camera),this.canvas}renderDeclutter(e){}featuresToMeshes(e){const t=[];for(const r of e){const i=r.getGeometry(),o=r.get("height"),a=this.fGeom2tGeom(i,.1*o),c=new de.Q1f(16777215);c.setHex(16777215*Math.random());const f=new de.tXL({color:c}),p=new de.eaF(a,f);t.push(p)}return t}fGeom2tGeom(e,t){const r=e.getCoordinates()[0],i=new de.ypk;i.moveTo(r[0][0],r[0][1]);for(let o=1;o<r.length;o++){const a=r[o];i.lineTo(a[0],a[1])}return new de.QCA(i,{depth:t,bevelEnabled:!1})}extent2Height(e,t){return(0,Zn.xm)(e[3]-e[1],t)}}var or=_(1363),Vn=_(7327);const Xn=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"name":"Polygon 1"},"geometry":{"type":"Polygon","coordinates":[[[-0.703125,56.12106042504407],[-2.197265625,49.15296965617042],[5.009765625,45.460130637921004],[16.435546875,46.37725420510028],[20.0390625,55.229023057406344],[4.658203125,58.03137242177637],[-0.703125,56.12106042504407]]]}},{"type":"Feature","properties":{"name":"Polygon 2"},"geometry":{"type":"Polygon","coordinates":[[[6.6796875,58.768200159239576],[19.86328125,56.80087831233043],[22.5,62.99515845212052],[10.01953125,64.88626540914477],[6.328125,62.062733258846514],[6.6796875,58.768200159239576]]]}},{"type":"Feature","properties":{"name":"Polygon 3"},"geometry":{"type":"Polygon","coordinates":[[[30.937499999999996,62.02152819100765],[23.994140624999996,62.062733258846514],[22.587890625,55.3791104480105],[37.79296875,55.62799595426723],[30.937499999999996,62.02152819100765]]]}},{"type":"Feature","properties":{"name":"Polygon 4"},"geometry":{"type":"Polygon","coordinates":[[[-8.876953125,39.436192999314095],[-11.689453125,28.459033019728043],[0.615234375,25.562265014427492],[8.173828125,33.137551192346145],[-0.9667968749999999,38.8225909761771],[-8.876953125,39.436192999314095]]]}},{"type":"Feature","properties":{"name":"Polygon 5"},"geometry":{"type":"Polygon","coordinates":[[[-140.44921875,-52.26815737376816],[-70.83984375,-52.26815737376816],[-70.83984375,59.17592824927136],[-140.44921875,59.17592824927136],[-140.44921875,-52.26815737376816]]]}}]}');function kn(n,e){if(1&n&&(h.j41(0,"li"),h.EFF(1),h.k0s()),2&n){const t=e.$implicit,r=h.XpG();h.R7$(),h.Lme(" ",t,": ",r.group[t]||"undefined"," ")}}let Yn=(()=>{class n{constructor(t){this.layersSvc=t}ngOnInit(){this.groupkeys=["bbox","cssClass","displayName","filtertype","id","name","removable"]}static{this.\u0275fac=function(r){return new(r||n)(h.rXU(Q._t))}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-example-group-action"]],inputs:{group:"group"},standalone:!0,features:[h.aNF],decls:6,vars:0,template:function(r,i){1&r&&(h.j41(0,"div")(1,"span"),h.EFF(2,"some properties of the group:"),h.k0s(),h.j41(3,"ul"),h.Z7z(4,kn,2,2,"li",null,h.fX1),h.k0s()()),2&r&&(h.R7$(4),h.Dyx(i.groupkeys))}})}}return n})();var Jn=_(1584);function Kn(n,e){if(1&n&&(h.j41(0,"th"),h.EFF(1),h.k0s()),2&n){const t=e.$implicit;h.R7$(),h.JRh(t.key)}}function Qn(n,e){if(1&n&&(h.j41(0,"td"),h.EFF(1),h.k0s()),2&n){const t=e.$implicit;h.R7$(),h.JRh(t.value)}}let qn=(()=>{class n{constructor(){}ngOnInit(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-popup2"]],inputs:{data:"data"},standalone:!0,features:[h.aNF],decls:13,vars:4,consts:[[1,"table"]],template:function(r,i){1&r&&(h.j41(0,"table",0)(1,"caption"),h.EFF(2," Demo for a basic Clarity table. "),h.k0s(),h.j41(3,"thead")(4,"tr"),h.Z7z(5,Kn,2,1,"th",null,h.fX1),h.nI1(7,"keyvalue"),h.k0s()(),h.j41(8,"tbody")(9,"tr"),h.Z7z(10,Qn,2,1,"td",null,h.fX1),h.nI1(12,"keyvalue"),h.k0s()()()),2&r&&(h.R7$(5),h.Dyx(h.bMT(7,0,i.data)),h.R7$(5),h.Dyx(h.bMT(12,2,i.data)))},dependencies:[ne.lG]})}}return n})();var ei=_(3982),ti=_(479);const ni=["paperclip",(0,_(6256).s)({outline:'<path d="M8.42,32.6A6.3,6.3,0,0,1,4,30.79l-.13-.13A6.2,6.2,0,0,1,2,26.22,6.77,6.77,0,0,1,4,21.4L19.5,6.07a8.67,8.67,0,0,1,12.15-.35A8,8,0,0,1,34,11.44a9,9,0,0,1-2.7,6.36L17.37,31.6A1,1,0,1,1,16,30.18L29.89,16.38A7,7,0,0,0,32,11.44a6,6,0,0,0-1.76-4.3,6.67,6.67,0,0,0-9.34.35L5.45,22.82A4.78,4.78,0,0,0,4,26.22a4.21,4.21,0,0,0,1.24,3l.13.13a4.64,4.64,0,0,0,6.5-.21L25.22,15.94A2.7,2.7,0,0,0,26,14a2.35,2.35,0,0,0-.69-1.68,2.61,2.61,0,0,0-3.66.13l-9.2,9.12a1,1,0,1,1-1.41-1.42L20.28,11a4.62,4.62,0,0,1,6.48-.13A4.33,4.33,0,0,1,28,14a4.68,4.68,0,0,1-1.41,3.34L13.28,30.58A6.91,6.91,0,0,1,8.42,32.6Z"/>'})];var ii=_(3522);ei.h.addIcons(ti.Q,ni);let sr=(()=>{class n{constructor(t,r,i){this.layersSvc=t,this.mapStateSvc=r,this.mapSvc=i,this.class="content-container",this.test=[],this.inputValue={value:15},this.controls={attribution:!0,scaleLine:!0,overviewMap:!0}}ngOnInit(){this.addLayers()}setInput(){const t=this.layersSvc.getLayerById("heatmap_layer");this.inputValue.value=40,t.action.inputs.value=this.inputValue.value}addLayers(){const t=new Ke.dl({id:"OSM1",visible:!1,bbox:[-66.408,3.577,113.592,64.94]}),r=new Q.tr({id:"heatmap_layer",name:"Heatmap Layer",actions:[{title:"test",icon:"paperclip",action:B=>{}}],popup:{event:"click"},action:{component:Un,inputs:this.inputValue,outputs:{valueChange:B=>{this.inputValue.value=B}}},custom_layer:new nn({source:new Ee.A({features:this.mapSvc.geoJsonToFeatures(Ot),format:new tr.A}),radius:this.inputValue.value}),visible:!1}),i=new Q.vK({id:"Vector Layer1",name:"Vector Layer",type:"geojson",data:Ot,visible:!0,popup:{single:!0}}),o=new Q.tr({id:"Layer_KML",name:"KML - VectorLayer",popup:!0,custom_layer:new wt.A({source:new Ee.A({url:"assets/kml/TimeZones.kml",format:new dn.Ay({extractStyles:!0})})}),visible:!1,bbox:[-180,-90,180,90]}),a=new Q.tr({id:"topo_json_layer",name:"Topo Json - VectorImageLayer",custom_layer:new ft.A({source:new Ee.A({url:"https://openlayers.org/en/latest/examples/data/topojson/world-110m.json",format:new Gn({layers:["countries"]}),overlaps:!1}),style:(B,ge)=>((0,d.v6)(B),[new Re.Ay({stroke:new Je.A({color:"gray",width:1}),fill:new fe.A({color:"rgba(0, 153, 255, 0.2)"})})])}),visible:!1}),c=new Q.tr({id:"geo_json_layer_ocean",name:"GeoJson - VectorImageLayer ocean",popup:{event:"move"},custom_layer:new ft.A({source:new Ee.A({features:this.mapSvc.geoJsonToFeatures(Vn)}),style:(B,ge)=>new Re.Ay({stroke:new Je.A({color:"gray",width:1}),fill:new fe.A({color:"rgba(20,20,20,0.9)"})})}),visible:!0,bbox:[-180.35156249999997,-22.268764039073968,-129.375,29.84064389983441]}),f=new Q.tr({id:"geo_json_layer_polys",name:"GeoJson polys - VectorImageLayer",popup:[{event:"click",single:!0,options:{autoPan:!1},dynamicPopup:{component:Jn.o,getAttributes:B=>({data:B.properties})}},{event:"move",options:{autoPan:!1},dynamicPopup:{component:qn,getAttributes:B=>({data:B.properties})}}],custom_layer:new ft.A({source:new Ee.A({features:this.mapSvc.geoJsonToFeatures(Xn)}),style:(B,ge)=>new Re.Ay({stroke:new Je.A({color:"gray",width:1}),fill:new fe.A({color:"rgba(51,153,51,1)"})})}),visible:!0}),p=new Q.tr({id:"geo_json_layer_collection",name:"GeoJson Collection - VectorImageLayer",popup:{event:"click",single:!0,options:{autoPan:!1}},custom_layer:new ft.A({source:new Ee.A({url:"assets/geojson/test.collection.json",format:new tr.A}),style:(B,ge)=>new Re.Ay({stroke:new Je.A({color:"rgba(153,51,51,1)",width:2}),fill:new fe.A({color:"rgba(153,51,51,1)"}),image:new nr.A({radius:5,fill:new fe.A({color:"rgba(153,51,51,1)"})})})}),visible:!0}),m=new Q.tr({id:"static_image_layer",name:"Static Image",visible:!1,popup:{popupFunction:B=>B.color.toString()},custom_layer:new dt.A({source:new Kt({url:"assets/image/srtm_small.png",imageExtent:[10,45,15,50],projection:"EPSG:4326"})})}),x=new Q.tr({id:"osm_clip_layer",name:"OSM Clip",visible:!0,popup:{popupFunction:B=>B.color.toString()},custom_layer:new Ct.A({source:new It.A}),bbox:[-105.41888884797893,6.480590573390401,-15.540298246016693,42.53496284727569]}),E=new Q.tr({id:"customLayerOlGroup",name:"Custom Layer OlGroup",visible:!0,opacity:.6,popup:{event:"move",popupFunction:B=>`${B.color.toString()}`,options:{autoPan:!1}},custom_layer:new on.A({layers:[new Ct.A({source:new Qt.A({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"litemap",TILED:!0},serverType:"geoserver",transition:0})}),new Ct.A({source:new Qt.A({url:"https://geoservice.dlr.de/eoc/basemap/wms",params:{LAYERS:"liteoverlay",TILED:!0},serverType:"geoserver",transition:0})})]}),bbox:[-18.213,-26.814,68.344,11.783]}),T=new Q.tr({id:"clusterLayer",name:"cluster Layer - VectorLayer",visible:!1,popup:!0,custom_layer:new wt.A({source:new qt.A({distance:10,source:new Ee.A({features:this.mapSvc.geoJsonToFeatures(Ot)})})})}),R=new Q.tr({id:"vectorTile",name:"VectorTileLayer",visible:!1,popup:{event:"move",filterkeys:["name","layer","class"],properties:{name:"Name"},options:{autoPan:!1}},custom_layer:new sn.A({source:new cn.A({format:new On.A,url:"https://tiles.geoservice.dlr.de/service/tms/1.0.0/planet_eoc@EPSG%3A900913@pbf/{z}/{x}/{y}.pbf?flipy=true"}),style:(B,ge)=>{const he=B.get("layer"),Le=B.get("class");if(this.test.includes(he)||this.test.push(he),he){if("water"===he)return new Re.Ay({fill:new fe.A({color:"rgba(67,162,202,0.9)"})});if("boundary"===he)return new Re.Ay({stroke:new Je.A({color:"gray",width:1}),fill:new fe.A({color:"rgba(0,0,0,0)"})});if("landcover"===he&&Le){if("wood"===Le)return new Re.Ay({fill:new fe.A({color:"rgba(53,151,143,0.7)"})});if("grass"===Le)return new Re.Ay({fill:new fe.A({color:"rgba(168,221,181,0.7)"})})}}}})}),L=new Q.x2({name:"Heatmap Group",filtertype:"Layers",id:"group1",layers:[r,i],description:"This is a custom layer group with some custom angular components in the UI",action:{component:Yn}}),O=new Q.tr({id:"image_wms",name:"Image WMS",custom_layer:new dt.A({source:new un.A({url:"https://ahocevar.com/geoserver/wms",params:{LAYERS:"topp:states"},serverType:"geoserver"})}),visible:!1,popup:{popupFunction:B=>B.color.toString()},bbox:[-133.9453125,18.979025953255267,-60.46875,52.908902047770255]}),N=[10,45,15,50],F=new Q.tr({id:"dtmLayer",name:"SRTM DTM",filtertype:"Layers",bbox:N,custom_layer:new or.n3({source:new Kt({url:"assets/image/srtm_small.png",imageExtent:N,projection:"EPSG:4326"})}),action:{component:jn,inputs:{changeHandler:(B,ge)=>{F.custom_layer.updateSunAngle([B,ge])}}},opacity:.6,visible:!1,description:"<p>This layer uses SRTM data to calculate surface-normals and uses them to dynamically create shades on hilltops. Things like these might be a nice illustration for time-enabled maps.</p>\n      <p>Use the controls to dynamically change the sun's angle.</p>"}),I=this.mapSvc.getProjection().getMetersPerUnit(),A=new Oe.MF({code:"EPSG:4326",units:"degrees"}).getMetersPerUnit();Gt.features.map(B=>B.properties.height=B.properties.height*A/I);const H=this.mapSvc.geoJsonToFeatures(Gt),w=this.mapSvc.getFeaturesExtent(H,!0),C=new Q.tr({id:"three",name:"Bars layer",bbox:w,custom_layer:new $n({source:new Ee.A({features:this.mapSvc.geoJsonToFeatures(Gt)})}),filtertype:"Layers",opacity:.7,visible:!1,description:"<p>This layer demonstrates how a common 3d-library, three.js, can be integrated in a 2d-map. Using three.js often yields less verbose code than calling WebGL directly.</p>"}),U=this.mapSvc.geoJsonToFeatures(ir),G=this.mapSvc.getFeaturesExtent(U,!0),Y=new Ee.A({features:this.mapSvc.geoJsonToFeatures(ir)}),re=new qt.A({source:Y,distance:25}),_e=new Q.tr({id:"interpolation",name:"Interpolation",bbox:G,custom_layer:new or.cS({source:re,style:(B,ge)=>{const he=B.getProperties().features;let Le;return Le=he.length>1?`${B.getProperties().features.length}`:`${Number.parseFloat(he[0].getProperties().SWH).toPrecision(3)}`,new Re.Ay({image:new nr.A({radius:13,fill:new fe.A({color:"rgba(0, 153, 255, 0.2)"}),stroke:new Je.A({color:"rgba(255, 255, 255, 0.2)",width:1})}),text:new Nn.A({text:Le,overflow:!0,offsetX:-5*Le.length/2,offsetY:1,textAlign:"left",fill:new fe.A({color:"#ffffff"})})})},renderSettings:{maxEdgeLength:15e3/I,power:2,colorRamp:[{val:0,rgb:[166,97,26]},{val:.4,rgb:[223,194,125]},{val:.8,rgb:[247,247,247]},{val:2,rgb:[128,205,193]},{val:22.5,rgb:[1,133,113]}],smooth:!0,showLabels:!1,valueProperty:"SWH",storeInterpolatedPixelData:!1}}),action:{component:Wn,inputs:{changeHandler:(B,ge,he)=>{_e.custom_layer.updateParas(B,ge,he)}}},filtertype:"Layers",opacity:.7,visible:!1,description:"This layer is an example of how WebGL can be used to outsource computationally expensive operations. For inverse-distance interpolation we need to account for every datapoint at every pixel."}),ue=new Q.x2({name:"Webgl Group",filtertype:"Layers",id:"group2",layers:[F,C,_e]}),De=new Q.tr({name:"Transparenter Hintergrund",id:"blank",type:"custom",visible:!1,custom_layer:new dt.A({source:new fn({canvasFunction:()=>document.createElement("canvas")})})}),je=new Q.tr({name:"Ol Raster Source OSM",id:"rasterSourceLayer",type:"custom",visible:!1,removable:!0,custom_layer:new dt.A({source:new er.Ay({sources:[new It.A],operation:B=>B[0],operationType:"image"})})});[De,je,t,R,ue,T,O,o,m,x,a,f,p,L,c,E].forEach(B=>{B instanceof Q.Wd?this.layersSvc.addLayer(B,"Layers"):B instanceof Q.x2&&this.layersSvc.addLayerGroup(B)}),setTimeout(()=>{je.visible=!0,je.custom_layer.setSource(new er.Ay({sources:[new It.A],operation:B=>B[0],operationType:"image"})),this.layersSvc.updateLayer(je)},2e3)}ngAfterViewInit(){const t=new Q.vK({id:"Vector Layer2",name:"async add Layer",type:"geojson",data:Bn,visible:!1,popup:!0});setTimeout(()=>{this.layersSvc.addLayer(t,"Layers")},2e3)}static{this.\u0275fac=function(r){return new(r||n)(h.rXU(Q._t),h.rXU(We.d),h.rXU(Ie.t))}}static{this.\u0275cmp=h.VBU({type:n,selectors:[["app-route-map4"]],hostVars:2,hostBindings:function(r,i){2&r&&h.HbH(i.class)},standalone:!0,features:[h.Jv_([Q._t,We.d,Ie.t]),h.aNF],decls:15,vars:10,consts:[[1,"content-area","map-view"],["id","olMap",3,"layersSvc","mapState","controls"],[1,"right",3,"clrVerticalNavCollapsible","clr-nav-level"],[1,"layers",3,"clrVerticalNavGroupExpanded"],["shape","layers","clrVerticalNavIcon","","title","layers"],[1,"padding","title-ellipsis"],[3,"layersSvc","mapStateSvc"],["title","set input of dynamic component from parent when it is created or the input changed",1,"btn","btn-primary",3,"click"]],template:function(r,i){1&r&&(h.j41(0,"main",0),h.nrm(1,"ukis-map-ol",1),h.k0s(),h.j41(2,"clr-vertical-nav",2)(3,"clr-vertical-nav-group",3),h.nrm(4,"cds-icon",4),h.EFF(5," Layers "),h.j41(6,"clr-vertical-nav-group-children",5),h.nrm(7,"ukis-layer-control",6),h.k0s()(),h.j41(8,"clr-vertical-nav-group",3),h.nrm(9,"cds-icon",4),h.EFF(10," Test to set dynamic component "),h.j41(11,"clr-vertical-nav-group-children",5)(12,"button",7),h.bIt("click",function(){return i.setInput()}),h.EFF(13,"Set Heatmap Layer radius"),h.k0s(),h.EFF(14),h.k0s()()()),2&r&&(h.R7$(),h.Y8G("layersSvc",i.layersSvc)("mapState",i.mapStateSvc)("controls",i.controls),h.R7$(),h.Y8G("clrVerticalNavCollapsible",!0)("clr-nav-level",2),h.R7$(),h.Y8G("clrVerticalNavGroupExpanded",!0),h.R7$(4),h.Y8G("layersSvc",i.layersSvc)("mapStateSvc",i.mapStateSvc),h.R7$(),h.Y8G("clrVerticalNavGroupExpanded",!0),h.R7$(6),h.SpI(" ",i.inputValue.value," "))},dependencies:[Ie.L,Z.HEs,Z.D2I,Z.wqM,Z.zLy,Z.Wfw,Z.BlU,Z.Qmr,Z.ndX,Z.Lfk,ii.Sj]})}}return n})();const oi=[{path:"",component:sr}];let ar=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=h.$C({type:n})}static{this.\u0275inj=h.G2t({imports:[me.iI.forChild(oi),me.iI]})}}return n})(),si=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=h.$C({type:n})}static{this.\u0275inj=h.G2t({imports:[ne.MD,ar,Z.PuD,sr]})}}return n})()}}]);